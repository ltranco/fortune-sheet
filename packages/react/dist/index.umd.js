(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('crypto'), require('react')) :
  typeof define === 'function' && define.amd ? define(['exports', 'crypto', 'react'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.react = {}, global.crypto, global.React));
}(this, (function (exports, crypto, React) { 'use strict';

  function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

  var crypto__default = /*#__PURE__*/_interopDefaultLegacy(crypto);
  var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);

    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      enumerableOnly && (symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      })), keys.push.apply(keys, symbols);
    }

    return keys;
  }

  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = null != arguments[i] ? arguments[i] : {};
      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }

    return target;
  }

  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", {
      writable: false
    });
    return Constructor;
  }

  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _inherits(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    Object.defineProperty(subClass, "prototype", {
      writable: false
    });
    if (superClass) _setPrototypeOf(subClass, superClass);
  }

  function _getPrototypeOf(o) {
    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf(o);
  }

  function _setPrototypeOf(o, p) {
    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf(o, p);
  }

  function _isNativeReflectConstruct() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  function _objectWithoutPropertiesLoose(source, excluded) {
    if (source == null) return {};
    var target = {};
    var sourceKeys = Object.keys(source);
    var key, i;

    for (i = 0; i < sourceKeys.length; i++) {
      key = sourceKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      target[key] = source[key];
    }

    return target;
  }

  function _objectWithoutProperties(source, excluded) {
    if (source == null) return {};

    var target = _objectWithoutPropertiesLoose(source, excluded);

    var key, i;

    if (Object.getOwnPropertySymbols) {
      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

      for (i = 0; i < sourceSymbolKeys.length; i++) {
        key = sourceSymbolKeys[i];
        if (excluded.indexOf(key) >= 0) continue;
        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
        target[key] = source[key];
      }
    }

    return target;
  }

  function _assertThisInitialized(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _possibleConstructorReturn(self, call) {
    if (call && (typeof call === "object" || typeof call === "function")) {
      return call;
    } else if (call !== void 0) {
      throw new TypeError("Derived constructors may only return object or undefined");
    }

    return _assertThisInitialized(self);
  }

  function _createSuper(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct();

    return function _createSuperInternal() {
      var Super = _getPrototypeOf(Derived),
          result;

      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf(this).constructor;

        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }

      return _possibleConstructorReturn(this, result);
    };
  }

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
  }

  function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
  }

  function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
  }

  function _iterableToArrayLimit(arr, i) {
    var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

    if (_i == null) return;
    var _arr = [];
    var _n = true;
    var _d = false;

    var _s, _e;

    try {
      for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
  }

  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

    return arr2;
  }

  function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

  function createCommonjsModule(fn, basedir, module) {
  	return module = {
  		path: basedir,
  		exports: {},
  		require: function (path, base) {
  			return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
  		}
  	}, fn(module, module.exports), module.exports;
  }

  function commonjsRequire () {
  	throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
  }

  var lodash = createCommonjsModule(function (module, exports) {
  (function() {

    /** Used as a safe reference for `undefined` in pre-ES5 environments. */
    var undefined$1;

    /** Used as the semantic version number. */
    var VERSION = '4.17.21';

    /** Used as the size to enable large array optimizations. */
    var LARGE_ARRAY_SIZE = 200;

    /** Error message constants. */
    var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',
        FUNC_ERROR_TEXT = 'Expected a function',
        INVALID_TEMPL_VAR_ERROR_TEXT = 'Invalid `variable` option passed into `_.template`';

    /** Used to stand-in for `undefined` hash values. */
    var HASH_UNDEFINED = '__lodash_hash_undefined__';

    /** Used as the maximum memoize cache size. */
    var MAX_MEMOIZE_SIZE = 500;

    /** Used as the internal argument placeholder. */
    var PLACEHOLDER = '__lodash_placeholder__';

    /** Used to compose bitmasks for cloning. */
    var CLONE_DEEP_FLAG = 1,
        CLONE_FLAT_FLAG = 2,
        CLONE_SYMBOLS_FLAG = 4;

    /** Used to compose bitmasks for value comparisons. */
    var COMPARE_PARTIAL_FLAG = 1,
        COMPARE_UNORDERED_FLAG = 2;

    /** Used to compose bitmasks for function metadata. */
    var WRAP_BIND_FLAG = 1,
        WRAP_BIND_KEY_FLAG = 2,
        WRAP_CURRY_BOUND_FLAG = 4,
        WRAP_CURRY_FLAG = 8,
        WRAP_CURRY_RIGHT_FLAG = 16,
        WRAP_PARTIAL_FLAG = 32,
        WRAP_PARTIAL_RIGHT_FLAG = 64,
        WRAP_ARY_FLAG = 128,
        WRAP_REARG_FLAG = 256,
        WRAP_FLIP_FLAG = 512;

    /** Used as default options for `_.truncate`. */
    var DEFAULT_TRUNC_LENGTH = 30,
        DEFAULT_TRUNC_OMISSION = '...';

    /** Used to detect hot functions by number of calls within a span of milliseconds. */
    var HOT_COUNT = 800,
        HOT_SPAN = 16;

    /** Used to indicate the type of lazy iteratees. */
    var LAZY_FILTER_FLAG = 1,
        LAZY_MAP_FLAG = 2,
        LAZY_WHILE_FLAG = 3;

    /** Used as references for various `Number` constants. */
    var INFINITY = 1 / 0,
        MAX_SAFE_INTEGER = 9007199254740991,
        MAX_INTEGER = 1.7976931348623157e+308,
        NAN = 0 / 0;

    /** Used as references for the maximum length and index of an array. */
    var MAX_ARRAY_LENGTH = 4294967295,
        MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,
        HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;

    /** Used to associate wrap methods with their bit flags. */
    var wrapFlags = [
      ['ary', WRAP_ARY_FLAG],
      ['bind', WRAP_BIND_FLAG],
      ['bindKey', WRAP_BIND_KEY_FLAG],
      ['curry', WRAP_CURRY_FLAG],
      ['curryRight', WRAP_CURRY_RIGHT_FLAG],
      ['flip', WRAP_FLIP_FLAG],
      ['partial', WRAP_PARTIAL_FLAG],
      ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],
      ['rearg', WRAP_REARG_FLAG]
    ];

    /** `Object#toString` result references. */
    var argsTag = '[object Arguments]',
        arrayTag = '[object Array]',
        asyncTag = '[object AsyncFunction]',
        boolTag = '[object Boolean]',
        dateTag = '[object Date]',
        domExcTag = '[object DOMException]',
        errorTag = '[object Error]',
        funcTag = '[object Function]',
        genTag = '[object GeneratorFunction]',
        mapTag = '[object Map]',
        numberTag = '[object Number]',
        nullTag = '[object Null]',
        objectTag = '[object Object]',
        promiseTag = '[object Promise]',
        proxyTag = '[object Proxy]',
        regexpTag = '[object RegExp]',
        setTag = '[object Set]',
        stringTag = '[object String]',
        symbolTag = '[object Symbol]',
        undefinedTag = '[object Undefined]',
        weakMapTag = '[object WeakMap]',
        weakSetTag = '[object WeakSet]';

    var arrayBufferTag = '[object ArrayBuffer]',
        dataViewTag = '[object DataView]',
        float32Tag = '[object Float32Array]',
        float64Tag = '[object Float64Array]',
        int8Tag = '[object Int8Array]',
        int16Tag = '[object Int16Array]',
        int32Tag = '[object Int32Array]',
        uint8Tag = '[object Uint8Array]',
        uint8ClampedTag = '[object Uint8ClampedArray]',
        uint16Tag = '[object Uint16Array]',
        uint32Tag = '[object Uint32Array]';

    /** Used to match empty string literals in compiled template source. */
    var reEmptyStringLeading = /\b__p \+= '';/g,
        reEmptyStringMiddle = /\b(__p \+=) '' \+/g,
        reEmptyStringTrailing = /(__e\(.*?\)|\b__t\)) \+\n'';/g;

    /** Used to match HTML entities and HTML characters. */
    var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,
        reUnescapedHtml = /[&<>"']/g,
        reHasEscapedHtml = RegExp(reEscapedHtml.source),
        reHasUnescapedHtml = RegExp(reUnescapedHtml.source);

    /** Used to match template delimiters. */
    var reEscape = /<%-([\s\S]+?)%>/g,
        reEvaluate = /<%([\s\S]+?)%>/g,
        reInterpolate = /<%=([\s\S]+?)%>/g;

    /** Used to match property names within property paths. */
    var reIsDeepProp = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,
        reIsPlainProp = /^\w*$/,
        rePropName = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;

    /**
     * Used to match `RegExp`
     * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
     */
    var reRegExpChar = /[\\^$.*+?()[\]{}|]/g,
        reHasRegExpChar = RegExp(reRegExpChar.source);

    /** Used to match leading whitespace. */
    var reTrimStart = /^\s+/;

    /** Used to match a single whitespace character. */
    var reWhitespace = /\s/;

    /** Used to match wrap detail comments. */
    var reWrapComment = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,
        reWrapDetails = /\{\n\/\* \[wrapped with (.+)\] \*/,
        reSplitDetails = /,? & /;

    /** Used to match words composed of alphanumeric characters. */
    var reAsciiWord = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;

    /**
     * Used to validate the `validate` option in `_.template` variable.
     *
     * Forbids characters which could potentially change the meaning of the function argument definition:
     * - "()," (modification of function parameters)
     * - "=" (default value)
     * - "[]{}" (destructuring of function parameters)
     * - "/" (beginning of a comment)
     * - whitespace
     */
    var reForbiddenIdentifierChars = /[()=,{}\[\]\/\s]/;

    /** Used to match backslashes in property paths. */
    var reEscapeChar = /\\(\\)?/g;

    /**
     * Used to match
     * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).
     */
    var reEsTemplate = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;

    /** Used to match `RegExp` flags from their coerced string values. */
    var reFlags = /\w*$/;

    /** Used to detect bad signed hexadecimal string values. */
    var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;

    /** Used to detect binary string values. */
    var reIsBinary = /^0b[01]+$/i;

    /** Used to detect host constructors (Safari). */
    var reIsHostCtor = /^\[object .+?Constructor\]$/;

    /** Used to detect octal string values. */
    var reIsOctal = /^0o[0-7]+$/i;

    /** Used to detect unsigned integer values. */
    var reIsUint = /^(?:0|[1-9]\d*)$/;

    /** Used to match Latin Unicode letters (excluding mathematical operators). */
    var reLatin = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;

    /** Used to ensure capturing order of template delimiters. */
    var reNoMatch = /($^)/;

    /** Used to match unescaped characters in compiled string literals. */
    var reUnescapedString = /['\n\r\u2028\u2029\\]/g;

    /** Used to compose unicode character classes. */
    var rsAstralRange = '\\ud800-\\udfff',
        rsComboMarksRange = '\\u0300-\\u036f',
        reComboHalfMarksRange = '\\ufe20-\\ufe2f',
        rsComboSymbolsRange = '\\u20d0-\\u20ff',
        rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,
        rsDingbatRange = '\\u2700-\\u27bf',
        rsLowerRange = 'a-z\\xdf-\\xf6\\xf8-\\xff',
        rsMathOpRange = '\\xac\\xb1\\xd7\\xf7',
        rsNonCharRange = '\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf',
        rsPunctuationRange = '\\u2000-\\u206f',
        rsSpaceRange = ' \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000',
        rsUpperRange = 'A-Z\\xc0-\\xd6\\xd8-\\xde',
        rsVarRange = '\\ufe0e\\ufe0f',
        rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;

    /** Used to compose unicode capture groups. */
    var rsApos = "['\u2019]",
        rsAstral = '[' + rsAstralRange + ']',
        rsBreak = '[' + rsBreakRange + ']',
        rsCombo = '[' + rsComboRange + ']',
        rsDigits = '\\d+',
        rsDingbat = '[' + rsDingbatRange + ']',
        rsLower = '[' + rsLowerRange + ']',
        rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',
        rsFitz = '\\ud83c[\\udffb-\\udfff]',
        rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',
        rsNonAstral = '[^' + rsAstralRange + ']',
        rsRegional = '(?:\\ud83c[\\udde6-\\uddff]){2}',
        rsSurrPair = '[\\ud800-\\udbff][\\udc00-\\udfff]',
        rsUpper = '[' + rsUpperRange + ']',
        rsZWJ = '\\u200d';

    /** Used to compose unicode regexes. */
    var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',
        rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',
        rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',
        rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',
        reOptMod = rsModifier + '?',
        rsOptVar = '[' + rsVarRange + ']?',
        rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',
        rsOrdLower = '\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])',
        rsOrdUpper = '\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])',
        rsSeq = rsOptVar + reOptMod + rsOptJoin,
        rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,
        rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';

    /** Used to match apostrophes. */
    var reApos = RegExp(rsApos, 'g');

    /**
     * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and
     * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).
     */
    var reComboMark = RegExp(rsCombo, 'g');

    /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */
    var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');

    /** Used to match complex or compound words. */
    var reUnicodeWord = RegExp([
      rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',
      rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',
      rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,
      rsUpper + '+' + rsOptContrUpper,
      rsOrdUpper,
      rsOrdLower,
      rsDigits,
      rsEmoji
    ].join('|'), 'g');

    /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */
    var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');

    /** Used to detect strings that need a more robust regexp to match words. */
    var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;

    /** Used to assign default `context` object properties. */
    var contextProps = [
      'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',
      'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',
      'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',
      'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',
      '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'
    ];

    /** Used to make template sourceURLs easier to identify. */
    var templateCounter = -1;

    /** Used to identify `toStringTag` values of typed arrays. */
    var typedArrayTags = {};
    typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
    typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
    typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
    typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
    typedArrayTags[uint32Tag] = true;
    typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
    typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
    typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
    typedArrayTags[errorTag] = typedArrayTags[funcTag] =
    typedArrayTags[mapTag] = typedArrayTags[numberTag] =
    typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
    typedArrayTags[setTag] = typedArrayTags[stringTag] =
    typedArrayTags[weakMapTag] = false;

    /** Used to identify `toStringTag` values supported by `_.clone`. */
    var cloneableTags = {};
    cloneableTags[argsTag] = cloneableTags[arrayTag] =
    cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =
    cloneableTags[boolTag] = cloneableTags[dateTag] =
    cloneableTags[float32Tag] = cloneableTags[float64Tag] =
    cloneableTags[int8Tag] = cloneableTags[int16Tag] =
    cloneableTags[int32Tag] = cloneableTags[mapTag] =
    cloneableTags[numberTag] = cloneableTags[objectTag] =
    cloneableTags[regexpTag] = cloneableTags[setTag] =
    cloneableTags[stringTag] = cloneableTags[symbolTag] =
    cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =
    cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;
    cloneableTags[errorTag] = cloneableTags[funcTag] =
    cloneableTags[weakMapTag] = false;

    /** Used to map Latin Unicode letters to basic Latin letters. */
    var deburredLetters = {
      // Latin-1 Supplement block.
      '\xc0': 'A',  '\xc1': 'A', '\xc2': 'A', '\xc3': 'A', '\xc4': 'A', '\xc5': 'A',
      '\xe0': 'a',  '\xe1': 'a', '\xe2': 'a', '\xe3': 'a', '\xe4': 'a', '\xe5': 'a',
      '\xc7': 'C',  '\xe7': 'c',
      '\xd0': 'D',  '\xf0': 'd',
      '\xc8': 'E',  '\xc9': 'E', '\xca': 'E', '\xcb': 'E',
      '\xe8': 'e',  '\xe9': 'e', '\xea': 'e', '\xeb': 'e',
      '\xcc': 'I',  '\xcd': 'I', '\xce': 'I', '\xcf': 'I',
      '\xec': 'i',  '\xed': 'i', '\xee': 'i', '\xef': 'i',
      '\xd1': 'N',  '\xf1': 'n',
      '\xd2': 'O',  '\xd3': 'O', '\xd4': 'O', '\xd5': 'O', '\xd6': 'O', '\xd8': 'O',
      '\xf2': 'o',  '\xf3': 'o', '\xf4': 'o', '\xf5': 'o', '\xf6': 'o', '\xf8': 'o',
      '\xd9': 'U',  '\xda': 'U', '\xdb': 'U', '\xdc': 'U',
      '\xf9': 'u',  '\xfa': 'u', '\xfb': 'u', '\xfc': 'u',
      '\xdd': 'Y',  '\xfd': 'y', '\xff': 'y',
      '\xc6': 'Ae', '\xe6': 'ae',
      '\xde': 'Th', '\xfe': 'th',
      '\xdf': 'ss',
      // Latin Extended-A block.
      '\u0100': 'A',  '\u0102': 'A', '\u0104': 'A',
      '\u0101': 'a',  '\u0103': 'a', '\u0105': 'a',
      '\u0106': 'C',  '\u0108': 'C', '\u010a': 'C', '\u010c': 'C',
      '\u0107': 'c',  '\u0109': 'c', '\u010b': 'c', '\u010d': 'c',
      '\u010e': 'D',  '\u0110': 'D', '\u010f': 'd', '\u0111': 'd',
      '\u0112': 'E',  '\u0114': 'E', '\u0116': 'E', '\u0118': 'E', '\u011a': 'E',
      '\u0113': 'e',  '\u0115': 'e', '\u0117': 'e', '\u0119': 'e', '\u011b': 'e',
      '\u011c': 'G',  '\u011e': 'G', '\u0120': 'G', '\u0122': 'G',
      '\u011d': 'g',  '\u011f': 'g', '\u0121': 'g', '\u0123': 'g',
      '\u0124': 'H',  '\u0126': 'H', '\u0125': 'h', '\u0127': 'h',
      '\u0128': 'I',  '\u012a': 'I', '\u012c': 'I', '\u012e': 'I', '\u0130': 'I',
      '\u0129': 'i',  '\u012b': 'i', '\u012d': 'i', '\u012f': 'i', '\u0131': 'i',
      '\u0134': 'J',  '\u0135': 'j',
      '\u0136': 'K',  '\u0137': 'k', '\u0138': 'k',
      '\u0139': 'L',  '\u013b': 'L', '\u013d': 'L', '\u013f': 'L', '\u0141': 'L',
      '\u013a': 'l',  '\u013c': 'l', '\u013e': 'l', '\u0140': 'l', '\u0142': 'l',
      '\u0143': 'N',  '\u0145': 'N', '\u0147': 'N', '\u014a': 'N',
      '\u0144': 'n',  '\u0146': 'n', '\u0148': 'n', '\u014b': 'n',
      '\u014c': 'O',  '\u014e': 'O', '\u0150': 'O',
      '\u014d': 'o',  '\u014f': 'o', '\u0151': 'o',
      '\u0154': 'R',  '\u0156': 'R', '\u0158': 'R',
      '\u0155': 'r',  '\u0157': 'r', '\u0159': 'r',
      '\u015a': 'S',  '\u015c': 'S', '\u015e': 'S', '\u0160': 'S',
      '\u015b': 's',  '\u015d': 's', '\u015f': 's', '\u0161': 's',
      '\u0162': 'T',  '\u0164': 'T', '\u0166': 'T',
      '\u0163': 't',  '\u0165': 't', '\u0167': 't',
      '\u0168': 'U',  '\u016a': 'U', '\u016c': 'U', '\u016e': 'U', '\u0170': 'U', '\u0172': 'U',
      '\u0169': 'u',  '\u016b': 'u', '\u016d': 'u', '\u016f': 'u', '\u0171': 'u', '\u0173': 'u',
      '\u0174': 'W',  '\u0175': 'w',
      '\u0176': 'Y',  '\u0177': 'y', '\u0178': 'Y',
      '\u0179': 'Z',  '\u017b': 'Z', '\u017d': 'Z',
      '\u017a': 'z',  '\u017c': 'z', '\u017e': 'z',
      '\u0132': 'IJ', '\u0133': 'ij',
      '\u0152': 'Oe', '\u0153': 'oe',
      '\u0149': "'n", '\u017f': 's'
    };

    /** Used to map characters to HTML entities. */
    var htmlEscapes = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#39;'
    };

    /** Used to map HTML entities to characters. */
    var htmlUnescapes = {
      '&amp;': '&',
      '&lt;': '<',
      '&gt;': '>',
      '&quot;': '"',
      '&#39;': "'"
    };

    /** Used to escape characters for inclusion in compiled string literals. */
    var stringEscapes = {
      '\\': '\\',
      "'": "'",
      '\n': 'n',
      '\r': 'r',
      '\u2028': 'u2028',
      '\u2029': 'u2029'
    };

    /** Built-in method references without a dependency on `root`. */
    var freeParseFloat = parseFloat,
        freeParseInt = parseInt;

    /** Detect free variable `global` from Node.js. */
    var freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;

    /** Detect free variable `self`. */
    var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

    /** Used as a reference to the global object. */
    var root = freeGlobal || freeSelf || Function('return this')();

    /** Detect free variable `exports`. */
    var freeExports =  exports && !exports.nodeType && exports;

    /** Detect free variable `module`. */
    var freeModule = freeExports && 'object' == 'object' && module && !module.nodeType && module;

    /** Detect the popular CommonJS extension `module.exports`. */
    var moduleExports = freeModule && freeModule.exports === freeExports;

    /** Detect free variable `process` from Node.js. */
    var freeProcess = moduleExports && freeGlobal.process;

    /** Used to access faster Node.js helpers. */
    var nodeUtil = (function() {
      try {
        // Use `util.types` for Node.js 10+.
        var types = freeModule && freeModule.require && freeModule.require('util').types;

        if (types) {
          return types;
        }

        // Legacy `process.binding('util')` for Node.js < 10.
        return freeProcess && freeProcess.binding && freeProcess.binding('util');
      } catch (e) {}
    }());

    /* Node.js helper references. */
    var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,
        nodeIsDate = nodeUtil && nodeUtil.isDate,
        nodeIsMap = nodeUtil && nodeUtil.isMap,
        nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,
        nodeIsSet = nodeUtil && nodeUtil.isSet,
        nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

    /*--------------------------------------------------------------------------*/

    /**
     * A faster alternative to `Function#apply`, this function invokes `func`
     * with the `this` binding of `thisArg` and the arguments of `args`.
     *
     * @private
     * @param {Function} func The function to invoke.
     * @param {*} thisArg The `this` binding of `func`.
     * @param {Array} args The arguments to invoke `func` with.
     * @returns {*} Returns the result of `func`.
     */
    function apply(func, thisArg, args) {
      switch (args.length) {
        case 0: return func.call(thisArg);
        case 1: return func.call(thisArg, args[0]);
        case 2: return func.call(thisArg, args[0], args[1]);
        case 3: return func.call(thisArg, args[0], args[1], args[2]);
      }
      return func.apply(thisArg, args);
    }

    /**
     * A specialized version of `baseAggregator` for arrays.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} setter The function to set `accumulator` values.
     * @param {Function} iteratee The iteratee to transform keys.
     * @param {Object} accumulator The initial aggregated object.
     * @returns {Function} Returns `accumulator`.
     */
    function arrayAggregator(array, setter, iteratee, accumulator) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        var value = array[index];
        setter(accumulator, value, iteratee(value), array);
      }
      return accumulator;
    }

    /**
     * A specialized version of `_.forEach` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns `array`.
     */
    function arrayEach(array, iteratee) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        if (iteratee(array[index], index, array) === false) {
          break;
        }
      }
      return array;
    }

    /**
     * A specialized version of `_.forEachRight` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns `array`.
     */
    function arrayEachRight(array, iteratee) {
      var length = array == null ? 0 : array.length;

      while (length--) {
        if (iteratee(array[length], length, array) === false) {
          break;
        }
      }
      return array;
    }

    /**
     * A specialized version of `_.every` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} predicate The function invoked per iteration.
     * @returns {boolean} Returns `true` if all elements pass the predicate check,
     *  else `false`.
     */
    function arrayEvery(array, predicate) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        if (!predicate(array[index], index, array)) {
          return false;
        }
      }
      return true;
    }

    /**
     * A specialized version of `_.filter` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} predicate The function invoked per iteration.
     * @returns {Array} Returns the new filtered array.
     */
    function arrayFilter(array, predicate) {
      var index = -1,
          length = array == null ? 0 : array.length,
          resIndex = 0,
          result = [];

      while (++index < length) {
        var value = array[index];
        if (predicate(value, index, array)) {
          result[resIndex++] = value;
        }
      }
      return result;
    }

    /**
     * A specialized version of `_.includes` for arrays without support for
     * specifying an index to search from.
     *
     * @private
     * @param {Array} [array] The array to inspect.
     * @param {*} target The value to search for.
     * @returns {boolean} Returns `true` if `target` is found, else `false`.
     */
    function arrayIncludes(array, value) {
      var length = array == null ? 0 : array.length;
      return !!length && baseIndexOf(array, value, 0) > -1;
    }

    /**
     * This function is like `arrayIncludes` except that it accepts a comparator.
     *
     * @private
     * @param {Array} [array] The array to inspect.
     * @param {*} target The value to search for.
     * @param {Function} comparator The comparator invoked per element.
     * @returns {boolean} Returns `true` if `target` is found, else `false`.
     */
    function arrayIncludesWith(array, value, comparator) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        if (comparator(value, array[index])) {
          return true;
        }
      }
      return false;
    }

    /**
     * A specialized version of `_.map` for arrays without support for iteratee
     * shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns the new mapped array.
     */
    function arrayMap(array, iteratee) {
      var index = -1,
          length = array == null ? 0 : array.length,
          result = Array(length);

      while (++index < length) {
        result[index] = iteratee(array[index], index, array);
      }
      return result;
    }

    /**
     * Appends the elements of `values` to `array`.
     *
     * @private
     * @param {Array} array The array to modify.
     * @param {Array} values The values to append.
     * @returns {Array} Returns `array`.
     */
    function arrayPush(array, values) {
      var index = -1,
          length = values.length,
          offset = array.length;

      while (++index < length) {
        array[offset + index] = values[index];
      }
      return array;
    }

    /**
     * A specialized version of `_.reduce` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @param {*} [accumulator] The initial value.
     * @param {boolean} [initAccum] Specify using the first element of `array` as
     *  the initial value.
     * @returns {*} Returns the accumulated value.
     */
    function arrayReduce(array, iteratee, accumulator, initAccum) {
      var index = -1,
          length = array == null ? 0 : array.length;

      if (initAccum && length) {
        accumulator = array[++index];
      }
      while (++index < length) {
        accumulator = iteratee(accumulator, array[index], index, array);
      }
      return accumulator;
    }

    /**
     * A specialized version of `_.reduceRight` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @param {*} [accumulator] The initial value.
     * @param {boolean} [initAccum] Specify using the last element of `array` as
     *  the initial value.
     * @returns {*} Returns the accumulated value.
     */
    function arrayReduceRight(array, iteratee, accumulator, initAccum) {
      var length = array == null ? 0 : array.length;
      if (initAccum && length) {
        accumulator = array[--length];
      }
      while (length--) {
        accumulator = iteratee(accumulator, array[length], length, array);
      }
      return accumulator;
    }

    /**
     * A specialized version of `_.some` for arrays without support for iteratee
     * shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} predicate The function invoked per iteration.
     * @returns {boolean} Returns `true` if any element passes the predicate check,
     *  else `false`.
     */
    function arraySome(array, predicate) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        if (predicate(array[index], index, array)) {
          return true;
        }
      }
      return false;
    }

    /**
     * Gets the size of an ASCII `string`.
     *
     * @private
     * @param {string} string The string inspect.
     * @returns {number} Returns the string size.
     */
    var asciiSize = baseProperty('length');

    /**
     * Converts an ASCII `string` to an array.
     *
     * @private
     * @param {string} string The string to convert.
     * @returns {Array} Returns the converted array.
     */
    function asciiToArray(string) {
      return string.split('');
    }

    /**
     * Splits an ASCII `string` into an array of its words.
     *
     * @private
     * @param {string} The string to inspect.
     * @returns {Array} Returns the words of `string`.
     */
    function asciiWords(string) {
      return string.match(reAsciiWord) || [];
    }

    /**
     * The base implementation of methods like `_.findKey` and `_.findLastKey`,
     * without support for iteratee shorthands, which iterates over `collection`
     * using `eachFunc`.
     *
     * @private
     * @param {Array|Object} collection The collection to inspect.
     * @param {Function} predicate The function invoked per iteration.
     * @param {Function} eachFunc The function to iterate over `collection`.
     * @returns {*} Returns the found element or its key, else `undefined`.
     */
    function baseFindKey(collection, predicate, eachFunc) {
      var result;
      eachFunc(collection, function(value, key, collection) {
        if (predicate(value, key, collection)) {
          result = key;
          return false;
        }
      });
      return result;
    }

    /**
     * The base implementation of `_.findIndex` and `_.findLastIndex` without
     * support for iteratee shorthands.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {Function} predicate The function invoked per iteration.
     * @param {number} fromIndex The index to search from.
     * @param {boolean} [fromRight] Specify iterating from right to left.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function baseFindIndex(array, predicate, fromIndex, fromRight) {
      var length = array.length,
          index = fromIndex + (fromRight ? 1 : -1);

      while ((fromRight ? index-- : ++index < length)) {
        if (predicate(array[index], index, array)) {
          return index;
        }
      }
      return -1;
    }

    /**
     * The base implementation of `_.indexOf` without `fromIndex` bounds checks.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} value The value to search for.
     * @param {number} fromIndex The index to search from.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function baseIndexOf(array, value, fromIndex) {
      return value === value
        ? strictIndexOf(array, value, fromIndex)
        : baseFindIndex(array, baseIsNaN, fromIndex);
    }

    /**
     * This function is like `baseIndexOf` except that it accepts a comparator.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} value The value to search for.
     * @param {number} fromIndex The index to search from.
     * @param {Function} comparator The comparator invoked per element.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function baseIndexOfWith(array, value, fromIndex, comparator) {
      var index = fromIndex - 1,
          length = array.length;

      while (++index < length) {
        if (comparator(array[index], value)) {
          return index;
        }
      }
      return -1;
    }

    /**
     * The base implementation of `_.isNaN` without support for number objects.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
     */
    function baseIsNaN(value) {
      return value !== value;
    }

    /**
     * The base implementation of `_.mean` and `_.meanBy` without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} array The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {number} Returns the mean.
     */
    function baseMean(array, iteratee) {
      var length = array == null ? 0 : array.length;
      return length ? (baseSum(array, iteratee) / length) : NAN;
    }

    /**
     * The base implementation of `_.property` without support for deep paths.
     *
     * @private
     * @param {string} key The key of the property to get.
     * @returns {Function} Returns the new accessor function.
     */
    function baseProperty(key) {
      return function(object) {
        return object == null ? undefined$1 : object[key];
      };
    }

    /**
     * The base implementation of `_.propertyOf` without support for deep paths.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Function} Returns the new accessor function.
     */
    function basePropertyOf(object) {
      return function(key) {
        return object == null ? undefined$1 : object[key];
      };
    }

    /**
     * The base implementation of `_.reduce` and `_.reduceRight`, without support
     * for iteratee shorthands, which iterates over `collection` using `eachFunc`.
     *
     * @private
     * @param {Array|Object} collection The collection to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @param {*} accumulator The initial value.
     * @param {boolean} initAccum Specify using the first or last element of
     *  `collection` as the initial value.
     * @param {Function} eachFunc The function to iterate over `collection`.
     * @returns {*} Returns the accumulated value.
     */
    function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {
      eachFunc(collection, function(value, index, collection) {
        accumulator = initAccum
          ? (initAccum = false, value)
          : iteratee(accumulator, value, index, collection);
      });
      return accumulator;
    }

    /**
     * The base implementation of `_.sortBy` which uses `comparer` to define the
     * sort order of `array` and replaces criteria objects with their corresponding
     * values.
     *
     * @private
     * @param {Array} array The array to sort.
     * @param {Function} comparer The function to define sort order.
     * @returns {Array} Returns `array`.
     */
    function baseSortBy(array, comparer) {
      var length = array.length;

      array.sort(comparer);
      while (length--) {
        array[length] = array[length].value;
      }
      return array;
    }

    /**
     * The base implementation of `_.sum` and `_.sumBy` without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} array The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {number} Returns the sum.
     */
    function baseSum(array, iteratee) {
      var result,
          index = -1,
          length = array.length;

      while (++index < length) {
        var current = iteratee(array[index]);
        if (current !== undefined$1) {
          result = result === undefined$1 ? current : (result + current);
        }
      }
      return result;
    }

    /**
     * The base implementation of `_.times` without support for iteratee shorthands
     * or max array length checks.
     *
     * @private
     * @param {number} n The number of times to invoke `iteratee`.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns the array of results.
     */
    function baseTimes(n, iteratee) {
      var index = -1,
          result = Array(n);

      while (++index < n) {
        result[index] = iteratee(index);
      }
      return result;
    }

    /**
     * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array
     * of key-value pairs for `object` corresponding to the property names of `props`.
     *
     * @private
     * @param {Object} object The object to query.
     * @param {Array} props The property names to get values for.
     * @returns {Object} Returns the key-value pairs.
     */
    function baseToPairs(object, props) {
      return arrayMap(props, function(key) {
        return [key, object[key]];
      });
    }

    /**
     * The base implementation of `_.trim`.
     *
     * @private
     * @param {string} string The string to trim.
     * @returns {string} Returns the trimmed string.
     */
    function baseTrim(string) {
      return string
        ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')
        : string;
    }

    /**
     * The base implementation of `_.unary` without support for storing metadata.
     *
     * @private
     * @param {Function} func The function to cap arguments for.
     * @returns {Function} Returns the new capped function.
     */
    function baseUnary(func) {
      return function(value) {
        return func(value);
      };
    }

    /**
     * The base implementation of `_.values` and `_.valuesIn` which creates an
     * array of `object` property values corresponding to the property names
     * of `props`.
     *
     * @private
     * @param {Object} object The object to query.
     * @param {Array} props The property names to get values for.
     * @returns {Object} Returns the array of property values.
     */
    function baseValues(object, props) {
      return arrayMap(props, function(key) {
        return object[key];
      });
    }

    /**
     * Checks if a `cache` value for `key` exists.
     *
     * @private
     * @param {Object} cache The cache to query.
     * @param {string} key The key of the entry to check.
     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
     */
    function cacheHas(cache, key) {
      return cache.has(key);
    }

    /**
     * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol
     * that is not found in the character symbols.
     *
     * @private
     * @param {Array} strSymbols The string symbols to inspect.
     * @param {Array} chrSymbols The character symbols to find.
     * @returns {number} Returns the index of the first unmatched string symbol.
     */
    function charsStartIndex(strSymbols, chrSymbols) {
      var index = -1,
          length = strSymbols.length;

      while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}
      return index;
    }

    /**
     * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol
     * that is not found in the character symbols.
     *
     * @private
     * @param {Array} strSymbols The string symbols to inspect.
     * @param {Array} chrSymbols The character symbols to find.
     * @returns {number} Returns the index of the last unmatched string symbol.
     */
    function charsEndIndex(strSymbols, chrSymbols) {
      var index = strSymbols.length;

      while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}
      return index;
    }

    /**
     * Gets the number of `placeholder` occurrences in `array`.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} placeholder The placeholder to search for.
     * @returns {number} Returns the placeholder count.
     */
    function countHolders(array, placeholder) {
      var length = array.length,
          result = 0;

      while (length--) {
        if (array[length] === placeholder) {
          ++result;
        }
      }
      return result;
    }

    /**
     * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A
     * letters to basic Latin letters.
     *
     * @private
     * @param {string} letter The matched letter to deburr.
     * @returns {string} Returns the deburred letter.
     */
    var deburrLetter = basePropertyOf(deburredLetters);

    /**
     * Used by `_.escape` to convert characters to HTML entities.
     *
     * @private
     * @param {string} chr The matched character to escape.
     * @returns {string} Returns the escaped character.
     */
    var escapeHtmlChar = basePropertyOf(htmlEscapes);

    /**
     * Used by `_.template` to escape characters for inclusion in compiled string literals.
     *
     * @private
     * @param {string} chr The matched character to escape.
     * @returns {string} Returns the escaped character.
     */
    function escapeStringChar(chr) {
      return '\\' + stringEscapes[chr];
    }

    /**
     * Gets the value at `key` of `object`.
     *
     * @private
     * @param {Object} [object] The object to query.
     * @param {string} key The key of the property to get.
     * @returns {*} Returns the property value.
     */
    function getValue(object, key) {
      return object == null ? undefined$1 : object[key];
    }

    /**
     * Checks if `string` contains Unicode symbols.
     *
     * @private
     * @param {string} string The string to inspect.
     * @returns {boolean} Returns `true` if a symbol is found, else `false`.
     */
    function hasUnicode(string) {
      return reHasUnicode.test(string);
    }

    /**
     * Checks if `string` contains a word composed of Unicode symbols.
     *
     * @private
     * @param {string} string The string to inspect.
     * @returns {boolean} Returns `true` if a word is found, else `false`.
     */
    function hasUnicodeWord(string) {
      return reHasUnicodeWord.test(string);
    }

    /**
     * Converts `iterator` to an array.
     *
     * @private
     * @param {Object} iterator The iterator to convert.
     * @returns {Array} Returns the converted array.
     */
    function iteratorToArray(iterator) {
      var data,
          result = [];

      while (!(data = iterator.next()).done) {
        result.push(data.value);
      }
      return result;
    }

    /**
     * Converts `map` to its key-value pairs.
     *
     * @private
     * @param {Object} map The map to convert.
     * @returns {Array} Returns the key-value pairs.
     */
    function mapToArray(map) {
      var index = -1,
          result = Array(map.size);

      map.forEach(function(value, key) {
        result[++index] = [key, value];
      });
      return result;
    }

    /**
     * Creates a unary function that invokes `func` with its argument transformed.
     *
     * @private
     * @param {Function} func The function to wrap.
     * @param {Function} transform The argument transform.
     * @returns {Function} Returns the new function.
     */
    function overArg(func, transform) {
      return function(arg) {
        return func(transform(arg));
      };
    }

    /**
     * Replaces all `placeholder` elements in `array` with an internal placeholder
     * and returns an array of their indexes.
     *
     * @private
     * @param {Array} array The array to modify.
     * @param {*} placeholder The placeholder to replace.
     * @returns {Array} Returns the new array of placeholder indexes.
     */
    function replaceHolders(array, placeholder) {
      var index = -1,
          length = array.length,
          resIndex = 0,
          result = [];

      while (++index < length) {
        var value = array[index];
        if (value === placeholder || value === PLACEHOLDER) {
          array[index] = PLACEHOLDER;
          result[resIndex++] = index;
        }
      }
      return result;
    }

    /**
     * Converts `set` to an array of its values.
     *
     * @private
     * @param {Object} set The set to convert.
     * @returns {Array} Returns the values.
     */
    function setToArray(set) {
      var index = -1,
          result = Array(set.size);

      set.forEach(function(value) {
        result[++index] = value;
      });
      return result;
    }

    /**
     * Converts `set` to its value-value pairs.
     *
     * @private
     * @param {Object} set The set to convert.
     * @returns {Array} Returns the value-value pairs.
     */
    function setToPairs(set) {
      var index = -1,
          result = Array(set.size);

      set.forEach(function(value) {
        result[++index] = [value, value];
      });
      return result;
    }

    /**
     * A specialized version of `_.indexOf` which performs strict equality
     * comparisons of values, i.e. `===`.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} value The value to search for.
     * @param {number} fromIndex The index to search from.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function strictIndexOf(array, value, fromIndex) {
      var index = fromIndex - 1,
          length = array.length;

      while (++index < length) {
        if (array[index] === value) {
          return index;
        }
      }
      return -1;
    }

    /**
     * A specialized version of `_.lastIndexOf` which performs strict equality
     * comparisons of values, i.e. `===`.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} value The value to search for.
     * @param {number} fromIndex The index to search from.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function strictLastIndexOf(array, value, fromIndex) {
      var index = fromIndex + 1;
      while (index--) {
        if (array[index] === value) {
          return index;
        }
      }
      return index;
    }

    /**
     * Gets the number of symbols in `string`.
     *
     * @private
     * @param {string} string The string to inspect.
     * @returns {number} Returns the string size.
     */
    function stringSize(string) {
      return hasUnicode(string)
        ? unicodeSize(string)
        : asciiSize(string);
    }

    /**
     * Converts `string` to an array.
     *
     * @private
     * @param {string} string The string to convert.
     * @returns {Array} Returns the converted array.
     */
    function stringToArray(string) {
      return hasUnicode(string)
        ? unicodeToArray(string)
        : asciiToArray(string);
    }

    /**
     * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace
     * character of `string`.
     *
     * @private
     * @param {string} string The string to inspect.
     * @returns {number} Returns the index of the last non-whitespace character.
     */
    function trimmedEndIndex(string) {
      var index = string.length;

      while (index-- && reWhitespace.test(string.charAt(index))) {}
      return index;
    }

    /**
     * Used by `_.unescape` to convert HTML entities to characters.
     *
     * @private
     * @param {string} chr The matched character to unescape.
     * @returns {string} Returns the unescaped character.
     */
    var unescapeHtmlChar = basePropertyOf(htmlUnescapes);

    /**
     * Gets the size of a Unicode `string`.
     *
     * @private
     * @param {string} string The string inspect.
     * @returns {number} Returns the string size.
     */
    function unicodeSize(string) {
      var result = reUnicode.lastIndex = 0;
      while (reUnicode.test(string)) {
        ++result;
      }
      return result;
    }

    /**
     * Converts a Unicode `string` to an array.
     *
     * @private
     * @param {string} string The string to convert.
     * @returns {Array} Returns the converted array.
     */
    function unicodeToArray(string) {
      return string.match(reUnicode) || [];
    }

    /**
     * Splits a Unicode `string` into an array of its words.
     *
     * @private
     * @param {string} The string to inspect.
     * @returns {Array} Returns the words of `string`.
     */
    function unicodeWords(string) {
      return string.match(reUnicodeWord) || [];
    }

    /*--------------------------------------------------------------------------*/

    /**
     * Create a new pristine `lodash` function using the `context` object.
     *
     * @static
     * @memberOf _
     * @since 1.1.0
     * @category Util
     * @param {Object} [context=root] The context object.
     * @returns {Function} Returns a new `lodash` function.
     * @example
     *
     * _.mixin({ 'foo': _.constant('foo') });
     *
     * var lodash = _.runInContext();
     * lodash.mixin({ 'bar': lodash.constant('bar') });
     *
     * _.isFunction(_.foo);
     * // => true
     * _.isFunction(_.bar);
     * // => false
     *
     * lodash.isFunction(lodash.foo);
     * // => false
     * lodash.isFunction(lodash.bar);
     * // => true
     *
     * // Create a suped-up `defer` in Node.js.
     * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;
     */
    var runInContext = (function runInContext(context) {
      context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));

      /** Built-in constructor references. */
      var Array = context.Array,
          Date = context.Date,
          Error = context.Error,
          Function = context.Function,
          Math = context.Math,
          Object = context.Object,
          RegExp = context.RegExp,
          String = context.String,
          TypeError = context.TypeError;

      /** Used for built-in method references. */
      var arrayProto = Array.prototype,
          funcProto = Function.prototype,
          objectProto = Object.prototype;

      /** Used to detect overreaching core-js shims. */
      var coreJsData = context['__core-js_shared__'];

      /** Used to resolve the decompiled source of functions. */
      var funcToString = funcProto.toString;

      /** Used to check objects for own properties. */
      var hasOwnProperty = objectProto.hasOwnProperty;

      /** Used to generate unique IDs. */
      var idCounter = 0;

      /** Used to detect methods masquerading as native. */
      var maskSrcKey = (function() {
        var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
        return uid ? ('Symbol(src)_1.' + uid) : '';
      }());

      /**
       * Used to resolve the
       * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
       * of values.
       */
      var nativeObjectToString = objectProto.toString;

      /** Used to infer the `Object` constructor. */
      var objectCtorString = funcToString.call(Object);

      /** Used to restore the original `_` reference in `_.noConflict`. */
      var oldDash = root._;

      /** Used to detect if a method is native. */
      var reIsNative = RegExp('^' +
        funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
        .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
      );

      /** Built-in value references. */
      var Buffer = moduleExports ? context.Buffer : undefined$1,
          Symbol = context.Symbol,
          Uint8Array = context.Uint8Array,
          allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined$1,
          getPrototype = overArg(Object.getPrototypeOf, Object),
          objectCreate = Object.create,
          propertyIsEnumerable = objectProto.propertyIsEnumerable,
          splice = arrayProto.splice,
          spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined$1,
          symIterator = Symbol ? Symbol.iterator : undefined$1,
          symToStringTag = Symbol ? Symbol.toStringTag : undefined$1;

      var defineProperty = (function() {
        try {
          var func = getNative(Object, 'defineProperty');
          func({}, '', {});
          return func;
        } catch (e) {}
      }());

      /** Mocked built-ins. */
      var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,
          ctxNow = Date && Date.now !== root.Date.now && Date.now,
          ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;

      /* Built-in method references for those with the same name as other `lodash` methods. */
      var nativeCeil = Math.ceil,
          nativeFloor = Math.floor,
          nativeGetSymbols = Object.getOwnPropertySymbols,
          nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined$1,
          nativeIsFinite = context.isFinite,
          nativeJoin = arrayProto.join,
          nativeKeys = overArg(Object.keys, Object),
          nativeMax = Math.max,
          nativeMin = Math.min,
          nativeNow = Date.now,
          nativeParseInt = context.parseInt,
          nativeRandom = Math.random,
          nativeReverse = arrayProto.reverse;

      /* Built-in method references that are verified to be native. */
      var DataView = getNative(context, 'DataView'),
          Map = getNative(context, 'Map'),
          Promise = getNative(context, 'Promise'),
          Set = getNative(context, 'Set'),
          WeakMap = getNative(context, 'WeakMap'),
          nativeCreate = getNative(Object, 'create');

      /** Used to store function metadata. */
      var metaMap = WeakMap && new WeakMap;

      /** Used to lookup unminified function names. */
      var realNames = {};

      /** Used to detect maps, sets, and weakmaps. */
      var dataViewCtorString = toSource(DataView),
          mapCtorString = toSource(Map),
          promiseCtorString = toSource(Promise),
          setCtorString = toSource(Set),
          weakMapCtorString = toSource(WeakMap);

      /** Used to convert symbols to primitives and strings. */
      var symbolProto = Symbol ? Symbol.prototype : undefined$1,
          symbolValueOf = symbolProto ? symbolProto.valueOf : undefined$1,
          symbolToString = symbolProto ? symbolProto.toString : undefined$1;

      /*------------------------------------------------------------------------*/

      /**
       * Creates a `lodash` object which wraps `value` to enable implicit method
       * chain sequences. Methods that operate on and return arrays, collections,
       * and functions can be chained together. Methods that retrieve a single value
       * or may return a primitive value will automatically end the chain sequence
       * and return the unwrapped value. Otherwise, the value must be unwrapped
       * with `_#value`.
       *
       * Explicit chain sequences, which must be unwrapped with `_#value`, may be
       * enabled using `_.chain`.
       *
       * The execution of chained methods is lazy, that is, it's deferred until
       * `_#value` is implicitly or explicitly called.
       *
       * Lazy evaluation allows several methods to support shortcut fusion.
       * Shortcut fusion is an optimization to merge iteratee calls; this avoids
       * the creation of intermediate arrays and can greatly reduce the number of
       * iteratee executions. Sections of a chain sequence qualify for shortcut
       * fusion if the section is applied to an array and iteratees accept only
       * one argument. The heuristic for whether a section qualifies for shortcut
       * fusion is subject to change.
       *
       * Chaining is supported in custom builds as long as the `_#value` method is
       * directly or indirectly included in the build.
       *
       * In addition to lodash methods, wrappers have `Array` and `String` methods.
       *
       * The wrapper `Array` methods are:
       * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`
       *
       * The wrapper `String` methods are:
       * `replace` and `split`
       *
       * The wrapper methods that support shortcut fusion are:
       * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,
       * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,
       * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`
       *
       * The chainable wrapper methods are:
       * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,
       * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,
       * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,
       * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,
       * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,
       * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,
       * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,
       * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,
       * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,
       * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,
       * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,
       * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,
       * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,
       * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,
       * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,
       * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,
       * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,
       * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,
       * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,
       * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,
       * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,
       * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,
       * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,
       * `zipObject`, `zipObjectDeep`, and `zipWith`
       *
       * The wrapper methods that are **not** chainable by default are:
       * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,
       * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,
       * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,
       * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,
       * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,
       * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,
       * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,
       * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,
       * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,
       * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,
       * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,
       * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,
       * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,
       * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,
       * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,
       * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,
       * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,
       * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,
       * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,
       * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,
       * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,
       * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,
       * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,
       * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,
       * `upperFirst`, `value`, and `words`
       *
       * @name _
       * @constructor
       * @category Seq
       * @param {*} value The value to wrap in a `lodash` instance.
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * var wrapped = _([1, 2, 3]);
       *
       * // Returns an unwrapped value.
       * wrapped.reduce(_.add);
       * // => 6
       *
       * // Returns a wrapped value.
       * var squares = wrapped.map(square);
       *
       * _.isArray(squares);
       * // => false
       *
       * _.isArray(squares.value());
       * // => true
       */
      function lodash(value) {
        if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {
          if (value instanceof LodashWrapper) {
            return value;
          }
          if (hasOwnProperty.call(value, '__wrapped__')) {
            return wrapperClone(value);
          }
        }
        return new LodashWrapper(value);
      }

      /**
       * The base implementation of `_.create` without support for assigning
       * properties to the created object.
       *
       * @private
       * @param {Object} proto The object to inherit from.
       * @returns {Object} Returns the new object.
       */
      var baseCreate = (function() {
        function object() {}
        return function(proto) {
          if (!isObject(proto)) {
            return {};
          }
          if (objectCreate) {
            return objectCreate(proto);
          }
          object.prototype = proto;
          var result = new object;
          object.prototype = undefined$1;
          return result;
        };
      }());

      /**
       * The function whose prototype chain sequence wrappers inherit from.
       *
       * @private
       */
      function baseLodash() {
        // No operation performed.
      }

      /**
       * The base constructor for creating `lodash` wrapper objects.
       *
       * @private
       * @param {*} value The value to wrap.
       * @param {boolean} [chainAll] Enable explicit method chain sequences.
       */
      function LodashWrapper(value, chainAll) {
        this.__wrapped__ = value;
        this.__actions__ = [];
        this.__chain__ = !!chainAll;
        this.__index__ = 0;
        this.__values__ = undefined$1;
      }

      /**
       * By default, the template delimiters used by lodash are like those in
       * embedded Ruby (ERB) as well as ES2015 template strings. Change the
       * following template settings to use alternative delimiters.
       *
       * @static
       * @memberOf _
       * @type {Object}
       */
      lodash.templateSettings = {

        /**
         * Used to detect `data` property values to be HTML-escaped.
         *
         * @memberOf _.templateSettings
         * @type {RegExp}
         */
        'escape': reEscape,

        /**
         * Used to detect code to be evaluated.
         *
         * @memberOf _.templateSettings
         * @type {RegExp}
         */
        'evaluate': reEvaluate,

        /**
         * Used to detect `data` property values to inject.
         *
         * @memberOf _.templateSettings
         * @type {RegExp}
         */
        'interpolate': reInterpolate,

        /**
         * Used to reference the data object in the template text.
         *
         * @memberOf _.templateSettings
         * @type {string}
         */
        'variable': '',

        /**
         * Used to import variables into the compiled template.
         *
         * @memberOf _.templateSettings
         * @type {Object}
         */
        'imports': {

          /**
           * A reference to the `lodash` function.
           *
           * @memberOf _.templateSettings.imports
           * @type {Function}
           */
          '_': lodash
        }
      };

      // Ensure wrappers are instances of `baseLodash`.
      lodash.prototype = baseLodash.prototype;
      lodash.prototype.constructor = lodash;

      LodashWrapper.prototype = baseCreate(baseLodash.prototype);
      LodashWrapper.prototype.constructor = LodashWrapper;

      /*------------------------------------------------------------------------*/

      /**
       * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.
       *
       * @private
       * @constructor
       * @param {*} value The value to wrap.
       */
      function LazyWrapper(value) {
        this.__wrapped__ = value;
        this.__actions__ = [];
        this.__dir__ = 1;
        this.__filtered__ = false;
        this.__iteratees__ = [];
        this.__takeCount__ = MAX_ARRAY_LENGTH;
        this.__views__ = [];
      }

      /**
       * Creates a clone of the lazy wrapper object.
       *
       * @private
       * @name clone
       * @memberOf LazyWrapper
       * @returns {Object} Returns the cloned `LazyWrapper` object.
       */
      function lazyClone() {
        var result = new LazyWrapper(this.__wrapped__);
        result.__actions__ = copyArray(this.__actions__);
        result.__dir__ = this.__dir__;
        result.__filtered__ = this.__filtered__;
        result.__iteratees__ = copyArray(this.__iteratees__);
        result.__takeCount__ = this.__takeCount__;
        result.__views__ = copyArray(this.__views__);
        return result;
      }

      /**
       * Reverses the direction of lazy iteration.
       *
       * @private
       * @name reverse
       * @memberOf LazyWrapper
       * @returns {Object} Returns the new reversed `LazyWrapper` object.
       */
      function lazyReverse() {
        if (this.__filtered__) {
          var result = new LazyWrapper(this);
          result.__dir__ = -1;
          result.__filtered__ = true;
        } else {
          result = this.clone();
          result.__dir__ *= -1;
        }
        return result;
      }

      /**
       * Extracts the unwrapped value from its lazy wrapper.
       *
       * @private
       * @name value
       * @memberOf LazyWrapper
       * @returns {*} Returns the unwrapped value.
       */
      function lazyValue() {
        var array = this.__wrapped__.value(),
            dir = this.__dir__,
            isArr = isArray(array),
            isRight = dir < 0,
            arrLength = isArr ? array.length : 0,
            view = getView(0, arrLength, this.__views__),
            start = view.start,
            end = view.end,
            length = end - start,
            index = isRight ? end : (start - 1),
            iteratees = this.__iteratees__,
            iterLength = iteratees.length,
            resIndex = 0,
            takeCount = nativeMin(length, this.__takeCount__);

        if (!isArr || (!isRight && arrLength == length && takeCount == length)) {
          return baseWrapperValue(array, this.__actions__);
        }
        var result = [];

        outer:
        while (length-- && resIndex < takeCount) {
          index += dir;

          var iterIndex = -1,
              value = array[index];

          while (++iterIndex < iterLength) {
            var data = iteratees[iterIndex],
                iteratee = data.iteratee,
                type = data.type,
                computed = iteratee(value);

            if (type == LAZY_MAP_FLAG) {
              value = computed;
            } else if (!computed) {
              if (type == LAZY_FILTER_FLAG) {
                continue outer;
              } else {
                break outer;
              }
            }
          }
          result[resIndex++] = value;
        }
        return result;
      }

      // Ensure `LazyWrapper` is an instance of `baseLodash`.
      LazyWrapper.prototype = baseCreate(baseLodash.prototype);
      LazyWrapper.prototype.constructor = LazyWrapper;

      /*------------------------------------------------------------------------*/

      /**
       * Creates a hash object.
       *
       * @private
       * @constructor
       * @param {Array} [entries] The key-value pairs to cache.
       */
      function Hash(entries) {
        var index = -1,
            length = entries == null ? 0 : entries.length;

        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }

      /**
       * Removes all key-value entries from the hash.
       *
       * @private
       * @name clear
       * @memberOf Hash
       */
      function hashClear() {
        this.__data__ = nativeCreate ? nativeCreate(null) : {};
        this.size = 0;
      }

      /**
       * Removes `key` and its value from the hash.
       *
       * @private
       * @name delete
       * @memberOf Hash
       * @param {Object} hash The hash to modify.
       * @param {string} key The key of the value to remove.
       * @returns {boolean} Returns `true` if the entry was removed, else `false`.
       */
      function hashDelete(key) {
        var result = this.has(key) && delete this.__data__[key];
        this.size -= result ? 1 : 0;
        return result;
      }

      /**
       * Gets the hash value for `key`.
       *
       * @private
       * @name get
       * @memberOf Hash
       * @param {string} key The key of the value to get.
       * @returns {*} Returns the entry value.
       */
      function hashGet(key) {
        var data = this.__data__;
        if (nativeCreate) {
          var result = data[key];
          return result === HASH_UNDEFINED ? undefined$1 : result;
        }
        return hasOwnProperty.call(data, key) ? data[key] : undefined$1;
      }

      /**
       * Checks if a hash value for `key` exists.
       *
       * @private
       * @name has
       * @memberOf Hash
       * @param {string} key The key of the entry to check.
       * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
       */
      function hashHas(key) {
        var data = this.__data__;
        return nativeCreate ? (data[key] !== undefined$1) : hasOwnProperty.call(data, key);
      }

      /**
       * Sets the hash `key` to `value`.
       *
       * @private
       * @name set
       * @memberOf Hash
       * @param {string} key The key of the value to set.
       * @param {*} value The value to set.
       * @returns {Object} Returns the hash instance.
       */
      function hashSet(key, value) {
        var data = this.__data__;
        this.size += this.has(key) ? 0 : 1;
        data[key] = (nativeCreate && value === undefined$1) ? HASH_UNDEFINED : value;
        return this;
      }

      // Add methods to `Hash`.
      Hash.prototype.clear = hashClear;
      Hash.prototype['delete'] = hashDelete;
      Hash.prototype.get = hashGet;
      Hash.prototype.has = hashHas;
      Hash.prototype.set = hashSet;

      /*------------------------------------------------------------------------*/

      /**
       * Creates an list cache object.
       *
       * @private
       * @constructor
       * @param {Array} [entries] The key-value pairs to cache.
       */
      function ListCache(entries) {
        var index = -1,
            length = entries == null ? 0 : entries.length;

        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }

      /**
       * Removes all key-value entries from the list cache.
       *
       * @private
       * @name clear
       * @memberOf ListCache
       */
      function listCacheClear() {
        this.__data__ = [];
        this.size = 0;
      }

      /**
       * Removes `key` and its value from the list cache.
       *
       * @private
       * @name delete
       * @memberOf ListCache
       * @param {string} key The key of the value to remove.
       * @returns {boolean} Returns `true` if the entry was removed, else `false`.
       */
      function listCacheDelete(key) {
        var data = this.__data__,
            index = assocIndexOf(data, key);

        if (index < 0) {
          return false;
        }
        var lastIndex = data.length - 1;
        if (index == lastIndex) {
          data.pop();
        } else {
          splice.call(data, index, 1);
        }
        --this.size;
        return true;
      }

      /**
       * Gets the list cache value for `key`.
       *
       * @private
       * @name get
       * @memberOf ListCache
       * @param {string} key The key of the value to get.
       * @returns {*} Returns the entry value.
       */
      function listCacheGet(key) {
        var data = this.__data__,
            index = assocIndexOf(data, key);

        return index < 0 ? undefined$1 : data[index][1];
      }

      /**
       * Checks if a list cache value for `key` exists.
       *
       * @private
       * @name has
       * @memberOf ListCache
       * @param {string} key The key of the entry to check.
       * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
       */
      function listCacheHas(key) {
        return assocIndexOf(this.__data__, key) > -1;
      }

      /**
       * Sets the list cache `key` to `value`.
       *
       * @private
       * @name set
       * @memberOf ListCache
       * @param {string} key The key of the value to set.
       * @param {*} value The value to set.
       * @returns {Object} Returns the list cache instance.
       */
      function listCacheSet(key, value) {
        var data = this.__data__,
            index = assocIndexOf(data, key);

        if (index < 0) {
          ++this.size;
          data.push([key, value]);
        } else {
          data[index][1] = value;
        }
        return this;
      }

      // Add methods to `ListCache`.
      ListCache.prototype.clear = listCacheClear;
      ListCache.prototype['delete'] = listCacheDelete;
      ListCache.prototype.get = listCacheGet;
      ListCache.prototype.has = listCacheHas;
      ListCache.prototype.set = listCacheSet;

      /*------------------------------------------------------------------------*/

      /**
       * Creates a map cache object to store key-value pairs.
       *
       * @private
       * @constructor
       * @param {Array} [entries] The key-value pairs to cache.
       */
      function MapCache(entries) {
        var index = -1,
            length = entries == null ? 0 : entries.length;

        this.clear();
        while (++index < length) {
          var entry = entries[index];
          this.set(entry[0], entry[1]);
        }
      }

      /**
       * Removes all key-value entries from the map.
       *
       * @private
       * @name clear
       * @memberOf MapCache
       */
      function mapCacheClear() {
        this.size = 0;
        this.__data__ = {
          'hash': new Hash,
          'map': new (Map || ListCache),
          'string': new Hash
        };
      }

      /**
       * Removes `key` and its value from the map.
       *
       * @private
       * @name delete
       * @memberOf MapCache
       * @param {string} key The key of the value to remove.
       * @returns {boolean} Returns `true` if the entry was removed, else `false`.
       */
      function mapCacheDelete(key) {
        var result = getMapData(this, key)['delete'](key);
        this.size -= result ? 1 : 0;
        return result;
      }

      /**
       * Gets the map value for `key`.
       *
       * @private
       * @name get
       * @memberOf MapCache
       * @param {string} key The key of the value to get.
       * @returns {*} Returns the entry value.
       */
      function mapCacheGet(key) {
        return getMapData(this, key).get(key);
      }

      /**
       * Checks if a map value for `key` exists.
       *
       * @private
       * @name has
       * @memberOf MapCache
       * @param {string} key The key of the entry to check.
       * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
       */
      function mapCacheHas(key) {
        return getMapData(this, key).has(key);
      }

      /**
       * Sets the map `key` to `value`.
       *
       * @private
       * @name set
       * @memberOf MapCache
       * @param {string} key The key of the value to set.
       * @param {*} value The value to set.
       * @returns {Object} Returns the map cache instance.
       */
      function mapCacheSet(key, value) {
        var data = getMapData(this, key),
            size = data.size;

        data.set(key, value);
        this.size += data.size == size ? 0 : 1;
        return this;
      }

      // Add methods to `MapCache`.
      MapCache.prototype.clear = mapCacheClear;
      MapCache.prototype['delete'] = mapCacheDelete;
      MapCache.prototype.get = mapCacheGet;
      MapCache.prototype.has = mapCacheHas;
      MapCache.prototype.set = mapCacheSet;

      /*------------------------------------------------------------------------*/

      /**
       *
       * Creates an array cache object to store unique values.
       *
       * @private
       * @constructor
       * @param {Array} [values] The values to cache.
       */
      function SetCache(values) {
        var index = -1,
            length = values == null ? 0 : values.length;

        this.__data__ = new MapCache;
        while (++index < length) {
          this.add(values[index]);
        }
      }

      /**
       * Adds `value` to the array cache.
       *
       * @private
       * @name add
       * @memberOf SetCache
       * @alias push
       * @param {*} value The value to cache.
       * @returns {Object} Returns the cache instance.
       */
      function setCacheAdd(value) {
        this.__data__.set(value, HASH_UNDEFINED);
        return this;
      }

      /**
       * Checks if `value` is in the array cache.
       *
       * @private
       * @name has
       * @memberOf SetCache
       * @param {*} value The value to search for.
       * @returns {number} Returns `true` if `value` is found, else `false`.
       */
      function setCacheHas(value) {
        return this.__data__.has(value);
      }

      // Add methods to `SetCache`.
      SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;
      SetCache.prototype.has = setCacheHas;

      /*------------------------------------------------------------------------*/

      /**
       * Creates a stack cache object to store key-value pairs.
       *
       * @private
       * @constructor
       * @param {Array} [entries] The key-value pairs to cache.
       */
      function Stack(entries) {
        var data = this.__data__ = new ListCache(entries);
        this.size = data.size;
      }

      /**
       * Removes all key-value entries from the stack.
       *
       * @private
       * @name clear
       * @memberOf Stack
       */
      function stackClear() {
        this.__data__ = new ListCache;
        this.size = 0;
      }

      /**
       * Removes `key` and its value from the stack.
       *
       * @private
       * @name delete
       * @memberOf Stack
       * @param {string} key The key of the value to remove.
       * @returns {boolean} Returns `true` if the entry was removed, else `false`.
       */
      function stackDelete(key) {
        var data = this.__data__,
            result = data['delete'](key);

        this.size = data.size;
        return result;
      }

      /**
       * Gets the stack value for `key`.
       *
       * @private
       * @name get
       * @memberOf Stack
       * @param {string} key The key of the value to get.
       * @returns {*} Returns the entry value.
       */
      function stackGet(key) {
        return this.__data__.get(key);
      }

      /**
       * Checks if a stack value for `key` exists.
       *
       * @private
       * @name has
       * @memberOf Stack
       * @param {string} key The key of the entry to check.
       * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
       */
      function stackHas(key) {
        return this.__data__.has(key);
      }

      /**
       * Sets the stack `key` to `value`.
       *
       * @private
       * @name set
       * @memberOf Stack
       * @param {string} key The key of the value to set.
       * @param {*} value The value to set.
       * @returns {Object} Returns the stack cache instance.
       */
      function stackSet(key, value) {
        var data = this.__data__;
        if (data instanceof ListCache) {
          var pairs = data.__data__;
          if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {
            pairs.push([key, value]);
            this.size = ++data.size;
            return this;
          }
          data = this.__data__ = new MapCache(pairs);
        }
        data.set(key, value);
        this.size = data.size;
        return this;
      }

      // Add methods to `Stack`.
      Stack.prototype.clear = stackClear;
      Stack.prototype['delete'] = stackDelete;
      Stack.prototype.get = stackGet;
      Stack.prototype.has = stackHas;
      Stack.prototype.set = stackSet;

      /*------------------------------------------------------------------------*/

      /**
       * Creates an array of the enumerable property names of the array-like `value`.
       *
       * @private
       * @param {*} value The value to query.
       * @param {boolean} inherited Specify returning inherited property names.
       * @returns {Array} Returns the array of property names.
       */
      function arrayLikeKeys(value, inherited) {
        var isArr = isArray(value),
            isArg = !isArr && isArguments(value),
            isBuff = !isArr && !isArg && isBuffer(value),
            isType = !isArr && !isArg && !isBuff && isTypedArray(value),
            skipIndexes = isArr || isArg || isBuff || isType,
            result = skipIndexes ? baseTimes(value.length, String) : [],
            length = result.length;

        for (var key in value) {
          if ((inherited || hasOwnProperty.call(value, key)) &&
              !(skipIndexes && (
                 // Safari 9 has enumerable `arguments.length` in strict mode.
                 key == 'length' ||
                 // Node.js 0.10 has enumerable non-index properties on buffers.
                 (isBuff && (key == 'offset' || key == 'parent')) ||
                 // PhantomJS 2 has enumerable non-index properties on typed arrays.
                 (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||
                 // Skip index properties.
                 isIndex(key, length)
              ))) {
            result.push(key);
          }
        }
        return result;
      }

      /**
       * A specialized version of `_.sample` for arrays.
       *
       * @private
       * @param {Array} array The array to sample.
       * @returns {*} Returns the random element.
       */
      function arraySample(array) {
        var length = array.length;
        return length ? array[baseRandom(0, length - 1)] : undefined$1;
      }

      /**
       * A specialized version of `_.sampleSize` for arrays.
       *
       * @private
       * @param {Array} array The array to sample.
       * @param {number} n The number of elements to sample.
       * @returns {Array} Returns the random elements.
       */
      function arraySampleSize(array, n) {
        return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));
      }

      /**
       * A specialized version of `_.shuffle` for arrays.
       *
       * @private
       * @param {Array} array The array to shuffle.
       * @returns {Array} Returns the new shuffled array.
       */
      function arrayShuffle(array) {
        return shuffleSelf(copyArray(array));
      }

      /**
       * This function is like `assignValue` except that it doesn't assign
       * `undefined` values.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {string} key The key of the property to assign.
       * @param {*} value The value to assign.
       */
      function assignMergeValue(object, key, value) {
        if ((value !== undefined$1 && !eq(object[key], value)) ||
            (value === undefined$1 && !(key in object))) {
          baseAssignValue(object, key, value);
        }
      }

      /**
       * Assigns `value` to `key` of `object` if the existing value is not equivalent
       * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {string} key The key of the property to assign.
       * @param {*} value The value to assign.
       */
      function assignValue(object, key, value) {
        var objValue = object[key];
        if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||
            (value === undefined$1 && !(key in object))) {
          baseAssignValue(object, key, value);
        }
      }

      /**
       * Gets the index at which the `key` is found in `array` of key-value pairs.
       *
       * @private
       * @param {Array} array The array to inspect.
       * @param {*} key The key to search for.
       * @returns {number} Returns the index of the matched value, else `-1`.
       */
      function assocIndexOf(array, key) {
        var length = array.length;
        while (length--) {
          if (eq(array[length][0], key)) {
            return length;
          }
        }
        return -1;
      }

      /**
       * Aggregates elements of `collection` on `accumulator` with keys transformed
       * by `iteratee` and values set by `setter`.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} setter The function to set `accumulator` values.
       * @param {Function} iteratee The iteratee to transform keys.
       * @param {Object} accumulator The initial aggregated object.
       * @returns {Function} Returns `accumulator`.
       */
      function baseAggregator(collection, setter, iteratee, accumulator) {
        baseEach(collection, function(value, key, collection) {
          setter(accumulator, value, iteratee(value), collection);
        });
        return accumulator;
      }

      /**
       * The base implementation of `_.assign` without support for multiple sources
       * or `customizer` functions.
       *
       * @private
       * @param {Object} object The destination object.
       * @param {Object} source The source object.
       * @returns {Object} Returns `object`.
       */
      function baseAssign(object, source) {
        return object && copyObject(source, keys(source), object);
      }

      /**
       * The base implementation of `_.assignIn` without support for multiple sources
       * or `customizer` functions.
       *
       * @private
       * @param {Object} object The destination object.
       * @param {Object} source The source object.
       * @returns {Object} Returns `object`.
       */
      function baseAssignIn(object, source) {
        return object && copyObject(source, keysIn(source), object);
      }

      /**
       * The base implementation of `assignValue` and `assignMergeValue` without
       * value checks.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {string} key The key of the property to assign.
       * @param {*} value The value to assign.
       */
      function baseAssignValue(object, key, value) {
        if (key == '__proto__' && defineProperty) {
          defineProperty(object, key, {
            'configurable': true,
            'enumerable': true,
            'value': value,
            'writable': true
          });
        } else {
          object[key] = value;
        }
      }

      /**
       * The base implementation of `_.at` without support for individual paths.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {string[]} paths The property paths to pick.
       * @returns {Array} Returns the picked elements.
       */
      function baseAt(object, paths) {
        var index = -1,
            length = paths.length,
            result = Array(length),
            skip = object == null;

        while (++index < length) {
          result[index] = skip ? undefined$1 : get(object, paths[index]);
        }
        return result;
      }

      /**
       * The base implementation of `_.clamp` which doesn't coerce arguments.
       *
       * @private
       * @param {number} number The number to clamp.
       * @param {number} [lower] The lower bound.
       * @param {number} upper The upper bound.
       * @returns {number} Returns the clamped number.
       */
      function baseClamp(number, lower, upper) {
        if (number === number) {
          if (upper !== undefined$1) {
            number = number <= upper ? number : upper;
          }
          if (lower !== undefined$1) {
            number = number >= lower ? number : lower;
          }
        }
        return number;
      }

      /**
       * The base implementation of `_.clone` and `_.cloneDeep` which tracks
       * traversed objects.
       *
       * @private
       * @param {*} value The value to clone.
       * @param {boolean} bitmask The bitmask flags.
       *  1 - Deep clone
       *  2 - Flatten inherited properties
       *  4 - Clone symbols
       * @param {Function} [customizer] The function to customize cloning.
       * @param {string} [key] The key of `value`.
       * @param {Object} [object] The parent object of `value`.
       * @param {Object} [stack] Tracks traversed objects and their clone counterparts.
       * @returns {*} Returns the cloned value.
       */
      function baseClone(value, bitmask, customizer, key, object, stack) {
        var result,
            isDeep = bitmask & CLONE_DEEP_FLAG,
            isFlat = bitmask & CLONE_FLAT_FLAG,
            isFull = bitmask & CLONE_SYMBOLS_FLAG;

        if (customizer) {
          result = object ? customizer(value, key, object, stack) : customizer(value);
        }
        if (result !== undefined$1) {
          return result;
        }
        if (!isObject(value)) {
          return value;
        }
        var isArr = isArray(value);
        if (isArr) {
          result = initCloneArray(value);
          if (!isDeep) {
            return copyArray(value, result);
          }
        } else {
          var tag = getTag(value),
              isFunc = tag == funcTag || tag == genTag;

          if (isBuffer(value)) {
            return cloneBuffer(value, isDeep);
          }
          if (tag == objectTag || tag == argsTag || (isFunc && !object)) {
            result = (isFlat || isFunc) ? {} : initCloneObject(value);
            if (!isDeep) {
              return isFlat
                ? copySymbolsIn(value, baseAssignIn(result, value))
                : copySymbols(value, baseAssign(result, value));
            }
          } else {
            if (!cloneableTags[tag]) {
              return object ? value : {};
            }
            result = initCloneByTag(value, tag, isDeep);
          }
        }
        // Check for circular references and return its corresponding clone.
        stack || (stack = new Stack);
        var stacked = stack.get(value);
        if (stacked) {
          return stacked;
        }
        stack.set(value, result);

        if (isSet(value)) {
          value.forEach(function(subValue) {
            result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));
          });
        } else if (isMap(value)) {
          value.forEach(function(subValue, key) {
            result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));
          });
        }

        var keysFunc = isFull
          ? (isFlat ? getAllKeysIn : getAllKeys)
          : (isFlat ? keysIn : keys);

        var props = isArr ? undefined$1 : keysFunc(value);
        arrayEach(props || value, function(subValue, key) {
          if (props) {
            key = subValue;
            subValue = value[key];
          }
          // Recursively populate clone (susceptible to call stack limits).
          assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));
        });
        return result;
      }

      /**
       * The base implementation of `_.conforms` which doesn't clone `source`.
       *
       * @private
       * @param {Object} source The object of property predicates to conform to.
       * @returns {Function} Returns the new spec function.
       */
      function baseConforms(source) {
        var props = keys(source);
        return function(object) {
          return baseConformsTo(object, source, props);
        };
      }

      /**
       * The base implementation of `_.conformsTo` which accepts `props` to check.
       *
       * @private
       * @param {Object} object The object to inspect.
       * @param {Object} source The object of property predicates to conform to.
       * @returns {boolean} Returns `true` if `object` conforms, else `false`.
       */
      function baseConformsTo(object, source, props) {
        var length = props.length;
        if (object == null) {
          return !length;
        }
        object = Object(object);
        while (length--) {
          var key = props[length],
              predicate = source[key],
              value = object[key];

          if ((value === undefined$1 && !(key in object)) || !predicate(value)) {
            return false;
          }
        }
        return true;
      }

      /**
       * The base implementation of `_.delay` and `_.defer` which accepts `args`
       * to provide to `func`.
       *
       * @private
       * @param {Function} func The function to delay.
       * @param {number} wait The number of milliseconds to delay invocation.
       * @param {Array} args The arguments to provide to `func`.
       * @returns {number|Object} Returns the timer id or timeout object.
       */
      function baseDelay(func, wait, args) {
        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        return setTimeout(function() { func.apply(undefined$1, args); }, wait);
      }

      /**
       * The base implementation of methods like `_.difference` without support
       * for excluding multiple arrays or iteratee shorthands.
       *
       * @private
       * @param {Array} array The array to inspect.
       * @param {Array} values The values to exclude.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of filtered values.
       */
      function baseDifference(array, values, iteratee, comparator) {
        var index = -1,
            includes = arrayIncludes,
            isCommon = true,
            length = array.length,
            result = [],
            valuesLength = values.length;

        if (!length) {
          return result;
        }
        if (iteratee) {
          values = arrayMap(values, baseUnary(iteratee));
        }
        if (comparator) {
          includes = arrayIncludesWith;
          isCommon = false;
        }
        else if (values.length >= LARGE_ARRAY_SIZE) {
          includes = cacheHas;
          isCommon = false;
          values = new SetCache(values);
        }
        outer:
        while (++index < length) {
          var value = array[index],
              computed = iteratee == null ? value : iteratee(value);

          value = (comparator || value !== 0) ? value : 0;
          if (isCommon && computed === computed) {
            var valuesIndex = valuesLength;
            while (valuesIndex--) {
              if (values[valuesIndex] === computed) {
                continue outer;
              }
            }
            result.push(value);
          }
          else if (!includes(values, computed, comparator)) {
            result.push(value);
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.forEach` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @returns {Array|Object} Returns `collection`.
       */
      var baseEach = createBaseEach(baseForOwn);

      /**
       * The base implementation of `_.forEachRight` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @returns {Array|Object} Returns `collection`.
       */
      var baseEachRight = createBaseEach(baseForOwnRight, true);

      /**
       * The base implementation of `_.every` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} predicate The function invoked per iteration.
       * @returns {boolean} Returns `true` if all elements pass the predicate check,
       *  else `false`
       */
      function baseEvery(collection, predicate) {
        var result = true;
        baseEach(collection, function(value, index, collection) {
          result = !!predicate(value, index, collection);
          return result;
        });
        return result;
      }

      /**
       * The base implementation of methods like `_.max` and `_.min` which accepts a
       * `comparator` to determine the extremum value.
       *
       * @private
       * @param {Array} array The array to iterate over.
       * @param {Function} iteratee The iteratee invoked per iteration.
       * @param {Function} comparator The comparator used to compare values.
       * @returns {*} Returns the extremum value.
       */
      function baseExtremum(array, iteratee, comparator) {
        var index = -1,
            length = array.length;

        while (++index < length) {
          var value = array[index],
              current = iteratee(value);

          if (current != null && (computed === undefined$1
                ? (current === current && !isSymbol(current))
                : comparator(current, computed)
              )) {
            var computed = current,
                result = value;
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.fill` without an iteratee call guard.
       *
       * @private
       * @param {Array} array The array to fill.
       * @param {*} value The value to fill `array` with.
       * @param {number} [start=0] The start position.
       * @param {number} [end=array.length] The end position.
       * @returns {Array} Returns `array`.
       */
      function baseFill(array, value, start, end) {
        var length = array.length;

        start = toInteger(start);
        if (start < 0) {
          start = -start > length ? 0 : (length + start);
        }
        end = (end === undefined$1 || end > length) ? length : toInteger(end);
        if (end < 0) {
          end += length;
        }
        end = start > end ? 0 : toLength(end);
        while (start < end) {
          array[start++] = value;
        }
        return array;
      }

      /**
       * The base implementation of `_.filter` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} predicate The function invoked per iteration.
       * @returns {Array} Returns the new filtered array.
       */
      function baseFilter(collection, predicate) {
        var result = [];
        baseEach(collection, function(value, index, collection) {
          if (predicate(value, index, collection)) {
            result.push(value);
          }
        });
        return result;
      }

      /**
       * The base implementation of `_.flatten` with support for restricting flattening.
       *
       * @private
       * @param {Array} array The array to flatten.
       * @param {number} depth The maximum recursion depth.
       * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.
       * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.
       * @param {Array} [result=[]] The initial result value.
       * @returns {Array} Returns the new flattened array.
       */
      function baseFlatten(array, depth, predicate, isStrict, result) {
        var index = -1,
            length = array.length;

        predicate || (predicate = isFlattenable);
        result || (result = []);

        while (++index < length) {
          var value = array[index];
          if (depth > 0 && predicate(value)) {
            if (depth > 1) {
              // Recursively flatten arrays (susceptible to call stack limits).
              baseFlatten(value, depth - 1, predicate, isStrict, result);
            } else {
              arrayPush(result, value);
            }
          } else if (!isStrict) {
            result[result.length] = value;
          }
        }
        return result;
      }

      /**
       * The base implementation of `baseForOwn` which iterates over `object`
       * properties returned by `keysFunc` and invokes `iteratee` for each property.
       * Iteratee functions may exit iteration early by explicitly returning `false`.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @param {Function} keysFunc The function to get the keys of `object`.
       * @returns {Object} Returns `object`.
       */
      var baseFor = createBaseFor();

      /**
       * This function is like `baseFor` except that it iterates over properties
       * in the opposite order.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @param {Function} keysFunc The function to get the keys of `object`.
       * @returns {Object} Returns `object`.
       */
      var baseForRight = createBaseFor(true);

      /**
       * The base implementation of `_.forOwn` without support for iteratee shorthands.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @returns {Object} Returns `object`.
       */
      function baseForOwn(object, iteratee) {
        return object && baseFor(object, iteratee, keys);
      }

      /**
       * The base implementation of `_.forOwnRight` without support for iteratee shorthands.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @returns {Object} Returns `object`.
       */
      function baseForOwnRight(object, iteratee) {
        return object && baseForRight(object, iteratee, keys);
      }

      /**
       * The base implementation of `_.functions` which creates an array of
       * `object` function property names filtered from `props`.
       *
       * @private
       * @param {Object} object The object to inspect.
       * @param {Array} props The property names to filter.
       * @returns {Array} Returns the function names.
       */
      function baseFunctions(object, props) {
        return arrayFilter(props, function(key) {
          return isFunction(object[key]);
        });
      }

      /**
       * The base implementation of `_.get` without support for default values.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {Array|string} path The path of the property to get.
       * @returns {*} Returns the resolved value.
       */
      function baseGet(object, path) {
        path = castPath(path, object);

        var index = 0,
            length = path.length;

        while (object != null && index < length) {
          object = object[toKey(path[index++])];
        }
        return (index && index == length) ? object : undefined$1;
      }

      /**
       * The base implementation of `getAllKeys` and `getAllKeysIn` which uses
       * `keysFunc` and `symbolsFunc` to get the enumerable property names and
       * symbols of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {Function} keysFunc The function to get the keys of `object`.
       * @param {Function} symbolsFunc The function to get the symbols of `object`.
       * @returns {Array} Returns the array of property names and symbols.
       */
      function baseGetAllKeys(object, keysFunc, symbolsFunc) {
        var result = keysFunc(object);
        return isArray(object) ? result : arrayPush(result, symbolsFunc(object));
      }

      /**
       * The base implementation of `getTag` without fallbacks for buggy environments.
       *
       * @private
       * @param {*} value The value to query.
       * @returns {string} Returns the `toStringTag`.
       */
      function baseGetTag(value) {
        if (value == null) {
          return value === undefined$1 ? undefinedTag : nullTag;
        }
        return (symToStringTag && symToStringTag in Object(value))
          ? getRawTag(value)
          : objectToString(value);
      }

      /**
       * The base implementation of `_.gt` which doesn't coerce arguments.
       *
       * @private
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is greater than `other`,
       *  else `false`.
       */
      function baseGt(value, other) {
        return value > other;
      }

      /**
       * The base implementation of `_.has` without support for deep paths.
       *
       * @private
       * @param {Object} [object] The object to query.
       * @param {Array|string} key The key to check.
       * @returns {boolean} Returns `true` if `key` exists, else `false`.
       */
      function baseHas(object, key) {
        return object != null && hasOwnProperty.call(object, key);
      }

      /**
       * The base implementation of `_.hasIn` without support for deep paths.
       *
       * @private
       * @param {Object} [object] The object to query.
       * @param {Array|string} key The key to check.
       * @returns {boolean} Returns `true` if `key` exists, else `false`.
       */
      function baseHasIn(object, key) {
        return object != null && key in Object(object);
      }

      /**
       * The base implementation of `_.inRange` which doesn't coerce arguments.
       *
       * @private
       * @param {number} number The number to check.
       * @param {number} start The start of the range.
       * @param {number} end The end of the range.
       * @returns {boolean} Returns `true` if `number` is in the range, else `false`.
       */
      function baseInRange(number, start, end) {
        return number >= nativeMin(start, end) && number < nativeMax(start, end);
      }

      /**
       * The base implementation of methods like `_.intersection`, without support
       * for iteratee shorthands, that accepts an array of arrays to inspect.
       *
       * @private
       * @param {Array} arrays The arrays to inspect.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of shared values.
       */
      function baseIntersection(arrays, iteratee, comparator) {
        var includes = comparator ? arrayIncludesWith : arrayIncludes,
            length = arrays[0].length,
            othLength = arrays.length,
            othIndex = othLength,
            caches = Array(othLength),
            maxLength = Infinity,
            result = [];

        while (othIndex--) {
          var array = arrays[othIndex];
          if (othIndex && iteratee) {
            array = arrayMap(array, baseUnary(iteratee));
          }
          maxLength = nativeMin(array.length, maxLength);
          caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))
            ? new SetCache(othIndex && array)
            : undefined$1;
        }
        array = arrays[0];

        var index = -1,
            seen = caches[0];

        outer:
        while (++index < length && result.length < maxLength) {
          var value = array[index],
              computed = iteratee ? iteratee(value) : value;

          value = (comparator || value !== 0) ? value : 0;
          if (!(seen
                ? cacheHas(seen, computed)
                : includes(result, computed, comparator)
              )) {
            othIndex = othLength;
            while (--othIndex) {
              var cache = caches[othIndex];
              if (!(cache
                    ? cacheHas(cache, computed)
                    : includes(arrays[othIndex], computed, comparator))
                  ) {
                continue outer;
              }
            }
            if (seen) {
              seen.push(computed);
            }
            result.push(value);
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.invert` and `_.invertBy` which inverts
       * `object` with values transformed by `iteratee` and set by `setter`.
       *
       * @private
       * @param {Object} object The object to iterate over.
       * @param {Function} setter The function to set `accumulator` values.
       * @param {Function} iteratee The iteratee to transform values.
       * @param {Object} accumulator The initial inverted object.
       * @returns {Function} Returns `accumulator`.
       */
      function baseInverter(object, setter, iteratee, accumulator) {
        baseForOwn(object, function(value, key, object) {
          setter(accumulator, iteratee(value), key, object);
        });
        return accumulator;
      }

      /**
       * The base implementation of `_.invoke` without support for individual
       * method arguments.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {Array|string} path The path of the method to invoke.
       * @param {Array} args The arguments to invoke the method with.
       * @returns {*} Returns the result of the invoked method.
       */
      function baseInvoke(object, path, args) {
        path = castPath(path, object);
        object = parent(object, path);
        var func = object == null ? object : object[toKey(last(path))];
        return func == null ? undefined$1 : apply(func, object, args);
      }

      /**
       * The base implementation of `_.isArguments`.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an `arguments` object,
       */
      function baseIsArguments(value) {
        return isObjectLike(value) && baseGetTag(value) == argsTag;
      }

      /**
       * The base implementation of `_.isArrayBuffer` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.
       */
      function baseIsArrayBuffer(value) {
        return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;
      }

      /**
       * The base implementation of `_.isDate` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a date object, else `false`.
       */
      function baseIsDate(value) {
        return isObjectLike(value) && baseGetTag(value) == dateTag;
      }

      /**
       * The base implementation of `_.isEqual` which supports partial comparisons
       * and tracks traversed objects.
       *
       * @private
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @param {boolean} bitmask The bitmask flags.
       *  1 - Unordered comparison
       *  2 - Partial comparison
       * @param {Function} [customizer] The function to customize comparisons.
       * @param {Object} [stack] Tracks traversed `value` and `other` objects.
       * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
       */
      function baseIsEqual(value, other, bitmask, customizer, stack) {
        if (value === other) {
          return true;
        }
        if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {
          return value !== value && other !== other;
        }
        return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);
      }

      /**
       * A specialized version of `baseIsEqual` for arrays and objects which performs
       * deep comparisons and tracks traversed objects enabling objects with circular
       * references to be compared.
       *
       * @private
       * @param {Object} object The object to compare.
       * @param {Object} other The other object to compare.
       * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
       * @param {Function} customizer The function to customize comparisons.
       * @param {Function} equalFunc The function to determine equivalents of values.
       * @param {Object} [stack] Tracks traversed `object` and `other` objects.
       * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
       */
      function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {
        var objIsArr = isArray(object),
            othIsArr = isArray(other),
            objTag = objIsArr ? arrayTag : getTag(object),
            othTag = othIsArr ? arrayTag : getTag(other);

        objTag = objTag == argsTag ? objectTag : objTag;
        othTag = othTag == argsTag ? objectTag : othTag;

        var objIsObj = objTag == objectTag,
            othIsObj = othTag == objectTag,
            isSameTag = objTag == othTag;

        if (isSameTag && isBuffer(object)) {
          if (!isBuffer(other)) {
            return false;
          }
          objIsArr = true;
          objIsObj = false;
        }
        if (isSameTag && !objIsObj) {
          stack || (stack = new Stack);
          return (objIsArr || isTypedArray(object))
            ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)
            : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);
        }
        if (!(bitmask & COMPARE_PARTIAL_FLAG)) {
          var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),
              othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');

          if (objIsWrapped || othIsWrapped) {
            var objUnwrapped = objIsWrapped ? object.value() : object,
                othUnwrapped = othIsWrapped ? other.value() : other;

            stack || (stack = new Stack);
            return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);
          }
        }
        if (!isSameTag) {
          return false;
        }
        stack || (stack = new Stack);
        return equalObjects(object, other, bitmask, customizer, equalFunc, stack);
      }

      /**
       * The base implementation of `_.isMap` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a map, else `false`.
       */
      function baseIsMap(value) {
        return isObjectLike(value) && getTag(value) == mapTag;
      }

      /**
       * The base implementation of `_.isMatch` without support for iteratee shorthands.
       *
       * @private
       * @param {Object} object The object to inspect.
       * @param {Object} source The object of property values to match.
       * @param {Array} matchData The property names, values, and compare flags to match.
       * @param {Function} [customizer] The function to customize comparisons.
       * @returns {boolean} Returns `true` if `object` is a match, else `false`.
       */
      function baseIsMatch(object, source, matchData, customizer) {
        var index = matchData.length,
            length = index,
            noCustomizer = !customizer;

        if (object == null) {
          return !length;
        }
        object = Object(object);
        while (index--) {
          var data = matchData[index];
          if ((noCustomizer && data[2])
                ? data[1] !== object[data[0]]
                : !(data[0] in object)
              ) {
            return false;
          }
        }
        while (++index < length) {
          data = matchData[index];
          var key = data[0],
              objValue = object[key],
              srcValue = data[1];

          if (noCustomizer && data[2]) {
            if (objValue === undefined$1 && !(key in object)) {
              return false;
            }
          } else {
            var stack = new Stack;
            if (customizer) {
              var result = customizer(objValue, srcValue, key, object, source, stack);
            }
            if (!(result === undefined$1
                  ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)
                  : result
                )) {
              return false;
            }
          }
        }
        return true;
      }

      /**
       * The base implementation of `_.isNative` without bad shim checks.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a native function,
       *  else `false`.
       */
      function baseIsNative(value) {
        if (!isObject(value) || isMasked(value)) {
          return false;
        }
        var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
        return pattern.test(toSource(value));
      }

      /**
       * The base implementation of `_.isRegExp` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.
       */
      function baseIsRegExp(value) {
        return isObjectLike(value) && baseGetTag(value) == regexpTag;
      }

      /**
       * The base implementation of `_.isSet` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a set, else `false`.
       */
      function baseIsSet(value) {
        return isObjectLike(value) && getTag(value) == setTag;
      }

      /**
       * The base implementation of `_.isTypedArray` without Node.js optimizations.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
       */
      function baseIsTypedArray(value) {
        return isObjectLike(value) &&
          isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
      }

      /**
       * The base implementation of `_.iteratee`.
       *
       * @private
       * @param {*} [value=_.identity] The value to convert to an iteratee.
       * @returns {Function} Returns the iteratee.
       */
      function baseIteratee(value) {
        // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.
        // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.
        if (typeof value == 'function') {
          return value;
        }
        if (value == null) {
          return identity;
        }
        if (typeof value == 'object') {
          return isArray(value)
            ? baseMatchesProperty(value[0], value[1])
            : baseMatches(value);
        }
        return property(value);
      }

      /**
       * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names.
       */
      function baseKeys(object) {
        if (!isPrototype(object)) {
          return nativeKeys(object);
        }
        var result = [];
        for (var key in Object(object)) {
          if (hasOwnProperty.call(object, key) && key != 'constructor') {
            result.push(key);
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names.
       */
      function baseKeysIn(object) {
        if (!isObject(object)) {
          return nativeKeysIn(object);
        }
        var isProto = isPrototype(object),
            result = [];

        for (var key in object) {
          if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {
            result.push(key);
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.lt` which doesn't coerce arguments.
       *
       * @private
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is less than `other`,
       *  else `false`.
       */
      function baseLt(value, other) {
        return value < other;
      }

      /**
       * The base implementation of `_.map` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} iteratee The function invoked per iteration.
       * @returns {Array} Returns the new mapped array.
       */
      function baseMap(collection, iteratee) {
        var index = -1,
            result = isArrayLike(collection) ? Array(collection.length) : [];

        baseEach(collection, function(value, key, collection) {
          result[++index] = iteratee(value, key, collection);
        });
        return result;
      }

      /**
       * The base implementation of `_.matches` which doesn't clone `source`.
       *
       * @private
       * @param {Object} source The object of property values to match.
       * @returns {Function} Returns the new spec function.
       */
      function baseMatches(source) {
        var matchData = getMatchData(source);
        if (matchData.length == 1 && matchData[0][2]) {
          return matchesStrictComparable(matchData[0][0], matchData[0][1]);
        }
        return function(object) {
          return object === source || baseIsMatch(object, source, matchData);
        };
      }

      /**
       * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.
       *
       * @private
       * @param {string} path The path of the property to get.
       * @param {*} srcValue The value to match.
       * @returns {Function} Returns the new spec function.
       */
      function baseMatchesProperty(path, srcValue) {
        if (isKey(path) && isStrictComparable(srcValue)) {
          return matchesStrictComparable(toKey(path), srcValue);
        }
        return function(object) {
          var objValue = get(object, path);
          return (objValue === undefined$1 && objValue === srcValue)
            ? hasIn(object, path)
            : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);
        };
      }

      /**
       * The base implementation of `_.merge` without support for multiple sources.
       *
       * @private
       * @param {Object} object The destination object.
       * @param {Object} source The source object.
       * @param {number} srcIndex The index of `source`.
       * @param {Function} [customizer] The function to customize merged values.
       * @param {Object} [stack] Tracks traversed source values and their merged
       *  counterparts.
       */
      function baseMerge(object, source, srcIndex, customizer, stack) {
        if (object === source) {
          return;
        }
        baseFor(source, function(srcValue, key) {
          stack || (stack = new Stack);
          if (isObject(srcValue)) {
            baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);
          }
          else {
            var newValue = customizer
              ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)
              : undefined$1;

            if (newValue === undefined$1) {
              newValue = srcValue;
            }
            assignMergeValue(object, key, newValue);
          }
        }, keysIn);
      }

      /**
       * A specialized version of `baseMerge` for arrays and objects which performs
       * deep merges and tracks traversed objects enabling objects with circular
       * references to be merged.
       *
       * @private
       * @param {Object} object The destination object.
       * @param {Object} source The source object.
       * @param {string} key The key of the value to merge.
       * @param {number} srcIndex The index of `source`.
       * @param {Function} mergeFunc The function to merge values.
       * @param {Function} [customizer] The function to customize assigned values.
       * @param {Object} [stack] Tracks traversed source values and their merged
       *  counterparts.
       */
      function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {
        var objValue = safeGet(object, key),
            srcValue = safeGet(source, key),
            stacked = stack.get(srcValue);

        if (stacked) {
          assignMergeValue(object, key, stacked);
          return;
        }
        var newValue = customizer
          ? customizer(objValue, srcValue, (key + ''), object, source, stack)
          : undefined$1;

        var isCommon = newValue === undefined$1;

        if (isCommon) {
          var isArr = isArray(srcValue),
              isBuff = !isArr && isBuffer(srcValue),
              isTyped = !isArr && !isBuff && isTypedArray(srcValue);

          newValue = srcValue;
          if (isArr || isBuff || isTyped) {
            if (isArray(objValue)) {
              newValue = objValue;
            }
            else if (isArrayLikeObject(objValue)) {
              newValue = copyArray(objValue);
            }
            else if (isBuff) {
              isCommon = false;
              newValue = cloneBuffer(srcValue, true);
            }
            else if (isTyped) {
              isCommon = false;
              newValue = cloneTypedArray(srcValue, true);
            }
            else {
              newValue = [];
            }
          }
          else if (isPlainObject(srcValue) || isArguments(srcValue)) {
            newValue = objValue;
            if (isArguments(objValue)) {
              newValue = toPlainObject(objValue);
            }
            else if (!isObject(objValue) || isFunction(objValue)) {
              newValue = initCloneObject(srcValue);
            }
          }
          else {
            isCommon = false;
          }
        }
        if (isCommon) {
          // Recursively merge objects and arrays (susceptible to call stack limits).
          stack.set(srcValue, newValue);
          mergeFunc(newValue, srcValue, srcIndex, customizer, stack);
          stack['delete'](srcValue);
        }
        assignMergeValue(object, key, newValue);
      }

      /**
       * The base implementation of `_.nth` which doesn't coerce arguments.
       *
       * @private
       * @param {Array} array The array to query.
       * @param {number} n The index of the element to return.
       * @returns {*} Returns the nth element of `array`.
       */
      function baseNth(array, n) {
        var length = array.length;
        if (!length) {
          return;
        }
        n += n < 0 ? length : 0;
        return isIndex(n, length) ? array[n] : undefined$1;
      }

      /**
       * The base implementation of `_.orderBy` without param guards.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.
       * @param {string[]} orders The sort orders of `iteratees`.
       * @returns {Array} Returns the new sorted array.
       */
      function baseOrderBy(collection, iteratees, orders) {
        if (iteratees.length) {
          iteratees = arrayMap(iteratees, function(iteratee) {
            if (isArray(iteratee)) {
              return function(value) {
                return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);
              }
            }
            return iteratee;
          });
        } else {
          iteratees = [identity];
        }

        var index = -1;
        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));

        var result = baseMap(collection, function(value, key, collection) {
          var criteria = arrayMap(iteratees, function(iteratee) {
            return iteratee(value);
          });
          return { 'criteria': criteria, 'index': ++index, 'value': value };
        });

        return baseSortBy(result, function(object, other) {
          return compareMultiple(object, other, orders);
        });
      }

      /**
       * The base implementation of `_.pick` without support for individual
       * property identifiers.
       *
       * @private
       * @param {Object} object The source object.
       * @param {string[]} paths The property paths to pick.
       * @returns {Object} Returns the new object.
       */
      function basePick(object, paths) {
        return basePickBy(object, paths, function(value, path) {
          return hasIn(object, path);
        });
      }

      /**
       * The base implementation of  `_.pickBy` without support for iteratee shorthands.
       *
       * @private
       * @param {Object} object The source object.
       * @param {string[]} paths The property paths to pick.
       * @param {Function} predicate The function invoked per property.
       * @returns {Object} Returns the new object.
       */
      function basePickBy(object, paths, predicate) {
        var index = -1,
            length = paths.length,
            result = {};

        while (++index < length) {
          var path = paths[index],
              value = baseGet(object, path);

          if (predicate(value, path)) {
            baseSet(result, castPath(path, object), value);
          }
        }
        return result;
      }

      /**
       * A specialized version of `baseProperty` which supports deep paths.
       *
       * @private
       * @param {Array|string} path The path of the property to get.
       * @returns {Function} Returns the new accessor function.
       */
      function basePropertyDeep(path) {
        return function(object) {
          return baseGet(object, path);
        };
      }

      /**
       * The base implementation of `_.pullAllBy` without support for iteratee
       * shorthands.
       *
       * @private
       * @param {Array} array The array to modify.
       * @param {Array} values The values to remove.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns `array`.
       */
      function basePullAll(array, values, iteratee, comparator) {
        var indexOf = comparator ? baseIndexOfWith : baseIndexOf,
            index = -1,
            length = values.length,
            seen = array;

        if (array === values) {
          values = copyArray(values);
        }
        if (iteratee) {
          seen = arrayMap(array, baseUnary(iteratee));
        }
        while (++index < length) {
          var fromIndex = 0,
              value = values[index],
              computed = iteratee ? iteratee(value) : value;

          while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {
            if (seen !== array) {
              splice.call(seen, fromIndex, 1);
            }
            splice.call(array, fromIndex, 1);
          }
        }
        return array;
      }

      /**
       * The base implementation of `_.pullAt` without support for individual
       * indexes or capturing the removed elements.
       *
       * @private
       * @param {Array} array The array to modify.
       * @param {number[]} indexes The indexes of elements to remove.
       * @returns {Array} Returns `array`.
       */
      function basePullAt(array, indexes) {
        var length = array ? indexes.length : 0,
            lastIndex = length - 1;

        while (length--) {
          var index = indexes[length];
          if (length == lastIndex || index !== previous) {
            var previous = index;
            if (isIndex(index)) {
              splice.call(array, index, 1);
            } else {
              baseUnset(array, index);
            }
          }
        }
        return array;
      }

      /**
       * The base implementation of `_.random` without support for returning
       * floating-point numbers.
       *
       * @private
       * @param {number} lower The lower bound.
       * @param {number} upper The upper bound.
       * @returns {number} Returns the random number.
       */
      function baseRandom(lower, upper) {
        return lower + nativeFloor(nativeRandom() * (upper - lower + 1));
      }

      /**
       * The base implementation of `_.range` and `_.rangeRight` which doesn't
       * coerce arguments.
       *
       * @private
       * @param {number} start The start of the range.
       * @param {number} end The end of the range.
       * @param {number} step The value to increment or decrement by.
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Array} Returns the range of numbers.
       */
      function baseRange(start, end, step, fromRight) {
        var index = -1,
            length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),
            result = Array(length);

        while (length--) {
          result[fromRight ? length : ++index] = start;
          start += step;
        }
        return result;
      }

      /**
       * The base implementation of `_.repeat` which doesn't coerce arguments.
       *
       * @private
       * @param {string} string The string to repeat.
       * @param {number} n The number of times to repeat the string.
       * @returns {string} Returns the repeated string.
       */
      function baseRepeat(string, n) {
        var result = '';
        if (!string || n < 1 || n > MAX_SAFE_INTEGER) {
          return result;
        }
        // Leverage the exponentiation by squaring algorithm for a faster repeat.
        // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.
        do {
          if (n % 2) {
            result += string;
          }
          n = nativeFloor(n / 2);
          if (n) {
            string += string;
          }
        } while (n);

        return result;
      }

      /**
       * The base implementation of `_.rest` which doesn't validate or coerce arguments.
       *
       * @private
       * @param {Function} func The function to apply a rest parameter to.
       * @param {number} [start=func.length-1] The start position of the rest parameter.
       * @returns {Function} Returns the new function.
       */
      function baseRest(func, start) {
        return setToString(overRest(func, start, identity), func + '');
      }

      /**
       * The base implementation of `_.sample`.
       *
       * @private
       * @param {Array|Object} collection The collection to sample.
       * @returns {*} Returns the random element.
       */
      function baseSample(collection) {
        return arraySample(values(collection));
      }

      /**
       * The base implementation of `_.sampleSize` without param guards.
       *
       * @private
       * @param {Array|Object} collection The collection to sample.
       * @param {number} n The number of elements to sample.
       * @returns {Array} Returns the random elements.
       */
      function baseSampleSize(collection, n) {
        var array = values(collection);
        return shuffleSelf(array, baseClamp(n, 0, array.length));
      }

      /**
       * The base implementation of `_.set`.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to set.
       * @param {*} value The value to set.
       * @param {Function} [customizer] The function to customize path creation.
       * @returns {Object} Returns `object`.
       */
      function baseSet(object, path, value, customizer) {
        if (!isObject(object)) {
          return object;
        }
        path = castPath(path, object);

        var index = -1,
            length = path.length,
            lastIndex = length - 1,
            nested = object;

        while (nested != null && ++index < length) {
          var key = toKey(path[index]),
              newValue = value;

          if (key === '__proto__' || key === 'constructor' || key === 'prototype') {
            return object;
          }

          if (index != lastIndex) {
            var objValue = nested[key];
            newValue = customizer ? customizer(objValue, key, nested) : undefined$1;
            if (newValue === undefined$1) {
              newValue = isObject(objValue)
                ? objValue
                : (isIndex(path[index + 1]) ? [] : {});
            }
          }
          assignValue(nested, key, newValue);
          nested = nested[key];
        }
        return object;
      }

      /**
       * The base implementation of `setData` without support for hot loop shorting.
       *
       * @private
       * @param {Function} func The function to associate metadata with.
       * @param {*} data The metadata.
       * @returns {Function} Returns `func`.
       */
      var baseSetData = !metaMap ? identity : function(func, data) {
        metaMap.set(func, data);
        return func;
      };

      /**
       * The base implementation of `setToString` without support for hot loop shorting.
       *
       * @private
       * @param {Function} func The function to modify.
       * @param {Function} string The `toString` result.
       * @returns {Function} Returns `func`.
       */
      var baseSetToString = !defineProperty ? identity : function(func, string) {
        return defineProperty(func, 'toString', {
          'configurable': true,
          'enumerable': false,
          'value': constant(string),
          'writable': true
        });
      };

      /**
       * The base implementation of `_.shuffle`.
       *
       * @private
       * @param {Array|Object} collection The collection to shuffle.
       * @returns {Array} Returns the new shuffled array.
       */
      function baseShuffle(collection) {
        return shuffleSelf(values(collection));
      }

      /**
       * The base implementation of `_.slice` without an iteratee call guard.
       *
       * @private
       * @param {Array} array The array to slice.
       * @param {number} [start=0] The start position.
       * @param {number} [end=array.length] The end position.
       * @returns {Array} Returns the slice of `array`.
       */
      function baseSlice(array, start, end) {
        var index = -1,
            length = array.length;

        if (start < 0) {
          start = -start > length ? 0 : (length + start);
        }
        end = end > length ? length : end;
        if (end < 0) {
          end += length;
        }
        length = start > end ? 0 : ((end - start) >>> 0);
        start >>>= 0;

        var result = Array(length);
        while (++index < length) {
          result[index] = array[index + start];
        }
        return result;
      }

      /**
       * The base implementation of `_.some` without support for iteratee shorthands.
       *
       * @private
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} predicate The function invoked per iteration.
       * @returns {boolean} Returns `true` if any element passes the predicate check,
       *  else `false`.
       */
      function baseSome(collection, predicate) {
        var result;

        baseEach(collection, function(value, index, collection) {
          result = predicate(value, index, collection);
          return !result;
        });
        return !!result;
      }

      /**
       * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which
       * performs a binary search of `array` to determine the index at which `value`
       * should be inserted into `array` in order to maintain its sort order.
       *
       * @private
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @param {boolean} [retHighest] Specify returning the highest qualified index.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       */
      function baseSortedIndex(array, value, retHighest) {
        var low = 0,
            high = array == null ? low : array.length;

        if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {
          while (low < high) {
            var mid = (low + high) >>> 1,
                computed = array[mid];

            if (computed !== null && !isSymbol(computed) &&
                (retHighest ? (computed <= value) : (computed < value))) {
              low = mid + 1;
            } else {
              high = mid;
            }
          }
          return high;
        }
        return baseSortedIndexBy(array, value, identity, retHighest);
      }

      /**
       * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`
       * which invokes `iteratee` for `value` and each element of `array` to compute
       * their sort ranking. The iteratee is invoked with one argument; (value).
       *
       * @private
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @param {Function} iteratee The iteratee invoked per element.
       * @param {boolean} [retHighest] Specify returning the highest qualified index.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       */
      function baseSortedIndexBy(array, value, iteratee, retHighest) {
        var low = 0,
            high = array == null ? 0 : array.length;
        if (high === 0) {
          return 0;
        }

        value = iteratee(value);
        var valIsNaN = value !== value,
            valIsNull = value === null,
            valIsSymbol = isSymbol(value),
            valIsUndefined = value === undefined$1;

        while (low < high) {
          var mid = nativeFloor((low + high) / 2),
              computed = iteratee(array[mid]),
              othIsDefined = computed !== undefined$1,
              othIsNull = computed === null,
              othIsReflexive = computed === computed,
              othIsSymbol = isSymbol(computed);

          if (valIsNaN) {
            var setLow = retHighest || othIsReflexive;
          } else if (valIsUndefined) {
            setLow = othIsReflexive && (retHighest || othIsDefined);
          } else if (valIsNull) {
            setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);
          } else if (valIsSymbol) {
            setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);
          } else if (othIsNull || othIsSymbol) {
            setLow = false;
          } else {
            setLow = retHighest ? (computed <= value) : (computed < value);
          }
          if (setLow) {
            low = mid + 1;
          } else {
            high = mid;
          }
        }
        return nativeMin(high, MAX_ARRAY_INDEX);
      }

      /**
       * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without
       * support for iteratee shorthands.
       *
       * @private
       * @param {Array} array The array to inspect.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @returns {Array} Returns the new duplicate free array.
       */
      function baseSortedUniq(array, iteratee) {
        var index = -1,
            length = array.length,
            resIndex = 0,
            result = [];

        while (++index < length) {
          var value = array[index],
              computed = iteratee ? iteratee(value) : value;

          if (!index || !eq(computed, seen)) {
            var seen = computed;
            result[resIndex++] = value === 0 ? 0 : value;
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.toNumber` which doesn't ensure correct
       * conversions of binary, hexadecimal, or octal string values.
       *
       * @private
       * @param {*} value The value to process.
       * @returns {number} Returns the number.
       */
      function baseToNumber(value) {
        if (typeof value == 'number') {
          return value;
        }
        if (isSymbol(value)) {
          return NAN;
        }
        return +value;
      }

      /**
       * The base implementation of `_.toString` which doesn't convert nullish
       * values to empty strings.
       *
       * @private
       * @param {*} value The value to process.
       * @returns {string} Returns the string.
       */
      function baseToString(value) {
        // Exit early for strings to avoid a performance hit in some environments.
        if (typeof value == 'string') {
          return value;
        }
        if (isArray(value)) {
          // Recursively convert values (susceptible to call stack limits).
          return arrayMap(value, baseToString) + '';
        }
        if (isSymbol(value)) {
          return symbolToString ? symbolToString.call(value) : '';
        }
        var result = (value + '');
        return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;
      }

      /**
       * The base implementation of `_.uniqBy` without support for iteratee shorthands.
       *
       * @private
       * @param {Array} array The array to inspect.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new duplicate free array.
       */
      function baseUniq(array, iteratee, comparator) {
        var index = -1,
            includes = arrayIncludes,
            length = array.length,
            isCommon = true,
            result = [],
            seen = result;

        if (comparator) {
          isCommon = false;
          includes = arrayIncludesWith;
        }
        else if (length >= LARGE_ARRAY_SIZE) {
          var set = iteratee ? null : createSet(array);
          if (set) {
            return setToArray(set);
          }
          isCommon = false;
          includes = cacheHas;
          seen = new SetCache;
        }
        else {
          seen = iteratee ? [] : result;
        }
        outer:
        while (++index < length) {
          var value = array[index],
              computed = iteratee ? iteratee(value) : value;

          value = (comparator || value !== 0) ? value : 0;
          if (isCommon && computed === computed) {
            var seenIndex = seen.length;
            while (seenIndex--) {
              if (seen[seenIndex] === computed) {
                continue outer;
              }
            }
            if (iteratee) {
              seen.push(computed);
            }
            result.push(value);
          }
          else if (!includes(seen, computed, comparator)) {
            if (seen !== result) {
              seen.push(computed);
            }
            result.push(value);
          }
        }
        return result;
      }

      /**
       * The base implementation of `_.unset`.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {Array|string} path The property path to unset.
       * @returns {boolean} Returns `true` if the property is deleted, else `false`.
       */
      function baseUnset(object, path) {
        path = castPath(path, object);
        object = parent(object, path);
        return object == null || delete object[toKey(last(path))];
      }

      /**
       * The base implementation of `_.update`.
       *
       * @private
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to update.
       * @param {Function} updater The function to produce the updated value.
       * @param {Function} [customizer] The function to customize path creation.
       * @returns {Object} Returns `object`.
       */
      function baseUpdate(object, path, updater, customizer) {
        return baseSet(object, path, updater(baseGet(object, path)), customizer);
      }

      /**
       * The base implementation of methods like `_.dropWhile` and `_.takeWhile`
       * without support for iteratee shorthands.
       *
       * @private
       * @param {Array} array The array to query.
       * @param {Function} predicate The function invoked per iteration.
       * @param {boolean} [isDrop] Specify dropping elements instead of taking them.
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Array} Returns the slice of `array`.
       */
      function baseWhile(array, predicate, isDrop, fromRight) {
        var length = array.length,
            index = fromRight ? length : -1;

        while ((fromRight ? index-- : ++index < length) &&
          predicate(array[index], index, array)) {}

        return isDrop
          ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))
          : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));
      }

      /**
       * The base implementation of `wrapperValue` which returns the result of
       * performing a sequence of actions on the unwrapped `value`, where each
       * successive action is supplied the return value of the previous.
       *
       * @private
       * @param {*} value The unwrapped value.
       * @param {Array} actions Actions to perform to resolve the unwrapped value.
       * @returns {*} Returns the resolved value.
       */
      function baseWrapperValue(value, actions) {
        var result = value;
        if (result instanceof LazyWrapper) {
          result = result.value();
        }
        return arrayReduce(actions, function(result, action) {
          return action.func.apply(action.thisArg, arrayPush([result], action.args));
        }, result);
      }

      /**
       * The base implementation of methods like `_.xor`, without support for
       * iteratee shorthands, that accepts an array of arrays to inspect.
       *
       * @private
       * @param {Array} arrays The arrays to inspect.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of values.
       */
      function baseXor(arrays, iteratee, comparator) {
        var length = arrays.length;
        if (length < 2) {
          return length ? baseUniq(arrays[0]) : [];
        }
        var index = -1,
            result = Array(length);

        while (++index < length) {
          var array = arrays[index],
              othIndex = -1;

          while (++othIndex < length) {
            if (othIndex != index) {
              result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);
            }
          }
        }
        return baseUniq(baseFlatten(result, 1), iteratee, comparator);
      }

      /**
       * This base implementation of `_.zipObject` which assigns values using `assignFunc`.
       *
       * @private
       * @param {Array} props The property identifiers.
       * @param {Array} values The property values.
       * @param {Function} assignFunc The function to assign values.
       * @returns {Object} Returns the new object.
       */
      function baseZipObject(props, values, assignFunc) {
        var index = -1,
            length = props.length,
            valsLength = values.length,
            result = {};

        while (++index < length) {
          var value = index < valsLength ? values[index] : undefined$1;
          assignFunc(result, props[index], value);
        }
        return result;
      }

      /**
       * Casts `value` to an empty array if it's not an array like object.
       *
       * @private
       * @param {*} value The value to inspect.
       * @returns {Array|Object} Returns the cast array-like object.
       */
      function castArrayLikeObject(value) {
        return isArrayLikeObject(value) ? value : [];
      }

      /**
       * Casts `value` to `identity` if it's not a function.
       *
       * @private
       * @param {*} value The value to inspect.
       * @returns {Function} Returns cast function.
       */
      function castFunction(value) {
        return typeof value == 'function' ? value : identity;
      }

      /**
       * Casts `value` to a path array if it's not one.
       *
       * @private
       * @param {*} value The value to inspect.
       * @param {Object} [object] The object to query keys on.
       * @returns {Array} Returns the cast property path array.
       */
      function castPath(value, object) {
        if (isArray(value)) {
          return value;
        }
        return isKey(value, object) ? [value] : stringToPath(toString(value));
      }

      /**
       * A `baseRest` alias which can be replaced with `identity` by module
       * replacement plugins.
       *
       * @private
       * @type {Function}
       * @param {Function} func The function to apply a rest parameter to.
       * @returns {Function} Returns the new function.
       */
      var castRest = baseRest;

      /**
       * Casts `array` to a slice if it's needed.
       *
       * @private
       * @param {Array} array The array to inspect.
       * @param {number} start The start position.
       * @param {number} [end=array.length] The end position.
       * @returns {Array} Returns the cast slice.
       */
      function castSlice(array, start, end) {
        var length = array.length;
        end = end === undefined$1 ? length : end;
        return (!start && end >= length) ? array : baseSlice(array, start, end);
      }

      /**
       * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).
       *
       * @private
       * @param {number|Object} id The timer id or timeout object of the timer to clear.
       */
      var clearTimeout = ctxClearTimeout || function(id) {
        return root.clearTimeout(id);
      };

      /**
       * Creates a clone of  `buffer`.
       *
       * @private
       * @param {Buffer} buffer The buffer to clone.
       * @param {boolean} [isDeep] Specify a deep clone.
       * @returns {Buffer} Returns the cloned buffer.
       */
      function cloneBuffer(buffer, isDeep) {
        if (isDeep) {
          return buffer.slice();
        }
        var length = buffer.length,
            result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);

        buffer.copy(result);
        return result;
      }

      /**
       * Creates a clone of `arrayBuffer`.
       *
       * @private
       * @param {ArrayBuffer} arrayBuffer The array buffer to clone.
       * @returns {ArrayBuffer} Returns the cloned array buffer.
       */
      function cloneArrayBuffer(arrayBuffer) {
        var result = new arrayBuffer.constructor(arrayBuffer.byteLength);
        new Uint8Array(result).set(new Uint8Array(arrayBuffer));
        return result;
      }

      /**
       * Creates a clone of `dataView`.
       *
       * @private
       * @param {Object} dataView The data view to clone.
       * @param {boolean} [isDeep] Specify a deep clone.
       * @returns {Object} Returns the cloned data view.
       */
      function cloneDataView(dataView, isDeep) {
        var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;
        return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);
      }

      /**
       * Creates a clone of `regexp`.
       *
       * @private
       * @param {Object} regexp The regexp to clone.
       * @returns {Object} Returns the cloned regexp.
       */
      function cloneRegExp(regexp) {
        var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));
        result.lastIndex = regexp.lastIndex;
        return result;
      }

      /**
       * Creates a clone of the `symbol` object.
       *
       * @private
       * @param {Object} symbol The symbol object to clone.
       * @returns {Object} Returns the cloned symbol object.
       */
      function cloneSymbol(symbol) {
        return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};
      }

      /**
       * Creates a clone of `typedArray`.
       *
       * @private
       * @param {Object} typedArray The typed array to clone.
       * @param {boolean} [isDeep] Specify a deep clone.
       * @returns {Object} Returns the cloned typed array.
       */
      function cloneTypedArray(typedArray, isDeep) {
        var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;
        return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);
      }

      /**
       * Compares values to sort them in ascending order.
       *
       * @private
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {number} Returns the sort order indicator for `value`.
       */
      function compareAscending(value, other) {
        if (value !== other) {
          var valIsDefined = value !== undefined$1,
              valIsNull = value === null,
              valIsReflexive = value === value,
              valIsSymbol = isSymbol(value);

          var othIsDefined = other !== undefined$1,
              othIsNull = other === null,
              othIsReflexive = other === other,
              othIsSymbol = isSymbol(other);

          if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||
              (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||
              (valIsNull && othIsDefined && othIsReflexive) ||
              (!valIsDefined && othIsReflexive) ||
              !valIsReflexive) {
            return 1;
          }
          if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||
              (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||
              (othIsNull && valIsDefined && valIsReflexive) ||
              (!othIsDefined && valIsReflexive) ||
              !othIsReflexive) {
            return -1;
          }
        }
        return 0;
      }

      /**
       * Used by `_.orderBy` to compare multiple properties of a value to another
       * and stable sort them.
       *
       * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,
       * specify an order of "desc" for descending or "asc" for ascending sort order
       * of corresponding values.
       *
       * @private
       * @param {Object} object The object to compare.
       * @param {Object} other The other object to compare.
       * @param {boolean[]|string[]} orders The order to sort by for each property.
       * @returns {number} Returns the sort order indicator for `object`.
       */
      function compareMultiple(object, other, orders) {
        var index = -1,
            objCriteria = object.criteria,
            othCriteria = other.criteria,
            length = objCriteria.length,
            ordersLength = orders.length;

        while (++index < length) {
          var result = compareAscending(objCriteria[index], othCriteria[index]);
          if (result) {
            if (index >= ordersLength) {
              return result;
            }
            var order = orders[index];
            return result * (order == 'desc' ? -1 : 1);
          }
        }
        // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications
        // that causes it, under certain circumstances, to provide the same value for
        // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247
        // for more details.
        //
        // This also ensures a stable sort in V8 and other engines.
        // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.
        return object.index - other.index;
      }

      /**
       * Creates an array that is the composition of partially applied arguments,
       * placeholders, and provided arguments into a single array of arguments.
       *
       * @private
       * @param {Array} args The provided arguments.
       * @param {Array} partials The arguments to prepend to those provided.
       * @param {Array} holders The `partials` placeholder indexes.
       * @params {boolean} [isCurried] Specify composing for a curried function.
       * @returns {Array} Returns the new array of composed arguments.
       */
      function composeArgs(args, partials, holders, isCurried) {
        var argsIndex = -1,
            argsLength = args.length,
            holdersLength = holders.length,
            leftIndex = -1,
            leftLength = partials.length,
            rangeLength = nativeMax(argsLength - holdersLength, 0),
            result = Array(leftLength + rangeLength),
            isUncurried = !isCurried;

        while (++leftIndex < leftLength) {
          result[leftIndex] = partials[leftIndex];
        }
        while (++argsIndex < holdersLength) {
          if (isUncurried || argsIndex < argsLength) {
            result[holders[argsIndex]] = args[argsIndex];
          }
        }
        while (rangeLength--) {
          result[leftIndex++] = args[argsIndex++];
        }
        return result;
      }

      /**
       * This function is like `composeArgs` except that the arguments composition
       * is tailored for `_.partialRight`.
       *
       * @private
       * @param {Array} args The provided arguments.
       * @param {Array} partials The arguments to append to those provided.
       * @param {Array} holders The `partials` placeholder indexes.
       * @params {boolean} [isCurried] Specify composing for a curried function.
       * @returns {Array} Returns the new array of composed arguments.
       */
      function composeArgsRight(args, partials, holders, isCurried) {
        var argsIndex = -1,
            argsLength = args.length,
            holdersIndex = -1,
            holdersLength = holders.length,
            rightIndex = -1,
            rightLength = partials.length,
            rangeLength = nativeMax(argsLength - holdersLength, 0),
            result = Array(rangeLength + rightLength),
            isUncurried = !isCurried;

        while (++argsIndex < rangeLength) {
          result[argsIndex] = args[argsIndex];
        }
        var offset = argsIndex;
        while (++rightIndex < rightLength) {
          result[offset + rightIndex] = partials[rightIndex];
        }
        while (++holdersIndex < holdersLength) {
          if (isUncurried || argsIndex < argsLength) {
            result[offset + holders[holdersIndex]] = args[argsIndex++];
          }
        }
        return result;
      }

      /**
       * Copies the values of `source` to `array`.
       *
       * @private
       * @param {Array} source The array to copy values from.
       * @param {Array} [array=[]] The array to copy values to.
       * @returns {Array} Returns `array`.
       */
      function copyArray(source, array) {
        var index = -1,
            length = source.length;

        array || (array = Array(length));
        while (++index < length) {
          array[index] = source[index];
        }
        return array;
      }

      /**
       * Copies properties of `source` to `object`.
       *
       * @private
       * @param {Object} source The object to copy properties from.
       * @param {Array} props The property identifiers to copy.
       * @param {Object} [object={}] The object to copy properties to.
       * @param {Function} [customizer] The function to customize copied values.
       * @returns {Object} Returns `object`.
       */
      function copyObject(source, props, object, customizer) {
        var isNew = !object;
        object || (object = {});

        var index = -1,
            length = props.length;

        while (++index < length) {
          var key = props[index];

          var newValue = customizer
            ? customizer(object[key], source[key], key, object, source)
            : undefined$1;

          if (newValue === undefined$1) {
            newValue = source[key];
          }
          if (isNew) {
            baseAssignValue(object, key, newValue);
          } else {
            assignValue(object, key, newValue);
          }
        }
        return object;
      }

      /**
       * Copies own symbols of `source` to `object`.
       *
       * @private
       * @param {Object} source The object to copy symbols from.
       * @param {Object} [object={}] The object to copy symbols to.
       * @returns {Object} Returns `object`.
       */
      function copySymbols(source, object) {
        return copyObject(source, getSymbols(source), object);
      }

      /**
       * Copies own and inherited symbols of `source` to `object`.
       *
       * @private
       * @param {Object} source The object to copy symbols from.
       * @param {Object} [object={}] The object to copy symbols to.
       * @returns {Object} Returns `object`.
       */
      function copySymbolsIn(source, object) {
        return copyObject(source, getSymbolsIn(source), object);
      }

      /**
       * Creates a function like `_.groupBy`.
       *
       * @private
       * @param {Function} setter The function to set accumulator values.
       * @param {Function} [initializer] The accumulator object initializer.
       * @returns {Function} Returns the new aggregator function.
       */
      function createAggregator(setter, initializer) {
        return function(collection, iteratee) {
          var func = isArray(collection) ? arrayAggregator : baseAggregator,
              accumulator = initializer ? initializer() : {};

          return func(collection, setter, getIteratee(iteratee, 2), accumulator);
        };
      }

      /**
       * Creates a function like `_.assign`.
       *
       * @private
       * @param {Function} assigner The function to assign values.
       * @returns {Function} Returns the new assigner function.
       */
      function createAssigner(assigner) {
        return baseRest(function(object, sources) {
          var index = -1,
              length = sources.length,
              customizer = length > 1 ? sources[length - 1] : undefined$1,
              guard = length > 2 ? sources[2] : undefined$1;

          customizer = (assigner.length > 3 && typeof customizer == 'function')
            ? (length--, customizer)
            : undefined$1;

          if (guard && isIterateeCall(sources[0], sources[1], guard)) {
            customizer = length < 3 ? undefined$1 : customizer;
            length = 1;
          }
          object = Object(object);
          while (++index < length) {
            var source = sources[index];
            if (source) {
              assigner(object, source, index, customizer);
            }
          }
          return object;
        });
      }

      /**
       * Creates a `baseEach` or `baseEachRight` function.
       *
       * @private
       * @param {Function} eachFunc The function to iterate over a collection.
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Function} Returns the new base function.
       */
      function createBaseEach(eachFunc, fromRight) {
        return function(collection, iteratee) {
          if (collection == null) {
            return collection;
          }
          if (!isArrayLike(collection)) {
            return eachFunc(collection, iteratee);
          }
          var length = collection.length,
              index = fromRight ? length : -1,
              iterable = Object(collection);

          while ((fromRight ? index-- : ++index < length)) {
            if (iteratee(iterable[index], index, iterable) === false) {
              break;
            }
          }
          return collection;
        };
      }

      /**
       * Creates a base function for methods like `_.forIn` and `_.forOwn`.
       *
       * @private
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Function} Returns the new base function.
       */
      function createBaseFor(fromRight) {
        return function(object, iteratee, keysFunc) {
          var index = -1,
              iterable = Object(object),
              props = keysFunc(object),
              length = props.length;

          while (length--) {
            var key = props[fromRight ? length : ++index];
            if (iteratee(iterable[key], key, iterable) === false) {
              break;
            }
          }
          return object;
        };
      }

      /**
       * Creates a function that wraps `func` to invoke it with the optional `this`
       * binding of `thisArg`.
       *
       * @private
       * @param {Function} func The function to wrap.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @param {*} [thisArg] The `this` binding of `func`.
       * @returns {Function} Returns the new wrapped function.
       */
      function createBind(func, bitmask, thisArg) {
        var isBind = bitmask & WRAP_BIND_FLAG,
            Ctor = createCtor(func);

        function wrapper() {
          var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;
          return fn.apply(isBind ? thisArg : this, arguments);
        }
        return wrapper;
      }

      /**
       * Creates a function like `_.lowerFirst`.
       *
       * @private
       * @param {string} methodName The name of the `String` case method to use.
       * @returns {Function} Returns the new case function.
       */
      function createCaseFirst(methodName) {
        return function(string) {
          string = toString(string);

          var strSymbols = hasUnicode(string)
            ? stringToArray(string)
            : undefined$1;

          var chr = strSymbols
            ? strSymbols[0]
            : string.charAt(0);

          var trailing = strSymbols
            ? castSlice(strSymbols, 1).join('')
            : string.slice(1);

          return chr[methodName]() + trailing;
        };
      }

      /**
       * Creates a function like `_.camelCase`.
       *
       * @private
       * @param {Function} callback The function to combine each word.
       * @returns {Function} Returns the new compounder function.
       */
      function createCompounder(callback) {
        return function(string) {
          return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');
        };
      }

      /**
       * Creates a function that produces an instance of `Ctor` regardless of
       * whether it was invoked as part of a `new` expression or by `call` or `apply`.
       *
       * @private
       * @param {Function} Ctor The constructor to wrap.
       * @returns {Function} Returns the new wrapped function.
       */
      function createCtor(Ctor) {
        return function() {
          // Use a `switch` statement to work with class constructors. See
          // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist
          // for more details.
          var args = arguments;
          switch (args.length) {
            case 0: return new Ctor;
            case 1: return new Ctor(args[0]);
            case 2: return new Ctor(args[0], args[1]);
            case 3: return new Ctor(args[0], args[1], args[2]);
            case 4: return new Ctor(args[0], args[1], args[2], args[3]);
            case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);
            case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);
            case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);
          }
          var thisBinding = baseCreate(Ctor.prototype),
              result = Ctor.apply(thisBinding, args);

          // Mimic the constructor's `return` behavior.
          // See https://es5.github.io/#x13.2.2 for more details.
          return isObject(result) ? result : thisBinding;
        };
      }

      /**
       * Creates a function that wraps `func` to enable currying.
       *
       * @private
       * @param {Function} func The function to wrap.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @param {number} arity The arity of `func`.
       * @returns {Function} Returns the new wrapped function.
       */
      function createCurry(func, bitmask, arity) {
        var Ctor = createCtor(func);

        function wrapper() {
          var length = arguments.length,
              args = Array(length),
              index = length,
              placeholder = getHolder(wrapper);

          while (index--) {
            args[index] = arguments[index];
          }
          var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)
            ? []
            : replaceHolders(args, placeholder);

          length -= holders.length;
          if (length < arity) {
            return createRecurry(
              func, bitmask, createHybrid, wrapper.placeholder, undefined$1,
              args, holders, undefined$1, undefined$1, arity - length);
          }
          var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;
          return apply(fn, this, args);
        }
        return wrapper;
      }

      /**
       * Creates a `_.find` or `_.findLast` function.
       *
       * @private
       * @param {Function} findIndexFunc The function to find the collection index.
       * @returns {Function} Returns the new find function.
       */
      function createFind(findIndexFunc) {
        return function(collection, predicate, fromIndex) {
          var iterable = Object(collection);
          if (!isArrayLike(collection)) {
            var iteratee = getIteratee(predicate, 3);
            collection = keys(collection);
            predicate = function(key) { return iteratee(iterable[key], key, iterable); };
          }
          var index = findIndexFunc(collection, predicate, fromIndex);
          return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined$1;
        };
      }

      /**
       * Creates a `_.flow` or `_.flowRight` function.
       *
       * @private
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Function} Returns the new flow function.
       */
      function createFlow(fromRight) {
        return flatRest(function(funcs) {
          var length = funcs.length,
              index = length,
              prereq = LodashWrapper.prototype.thru;

          if (fromRight) {
            funcs.reverse();
          }
          while (index--) {
            var func = funcs[index];
            if (typeof func != 'function') {
              throw new TypeError(FUNC_ERROR_TEXT);
            }
            if (prereq && !wrapper && getFuncName(func) == 'wrapper') {
              var wrapper = new LodashWrapper([], true);
            }
          }
          index = wrapper ? index : length;
          while (++index < length) {
            func = funcs[index];

            var funcName = getFuncName(func),
                data = funcName == 'wrapper' ? getData(func) : undefined$1;

            if (data && isLaziable(data[0]) &&
                  data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&
                  !data[4].length && data[9] == 1
                ) {
              wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);
            } else {
              wrapper = (func.length == 1 && isLaziable(func))
                ? wrapper[funcName]()
                : wrapper.thru(func);
            }
          }
          return function() {
            var args = arguments,
                value = args[0];

            if (wrapper && args.length == 1 && isArray(value)) {
              return wrapper.plant(value).value();
            }
            var index = 0,
                result = length ? funcs[index].apply(this, args) : value;

            while (++index < length) {
              result = funcs[index].call(this, result);
            }
            return result;
          };
        });
      }

      /**
       * Creates a function that wraps `func` to invoke it with optional `this`
       * binding of `thisArg`, partial application, and currying.
       *
       * @private
       * @param {Function|string} func The function or method name to wrap.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @param {*} [thisArg] The `this` binding of `func`.
       * @param {Array} [partials] The arguments to prepend to those provided to
       *  the new function.
       * @param {Array} [holders] The `partials` placeholder indexes.
       * @param {Array} [partialsRight] The arguments to append to those provided
       *  to the new function.
       * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.
       * @param {Array} [argPos] The argument positions of the new function.
       * @param {number} [ary] The arity cap of `func`.
       * @param {number} [arity] The arity of `func`.
       * @returns {Function} Returns the new wrapped function.
       */
      function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {
        var isAry = bitmask & WRAP_ARY_FLAG,
            isBind = bitmask & WRAP_BIND_FLAG,
            isBindKey = bitmask & WRAP_BIND_KEY_FLAG,
            isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),
            isFlip = bitmask & WRAP_FLIP_FLAG,
            Ctor = isBindKey ? undefined$1 : createCtor(func);

        function wrapper() {
          var length = arguments.length,
              args = Array(length),
              index = length;

          while (index--) {
            args[index] = arguments[index];
          }
          if (isCurried) {
            var placeholder = getHolder(wrapper),
                holdersCount = countHolders(args, placeholder);
          }
          if (partials) {
            args = composeArgs(args, partials, holders, isCurried);
          }
          if (partialsRight) {
            args = composeArgsRight(args, partialsRight, holdersRight, isCurried);
          }
          length -= holdersCount;
          if (isCurried && length < arity) {
            var newHolders = replaceHolders(args, placeholder);
            return createRecurry(
              func, bitmask, createHybrid, wrapper.placeholder, thisArg,
              args, newHolders, argPos, ary, arity - length
            );
          }
          var thisBinding = isBind ? thisArg : this,
              fn = isBindKey ? thisBinding[func] : func;

          length = args.length;
          if (argPos) {
            args = reorder(args, argPos);
          } else if (isFlip && length > 1) {
            args.reverse();
          }
          if (isAry && ary < length) {
            args.length = ary;
          }
          if (this && this !== root && this instanceof wrapper) {
            fn = Ctor || createCtor(fn);
          }
          return fn.apply(thisBinding, args);
        }
        return wrapper;
      }

      /**
       * Creates a function like `_.invertBy`.
       *
       * @private
       * @param {Function} setter The function to set accumulator values.
       * @param {Function} toIteratee The function to resolve iteratees.
       * @returns {Function} Returns the new inverter function.
       */
      function createInverter(setter, toIteratee) {
        return function(object, iteratee) {
          return baseInverter(object, setter, toIteratee(iteratee), {});
        };
      }

      /**
       * Creates a function that performs a mathematical operation on two values.
       *
       * @private
       * @param {Function} operator The function to perform the operation.
       * @param {number} [defaultValue] The value used for `undefined` arguments.
       * @returns {Function} Returns the new mathematical operation function.
       */
      function createMathOperation(operator, defaultValue) {
        return function(value, other) {
          var result;
          if (value === undefined$1 && other === undefined$1) {
            return defaultValue;
          }
          if (value !== undefined$1) {
            result = value;
          }
          if (other !== undefined$1) {
            if (result === undefined$1) {
              return other;
            }
            if (typeof value == 'string' || typeof other == 'string') {
              value = baseToString(value);
              other = baseToString(other);
            } else {
              value = baseToNumber(value);
              other = baseToNumber(other);
            }
            result = operator(value, other);
          }
          return result;
        };
      }

      /**
       * Creates a function like `_.over`.
       *
       * @private
       * @param {Function} arrayFunc The function to iterate over iteratees.
       * @returns {Function} Returns the new over function.
       */
      function createOver(arrayFunc) {
        return flatRest(function(iteratees) {
          iteratees = arrayMap(iteratees, baseUnary(getIteratee()));
          return baseRest(function(args) {
            var thisArg = this;
            return arrayFunc(iteratees, function(iteratee) {
              return apply(iteratee, thisArg, args);
            });
          });
        });
      }

      /**
       * Creates the padding for `string` based on `length`. The `chars` string
       * is truncated if the number of characters exceeds `length`.
       *
       * @private
       * @param {number} length The padding length.
       * @param {string} [chars=' '] The string used as padding.
       * @returns {string} Returns the padding for `string`.
       */
      function createPadding(length, chars) {
        chars = chars === undefined$1 ? ' ' : baseToString(chars);

        var charsLength = chars.length;
        if (charsLength < 2) {
          return charsLength ? baseRepeat(chars, length) : chars;
        }
        var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));
        return hasUnicode(chars)
          ? castSlice(stringToArray(result), 0, length).join('')
          : result.slice(0, length);
      }

      /**
       * Creates a function that wraps `func` to invoke it with the `this` binding
       * of `thisArg` and `partials` prepended to the arguments it receives.
       *
       * @private
       * @param {Function} func The function to wrap.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @param {*} thisArg The `this` binding of `func`.
       * @param {Array} partials The arguments to prepend to those provided to
       *  the new function.
       * @returns {Function} Returns the new wrapped function.
       */
      function createPartial(func, bitmask, thisArg, partials) {
        var isBind = bitmask & WRAP_BIND_FLAG,
            Ctor = createCtor(func);

        function wrapper() {
          var argsIndex = -1,
              argsLength = arguments.length,
              leftIndex = -1,
              leftLength = partials.length,
              args = Array(leftLength + argsLength),
              fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;

          while (++leftIndex < leftLength) {
            args[leftIndex] = partials[leftIndex];
          }
          while (argsLength--) {
            args[leftIndex++] = arguments[++argsIndex];
          }
          return apply(fn, isBind ? thisArg : this, args);
        }
        return wrapper;
      }

      /**
       * Creates a `_.range` or `_.rangeRight` function.
       *
       * @private
       * @param {boolean} [fromRight] Specify iterating from right to left.
       * @returns {Function} Returns the new range function.
       */
      function createRange(fromRight) {
        return function(start, end, step) {
          if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {
            end = step = undefined$1;
          }
          // Ensure the sign of `-0` is preserved.
          start = toFinite(start);
          if (end === undefined$1) {
            end = start;
            start = 0;
          } else {
            end = toFinite(end);
          }
          step = step === undefined$1 ? (start < end ? 1 : -1) : toFinite(step);
          return baseRange(start, end, step, fromRight);
        };
      }

      /**
       * Creates a function that performs a relational operation on two values.
       *
       * @private
       * @param {Function} operator The function to perform the operation.
       * @returns {Function} Returns the new relational operation function.
       */
      function createRelationalOperation(operator) {
        return function(value, other) {
          if (!(typeof value == 'string' && typeof other == 'string')) {
            value = toNumber(value);
            other = toNumber(other);
          }
          return operator(value, other);
        };
      }

      /**
       * Creates a function that wraps `func` to continue currying.
       *
       * @private
       * @param {Function} func The function to wrap.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @param {Function} wrapFunc The function to create the `func` wrapper.
       * @param {*} placeholder The placeholder value.
       * @param {*} [thisArg] The `this` binding of `func`.
       * @param {Array} [partials] The arguments to prepend to those provided to
       *  the new function.
       * @param {Array} [holders] The `partials` placeholder indexes.
       * @param {Array} [argPos] The argument positions of the new function.
       * @param {number} [ary] The arity cap of `func`.
       * @param {number} [arity] The arity of `func`.
       * @returns {Function} Returns the new wrapped function.
       */
      function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {
        var isCurry = bitmask & WRAP_CURRY_FLAG,
            newHolders = isCurry ? holders : undefined$1,
            newHoldersRight = isCurry ? undefined$1 : holders,
            newPartials = isCurry ? partials : undefined$1,
            newPartialsRight = isCurry ? undefined$1 : partials;

        bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);
        bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);

        if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {
          bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);
        }
        var newData = [
          func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,
          newHoldersRight, argPos, ary, arity
        ];

        var result = wrapFunc.apply(undefined$1, newData);
        if (isLaziable(func)) {
          setData(result, newData);
        }
        result.placeholder = placeholder;
        return setWrapToString(result, func, bitmask);
      }

      /**
       * Creates a function like `_.round`.
       *
       * @private
       * @param {string} methodName The name of the `Math` method to use when rounding.
       * @returns {Function} Returns the new round function.
       */
      function createRound(methodName) {
        var func = Math[methodName];
        return function(number, precision) {
          number = toNumber(number);
          precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);
          if (precision && nativeIsFinite(number)) {
            // Shift with exponential notation to avoid floating-point issues.
            // See [MDN](https://mdn.io/round#Examples) for more details.
            var pair = (toString(number) + 'e').split('e'),
                value = func(pair[0] + 'e' + (+pair[1] + precision));

            pair = (toString(value) + 'e').split('e');
            return +(pair[0] + 'e' + (+pair[1] - precision));
          }
          return func(number);
        };
      }

      /**
       * Creates a set object of `values`.
       *
       * @private
       * @param {Array} values The values to add to the set.
       * @returns {Object} Returns the new set.
       */
      var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {
        return new Set(values);
      };

      /**
       * Creates a `_.toPairs` or `_.toPairsIn` function.
       *
       * @private
       * @param {Function} keysFunc The function to get the keys of a given object.
       * @returns {Function} Returns the new pairs function.
       */
      function createToPairs(keysFunc) {
        return function(object) {
          var tag = getTag(object);
          if (tag == mapTag) {
            return mapToArray(object);
          }
          if (tag == setTag) {
            return setToPairs(object);
          }
          return baseToPairs(object, keysFunc(object));
        };
      }

      /**
       * Creates a function that either curries or invokes `func` with optional
       * `this` binding and partially applied arguments.
       *
       * @private
       * @param {Function|string} func The function or method name to wrap.
       * @param {number} bitmask The bitmask flags.
       *    1 - `_.bind`
       *    2 - `_.bindKey`
       *    4 - `_.curry` or `_.curryRight` of a bound function
       *    8 - `_.curry`
       *   16 - `_.curryRight`
       *   32 - `_.partial`
       *   64 - `_.partialRight`
       *  128 - `_.rearg`
       *  256 - `_.ary`
       *  512 - `_.flip`
       * @param {*} [thisArg] The `this` binding of `func`.
       * @param {Array} [partials] The arguments to be partially applied.
       * @param {Array} [holders] The `partials` placeholder indexes.
       * @param {Array} [argPos] The argument positions of the new function.
       * @param {number} [ary] The arity cap of `func`.
       * @param {number} [arity] The arity of `func`.
       * @returns {Function} Returns the new wrapped function.
       */
      function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {
        var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;
        if (!isBindKey && typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        var length = partials ? partials.length : 0;
        if (!length) {
          bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);
          partials = holders = undefined$1;
        }
        ary = ary === undefined$1 ? ary : nativeMax(toInteger(ary), 0);
        arity = arity === undefined$1 ? arity : toInteger(arity);
        length -= holders ? holders.length : 0;

        if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {
          var partialsRight = partials,
              holdersRight = holders;

          partials = holders = undefined$1;
        }
        var data = isBindKey ? undefined$1 : getData(func);

        var newData = [
          func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,
          argPos, ary, arity
        ];

        if (data) {
          mergeData(newData, data);
        }
        func = newData[0];
        bitmask = newData[1];
        thisArg = newData[2];
        partials = newData[3];
        holders = newData[4];
        arity = newData[9] = newData[9] === undefined$1
          ? (isBindKey ? 0 : func.length)
          : nativeMax(newData[9] - length, 0);

        if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {
          bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);
        }
        if (!bitmask || bitmask == WRAP_BIND_FLAG) {
          var result = createBind(func, bitmask, thisArg);
        } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {
          result = createCurry(func, bitmask, arity);
        } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {
          result = createPartial(func, bitmask, thisArg, partials);
        } else {
          result = createHybrid.apply(undefined$1, newData);
        }
        var setter = data ? baseSetData : setData;
        return setWrapToString(setter(result, newData), func, bitmask);
      }

      /**
       * Used by `_.defaults` to customize its `_.assignIn` use to assign properties
       * of source objects to the destination object for all destination properties
       * that resolve to `undefined`.
       *
       * @private
       * @param {*} objValue The destination value.
       * @param {*} srcValue The source value.
       * @param {string} key The key of the property to assign.
       * @param {Object} object The parent object of `objValue`.
       * @returns {*} Returns the value to assign.
       */
      function customDefaultsAssignIn(objValue, srcValue, key, object) {
        if (objValue === undefined$1 ||
            (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {
          return srcValue;
        }
        return objValue;
      }

      /**
       * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source
       * objects into destination objects that are passed thru.
       *
       * @private
       * @param {*} objValue The destination value.
       * @param {*} srcValue The source value.
       * @param {string} key The key of the property to merge.
       * @param {Object} object The parent object of `objValue`.
       * @param {Object} source The parent object of `srcValue`.
       * @param {Object} [stack] Tracks traversed source values and their merged
       *  counterparts.
       * @returns {*} Returns the value to assign.
       */
      function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {
        if (isObject(objValue) && isObject(srcValue)) {
          // Recursively merge objects and arrays (susceptible to call stack limits).
          stack.set(srcValue, objValue);
          baseMerge(objValue, srcValue, undefined$1, customDefaultsMerge, stack);
          stack['delete'](srcValue);
        }
        return objValue;
      }

      /**
       * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain
       * objects.
       *
       * @private
       * @param {*} value The value to inspect.
       * @param {string} key The key of the property to inspect.
       * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.
       */
      function customOmitClone(value) {
        return isPlainObject(value) ? undefined$1 : value;
      }

      /**
       * A specialized version of `baseIsEqualDeep` for arrays with support for
       * partial deep comparisons.
       *
       * @private
       * @param {Array} array The array to compare.
       * @param {Array} other The other array to compare.
       * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
       * @param {Function} customizer The function to customize comparisons.
       * @param {Function} equalFunc The function to determine equivalents of values.
       * @param {Object} stack Tracks traversed `array` and `other` objects.
       * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.
       */
      function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {
        var isPartial = bitmask & COMPARE_PARTIAL_FLAG,
            arrLength = array.length,
            othLength = other.length;

        if (arrLength != othLength && !(isPartial && othLength > arrLength)) {
          return false;
        }
        // Check that cyclic values are equal.
        var arrStacked = stack.get(array);
        var othStacked = stack.get(other);
        if (arrStacked && othStacked) {
          return arrStacked == other && othStacked == array;
        }
        var index = -1,
            result = true,
            seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined$1;

        stack.set(array, other);
        stack.set(other, array);

        // Ignore non-index properties.
        while (++index < arrLength) {
          var arrValue = array[index],
              othValue = other[index];

          if (customizer) {
            var compared = isPartial
              ? customizer(othValue, arrValue, index, other, array, stack)
              : customizer(arrValue, othValue, index, array, other, stack);
          }
          if (compared !== undefined$1) {
            if (compared) {
              continue;
            }
            result = false;
            break;
          }
          // Recursively compare arrays (susceptible to call stack limits).
          if (seen) {
            if (!arraySome(other, function(othValue, othIndex) {
                  if (!cacheHas(seen, othIndex) &&
                      (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {
                    return seen.push(othIndex);
                  }
                })) {
              result = false;
              break;
            }
          } else if (!(
                arrValue === othValue ||
                  equalFunc(arrValue, othValue, bitmask, customizer, stack)
              )) {
            result = false;
            break;
          }
        }
        stack['delete'](array);
        stack['delete'](other);
        return result;
      }

      /**
       * A specialized version of `baseIsEqualDeep` for comparing objects of
       * the same `toStringTag`.
       *
       * **Note:** This function only supports comparing values with tags of
       * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
       *
       * @private
       * @param {Object} object The object to compare.
       * @param {Object} other The other object to compare.
       * @param {string} tag The `toStringTag` of the objects to compare.
       * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
       * @param {Function} customizer The function to customize comparisons.
       * @param {Function} equalFunc The function to determine equivalents of values.
       * @param {Object} stack Tracks traversed `object` and `other` objects.
       * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
       */
      function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {
        switch (tag) {
          case dataViewTag:
            if ((object.byteLength != other.byteLength) ||
                (object.byteOffset != other.byteOffset)) {
              return false;
            }
            object = object.buffer;
            other = other.buffer;

          case arrayBufferTag:
            if ((object.byteLength != other.byteLength) ||
                !equalFunc(new Uint8Array(object), new Uint8Array(other))) {
              return false;
            }
            return true;

          case boolTag:
          case dateTag:
          case numberTag:
            // Coerce booleans to `1` or `0` and dates to milliseconds.
            // Invalid dates are coerced to `NaN`.
            return eq(+object, +other);

          case errorTag:
            return object.name == other.name && object.message == other.message;

          case regexpTag:
          case stringTag:
            // Coerce regexes to strings and treat strings, primitives and objects,
            // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring
            // for more details.
            return object == (other + '');

          case mapTag:
            var convert = mapToArray;

          case setTag:
            var isPartial = bitmask & COMPARE_PARTIAL_FLAG;
            convert || (convert = setToArray);

            if (object.size != other.size && !isPartial) {
              return false;
            }
            // Assume cyclic values are equal.
            var stacked = stack.get(object);
            if (stacked) {
              return stacked == other;
            }
            bitmask |= COMPARE_UNORDERED_FLAG;

            // Recursively compare objects (susceptible to call stack limits).
            stack.set(object, other);
            var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);
            stack['delete'](object);
            return result;

          case symbolTag:
            if (symbolValueOf) {
              return symbolValueOf.call(object) == symbolValueOf.call(other);
            }
        }
        return false;
      }

      /**
       * A specialized version of `baseIsEqualDeep` for objects with support for
       * partial deep comparisons.
       *
       * @private
       * @param {Object} object The object to compare.
       * @param {Object} other The other object to compare.
       * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
       * @param {Function} customizer The function to customize comparisons.
       * @param {Function} equalFunc The function to determine equivalents of values.
       * @param {Object} stack Tracks traversed `object` and `other` objects.
       * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
       */
      function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {
        var isPartial = bitmask & COMPARE_PARTIAL_FLAG,
            objProps = getAllKeys(object),
            objLength = objProps.length,
            othProps = getAllKeys(other),
            othLength = othProps.length;

        if (objLength != othLength && !isPartial) {
          return false;
        }
        var index = objLength;
        while (index--) {
          var key = objProps[index];
          if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {
            return false;
          }
        }
        // Check that cyclic values are equal.
        var objStacked = stack.get(object);
        var othStacked = stack.get(other);
        if (objStacked && othStacked) {
          return objStacked == other && othStacked == object;
        }
        var result = true;
        stack.set(object, other);
        stack.set(other, object);

        var skipCtor = isPartial;
        while (++index < objLength) {
          key = objProps[index];
          var objValue = object[key],
              othValue = other[key];

          if (customizer) {
            var compared = isPartial
              ? customizer(othValue, objValue, key, other, object, stack)
              : customizer(objValue, othValue, key, object, other, stack);
          }
          // Recursively compare objects (susceptible to call stack limits).
          if (!(compared === undefined$1
                ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))
                : compared
              )) {
            result = false;
            break;
          }
          skipCtor || (skipCtor = key == 'constructor');
        }
        if (result && !skipCtor) {
          var objCtor = object.constructor,
              othCtor = other.constructor;

          // Non `Object` object instances with different constructors are not equal.
          if (objCtor != othCtor &&
              ('constructor' in object && 'constructor' in other) &&
              !(typeof objCtor == 'function' && objCtor instanceof objCtor &&
                typeof othCtor == 'function' && othCtor instanceof othCtor)) {
            result = false;
          }
        }
        stack['delete'](object);
        stack['delete'](other);
        return result;
      }

      /**
       * A specialized version of `baseRest` which flattens the rest array.
       *
       * @private
       * @param {Function} func The function to apply a rest parameter to.
       * @returns {Function} Returns the new function.
       */
      function flatRest(func) {
        return setToString(overRest(func, undefined$1, flatten), func + '');
      }

      /**
       * Creates an array of own enumerable property names and symbols of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names and symbols.
       */
      function getAllKeys(object) {
        return baseGetAllKeys(object, keys, getSymbols);
      }

      /**
       * Creates an array of own and inherited enumerable property names and
       * symbols of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names and symbols.
       */
      function getAllKeysIn(object) {
        return baseGetAllKeys(object, keysIn, getSymbolsIn);
      }

      /**
       * Gets metadata for `func`.
       *
       * @private
       * @param {Function} func The function to query.
       * @returns {*} Returns the metadata for `func`.
       */
      var getData = !metaMap ? noop : function(func) {
        return metaMap.get(func);
      };

      /**
       * Gets the name of `func`.
       *
       * @private
       * @param {Function} func The function to query.
       * @returns {string} Returns the function name.
       */
      function getFuncName(func) {
        var result = (func.name + ''),
            array = realNames[result],
            length = hasOwnProperty.call(realNames, result) ? array.length : 0;

        while (length--) {
          var data = array[length],
              otherFunc = data.func;
          if (otherFunc == null || otherFunc == func) {
            return data.name;
          }
        }
        return result;
      }

      /**
       * Gets the argument placeholder value for `func`.
       *
       * @private
       * @param {Function} func The function to inspect.
       * @returns {*} Returns the placeholder value.
       */
      function getHolder(func) {
        var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;
        return object.placeholder;
      }

      /**
       * Gets the appropriate "iteratee" function. If `_.iteratee` is customized,
       * this function returns the custom method, otherwise it returns `baseIteratee`.
       * If arguments are provided, the chosen function is invoked with them and
       * its result is returned.
       *
       * @private
       * @param {*} [value] The value to convert to an iteratee.
       * @param {number} [arity] The arity of the created iteratee.
       * @returns {Function} Returns the chosen function or its result.
       */
      function getIteratee() {
        var result = lodash.iteratee || iteratee;
        result = result === iteratee ? baseIteratee : result;
        return arguments.length ? result(arguments[0], arguments[1]) : result;
      }

      /**
       * Gets the data for `map`.
       *
       * @private
       * @param {Object} map The map to query.
       * @param {string} key The reference key.
       * @returns {*} Returns the map data.
       */
      function getMapData(map, key) {
        var data = map.__data__;
        return isKeyable(key)
          ? data[typeof key == 'string' ? 'string' : 'hash']
          : data.map;
      }

      /**
       * Gets the property names, values, and compare flags of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the match data of `object`.
       */
      function getMatchData(object) {
        var result = keys(object),
            length = result.length;

        while (length--) {
          var key = result[length],
              value = object[key];

          result[length] = [key, value, isStrictComparable(value)];
        }
        return result;
      }

      /**
       * Gets the native function at `key` of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {string} key The key of the method to get.
       * @returns {*} Returns the function if it's native, else `undefined`.
       */
      function getNative(object, key) {
        var value = getValue(object, key);
        return baseIsNative(value) ? value : undefined$1;
      }

      /**
       * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
       *
       * @private
       * @param {*} value The value to query.
       * @returns {string} Returns the raw `toStringTag`.
       */
      function getRawTag(value) {
        var isOwn = hasOwnProperty.call(value, symToStringTag),
            tag = value[symToStringTag];

        try {
          value[symToStringTag] = undefined$1;
          var unmasked = true;
        } catch (e) {}

        var result = nativeObjectToString.call(value);
        if (unmasked) {
          if (isOwn) {
            value[symToStringTag] = tag;
          } else {
            delete value[symToStringTag];
          }
        }
        return result;
      }

      /**
       * Creates an array of the own enumerable symbols of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of symbols.
       */
      var getSymbols = !nativeGetSymbols ? stubArray : function(object) {
        if (object == null) {
          return [];
        }
        object = Object(object);
        return arrayFilter(nativeGetSymbols(object), function(symbol) {
          return propertyIsEnumerable.call(object, symbol);
        });
      };

      /**
       * Creates an array of the own and inherited enumerable symbols of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of symbols.
       */
      var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {
        var result = [];
        while (object) {
          arrayPush(result, getSymbols(object));
          object = getPrototype(object);
        }
        return result;
      };

      /**
       * Gets the `toStringTag` of `value`.
       *
       * @private
       * @param {*} value The value to query.
       * @returns {string} Returns the `toStringTag`.
       */
      var getTag = baseGetTag;

      // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.
      if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||
          (Map && getTag(new Map) != mapTag) ||
          (Promise && getTag(Promise.resolve()) != promiseTag) ||
          (Set && getTag(new Set) != setTag) ||
          (WeakMap && getTag(new WeakMap) != weakMapTag)) {
        getTag = function(value) {
          var result = baseGetTag(value),
              Ctor = result == objectTag ? value.constructor : undefined$1,
              ctorString = Ctor ? toSource(Ctor) : '';

          if (ctorString) {
            switch (ctorString) {
              case dataViewCtorString: return dataViewTag;
              case mapCtorString: return mapTag;
              case promiseCtorString: return promiseTag;
              case setCtorString: return setTag;
              case weakMapCtorString: return weakMapTag;
            }
          }
          return result;
        };
      }

      /**
       * Gets the view, applying any `transforms` to the `start` and `end` positions.
       *
       * @private
       * @param {number} start The start of the view.
       * @param {number} end The end of the view.
       * @param {Array} transforms The transformations to apply to the view.
       * @returns {Object} Returns an object containing the `start` and `end`
       *  positions of the view.
       */
      function getView(start, end, transforms) {
        var index = -1,
            length = transforms.length;

        while (++index < length) {
          var data = transforms[index],
              size = data.size;

          switch (data.type) {
            case 'drop':      start += size; break;
            case 'dropRight': end -= size; break;
            case 'take':      end = nativeMin(end, start + size); break;
            case 'takeRight': start = nativeMax(start, end - size); break;
          }
        }
        return { 'start': start, 'end': end };
      }

      /**
       * Extracts wrapper details from the `source` body comment.
       *
       * @private
       * @param {string} source The source to inspect.
       * @returns {Array} Returns the wrapper details.
       */
      function getWrapDetails(source) {
        var match = source.match(reWrapDetails);
        return match ? match[1].split(reSplitDetails) : [];
      }

      /**
       * Checks if `path` exists on `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {Array|string} path The path to check.
       * @param {Function} hasFunc The function to check properties.
       * @returns {boolean} Returns `true` if `path` exists, else `false`.
       */
      function hasPath(object, path, hasFunc) {
        path = castPath(path, object);

        var index = -1,
            length = path.length,
            result = false;

        while (++index < length) {
          var key = toKey(path[index]);
          if (!(result = object != null && hasFunc(object, key))) {
            break;
          }
          object = object[key];
        }
        if (result || ++index != length) {
          return result;
        }
        length = object == null ? 0 : object.length;
        return !!length && isLength(length) && isIndex(key, length) &&
          (isArray(object) || isArguments(object));
      }

      /**
       * Initializes an array clone.
       *
       * @private
       * @param {Array} array The array to clone.
       * @returns {Array} Returns the initialized clone.
       */
      function initCloneArray(array) {
        var length = array.length,
            result = new array.constructor(length);

        // Add properties assigned by `RegExp#exec`.
        if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {
          result.index = array.index;
          result.input = array.input;
        }
        return result;
      }

      /**
       * Initializes an object clone.
       *
       * @private
       * @param {Object} object The object to clone.
       * @returns {Object} Returns the initialized clone.
       */
      function initCloneObject(object) {
        return (typeof object.constructor == 'function' && !isPrototype(object))
          ? baseCreate(getPrototype(object))
          : {};
      }

      /**
       * Initializes an object clone based on its `toStringTag`.
       *
       * **Note:** This function only supports cloning values with tags of
       * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.
       *
       * @private
       * @param {Object} object The object to clone.
       * @param {string} tag The `toStringTag` of the object to clone.
       * @param {boolean} [isDeep] Specify a deep clone.
       * @returns {Object} Returns the initialized clone.
       */
      function initCloneByTag(object, tag, isDeep) {
        var Ctor = object.constructor;
        switch (tag) {
          case arrayBufferTag:
            return cloneArrayBuffer(object);

          case boolTag:
          case dateTag:
            return new Ctor(+object);

          case dataViewTag:
            return cloneDataView(object, isDeep);

          case float32Tag: case float64Tag:
          case int8Tag: case int16Tag: case int32Tag:
          case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:
            return cloneTypedArray(object, isDeep);

          case mapTag:
            return new Ctor;

          case numberTag:
          case stringTag:
            return new Ctor(object);

          case regexpTag:
            return cloneRegExp(object);

          case setTag:
            return new Ctor;

          case symbolTag:
            return cloneSymbol(object);
        }
      }

      /**
       * Inserts wrapper `details` in a comment at the top of the `source` body.
       *
       * @private
       * @param {string} source The source to modify.
       * @returns {Array} details The details to insert.
       * @returns {string} Returns the modified source.
       */
      function insertWrapDetails(source, details) {
        var length = details.length;
        if (!length) {
          return source;
        }
        var lastIndex = length - 1;
        details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];
        details = details.join(length > 2 ? ', ' : ' ');
        return source.replace(reWrapComment, '{\n/* [wrapped with ' + details + '] */\n');
      }

      /**
       * Checks if `value` is a flattenable `arguments` object or array.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.
       */
      function isFlattenable(value) {
        return isArray(value) || isArguments(value) ||
          !!(spreadableSymbol && value && value[spreadableSymbol]);
      }

      /**
       * Checks if `value` is a valid array-like index.
       *
       * @private
       * @param {*} value The value to check.
       * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
       * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
       */
      function isIndex(value, length) {
        var type = typeof value;
        length = length == null ? MAX_SAFE_INTEGER : length;

        return !!length &&
          (type == 'number' ||
            (type != 'symbol' && reIsUint.test(value))) &&
              (value > -1 && value % 1 == 0 && value < length);
      }

      /**
       * Checks if the given arguments are from an iteratee call.
       *
       * @private
       * @param {*} value The potential iteratee value argument.
       * @param {*} index The potential iteratee index or key argument.
       * @param {*} object The potential iteratee object argument.
       * @returns {boolean} Returns `true` if the arguments are from an iteratee call,
       *  else `false`.
       */
      function isIterateeCall(value, index, object) {
        if (!isObject(object)) {
          return false;
        }
        var type = typeof index;
        if (type == 'number'
              ? (isArrayLike(object) && isIndex(index, object.length))
              : (type == 'string' && index in object)
            ) {
          return eq(object[index], value);
        }
        return false;
      }

      /**
       * Checks if `value` is a property name and not a property path.
       *
       * @private
       * @param {*} value The value to check.
       * @param {Object} [object] The object to query keys on.
       * @returns {boolean} Returns `true` if `value` is a property name, else `false`.
       */
      function isKey(value, object) {
        if (isArray(value)) {
          return false;
        }
        var type = typeof value;
        if (type == 'number' || type == 'symbol' || type == 'boolean' ||
            value == null || isSymbol(value)) {
          return true;
        }
        return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||
          (object != null && value in Object(object));
      }

      /**
       * Checks if `value` is suitable for use as unique object key.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
       */
      function isKeyable(value) {
        var type = typeof value;
        return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
          ? (value !== '__proto__')
          : (value === null);
      }

      /**
       * Checks if `func` has a lazy counterpart.
       *
       * @private
       * @param {Function} func The function to check.
       * @returns {boolean} Returns `true` if `func` has a lazy counterpart,
       *  else `false`.
       */
      function isLaziable(func) {
        var funcName = getFuncName(func),
            other = lodash[funcName];

        if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {
          return false;
        }
        if (func === other) {
          return true;
        }
        var data = getData(other);
        return !!data && func === data[0];
      }

      /**
       * Checks if `func` has its source masked.
       *
       * @private
       * @param {Function} func The function to check.
       * @returns {boolean} Returns `true` if `func` is masked, else `false`.
       */
      function isMasked(func) {
        return !!maskSrcKey && (maskSrcKey in func);
      }

      /**
       * Checks if `func` is capable of being masked.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `func` is maskable, else `false`.
       */
      var isMaskable = coreJsData ? isFunction : stubFalse;

      /**
       * Checks if `value` is likely a prototype object.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
       */
      function isPrototype(value) {
        var Ctor = value && value.constructor,
            proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

        return value === proto;
      }

      /**
       * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.
       *
       * @private
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` if suitable for strict
       *  equality comparisons, else `false`.
       */
      function isStrictComparable(value) {
        return value === value && !isObject(value);
      }

      /**
       * A specialized version of `matchesProperty` for source values suitable
       * for strict equality comparisons, i.e. `===`.
       *
       * @private
       * @param {string} key The key of the property to get.
       * @param {*} srcValue The value to match.
       * @returns {Function} Returns the new spec function.
       */
      function matchesStrictComparable(key, srcValue) {
        return function(object) {
          if (object == null) {
            return false;
          }
          return object[key] === srcValue &&
            (srcValue !== undefined$1 || (key in Object(object)));
        };
      }

      /**
       * A specialized version of `_.memoize` which clears the memoized function's
       * cache when it exceeds `MAX_MEMOIZE_SIZE`.
       *
       * @private
       * @param {Function} func The function to have its output memoized.
       * @returns {Function} Returns the new memoized function.
       */
      function memoizeCapped(func) {
        var result = memoize(func, function(key) {
          if (cache.size === MAX_MEMOIZE_SIZE) {
            cache.clear();
          }
          return key;
        });

        var cache = result.cache;
        return result;
      }

      /**
       * Merges the function metadata of `source` into `data`.
       *
       * Merging metadata reduces the number of wrappers used to invoke a function.
       * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`
       * may be applied regardless of execution order. Methods like `_.ary` and
       * `_.rearg` modify function arguments, making the order in which they are
       * executed important, preventing the merging of metadata. However, we make
       * an exception for a safe combined case where curried functions have `_.ary`
       * and or `_.rearg` applied.
       *
       * @private
       * @param {Array} data The destination metadata.
       * @param {Array} source The source metadata.
       * @returns {Array} Returns `data`.
       */
      function mergeData(data, source) {
        var bitmask = data[1],
            srcBitmask = source[1],
            newBitmask = bitmask | srcBitmask,
            isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);

        var isCombo =
          ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||
          ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||
          ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));

        // Exit early if metadata can't be merged.
        if (!(isCommon || isCombo)) {
          return data;
        }
        // Use source `thisArg` if available.
        if (srcBitmask & WRAP_BIND_FLAG) {
          data[2] = source[2];
          // Set when currying a bound function.
          newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;
        }
        // Compose partial arguments.
        var value = source[3];
        if (value) {
          var partials = data[3];
          data[3] = partials ? composeArgs(partials, value, source[4]) : value;
          data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];
        }
        // Compose partial right arguments.
        value = source[5];
        if (value) {
          partials = data[5];
          data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;
          data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];
        }
        // Use source `argPos` if available.
        value = source[7];
        if (value) {
          data[7] = value;
        }
        // Use source `ary` if it's smaller.
        if (srcBitmask & WRAP_ARY_FLAG) {
          data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);
        }
        // Use source `arity` if one is not provided.
        if (data[9] == null) {
          data[9] = source[9];
        }
        // Use source `func` and merge bitmasks.
        data[0] = source[0];
        data[1] = newBitmask;

        return data;
      }

      /**
       * This function is like
       * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
       * except that it includes inherited enumerable properties.
       *
       * @private
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names.
       */
      function nativeKeysIn(object) {
        var result = [];
        if (object != null) {
          for (var key in Object(object)) {
            result.push(key);
          }
        }
        return result;
      }

      /**
       * Converts `value` to a string using `Object.prototype.toString`.
       *
       * @private
       * @param {*} value The value to convert.
       * @returns {string} Returns the converted string.
       */
      function objectToString(value) {
        return nativeObjectToString.call(value);
      }

      /**
       * A specialized version of `baseRest` which transforms the rest array.
       *
       * @private
       * @param {Function} func The function to apply a rest parameter to.
       * @param {number} [start=func.length-1] The start position of the rest parameter.
       * @param {Function} transform The rest array transform.
       * @returns {Function} Returns the new function.
       */
      function overRest(func, start, transform) {
        start = nativeMax(start === undefined$1 ? (func.length - 1) : start, 0);
        return function() {
          var args = arguments,
              index = -1,
              length = nativeMax(args.length - start, 0),
              array = Array(length);

          while (++index < length) {
            array[index] = args[start + index];
          }
          index = -1;
          var otherArgs = Array(start + 1);
          while (++index < start) {
            otherArgs[index] = args[index];
          }
          otherArgs[start] = transform(array);
          return apply(func, this, otherArgs);
        };
      }

      /**
       * Gets the parent value at `path` of `object`.
       *
       * @private
       * @param {Object} object The object to query.
       * @param {Array} path The path to get the parent value of.
       * @returns {*} Returns the parent value.
       */
      function parent(object, path) {
        return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));
      }

      /**
       * Reorder `array` according to the specified indexes where the element at
       * the first index is assigned as the first element, the element at
       * the second index is assigned as the second element, and so on.
       *
       * @private
       * @param {Array} array The array to reorder.
       * @param {Array} indexes The arranged array indexes.
       * @returns {Array} Returns `array`.
       */
      function reorder(array, indexes) {
        var arrLength = array.length,
            length = nativeMin(indexes.length, arrLength),
            oldArray = copyArray(array);

        while (length--) {
          var index = indexes[length];
          array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined$1;
        }
        return array;
      }

      /**
       * Gets the value at `key`, unless `key` is "__proto__" or "constructor".
       *
       * @private
       * @param {Object} object The object to query.
       * @param {string} key The key of the property to get.
       * @returns {*} Returns the property value.
       */
      function safeGet(object, key) {
        if (key === 'constructor' && typeof object[key] === 'function') {
          return;
        }

        if (key == '__proto__') {
          return;
        }

        return object[key];
      }

      /**
       * Sets metadata for `func`.
       *
       * **Note:** If this function becomes hot, i.e. is invoked a lot in a short
       * period of time, it will trip its breaker and transition to an identity
       * function to avoid garbage collection pauses in V8. See
       * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)
       * for more details.
       *
       * @private
       * @param {Function} func The function to associate metadata with.
       * @param {*} data The metadata.
       * @returns {Function} Returns `func`.
       */
      var setData = shortOut(baseSetData);

      /**
       * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).
       *
       * @private
       * @param {Function} func The function to delay.
       * @param {number} wait The number of milliseconds to delay invocation.
       * @returns {number|Object} Returns the timer id or timeout object.
       */
      var setTimeout = ctxSetTimeout || function(func, wait) {
        return root.setTimeout(func, wait);
      };

      /**
       * Sets the `toString` method of `func` to return `string`.
       *
       * @private
       * @param {Function} func The function to modify.
       * @param {Function} string The `toString` result.
       * @returns {Function} Returns `func`.
       */
      var setToString = shortOut(baseSetToString);

      /**
       * Sets the `toString` method of `wrapper` to mimic the source of `reference`
       * with wrapper details in a comment at the top of the source body.
       *
       * @private
       * @param {Function} wrapper The function to modify.
       * @param {Function} reference The reference function.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @returns {Function} Returns `wrapper`.
       */
      function setWrapToString(wrapper, reference, bitmask) {
        var source = (reference + '');
        return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));
      }

      /**
       * Creates a function that'll short out and invoke `identity` instead
       * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`
       * milliseconds.
       *
       * @private
       * @param {Function} func The function to restrict.
       * @returns {Function} Returns the new shortable function.
       */
      function shortOut(func) {
        var count = 0,
            lastCalled = 0;

        return function() {
          var stamp = nativeNow(),
              remaining = HOT_SPAN - (stamp - lastCalled);

          lastCalled = stamp;
          if (remaining > 0) {
            if (++count >= HOT_COUNT) {
              return arguments[0];
            }
          } else {
            count = 0;
          }
          return func.apply(undefined$1, arguments);
        };
      }

      /**
       * A specialized version of `_.shuffle` which mutates and sets the size of `array`.
       *
       * @private
       * @param {Array} array The array to shuffle.
       * @param {number} [size=array.length] The size of `array`.
       * @returns {Array} Returns `array`.
       */
      function shuffleSelf(array, size) {
        var index = -1,
            length = array.length,
            lastIndex = length - 1;

        size = size === undefined$1 ? length : size;
        while (++index < size) {
          var rand = baseRandom(index, lastIndex),
              value = array[rand];

          array[rand] = array[index];
          array[index] = value;
        }
        array.length = size;
        return array;
      }

      /**
       * Converts `string` to a property path array.
       *
       * @private
       * @param {string} string The string to convert.
       * @returns {Array} Returns the property path array.
       */
      var stringToPath = memoizeCapped(function(string) {
        var result = [];
        if (string.charCodeAt(0) === 46 /* . */) {
          result.push('');
        }
        string.replace(rePropName, function(match, number, quote, subString) {
          result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));
        });
        return result;
      });

      /**
       * Converts `value` to a string key if it's not a string or symbol.
       *
       * @private
       * @param {*} value The value to inspect.
       * @returns {string|symbol} Returns the key.
       */
      function toKey(value) {
        if (typeof value == 'string' || isSymbol(value)) {
          return value;
        }
        var result = (value + '');
        return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;
      }

      /**
       * Converts `func` to its source code.
       *
       * @private
       * @param {Function} func The function to convert.
       * @returns {string} Returns the source code.
       */
      function toSource(func) {
        if (func != null) {
          try {
            return funcToString.call(func);
          } catch (e) {}
          try {
            return (func + '');
          } catch (e) {}
        }
        return '';
      }

      /**
       * Updates wrapper `details` based on `bitmask` flags.
       *
       * @private
       * @returns {Array} details The details to modify.
       * @param {number} bitmask The bitmask flags. See `createWrap` for more details.
       * @returns {Array} Returns `details`.
       */
      function updateWrapDetails(details, bitmask) {
        arrayEach(wrapFlags, function(pair) {
          var value = '_.' + pair[0];
          if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {
            details.push(value);
          }
        });
        return details.sort();
      }

      /**
       * Creates a clone of `wrapper`.
       *
       * @private
       * @param {Object} wrapper The wrapper to clone.
       * @returns {Object} Returns the cloned wrapper.
       */
      function wrapperClone(wrapper) {
        if (wrapper instanceof LazyWrapper) {
          return wrapper.clone();
        }
        var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);
        result.__actions__ = copyArray(wrapper.__actions__);
        result.__index__  = wrapper.__index__;
        result.__values__ = wrapper.__values__;
        return result;
      }

      /*------------------------------------------------------------------------*/

      /**
       * Creates an array of elements split into groups the length of `size`.
       * If `array` can't be split evenly, the final chunk will be the remaining
       * elements.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to process.
       * @param {number} [size=1] The length of each chunk
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the new array of chunks.
       * @example
       *
       * _.chunk(['a', 'b', 'c', 'd'], 2);
       * // => [['a', 'b'], ['c', 'd']]
       *
       * _.chunk(['a', 'b', 'c', 'd'], 3);
       * // => [['a', 'b', 'c'], ['d']]
       */
      function chunk(array, size, guard) {
        if ((guard ? isIterateeCall(array, size, guard) : size === undefined$1)) {
          size = 1;
        } else {
          size = nativeMax(toInteger(size), 0);
        }
        var length = array == null ? 0 : array.length;
        if (!length || size < 1) {
          return [];
        }
        var index = 0,
            resIndex = 0,
            result = Array(nativeCeil(length / size));

        while (index < length) {
          result[resIndex++] = baseSlice(array, index, (index += size));
        }
        return result;
      }

      /**
       * Creates an array with all falsey values removed. The values `false`, `null`,
       * `0`, `""`, `undefined`, and `NaN` are falsey.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to compact.
       * @returns {Array} Returns the new array of filtered values.
       * @example
       *
       * _.compact([0, 1, false, 2, '', 3]);
       * // => [1, 2, 3]
       */
      function compact(array) {
        var index = -1,
            length = array == null ? 0 : array.length,
            resIndex = 0,
            result = [];

        while (++index < length) {
          var value = array[index];
          if (value) {
            result[resIndex++] = value;
          }
        }
        return result;
      }

      /**
       * Creates a new array concatenating `array` with any additional arrays
       * and/or values.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to concatenate.
       * @param {...*} [values] The values to concatenate.
       * @returns {Array} Returns the new concatenated array.
       * @example
       *
       * var array = [1];
       * var other = _.concat(array, 2, [3], [[4]]);
       *
       * console.log(other);
       * // => [1, 2, 3, [4]]
       *
       * console.log(array);
       * // => [1]
       */
      function concat() {
        var length = arguments.length;
        if (!length) {
          return [];
        }
        var args = Array(length - 1),
            array = arguments[0],
            index = length;

        while (index--) {
          args[index - 1] = arguments[index];
        }
        return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));
      }

      /**
       * Creates an array of `array` values not included in the other given arrays
       * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons. The order and references of result values are
       * determined by the first array.
       *
       * **Note:** Unlike `_.pullAll`, this method returns a new array.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {...Array} [values] The values to exclude.
       * @returns {Array} Returns the new array of filtered values.
       * @see _.without, _.xor
       * @example
       *
       * _.difference([2, 1], [2, 3]);
       * // => [1]
       */
      var difference = baseRest(function(array, values) {
        return isArrayLikeObject(array)
          ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))
          : [];
      });

      /**
       * This method is like `_.difference` except that it accepts `iteratee` which
       * is invoked for each element of `array` and `values` to generate the criterion
       * by which they're compared. The order and references of result values are
       * determined by the first array. The iteratee is invoked with one argument:
       * (value).
       *
       * **Note:** Unlike `_.pullAllBy`, this method returns a new array.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {...Array} [values] The values to exclude.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns the new array of filtered values.
       * @example
       *
       * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);
       * // => [1.2]
       *
       * // The `_.property` iteratee shorthand.
       * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');
       * // => [{ 'x': 2 }]
       */
      var differenceBy = baseRest(function(array, values) {
        var iteratee = last(values);
        if (isArrayLikeObject(iteratee)) {
          iteratee = undefined$1;
        }
        return isArrayLikeObject(array)
          ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))
          : [];
      });

      /**
       * This method is like `_.difference` except that it accepts `comparator`
       * which is invoked to compare elements of `array` to `values`. The order and
       * references of result values are determined by the first array. The comparator
       * is invoked with two arguments: (arrVal, othVal).
       *
       * **Note:** Unlike `_.pullAllWith`, this method returns a new array.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {...Array} [values] The values to exclude.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of filtered values.
       * @example
       *
       * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
       *
       * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);
       * // => [{ 'x': 2, 'y': 1 }]
       */
      var differenceWith = baseRest(function(array, values) {
        var comparator = last(values);
        if (isArrayLikeObject(comparator)) {
          comparator = undefined$1;
        }
        return isArrayLikeObject(array)
          ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined$1, comparator)
          : [];
      });

      /**
       * Creates a slice of `array` with `n` elements dropped from the beginning.
       *
       * @static
       * @memberOf _
       * @since 0.5.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {number} [n=1] The number of elements to drop.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.drop([1, 2, 3]);
       * // => [2, 3]
       *
       * _.drop([1, 2, 3], 2);
       * // => [3]
       *
       * _.drop([1, 2, 3], 5);
       * // => []
       *
       * _.drop([1, 2, 3], 0);
       * // => [1, 2, 3]
       */
      function drop(array, n, guard) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        n = (guard || n === undefined$1) ? 1 : toInteger(n);
        return baseSlice(array, n < 0 ? 0 : n, length);
      }

      /**
       * Creates a slice of `array` with `n` elements dropped from the end.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {number} [n=1] The number of elements to drop.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.dropRight([1, 2, 3]);
       * // => [1, 2]
       *
       * _.dropRight([1, 2, 3], 2);
       * // => [1]
       *
       * _.dropRight([1, 2, 3], 5);
       * // => []
       *
       * _.dropRight([1, 2, 3], 0);
       * // => [1, 2, 3]
       */
      function dropRight(array, n, guard) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        n = (guard || n === undefined$1) ? 1 : toInteger(n);
        n = length - n;
        return baseSlice(array, 0, n < 0 ? 0 : n);
      }

      /**
       * Creates a slice of `array` excluding elements dropped from the end.
       * Elements are dropped until `predicate` returns falsey. The predicate is
       * invoked with three arguments: (value, index, array).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': true },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': false }
       * ];
       *
       * _.dropRightWhile(users, function(o) { return !o.active; });
       * // => objects for ['barney']
       *
       * // The `_.matches` iteratee shorthand.
       * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });
       * // => objects for ['barney', 'fred']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.dropRightWhile(users, ['active', false]);
       * // => objects for ['barney']
       *
       * // The `_.property` iteratee shorthand.
       * _.dropRightWhile(users, 'active');
       * // => objects for ['barney', 'fred', 'pebbles']
       */
      function dropRightWhile(array, predicate) {
        return (array && array.length)
          ? baseWhile(array, getIteratee(predicate, 3), true, true)
          : [];
      }

      /**
       * Creates a slice of `array` excluding elements dropped from the beginning.
       * Elements are dropped until `predicate` returns falsey. The predicate is
       * invoked with three arguments: (value, index, array).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': false },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': true }
       * ];
       *
       * _.dropWhile(users, function(o) { return !o.active; });
       * // => objects for ['pebbles']
       *
       * // The `_.matches` iteratee shorthand.
       * _.dropWhile(users, { 'user': 'barney', 'active': false });
       * // => objects for ['fred', 'pebbles']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.dropWhile(users, ['active', false]);
       * // => objects for ['pebbles']
       *
       * // The `_.property` iteratee shorthand.
       * _.dropWhile(users, 'active');
       * // => objects for ['barney', 'fred', 'pebbles']
       */
      function dropWhile(array, predicate) {
        return (array && array.length)
          ? baseWhile(array, getIteratee(predicate, 3), true)
          : [];
      }

      /**
       * Fills elements of `array` with `value` from `start` up to, but not
       * including, `end`.
       *
       * **Note:** This method mutates `array`.
       *
       * @static
       * @memberOf _
       * @since 3.2.0
       * @category Array
       * @param {Array} array The array to fill.
       * @param {*} value The value to fill `array` with.
       * @param {number} [start=0] The start position.
       * @param {number} [end=array.length] The end position.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = [1, 2, 3];
       *
       * _.fill(array, 'a');
       * console.log(array);
       * // => ['a', 'a', 'a']
       *
       * _.fill(Array(3), 2);
       * // => [2, 2, 2]
       *
       * _.fill([4, 6, 8, 10], '*', 1, 3);
       * // => [4, '*', '*', 10]
       */
      function fill(array, value, start, end) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {
          start = 0;
          end = length;
        }
        return baseFill(array, value, start, end);
      }

      /**
       * This method is like `_.find` except that it returns the index of the first
       * element `predicate` returns truthy for instead of the element itself.
       *
       * @static
       * @memberOf _
       * @since 1.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param {number} [fromIndex=0] The index to search from.
       * @returns {number} Returns the index of the found element, else `-1`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': false },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': true }
       * ];
       *
       * _.findIndex(users, function(o) { return o.user == 'barney'; });
       * // => 0
       *
       * // The `_.matches` iteratee shorthand.
       * _.findIndex(users, { 'user': 'fred', 'active': false });
       * // => 1
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.findIndex(users, ['active', false]);
       * // => 0
       *
       * // The `_.property` iteratee shorthand.
       * _.findIndex(users, 'active');
       * // => 2
       */
      function findIndex(array, predicate, fromIndex) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return -1;
        }
        var index = fromIndex == null ? 0 : toInteger(fromIndex);
        if (index < 0) {
          index = nativeMax(length + index, 0);
        }
        return baseFindIndex(array, getIteratee(predicate, 3), index);
      }

      /**
       * This method is like `_.findIndex` except that it iterates over elements
       * of `collection` from right to left.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param {number} [fromIndex=array.length-1] The index to search from.
       * @returns {number} Returns the index of the found element, else `-1`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': true },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': false }
       * ];
       *
       * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });
       * // => 2
       *
       * // The `_.matches` iteratee shorthand.
       * _.findLastIndex(users, { 'user': 'barney', 'active': true });
       * // => 0
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.findLastIndex(users, ['active', false]);
       * // => 2
       *
       * // The `_.property` iteratee shorthand.
       * _.findLastIndex(users, 'active');
       * // => 0
       */
      function findLastIndex(array, predicate, fromIndex) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return -1;
        }
        var index = length - 1;
        if (fromIndex !== undefined$1) {
          index = toInteger(fromIndex);
          index = fromIndex < 0
            ? nativeMax(length + index, 0)
            : nativeMin(index, length - 1);
        }
        return baseFindIndex(array, getIteratee(predicate, 3), index, true);
      }

      /**
       * Flattens `array` a single level deep.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to flatten.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * _.flatten([1, [2, [3, [4]], 5]]);
       * // => [1, 2, [3, [4]], 5]
       */
      function flatten(array) {
        var length = array == null ? 0 : array.length;
        return length ? baseFlatten(array, 1) : [];
      }

      /**
       * Recursively flattens `array`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to flatten.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * _.flattenDeep([1, [2, [3, [4]], 5]]);
       * // => [1, 2, 3, 4, 5]
       */
      function flattenDeep(array) {
        var length = array == null ? 0 : array.length;
        return length ? baseFlatten(array, INFINITY) : [];
      }

      /**
       * Recursively flatten `array` up to `depth` times.
       *
       * @static
       * @memberOf _
       * @since 4.4.0
       * @category Array
       * @param {Array} array The array to flatten.
       * @param {number} [depth=1] The maximum recursion depth.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * var array = [1, [2, [3, [4]], 5]];
       *
       * _.flattenDepth(array, 1);
       * // => [1, 2, [3, [4]], 5]
       *
       * _.flattenDepth(array, 2);
       * // => [1, 2, 3, [4], 5]
       */
      function flattenDepth(array, depth) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        depth = depth === undefined$1 ? 1 : toInteger(depth);
        return baseFlatten(array, depth);
      }

      /**
       * The inverse of `_.toPairs`; this method returns an object composed
       * from key-value `pairs`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} pairs The key-value pairs.
       * @returns {Object} Returns the new object.
       * @example
       *
       * _.fromPairs([['a', 1], ['b', 2]]);
       * // => { 'a': 1, 'b': 2 }
       */
      function fromPairs(pairs) {
        var index = -1,
            length = pairs == null ? 0 : pairs.length,
            result = {};

        while (++index < length) {
          var pair = pairs[index];
          result[pair[0]] = pair[1];
        }
        return result;
      }

      /**
       * Gets the first element of `array`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @alias first
       * @category Array
       * @param {Array} array The array to query.
       * @returns {*} Returns the first element of `array`.
       * @example
       *
       * _.head([1, 2, 3]);
       * // => 1
       *
       * _.head([]);
       * // => undefined
       */
      function head(array) {
        return (array && array.length) ? array[0] : undefined$1;
      }

      /**
       * Gets the index at which the first occurrence of `value` is found in `array`
       * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons. If `fromIndex` is negative, it's used as the
       * offset from the end of `array`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {*} value The value to search for.
       * @param {number} [fromIndex=0] The index to search from.
       * @returns {number} Returns the index of the matched value, else `-1`.
       * @example
       *
       * _.indexOf([1, 2, 1, 2], 2);
       * // => 1
       *
       * // Search from the `fromIndex`.
       * _.indexOf([1, 2, 1, 2], 2, 2);
       * // => 3
       */
      function indexOf(array, value, fromIndex) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return -1;
        }
        var index = fromIndex == null ? 0 : toInteger(fromIndex);
        if (index < 0) {
          index = nativeMax(length + index, 0);
        }
        return baseIndexOf(array, value, index);
      }

      /**
       * Gets all but the last element of `array`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to query.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.initial([1, 2, 3]);
       * // => [1, 2]
       */
      function initial(array) {
        var length = array == null ? 0 : array.length;
        return length ? baseSlice(array, 0, -1) : [];
      }

      /**
       * Creates an array of unique values that are included in all given arrays
       * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons. The order and references of result values are
       * determined by the first array.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @returns {Array} Returns the new array of intersecting values.
       * @example
       *
       * _.intersection([2, 1], [2, 3]);
       * // => [2]
       */
      var intersection = baseRest(function(arrays) {
        var mapped = arrayMap(arrays, castArrayLikeObject);
        return (mapped.length && mapped[0] === arrays[0])
          ? baseIntersection(mapped)
          : [];
      });

      /**
       * This method is like `_.intersection` except that it accepts `iteratee`
       * which is invoked for each element of each `arrays` to generate the criterion
       * by which they're compared. The order and references of result values are
       * determined by the first array. The iteratee is invoked with one argument:
       * (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns the new array of intersecting values.
       * @example
       *
       * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);
       * // => [2.1]
       *
       * // The `_.property` iteratee shorthand.
       * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
       * // => [{ 'x': 1 }]
       */
      var intersectionBy = baseRest(function(arrays) {
        var iteratee = last(arrays),
            mapped = arrayMap(arrays, castArrayLikeObject);

        if (iteratee === last(mapped)) {
          iteratee = undefined$1;
        } else {
          mapped.pop();
        }
        return (mapped.length && mapped[0] === arrays[0])
          ? baseIntersection(mapped, getIteratee(iteratee, 2))
          : [];
      });

      /**
       * This method is like `_.intersection` except that it accepts `comparator`
       * which is invoked to compare elements of `arrays`. The order and references
       * of result values are determined by the first array. The comparator is
       * invoked with two arguments: (arrVal, othVal).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of intersecting values.
       * @example
       *
       * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
       * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
       *
       * _.intersectionWith(objects, others, _.isEqual);
       * // => [{ 'x': 1, 'y': 2 }]
       */
      var intersectionWith = baseRest(function(arrays) {
        var comparator = last(arrays),
            mapped = arrayMap(arrays, castArrayLikeObject);

        comparator = typeof comparator == 'function' ? comparator : undefined$1;
        if (comparator) {
          mapped.pop();
        }
        return (mapped.length && mapped[0] === arrays[0])
          ? baseIntersection(mapped, undefined$1, comparator)
          : [];
      });

      /**
       * Converts all elements in `array` into a string separated by `separator`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to convert.
       * @param {string} [separator=','] The element separator.
       * @returns {string} Returns the joined string.
       * @example
       *
       * _.join(['a', 'b', 'c'], '~');
       * // => 'a~b~c'
       */
      function join(array, separator) {
        return array == null ? '' : nativeJoin.call(array, separator);
      }

      /**
       * Gets the last element of `array`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to query.
       * @returns {*} Returns the last element of `array`.
       * @example
       *
       * _.last([1, 2, 3]);
       * // => 3
       */
      function last(array) {
        var length = array == null ? 0 : array.length;
        return length ? array[length - 1] : undefined$1;
      }

      /**
       * This method is like `_.indexOf` except that it iterates over elements of
       * `array` from right to left.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {*} value The value to search for.
       * @param {number} [fromIndex=array.length-1] The index to search from.
       * @returns {number} Returns the index of the matched value, else `-1`.
       * @example
       *
       * _.lastIndexOf([1, 2, 1, 2], 2);
       * // => 3
       *
       * // Search from the `fromIndex`.
       * _.lastIndexOf([1, 2, 1, 2], 2, 2);
       * // => 1
       */
      function lastIndexOf(array, value, fromIndex) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return -1;
        }
        var index = length;
        if (fromIndex !== undefined$1) {
          index = toInteger(fromIndex);
          index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);
        }
        return value === value
          ? strictLastIndexOf(array, value, index)
          : baseFindIndex(array, baseIsNaN, index, true);
      }

      /**
       * Gets the element at index `n` of `array`. If `n` is negative, the nth
       * element from the end is returned.
       *
       * @static
       * @memberOf _
       * @since 4.11.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {number} [n=0] The index of the element to return.
       * @returns {*} Returns the nth element of `array`.
       * @example
       *
       * var array = ['a', 'b', 'c', 'd'];
       *
       * _.nth(array, 1);
       * // => 'b'
       *
       * _.nth(array, -2);
       * // => 'c';
       */
      function nth(array, n) {
        return (array && array.length) ? baseNth(array, toInteger(n)) : undefined$1;
      }

      /**
       * Removes all given values from `array` using
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons.
       *
       * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`
       * to remove elements from an array by predicate.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {...*} [values] The values to remove.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = ['a', 'b', 'c', 'a', 'b', 'c'];
       *
       * _.pull(array, 'a', 'c');
       * console.log(array);
       * // => ['b', 'b']
       */
      var pull = baseRest(pullAll);

      /**
       * This method is like `_.pull` except that it accepts an array of values to remove.
       *
       * **Note:** Unlike `_.difference`, this method mutates `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {Array} values The values to remove.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = ['a', 'b', 'c', 'a', 'b', 'c'];
       *
       * _.pullAll(array, ['a', 'c']);
       * console.log(array);
       * // => ['b', 'b']
       */
      function pullAll(array, values) {
        return (array && array.length && values && values.length)
          ? basePullAll(array, values)
          : array;
      }

      /**
       * This method is like `_.pullAll` except that it accepts `iteratee` which is
       * invoked for each element of `array` and `values` to generate the criterion
       * by which they're compared. The iteratee is invoked with one argument: (value).
       *
       * **Note:** Unlike `_.differenceBy`, this method mutates `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {Array} values The values to remove.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];
       *
       * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');
       * console.log(array);
       * // => [{ 'x': 2 }]
       */
      function pullAllBy(array, values, iteratee) {
        return (array && array.length && values && values.length)
          ? basePullAll(array, values, getIteratee(iteratee, 2))
          : array;
      }

      /**
       * This method is like `_.pullAll` except that it accepts `comparator` which
       * is invoked to compare elements of `array` to `values`. The comparator is
       * invoked with two arguments: (arrVal, othVal).
       *
       * **Note:** Unlike `_.differenceWith`, this method mutates `array`.
       *
       * @static
       * @memberOf _
       * @since 4.6.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {Array} values The values to remove.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];
       *
       * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);
       * console.log(array);
       * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]
       */
      function pullAllWith(array, values, comparator) {
        return (array && array.length && values && values.length)
          ? basePullAll(array, values, undefined$1, comparator)
          : array;
      }

      /**
       * Removes elements from `array` corresponding to `indexes` and returns an
       * array of removed elements.
       *
       * **Note:** Unlike `_.at`, this method mutates `array`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {...(number|number[])} [indexes] The indexes of elements to remove.
       * @returns {Array} Returns the new array of removed elements.
       * @example
       *
       * var array = ['a', 'b', 'c', 'd'];
       * var pulled = _.pullAt(array, [1, 3]);
       *
       * console.log(array);
       * // => ['a', 'c']
       *
       * console.log(pulled);
       * // => ['b', 'd']
       */
      var pullAt = flatRest(function(array, indexes) {
        var length = array == null ? 0 : array.length,
            result = baseAt(array, indexes);

        basePullAt(array, arrayMap(indexes, function(index) {
          return isIndex(index, length) ? +index : index;
        }).sort(compareAscending));

        return result;
      });

      /**
       * Removes all elements from `array` that `predicate` returns truthy for
       * and returns an array of the removed elements. The predicate is invoked
       * with three arguments: (value, index, array).
       *
       * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`
       * to pull elements from an array by value.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new array of removed elements.
       * @example
       *
       * var array = [1, 2, 3, 4];
       * var evens = _.remove(array, function(n) {
       *   return n % 2 == 0;
       * });
       *
       * console.log(array);
       * // => [1, 3]
       *
       * console.log(evens);
       * // => [2, 4]
       */
      function remove(array, predicate) {
        var result = [];
        if (!(array && array.length)) {
          return result;
        }
        var index = -1,
            indexes = [],
            length = array.length;

        predicate = getIteratee(predicate, 3);
        while (++index < length) {
          var value = array[index];
          if (predicate(value, index, array)) {
            result.push(value);
            indexes.push(index);
          }
        }
        basePullAt(array, indexes);
        return result;
      }

      /**
       * Reverses `array` so that the first element becomes the last, the second
       * element becomes the second to last, and so on.
       *
       * **Note:** This method mutates `array` and is based on
       * [`Array#reverse`](https://mdn.io/Array/reverse).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to modify.
       * @returns {Array} Returns `array`.
       * @example
       *
       * var array = [1, 2, 3];
       *
       * _.reverse(array);
       * // => [3, 2, 1]
       *
       * console.log(array);
       * // => [3, 2, 1]
       */
      function reverse(array) {
        return array == null ? array : nativeReverse.call(array);
      }

      /**
       * Creates a slice of `array` from `start` up to, but not including, `end`.
       *
       * **Note:** This method is used instead of
       * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are
       * returned.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to slice.
       * @param {number} [start=0] The start position.
       * @param {number} [end=array.length] The end position.
       * @returns {Array} Returns the slice of `array`.
       */
      function slice(array, start, end) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {
          start = 0;
          end = length;
        }
        else {
          start = start == null ? 0 : toInteger(start);
          end = end === undefined$1 ? length : toInteger(end);
        }
        return baseSlice(array, start, end);
      }

      /**
       * Uses a binary search to determine the lowest index at which `value`
       * should be inserted into `array` in order to maintain its sort order.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       * @example
       *
       * _.sortedIndex([30, 50], 40);
       * // => 1
       */
      function sortedIndex(array, value) {
        return baseSortedIndex(array, value);
      }

      /**
       * This method is like `_.sortedIndex` except that it accepts `iteratee`
       * which is invoked for `value` and each element of `array` to compute their
       * sort ranking. The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       * @example
       *
       * var objects = [{ 'x': 4 }, { 'x': 5 }];
       *
       * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });
       * // => 0
       *
       * // The `_.property` iteratee shorthand.
       * _.sortedIndexBy(objects, { 'x': 4 }, 'x');
       * // => 0
       */
      function sortedIndexBy(array, value, iteratee) {
        return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));
      }

      /**
       * This method is like `_.indexOf` except that it performs a binary
       * search on a sorted `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {*} value The value to search for.
       * @returns {number} Returns the index of the matched value, else `-1`.
       * @example
       *
       * _.sortedIndexOf([4, 5, 5, 5, 6], 5);
       * // => 1
       */
      function sortedIndexOf(array, value) {
        var length = array == null ? 0 : array.length;
        if (length) {
          var index = baseSortedIndex(array, value);
          if (index < length && eq(array[index], value)) {
            return index;
          }
        }
        return -1;
      }

      /**
       * This method is like `_.sortedIndex` except that it returns the highest
       * index at which `value` should be inserted into `array` in order to
       * maintain its sort order.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       * @example
       *
       * _.sortedLastIndex([4, 5, 5, 5, 6], 5);
       * // => 4
       */
      function sortedLastIndex(array, value) {
        return baseSortedIndex(array, value, true);
      }

      /**
       * This method is like `_.sortedLastIndex` except that it accepts `iteratee`
       * which is invoked for `value` and each element of `array` to compute their
       * sort ranking. The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The sorted array to inspect.
       * @param {*} value The value to evaluate.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {number} Returns the index at which `value` should be inserted
       *  into `array`.
       * @example
       *
       * var objects = [{ 'x': 4 }, { 'x': 5 }];
       *
       * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });
       * // => 1
       *
       * // The `_.property` iteratee shorthand.
       * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');
       * // => 1
       */
      function sortedLastIndexBy(array, value, iteratee) {
        return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);
      }

      /**
       * This method is like `_.lastIndexOf` except that it performs a binary
       * search on a sorted `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {*} value The value to search for.
       * @returns {number} Returns the index of the matched value, else `-1`.
       * @example
       *
       * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);
       * // => 3
       */
      function sortedLastIndexOf(array, value) {
        var length = array == null ? 0 : array.length;
        if (length) {
          var index = baseSortedIndex(array, value, true) - 1;
          if (eq(array[index], value)) {
            return index;
          }
        }
        return -1;
      }

      /**
       * This method is like `_.uniq` except that it's designed and optimized
       * for sorted arrays.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @returns {Array} Returns the new duplicate free array.
       * @example
       *
       * _.sortedUniq([1, 1, 2]);
       * // => [1, 2]
       */
      function sortedUniq(array) {
        return (array && array.length)
          ? baseSortedUniq(array)
          : [];
      }

      /**
       * This method is like `_.uniqBy` except that it's designed and optimized
       * for sorted arrays.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {Function} [iteratee] The iteratee invoked per element.
       * @returns {Array} Returns the new duplicate free array.
       * @example
       *
       * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);
       * // => [1.1, 2.3]
       */
      function sortedUniqBy(array, iteratee) {
        return (array && array.length)
          ? baseSortedUniq(array, getIteratee(iteratee, 2))
          : [];
      }

      /**
       * Gets all but the first element of `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.tail([1, 2, 3]);
       * // => [2, 3]
       */
      function tail(array) {
        var length = array == null ? 0 : array.length;
        return length ? baseSlice(array, 1, length) : [];
      }

      /**
       * Creates a slice of `array` with `n` elements taken from the beginning.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {number} [n=1] The number of elements to take.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.take([1, 2, 3]);
       * // => [1]
       *
       * _.take([1, 2, 3], 2);
       * // => [1, 2]
       *
       * _.take([1, 2, 3], 5);
       * // => [1, 2, 3]
       *
       * _.take([1, 2, 3], 0);
       * // => []
       */
      function take(array, n, guard) {
        if (!(array && array.length)) {
          return [];
        }
        n = (guard || n === undefined$1) ? 1 : toInteger(n);
        return baseSlice(array, 0, n < 0 ? 0 : n);
      }

      /**
       * Creates a slice of `array` with `n` elements taken from the end.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {number} [n=1] The number of elements to take.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * _.takeRight([1, 2, 3]);
       * // => [3]
       *
       * _.takeRight([1, 2, 3], 2);
       * // => [2, 3]
       *
       * _.takeRight([1, 2, 3], 5);
       * // => [1, 2, 3]
       *
       * _.takeRight([1, 2, 3], 0);
       * // => []
       */
      function takeRight(array, n, guard) {
        var length = array == null ? 0 : array.length;
        if (!length) {
          return [];
        }
        n = (guard || n === undefined$1) ? 1 : toInteger(n);
        n = length - n;
        return baseSlice(array, n < 0 ? 0 : n, length);
      }

      /**
       * Creates a slice of `array` with elements taken from the end. Elements are
       * taken until `predicate` returns falsey. The predicate is invoked with
       * three arguments: (value, index, array).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': true },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': false }
       * ];
       *
       * _.takeRightWhile(users, function(o) { return !o.active; });
       * // => objects for ['fred', 'pebbles']
       *
       * // The `_.matches` iteratee shorthand.
       * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });
       * // => objects for ['pebbles']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.takeRightWhile(users, ['active', false]);
       * // => objects for ['fred', 'pebbles']
       *
       * // The `_.property` iteratee shorthand.
       * _.takeRightWhile(users, 'active');
       * // => []
       */
      function takeRightWhile(array, predicate) {
        return (array && array.length)
          ? baseWhile(array, getIteratee(predicate, 3), false, true)
          : [];
      }

      /**
       * Creates a slice of `array` with elements taken from the beginning. Elements
       * are taken until `predicate` returns falsey. The predicate is invoked with
       * three arguments: (value, index, array).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Array
       * @param {Array} array The array to query.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the slice of `array`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'active': false },
       *   { 'user': 'fred',    'active': false },
       *   { 'user': 'pebbles', 'active': true }
       * ];
       *
       * _.takeWhile(users, function(o) { return !o.active; });
       * // => objects for ['barney', 'fred']
       *
       * // The `_.matches` iteratee shorthand.
       * _.takeWhile(users, { 'user': 'barney', 'active': false });
       * // => objects for ['barney']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.takeWhile(users, ['active', false]);
       * // => objects for ['barney', 'fred']
       *
       * // The `_.property` iteratee shorthand.
       * _.takeWhile(users, 'active');
       * // => []
       */
      function takeWhile(array, predicate) {
        return (array && array.length)
          ? baseWhile(array, getIteratee(predicate, 3))
          : [];
      }

      /**
       * Creates an array of unique values, in order, from all given arrays using
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @returns {Array} Returns the new array of combined values.
       * @example
       *
       * _.union([2], [1, 2]);
       * // => [2, 1]
       */
      var union = baseRest(function(arrays) {
        return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));
      });

      /**
       * This method is like `_.union` except that it accepts `iteratee` which is
       * invoked for each element of each `arrays` to generate the criterion by
       * which uniqueness is computed. Result values are chosen from the first
       * array in which the value occurs. The iteratee is invoked with one argument:
       * (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns the new array of combined values.
       * @example
       *
       * _.unionBy([2.1], [1.2, 2.3], Math.floor);
       * // => [2.1, 1.2]
       *
       * // The `_.property` iteratee shorthand.
       * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
       * // => [{ 'x': 1 }, { 'x': 2 }]
       */
      var unionBy = baseRest(function(arrays) {
        var iteratee = last(arrays);
        if (isArrayLikeObject(iteratee)) {
          iteratee = undefined$1;
        }
        return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));
      });

      /**
       * This method is like `_.union` except that it accepts `comparator` which
       * is invoked to compare elements of `arrays`. Result values are chosen from
       * the first array in which the value occurs. The comparator is invoked
       * with two arguments: (arrVal, othVal).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of combined values.
       * @example
       *
       * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
       * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
       *
       * _.unionWith(objects, others, _.isEqual);
       * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]
       */
      var unionWith = baseRest(function(arrays) {
        var comparator = last(arrays);
        comparator = typeof comparator == 'function' ? comparator : undefined$1;
        return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined$1, comparator);
      });

      /**
       * Creates a duplicate-free version of an array, using
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons, in which only the first occurrence of each element
       * is kept. The order of result values is determined by the order they occur
       * in the array.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @returns {Array} Returns the new duplicate free array.
       * @example
       *
       * _.uniq([2, 1, 2]);
       * // => [2, 1]
       */
      function uniq(array) {
        return (array && array.length) ? baseUniq(array) : [];
      }

      /**
       * This method is like `_.uniq` except that it accepts `iteratee` which is
       * invoked for each element in `array` to generate the criterion by which
       * uniqueness is computed. The order of result values is determined by the
       * order they occur in the array. The iteratee is invoked with one argument:
       * (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns the new duplicate free array.
       * @example
       *
       * _.uniqBy([2.1, 1.2, 2.3], Math.floor);
       * // => [2.1, 1.2]
       *
       * // The `_.property` iteratee shorthand.
       * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');
       * // => [{ 'x': 1 }, { 'x': 2 }]
       */
      function uniqBy(array, iteratee) {
        return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];
      }

      /**
       * This method is like `_.uniq` except that it accepts `comparator` which
       * is invoked to compare elements of `array`. The order of result values is
       * determined by the order they occur in the array.The comparator is invoked
       * with two arguments: (arrVal, othVal).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new duplicate free array.
       * @example
       *
       * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];
       *
       * _.uniqWith(objects, _.isEqual);
       * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]
       */
      function uniqWith(array, comparator) {
        comparator = typeof comparator == 'function' ? comparator : undefined$1;
        return (array && array.length) ? baseUniq(array, undefined$1, comparator) : [];
      }

      /**
       * This method is like `_.zip` except that it accepts an array of grouped
       * elements and creates an array regrouping the elements to their pre-zip
       * configuration.
       *
       * @static
       * @memberOf _
       * @since 1.2.0
       * @category Array
       * @param {Array} array The array of grouped elements to process.
       * @returns {Array} Returns the new array of regrouped elements.
       * @example
       *
       * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);
       * // => [['a', 1, true], ['b', 2, false]]
       *
       * _.unzip(zipped);
       * // => [['a', 'b'], [1, 2], [true, false]]
       */
      function unzip(array) {
        if (!(array && array.length)) {
          return [];
        }
        var length = 0;
        array = arrayFilter(array, function(group) {
          if (isArrayLikeObject(group)) {
            length = nativeMax(group.length, length);
            return true;
          }
        });
        return baseTimes(length, function(index) {
          return arrayMap(array, baseProperty(index));
        });
      }

      /**
       * This method is like `_.unzip` except that it accepts `iteratee` to specify
       * how regrouped values should be combined. The iteratee is invoked with the
       * elements of each group: (...group).
       *
       * @static
       * @memberOf _
       * @since 3.8.0
       * @category Array
       * @param {Array} array The array of grouped elements to process.
       * @param {Function} [iteratee=_.identity] The function to combine
       *  regrouped values.
       * @returns {Array} Returns the new array of regrouped elements.
       * @example
       *
       * var zipped = _.zip([1, 2], [10, 20], [100, 200]);
       * // => [[1, 10, 100], [2, 20, 200]]
       *
       * _.unzipWith(zipped, _.add);
       * // => [3, 30, 300]
       */
      function unzipWith(array, iteratee) {
        if (!(array && array.length)) {
          return [];
        }
        var result = unzip(array);
        if (iteratee == null) {
          return result;
        }
        return arrayMap(result, function(group) {
          return apply(iteratee, undefined$1, group);
        });
      }

      /**
       * Creates an array excluding all given values using
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * for equality comparisons.
       *
       * **Note:** Unlike `_.pull`, this method returns a new array.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {Array} array The array to inspect.
       * @param {...*} [values] The values to exclude.
       * @returns {Array} Returns the new array of filtered values.
       * @see _.difference, _.xor
       * @example
       *
       * _.without([2, 1, 2, 3], 1, 2);
       * // => [3]
       */
      var without = baseRest(function(array, values) {
        return isArrayLikeObject(array)
          ? baseDifference(array, values)
          : [];
      });

      /**
       * Creates an array of unique values that is the
       * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)
       * of the given arrays. The order of result values is determined by the order
       * they occur in the arrays.
       *
       * @static
       * @memberOf _
       * @since 2.4.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @returns {Array} Returns the new array of filtered values.
       * @see _.difference, _.without
       * @example
       *
       * _.xor([2, 1], [2, 3]);
       * // => [1, 3]
       */
      var xor = baseRest(function(arrays) {
        return baseXor(arrayFilter(arrays, isArrayLikeObject));
      });

      /**
       * This method is like `_.xor` except that it accepts `iteratee` which is
       * invoked for each element of each `arrays` to generate the criterion by
       * which by which they're compared. The order of result values is determined
       * by the order they occur in the arrays. The iteratee is invoked with one
       * argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Array} Returns the new array of filtered values.
       * @example
       *
       * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);
       * // => [1.2, 3.4]
       *
       * // The `_.property` iteratee shorthand.
       * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');
       * // => [{ 'x': 2 }]
       */
      var xorBy = baseRest(function(arrays) {
        var iteratee = last(arrays);
        if (isArrayLikeObject(iteratee)) {
          iteratee = undefined$1;
        }
        return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));
      });

      /**
       * This method is like `_.xor` except that it accepts `comparator` which is
       * invoked to compare elements of `arrays`. The order of result values is
       * determined by the order they occur in the arrays. The comparator is invoked
       * with two arguments: (arrVal, othVal).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Array
       * @param {...Array} [arrays] The arrays to inspect.
       * @param {Function} [comparator] The comparator invoked per element.
       * @returns {Array} Returns the new array of filtered values.
       * @example
       *
       * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];
       * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];
       *
       * _.xorWith(objects, others, _.isEqual);
       * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]
       */
      var xorWith = baseRest(function(arrays) {
        var comparator = last(arrays);
        comparator = typeof comparator == 'function' ? comparator : undefined$1;
        return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined$1, comparator);
      });

      /**
       * Creates an array of grouped elements, the first of which contains the
       * first elements of the given arrays, the second of which contains the
       * second elements of the given arrays, and so on.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Array
       * @param {...Array} [arrays] The arrays to process.
       * @returns {Array} Returns the new array of grouped elements.
       * @example
       *
       * _.zip(['a', 'b'], [1, 2], [true, false]);
       * // => [['a', 1, true], ['b', 2, false]]
       */
      var zip = baseRest(unzip);

      /**
       * This method is like `_.fromPairs` except that it accepts two arrays,
       * one of property identifiers and one of corresponding values.
       *
       * @static
       * @memberOf _
       * @since 0.4.0
       * @category Array
       * @param {Array} [props=[]] The property identifiers.
       * @param {Array} [values=[]] The property values.
       * @returns {Object} Returns the new object.
       * @example
       *
       * _.zipObject(['a', 'b'], [1, 2]);
       * // => { 'a': 1, 'b': 2 }
       */
      function zipObject(props, values) {
        return baseZipObject(props || [], values || [], assignValue);
      }

      /**
       * This method is like `_.zipObject` except that it supports property paths.
       *
       * @static
       * @memberOf _
       * @since 4.1.0
       * @category Array
       * @param {Array} [props=[]] The property identifiers.
       * @param {Array} [values=[]] The property values.
       * @returns {Object} Returns the new object.
       * @example
       *
       * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);
       * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }
       */
      function zipObjectDeep(props, values) {
        return baseZipObject(props || [], values || [], baseSet);
      }

      /**
       * This method is like `_.zip` except that it accepts `iteratee` to specify
       * how grouped values should be combined. The iteratee is invoked with the
       * elements of each group: (...group).
       *
       * @static
       * @memberOf _
       * @since 3.8.0
       * @category Array
       * @param {...Array} [arrays] The arrays to process.
       * @param {Function} [iteratee=_.identity] The function to combine
       *  grouped values.
       * @returns {Array} Returns the new array of grouped elements.
       * @example
       *
       * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {
       *   return a + b + c;
       * });
       * // => [111, 222]
       */
      var zipWith = baseRest(function(arrays) {
        var length = arrays.length,
            iteratee = length > 1 ? arrays[length - 1] : undefined$1;

        iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined$1;
        return unzipWith(arrays, iteratee);
      });

      /*------------------------------------------------------------------------*/

      /**
       * Creates a `lodash` wrapper instance that wraps `value` with explicit method
       * chain sequences enabled. The result of such sequences must be unwrapped
       * with `_#value`.
       *
       * @static
       * @memberOf _
       * @since 1.3.0
       * @category Seq
       * @param {*} value The value to wrap.
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'age': 36 },
       *   { 'user': 'fred',    'age': 40 },
       *   { 'user': 'pebbles', 'age': 1 }
       * ];
       *
       * var youngest = _
       *   .chain(users)
       *   .sortBy('age')
       *   .map(function(o) {
       *     return o.user + ' is ' + o.age;
       *   })
       *   .head()
       *   .value();
       * // => 'pebbles is 1'
       */
      function chain(value) {
        var result = lodash(value);
        result.__chain__ = true;
        return result;
      }

      /**
       * This method invokes `interceptor` and returns `value`. The interceptor
       * is invoked with one argument; (value). The purpose of this method is to
       * "tap into" a method chain sequence in order to modify intermediate results.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Seq
       * @param {*} value The value to provide to `interceptor`.
       * @param {Function} interceptor The function to invoke.
       * @returns {*} Returns `value`.
       * @example
       *
       * _([1, 2, 3])
       *  .tap(function(array) {
       *    // Mutate input array.
       *    array.pop();
       *  })
       *  .reverse()
       *  .value();
       * // => [2, 1]
       */
      function tap(value, interceptor) {
        interceptor(value);
        return value;
      }

      /**
       * This method is like `_.tap` except that it returns the result of `interceptor`.
       * The purpose of this method is to "pass thru" values replacing intermediate
       * results in a method chain sequence.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Seq
       * @param {*} value The value to provide to `interceptor`.
       * @param {Function} interceptor The function to invoke.
       * @returns {*} Returns the result of `interceptor`.
       * @example
       *
       * _('  abc  ')
       *  .chain()
       *  .trim()
       *  .thru(function(value) {
       *    return [value];
       *  })
       *  .value();
       * // => ['abc']
       */
      function thru(value, interceptor) {
        return interceptor(value);
      }

      /**
       * This method is the wrapper version of `_.at`.
       *
       * @name at
       * @memberOf _
       * @since 1.0.0
       * @category Seq
       * @param {...(string|string[])} [paths] The property paths to pick.
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };
       *
       * _(object).at(['a[0].b.c', 'a[1]']).value();
       * // => [3, 4]
       */
      var wrapperAt = flatRest(function(paths) {
        var length = paths.length,
            start = length ? paths[0] : 0,
            value = this.__wrapped__,
            interceptor = function(object) { return baseAt(object, paths); };

        if (length > 1 || this.__actions__.length ||
            !(value instanceof LazyWrapper) || !isIndex(start)) {
          return this.thru(interceptor);
        }
        value = value.slice(start, +start + (length ? 1 : 0));
        value.__actions__.push({
          'func': thru,
          'args': [interceptor],
          'thisArg': undefined$1
        });
        return new LodashWrapper(value, this.__chain__).thru(function(array) {
          if (length && !array.length) {
            array.push(undefined$1);
          }
          return array;
        });
      });

      /**
       * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.
       *
       * @name chain
       * @memberOf _
       * @since 0.1.0
       * @category Seq
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * var users = [
       *   { 'user': 'barney', 'age': 36 },
       *   { 'user': 'fred',   'age': 40 }
       * ];
       *
       * // A sequence without explicit chaining.
       * _(users).head();
       * // => { 'user': 'barney', 'age': 36 }
       *
       * // A sequence with explicit chaining.
       * _(users)
       *   .chain()
       *   .head()
       *   .pick('user')
       *   .value();
       * // => { 'user': 'barney' }
       */
      function wrapperChain() {
        return chain(this);
      }

      /**
       * Executes the chain sequence and returns the wrapped result.
       *
       * @name commit
       * @memberOf _
       * @since 3.2.0
       * @category Seq
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * var array = [1, 2];
       * var wrapped = _(array).push(3);
       *
       * console.log(array);
       * // => [1, 2]
       *
       * wrapped = wrapped.commit();
       * console.log(array);
       * // => [1, 2, 3]
       *
       * wrapped.last();
       * // => 3
       *
       * console.log(array);
       * // => [1, 2, 3]
       */
      function wrapperCommit() {
        return new LodashWrapper(this.value(), this.__chain__);
      }

      /**
       * Gets the next value on a wrapped object following the
       * [iterator protocol](https://mdn.io/iteration_protocols#iterator).
       *
       * @name next
       * @memberOf _
       * @since 4.0.0
       * @category Seq
       * @returns {Object} Returns the next iterator value.
       * @example
       *
       * var wrapped = _([1, 2]);
       *
       * wrapped.next();
       * // => { 'done': false, 'value': 1 }
       *
       * wrapped.next();
       * // => { 'done': false, 'value': 2 }
       *
       * wrapped.next();
       * // => { 'done': true, 'value': undefined }
       */
      function wrapperNext() {
        if (this.__values__ === undefined$1) {
          this.__values__ = toArray(this.value());
        }
        var done = this.__index__ >= this.__values__.length,
            value = done ? undefined$1 : this.__values__[this.__index__++];

        return { 'done': done, 'value': value };
      }

      /**
       * Enables the wrapper to be iterable.
       *
       * @name Symbol.iterator
       * @memberOf _
       * @since 4.0.0
       * @category Seq
       * @returns {Object} Returns the wrapper object.
       * @example
       *
       * var wrapped = _([1, 2]);
       *
       * wrapped[Symbol.iterator]() === wrapped;
       * // => true
       *
       * Array.from(wrapped);
       * // => [1, 2]
       */
      function wrapperToIterator() {
        return this;
      }

      /**
       * Creates a clone of the chain sequence planting `value` as the wrapped value.
       *
       * @name plant
       * @memberOf _
       * @since 3.2.0
       * @category Seq
       * @param {*} value The value to plant.
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * var wrapped = _([1, 2]).map(square);
       * var other = wrapped.plant([3, 4]);
       *
       * other.value();
       * // => [9, 16]
       *
       * wrapped.value();
       * // => [1, 4]
       */
      function wrapperPlant(value) {
        var result,
            parent = this;

        while (parent instanceof baseLodash) {
          var clone = wrapperClone(parent);
          clone.__index__ = 0;
          clone.__values__ = undefined$1;
          if (result) {
            previous.__wrapped__ = clone;
          } else {
            result = clone;
          }
          var previous = clone;
          parent = parent.__wrapped__;
        }
        previous.__wrapped__ = value;
        return result;
      }

      /**
       * This method is the wrapper version of `_.reverse`.
       *
       * **Note:** This method mutates the wrapped array.
       *
       * @name reverse
       * @memberOf _
       * @since 0.1.0
       * @category Seq
       * @returns {Object} Returns the new `lodash` wrapper instance.
       * @example
       *
       * var array = [1, 2, 3];
       *
       * _(array).reverse().value()
       * // => [3, 2, 1]
       *
       * console.log(array);
       * // => [3, 2, 1]
       */
      function wrapperReverse() {
        var value = this.__wrapped__;
        if (value instanceof LazyWrapper) {
          var wrapped = value;
          if (this.__actions__.length) {
            wrapped = new LazyWrapper(this);
          }
          wrapped = wrapped.reverse();
          wrapped.__actions__.push({
            'func': thru,
            'args': [reverse],
            'thisArg': undefined$1
          });
          return new LodashWrapper(wrapped, this.__chain__);
        }
        return this.thru(reverse);
      }

      /**
       * Executes the chain sequence to resolve the unwrapped value.
       *
       * @name value
       * @memberOf _
       * @since 0.1.0
       * @alias toJSON, valueOf
       * @category Seq
       * @returns {*} Returns the resolved unwrapped value.
       * @example
       *
       * _([1, 2, 3]).value();
       * // => [1, 2, 3]
       */
      function wrapperValue() {
        return baseWrapperValue(this.__wrapped__, this.__actions__);
      }

      /*------------------------------------------------------------------------*/

      /**
       * Creates an object composed of keys generated from the results of running
       * each element of `collection` thru `iteratee`. The corresponding value of
       * each key is the number of times the key was returned by `iteratee`. The
       * iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 0.5.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
       * @returns {Object} Returns the composed aggregate object.
       * @example
       *
       * _.countBy([6.1, 4.2, 6.3], Math.floor);
       * // => { '4': 1, '6': 2 }
       *
       * // The `_.property` iteratee shorthand.
       * _.countBy(['one', 'two', 'three'], 'length');
       * // => { '3': 2, '5': 1 }
       */
      var countBy = createAggregator(function(result, value, key) {
        if (hasOwnProperty.call(result, key)) {
          ++result[key];
        } else {
          baseAssignValue(result, key, 1);
        }
      });

      /**
       * Checks if `predicate` returns truthy for **all** elements of `collection`.
       * Iteration is stopped once `predicate` returns falsey. The predicate is
       * invoked with three arguments: (value, index|key, collection).
       *
       * **Note:** This method returns `true` for
       * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because
       * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of
       * elements of empty collections.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {boolean} Returns `true` if all elements pass the predicate check,
       *  else `false`.
       * @example
       *
       * _.every([true, 1, null, 'yes'], Boolean);
       * // => false
       *
       * var users = [
       *   { 'user': 'barney', 'age': 36, 'active': false },
       *   { 'user': 'fred',   'age': 40, 'active': false }
       * ];
       *
       * // The `_.matches` iteratee shorthand.
       * _.every(users, { 'user': 'barney', 'active': false });
       * // => false
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.every(users, ['active', false]);
       * // => true
       *
       * // The `_.property` iteratee shorthand.
       * _.every(users, 'active');
       * // => false
       */
      function every(collection, predicate, guard) {
        var func = isArray(collection) ? arrayEvery : baseEvery;
        if (guard && isIterateeCall(collection, predicate, guard)) {
          predicate = undefined$1;
        }
        return func(collection, getIteratee(predicate, 3));
      }

      /**
       * Iterates over elements of `collection`, returning an array of all elements
       * `predicate` returns truthy for. The predicate is invoked with three
       * arguments: (value, index|key, collection).
       *
       * **Note:** Unlike `_.remove`, this method returns a new array.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new filtered array.
       * @see _.reject
       * @example
       *
       * var users = [
       *   { 'user': 'barney', 'age': 36, 'active': true },
       *   { 'user': 'fred',   'age': 40, 'active': false }
       * ];
       *
       * _.filter(users, function(o) { return !o.active; });
       * // => objects for ['fred']
       *
       * // The `_.matches` iteratee shorthand.
       * _.filter(users, { 'age': 36, 'active': true });
       * // => objects for ['barney']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.filter(users, ['active', false]);
       * // => objects for ['fred']
       *
       * // The `_.property` iteratee shorthand.
       * _.filter(users, 'active');
       * // => objects for ['barney']
       *
       * // Combining several predicates using `_.overEvery` or `_.overSome`.
       * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));
       * // => objects for ['fred', 'barney']
       */
      function filter(collection, predicate) {
        var func = isArray(collection) ? arrayFilter : baseFilter;
        return func(collection, getIteratee(predicate, 3));
      }

      /**
       * Iterates over elements of `collection`, returning the first element
       * `predicate` returns truthy for. The predicate is invoked with three
       * arguments: (value, index|key, collection).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param {number} [fromIndex=0] The index to search from.
       * @returns {*} Returns the matched element, else `undefined`.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'age': 36, 'active': true },
       *   { 'user': 'fred',    'age': 40, 'active': false },
       *   { 'user': 'pebbles', 'age': 1,  'active': true }
       * ];
       *
       * _.find(users, function(o) { return o.age < 40; });
       * // => object for 'barney'
       *
       * // The `_.matches` iteratee shorthand.
       * _.find(users, { 'age': 1, 'active': true });
       * // => object for 'pebbles'
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.find(users, ['active', false]);
       * // => object for 'fred'
       *
       * // The `_.property` iteratee shorthand.
       * _.find(users, 'active');
       * // => object for 'barney'
       */
      var find = createFind(findIndex);

      /**
       * This method is like `_.find` except that it iterates over elements of
       * `collection` from right to left.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param {number} [fromIndex=collection.length-1] The index to search from.
       * @returns {*} Returns the matched element, else `undefined`.
       * @example
       *
       * _.findLast([1, 2, 3, 4], function(n) {
       *   return n % 2 == 1;
       * });
       * // => 3
       */
      var findLast = createFind(findLastIndex);

      /**
       * Creates a flattened array of values by running each element in `collection`
       * thru `iteratee` and flattening the mapped results. The iteratee is invoked
       * with three arguments: (value, index|key, collection).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * function duplicate(n) {
       *   return [n, n];
       * }
       *
       * _.flatMap([1, 2], duplicate);
       * // => [1, 1, 2, 2]
       */
      function flatMap(collection, iteratee) {
        return baseFlatten(map(collection, iteratee), 1);
      }

      /**
       * This method is like `_.flatMap` except that it recursively flattens the
       * mapped results.
       *
       * @static
       * @memberOf _
       * @since 4.7.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * function duplicate(n) {
       *   return [[[n, n]]];
       * }
       *
       * _.flatMapDeep([1, 2], duplicate);
       * // => [1, 1, 2, 2]
       */
      function flatMapDeep(collection, iteratee) {
        return baseFlatten(map(collection, iteratee), INFINITY);
      }

      /**
       * This method is like `_.flatMap` except that it recursively flattens the
       * mapped results up to `depth` times.
       *
       * @static
       * @memberOf _
       * @since 4.7.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @param {number} [depth=1] The maximum recursion depth.
       * @returns {Array} Returns the new flattened array.
       * @example
       *
       * function duplicate(n) {
       *   return [[[n, n]]];
       * }
       *
       * _.flatMapDepth([1, 2], duplicate, 2);
       * // => [[1, 1], [2, 2]]
       */
      function flatMapDepth(collection, iteratee, depth) {
        depth = depth === undefined$1 ? 1 : toInteger(depth);
        return baseFlatten(map(collection, iteratee), depth);
      }

      /**
       * Iterates over elements of `collection` and invokes `iteratee` for each element.
       * The iteratee is invoked with three arguments: (value, index|key, collection).
       * Iteratee functions may exit iteration early by explicitly returning `false`.
       *
       * **Note:** As with other "Collections" methods, objects with a "length"
       * property are iterated like arrays. To avoid this behavior use `_.forIn`
       * or `_.forOwn` for object iteration.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @alias each
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array|Object} Returns `collection`.
       * @see _.forEachRight
       * @example
       *
       * _.forEach([1, 2], function(value) {
       *   console.log(value);
       * });
       * // => Logs `1` then `2`.
       *
       * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {
       *   console.log(key);
       * });
       * // => Logs 'a' then 'b' (iteration order is not guaranteed).
       */
      function forEach(collection, iteratee) {
        var func = isArray(collection) ? arrayEach : baseEach;
        return func(collection, getIteratee(iteratee, 3));
      }

      /**
       * This method is like `_.forEach` except that it iterates over elements of
       * `collection` from right to left.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @alias eachRight
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array|Object} Returns `collection`.
       * @see _.forEach
       * @example
       *
       * _.forEachRight([1, 2], function(value) {
       *   console.log(value);
       * });
       * // => Logs `2` then `1`.
       */
      function forEachRight(collection, iteratee) {
        var func = isArray(collection) ? arrayEachRight : baseEachRight;
        return func(collection, getIteratee(iteratee, 3));
      }

      /**
       * Creates an object composed of keys generated from the results of running
       * each element of `collection` thru `iteratee`. The order of grouped values
       * is determined by the order they occur in `collection`. The corresponding
       * value of each key is an array of elements responsible for generating the
       * key. The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
       * @returns {Object} Returns the composed aggregate object.
       * @example
       *
       * _.groupBy([6.1, 4.2, 6.3], Math.floor);
       * // => { '4': [4.2], '6': [6.1, 6.3] }
       *
       * // The `_.property` iteratee shorthand.
       * _.groupBy(['one', 'two', 'three'], 'length');
       * // => { '3': ['one', 'two'], '5': ['three'] }
       */
      var groupBy = createAggregator(function(result, value, key) {
        if (hasOwnProperty.call(result, key)) {
          result[key].push(value);
        } else {
          baseAssignValue(result, key, [value]);
        }
      });

      /**
       * Checks if `value` is in `collection`. If `collection` is a string, it's
       * checked for a substring of `value`, otherwise
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * is used for equality comparisons. If `fromIndex` is negative, it's used as
       * the offset from the end of `collection`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object|string} collection The collection to inspect.
       * @param {*} value The value to search for.
       * @param {number} [fromIndex=0] The index to search from.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.
       * @returns {boolean} Returns `true` if `value` is found, else `false`.
       * @example
       *
       * _.includes([1, 2, 3], 1);
       * // => true
       *
       * _.includes([1, 2, 3], 1, 2);
       * // => false
       *
       * _.includes({ 'a': 1, 'b': 2 }, 1);
       * // => true
       *
       * _.includes('abcd', 'bc');
       * // => true
       */
      function includes(collection, value, fromIndex, guard) {
        collection = isArrayLike(collection) ? collection : values(collection);
        fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;

        var length = collection.length;
        if (fromIndex < 0) {
          fromIndex = nativeMax(length + fromIndex, 0);
        }
        return isString(collection)
          ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)
          : (!!length && baseIndexOf(collection, value, fromIndex) > -1);
      }

      /**
       * Invokes the method at `path` of each element in `collection`, returning
       * an array of the results of each invoked method. Any additional arguments
       * are provided to each invoked method. If `path` is a function, it's invoked
       * for, and `this` bound to, each element in `collection`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Array|Function|string} path The path of the method to invoke or
       *  the function invoked per iteration.
       * @param {...*} [args] The arguments to invoke each method with.
       * @returns {Array} Returns the array of results.
       * @example
       *
       * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');
       * // => [[1, 5, 7], [1, 2, 3]]
       *
       * _.invokeMap([123, 456], String.prototype.split, '');
       * // => [['1', '2', '3'], ['4', '5', '6']]
       */
      var invokeMap = baseRest(function(collection, path, args) {
        var index = -1,
            isFunc = typeof path == 'function',
            result = isArrayLike(collection) ? Array(collection.length) : [];

        baseEach(collection, function(value) {
          result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);
        });
        return result;
      });

      /**
       * Creates an object composed of keys generated from the results of running
       * each element of `collection` thru `iteratee`. The corresponding value of
       * each key is the last element responsible for generating the key. The
       * iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee to transform keys.
       * @returns {Object} Returns the composed aggregate object.
       * @example
       *
       * var array = [
       *   { 'dir': 'left', 'code': 97 },
       *   { 'dir': 'right', 'code': 100 }
       * ];
       *
       * _.keyBy(array, function(o) {
       *   return String.fromCharCode(o.code);
       * });
       * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }
       *
       * _.keyBy(array, 'dir');
       * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }
       */
      var keyBy = createAggregator(function(result, value, key) {
        baseAssignValue(result, key, value);
      });

      /**
       * Creates an array of values by running each element in `collection` thru
       * `iteratee`. The iteratee is invoked with three arguments:
       * (value, index|key, collection).
       *
       * Many lodash methods are guarded to work as iteratees for methods like
       * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.
       *
       * The guarded methods are:
       * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,
       * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,
       * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,
       * `template`, `trim`, `trimEnd`, `trimStart`, and `words`
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new mapped array.
       * @example
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * _.map([4, 8], square);
       * // => [16, 64]
       *
       * _.map({ 'a': 4, 'b': 8 }, square);
       * // => [16, 64] (iteration order is not guaranteed)
       *
       * var users = [
       *   { 'user': 'barney' },
       *   { 'user': 'fred' }
       * ];
       *
       * // The `_.property` iteratee shorthand.
       * _.map(users, 'user');
       * // => ['barney', 'fred']
       */
      function map(collection, iteratee) {
        var func = isArray(collection) ? arrayMap : baseMap;
        return func(collection, getIteratee(iteratee, 3));
      }

      /**
       * This method is like `_.sortBy` except that it allows specifying the sort
       * orders of the iteratees to sort by. If `orders` is unspecified, all values
       * are sorted in ascending order. Otherwise, specify an order of "desc" for
       * descending or "asc" for ascending sort order of corresponding values.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]
       *  The iteratees to sort by.
       * @param {string[]} [orders] The sort orders of `iteratees`.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.
       * @returns {Array} Returns the new sorted array.
       * @example
       *
       * var users = [
       *   { 'user': 'fred',   'age': 48 },
       *   { 'user': 'barney', 'age': 34 },
       *   { 'user': 'fred',   'age': 40 },
       *   { 'user': 'barney', 'age': 36 }
       * ];
       *
       * // Sort by `user` in ascending order and by `age` in descending order.
       * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);
       * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]
       */
      function orderBy(collection, iteratees, orders, guard) {
        if (collection == null) {
          return [];
        }
        if (!isArray(iteratees)) {
          iteratees = iteratees == null ? [] : [iteratees];
        }
        orders = guard ? undefined$1 : orders;
        if (!isArray(orders)) {
          orders = orders == null ? [] : [orders];
        }
        return baseOrderBy(collection, iteratees, orders);
      }

      /**
       * Creates an array of elements split into two groups, the first of which
       * contains elements `predicate` returns truthy for, the second of which
       * contains elements `predicate` returns falsey for. The predicate is
       * invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the array of grouped elements.
       * @example
       *
       * var users = [
       *   { 'user': 'barney',  'age': 36, 'active': false },
       *   { 'user': 'fred',    'age': 40, 'active': true },
       *   { 'user': 'pebbles', 'age': 1,  'active': false }
       * ];
       *
       * _.partition(users, function(o) { return o.active; });
       * // => objects for [['fred'], ['barney', 'pebbles']]
       *
       * // The `_.matches` iteratee shorthand.
       * _.partition(users, { 'age': 1, 'active': false });
       * // => objects for [['pebbles'], ['barney', 'fred']]
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.partition(users, ['active', false]);
       * // => objects for [['barney', 'pebbles'], ['fred']]
       *
       * // The `_.property` iteratee shorthand.
       * _.partition(users, 'active');
       * // => objects for [['fred'], ['barney', 'pebbles']]
       */
      var partition = createAggregator(function(result, value, key) {
        result[key ? 0 : 1].push(value);
      }, function() { return [[], []]; });

      /**
       * Reduces `collection` to a value which is the accumulated result of running
       * each element in `collection` thru `iteratee`, where each successive
       * invocation is supplied the return value of the previous. If `accumulator`
       * is not given, the first element of `collection` is used as the initial
       * value. The iteratee is invoked with four arguments:
       * (accumulator, value, index|key, collection).
       *
       * Many lodash methods are guarded to work as iteratees for methods like
       * `_.reduce`, `_.reduceRight`, and `_.transform`.
       *
       * The guarded methods are:
       * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,
       * and `sortBy`
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @param {*} [accumulator] The initial value.
       * @returns {*} Returns the accumulated value.
       * @see _.reduceRight
       * @example
       *
       * _.reduce([1, 2], function(sum, n) {
       *   return sum + n;
       * }, 0);
       * // => 3
       *
       * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {
       *   (result[value] || (result[value] = [])).push(key);
       *   return result;
       * }, {});
       * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)
       */
      function reduce(collection, iteratee, accumulator) {
        var func = isArray(collection) ? arrayReduce : baseReduce,
            initAccum = arguments.length < 3;

        return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);
      }

      /**
       * This method is like `_.reduce` except that it iterates over elements of
       * `collection` from right to left.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @param {*} [accumulator] The initial value.
       * @returns {*} Returns the accumulated value.
       * @see _.reduce
       * @example
       *
       * var array = [[0, 1], [2, 3], [4, 5]];
       *
       * _.reduceRight(array, function(flattened, other) {
       *   return flattened.concat(other);
       * }, []);
       * // => [4, 5, 2, 3, 0, 1]
       */
      function reduceRight(collection, iteratee, accumulator) {
        var func = isArray(collection) ? arrayReduceRight : baseReduce,
            initAccum = arguments.length < 3;

        return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);
      }

      /**
       * The opposite of `_.filter`; this method returns the elements of `collection`
       * that `predicate` does **not** return truthy for.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the new filtered array.
       * @see _.filter
       * @example
       *
       * var users = [
       *   { 'user': 'barney', 'age': 36, 'active': false },
       *   { 'user': 'fred',   'age': 40, 'active': true }
       * ];
       *
       * _.reject(users, function(o) { return !o.active; });
       * // => objects for ['fred']
       *
       * // The `_.matches` iteratee shorthand.
       * _.reject(users, { 'age': 40, 'active': true });
       * // => objects for ['barney']
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.reject(users, ['active', false]);
       * // => objects for ['fred']
       *
       * // The `_.property` iteratee shorthand.
       * _.reject(users, 'active');
       * // => objects for ['barney']
       */
      function reject(collection, predicate) {
        var func = isArray(collection) ? arrayFilter : baseFilter;
        return func(collection, negate(getIteratee(predicate, 3)));
      }

      /**
       * Gets a random element from `collection`.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to sample.
       * @returns {*} Returns the random element.
       * @example
       *
       * _.sample([1, 2, 3, 4]);
       * // => 2
       */
      function sample(collection) {
        var func = isArray(collection) ? arraySample : baseSample;
        return func(collection);
      }

      /**
       * Gets `n` random elements at unique keys from `collection` up to the
       * size of `collection`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Collection
       * @param {Array|Object} collection The collection to sample.
       * @param {number} [n=1] The number of elements to sample.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the random elements.
       * @example
       *
       * _.sampleSize([1, 2, 3], 2);
       * // => [3, 1]
       *
       * _.sampleSize([1, 2, 3], 4);
       * // => [2, 3, 1]
       */
      function sampleSize(collection, n, guard) {
        if ((guard ? isIterateeCall(collection, n, guard) : n === undefined$1)) {
          n = 1;
        } else {
          n = toInteger(n);
        }
        var func = isArray(collection) ? arraySampleSize : baseSampleSize;
        return func(collection, n);
      }

      /**
       * Creates an array of shuffled values, using a version of the
       * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to shuffle.
       * @returns {Array} Returns the new shuffled array.
       * @example
       *
       * _.shuffle([1, 2, 3, 4]);
       * // => [4, 1, 3, 2]
       */
      function shuffle(collection) {
        var func = isArray(collection) ? arrayShuffle : baseShuffle;
        return func(collection);
      }

      /**
       * Gets the size of `collection` by returning its length for array-like
       * values or the number of own enumerable string keyed properties for objects.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object|string} collection The collection to inspect.
       * @returns {number} Returns the collection size.
       * @example
       *
       * _.size([1, 2, 3]);
       * // => 3
       *
       * _.size({ 'a': 1, 'b': 2 });
       * // => 2
       *
       * _.size('pebbles');
       * // => 7
       */
      function size(collection) {
        if (collection == null) {
          return 0;
        }
        if (isArrayLike(collection)) {
          return isString(collection) ? stringSize(collection) : collection.length;
        }
        var tag = getTag(collection);
        if (tag == mapTag || tag == setTag) {
          return collection.size;
        }
        return baseKeys(collection).length;
      }

      /**
       * Checks if `predicate` returns truthy for **any** element of `collection`.
       * Iteration is stopped once `predicate` returns truthy. The predicate is
       * invoked with three arguments: (value, index|key, collection).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {boolean} Returns `true` if any element passes the predicate check,
       *  else `false`.
       * @example
       *
       * _.some([null, 0, 'yes', false], Boolean);
       * // => true
       *
       * var users = [
       *   { 'user': 'barney', 'active': true },
       *   { 'user': 'fred',   'active': false }
       * ];
       *
       * // The `_.matches` iteratee shorthand.
       * _.some(users, { 'user': 'barney', 'active': false });
       * // => false
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.some(users, ['active', false]);
       * // => true
       *
       * // The `_.property` iteratee shorthand.
       * _.some(users, 'active');
       * // => true
       */
      function some(collection, predicate, guard) {
        var func = isArray(collection) ? arraySome : baseSome;
        if (guard && isIterateeCall(collection, predicate, guard)) {
          predicate = undefined$1;
        }
        return func(collection, getIteratee(predicate, 3));
      }

      /**
       * Creates an array of elements, sorted in ascending order by the results of
       * running each element in a collection thru each iteratee. This method
       * performs a stable sort, that is, it preserves the original sort order of
       * equal elements. The iteratees are invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Collection
       * @param {Array|Object} collection The collection to iterate over.
       * @param {...(Function|Function[])} [iteratees=[_.identity]]
       *  The iteratees to sort by.
       * @returns {Array} Returns the new sorted array.
       * @example
       *
       * var users = [
       *   { 'user': 'fred',   'age': 48 },
       *   { 'user': 'barney', 'age': 36 },
       *   { 'user': 'fred',   'age': 30 },
       *   { 'user': 'barney', 'age': 34 }
       * ];
       *
       * _.sortBy(users, [function(o) { return o.user; }]);
       * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]
       *
       * _.sortBy(users, ['user', 'age']);
       * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]
       */
      var sortBy = baseRest(function(collection, iteratees) {
        if (collection == null) {
          return [];
        }
        var length = iteratees.length;
        if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {
          iteratees = [];
        } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {
          iteratees = [iteratees[0]];
        }
        return baseOrderBy(collection, baseFlatten(iteratees, 1), []);
      });

      /*------------------------------------------------------------------------*/

      /**
       * Gets the timestamp of the number of milliseconds that have elapsed since
       * the Unix epoch (1 January 1970 00:00:00 UTC).
       *
       * @static
       * @memberOf _
       * @since 2.4.0
       * @category Date
       * @returns {number} Returns the timestamp.
       * @example
       *
       * _.defer(function(stamp) {
       *   console.log(_.now() - stamp);
       * }, _.now());
       * // => Logs the number of milliseconds it took for the deferred invocation.
       */
      var now = ctxNow || function() {
        return root.Date.now();
      };

      /*------------------------------------------------------------------------*/

      /**
       * The opposite of `_.before`; this method creates a function that invokes
       * `func` once it's called `n` or more times.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {number} n The number of calls before `func` is invoked.
       * @param {Function} func The function to restrict.
       * @returns {Function} Returns the new restricted function.
       * @example
       *
       * var saves = ['profile', 'settings'];
       *
       * var done = _.after(saves.length, function() {
       *   console.log('done saving!');
       * });
       *
       * _.forEach(saves, function(type) {
       *   asyncSave({ 'type': type, 'complete': done });
       * });
       * // => Logs 'done saving!' after the two async saves have completed.
       */
      function after(n, func) {
        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        n = toInteger(n);
        return function() {
          if (--n < 1) {
            return func.apply(this, arguments);
          }
        };
      }

      /**
       * Creates a function that invokes `func`, with up to `n` arguments,
       * ignoring any additional arguments.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Function
       * @param {Function} func The function to cap arguments for.
       * @param {number} [n=func.length] The arity cap.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Function} Returns the new capped function.
       * @example
       *
       * _.map(['6', '8', '10'], _.ary(parseInt, 1));
       * // => [6, 8, 10]
       */
      function ary(func, n, guard) {
        n = guard ? undefined$1 : n;
        n = (func && n == null) ? func.length : n;
        return createWrap(func, WRAP_ARY_FLAG, undefined$1, undefined$1, undefined$1, undefined$1, n);
      }

      /**
       * Creates a function that invokes `func`, with the `this` binding and arguments
       * of the created function, while it's called less than `n` times. Subsequent
       * calls to the created function return the result of the last `func` invocation.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Function
       * @param {number} n The number of calls at which `func` is no longer invoked.
       * @param {Function} func The function to restrict.
       * @returns {Function} Returns the new restricted function.
       * @example
       *
       * jQuery(element).on('click', _.before(5, addContactToList));
       * // => Allows adding up to 4 contacts to the list.
       */
      function before(n, func) {
        var result;
        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        n = toInteger(n);
        return function() {
          if (--n > 0) {
            result = func.apply(this, arguments);
          }
          if (n <= 1) {
            func = undefined$1;
          }
          return result;
        };
      }

      /**
       * Creates a function that invokes `func` with the `this` binding of `thisArg`
       * and `partials` prepended to the arguments it receives.
       *
       * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,
       * may be used as a placeholder for partially applied arguments.
       *
       * **Note:** Unlike native `Function#bind`, this method doesn't set the "length"
       * property of bound functions.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to bind.
       * @param {*} thisArg The `this` binding of `func`.
       * @param {...*} [partials] The arguments to be partially applied.
       * @returns {Function} Returns the new bound function.
       * @example
       *
       * function greet(greeting, punctuation) {
       *   return greeting + ' ' + this.user + punctuation;
       * }
       *
       * var object = { 'user': 'fred' };
       *
       * var bound = _.bind(greet, object, 'hi');
       * bound('!');
       * // => 'hi fred!'
       *
       * // Bound with placeholders.
       * var bound = _.bind(greet, object, _, '!');
       * bound('hi');
       * // => 'hi fred!'
       */
      var bind = baseRest(function(func, thisArg, partials) {
        var bitmask = WRAP_BIND_FLAG;
        if (partials.length) {
          var holders = replaceHolders(partials, getHolder(bind));
          bitmask |= WRAP_PARTIAL_FLAG;
        }
        return createWrap(func, bitmask, thisArg, partials, holders);
      });

      /**
       * Creates a function that invokes the method at `object[key]` with `partials`
       * prepended to the arguments it receives.
       *
       * This method differs from `_.bind` by allowing bound functions to reference
       * methods that may be redefined or don't yet exist. See
       * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)
       * for more details.
       *
       * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic
       * builds, may be used as a placeholder for partially applied arguments.
       *
       * @static
       * @memberOf _
       * @since 0.10.0
       * @category Function
       * @param {Object} object The object to invoke the method on.
       * @param {string} key The key of the method.
       * @param {...*} [partials] The arguments to be partially applied.
       * @returns {Function} Returns the new bound function.
       * @example
       *
       * var object = {
       *   'user': 'fred',
       *   'greet': function(greeting, punctuation) {
       *     return greeting + ' ' + this.user + punctuation;
       *   }
       * };
       *
       * var bound = _.bindKey(object, 'greet', 'hi');
       * bound('!');
       * // => 'hi fred!'
       *
       * object.greet = function(greeting, punctuation) {
       *   return greeting + 'ya ' + this.user + punctuation;
       * };
       *
       * bound('!');
       * // => 'hiya fred!'
       *
       * // Bound with placeholders.
       * var bound = _.bindKey(object, 'greet', _, '!');
       * bound('hi');
       * // => 'hiya fred!'
       */
      var bindKey = baseRest(function(object, key, partials) {
        var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;
        if (partials.length) {
          var holders = replaceHolders(partials, getHolder(bindKey));
          bitmask |= WRAP_PARTIAL_FLAG;
        }
        return createWrap(key, bitmask, object, partials, holders);
      });

      /**
       * Creates a function that accepts arguments of `func` and either invokes
       * `func` returning its result, if at least `arity` number of arguments have
       * been provided, or returns a function that accepts the remaining `func`
       * arguments, and so on. The arity of `func` may be specified if `func.length`
       * is not sufficient.
       *
       * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,
       * may be used as a placeholder for provided arguments.
       *
       * **Note:** This method doesn't set the "length" property of curried functions.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Function
       * @param {Function} func The function to curry.
       * @param {number} [arity=func.length] The arity of `func`.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Function} Returns the new curried function.
       * @example
       *
       * var abc = function(a, b, c) {
       *   return [a, b, c];
       * };
       *
       * var curried = _.curry(abc);
       *
       * curried(1)(2)(3);
       * // => [1, 2, 3]
       *
       * curried(1, 2)(3);
       * // => [1, 2, 3]
       *
       * curried(1, 2, 3);
       * // => [1, 2, 3]
       *
       * // Curried with placeholders.
       * curried(1)(_, 3)(2);
       * // => [1, 2, 3]
       */
      function curry(func, arity, guard) {
        arity = guard ? undefined$1 : arity;
        var result = createWrap(func, WRAP_CURRY_FLAG, undefined$1, undefined$1, undefined$1, undefined$1, undefined$1, arity);
        result.placeholder = curry.placeholder;
        return result;
      }

      /**
       * This method is like `_.curry` except that arguments are applied to `func`
       * in the manner of `_.partialRight` instead of `_.partial`.
       *
       * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic
       * builds, may be used as a placeholder for provided arguments.
       *
       * **Note:** This method doesn't set the "length" property of curried functions.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Function
       * @param {Function} func The function to curry.
       * @param {number} [arity=func.length] The arity of `func`.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Function} Returns the new curried function.
       * @example
       *
       * var abc = function(a, b, c) {
       *   return [a, b, c];
       * };
       *
       * var curried = _.curryRight(abc);
       *
       * curried(3)(2)(1);
       * // => [1, 2, 3]
       *
       * curried(2, 3)(1);
       * // => [1, 2, 3]
       *
       * curried(1, 2, 3);
       * // => [1, 2, 3]
       *
       * // Curried with placeholders.
       * curried(3)(1, _)(2);
       * // => [1, 2, 3]
       */
      function curryRight(func, arity, guard) {
        arity = guard ? undefined$1 : arity;
        var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined$1, undefined$1, undefined$1, undefined$1, undefined$1, arity);
        result.placeholder = curryRight.placeholder;
        return result;
      }

      /**
       * Creates a debounced function that delays invoking `func` until after `wait`
       * milliseconds have elapsed since the last time the debounced function was
       * invoked. The debounced function comes with a `cancel` method to cancel
       * delayed `func` invocations and a `flush` method to immediately invoke them.
       * Provide `options` to indicate whether `func` should be invoked on the
       * leading and/or trailing edge of the `wait` timeout. The `func` is invoked
       * with the last arguments provided to the debounced function. Subsequent
       * calls to the debounced function return the result of the last `func`
       * invocation.
       *
       * **Note:** If `leading` and `trailing` options are `true`, `func` is
       * invoked on the trailing edge of the timeout only if the debounced function
       * is invoked more than once during the `wait` timeout.
       *
       * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
       * until to the next tick, similar to `setTimeout` with a timeout of `0`.
       *
       * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
       * for details over the differences between `_.debounce` and `_.throttle`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to debounce.
       * @param {number} [wait=0] The number of milliseconds to delay.
       * @param {Object} [options={}] The options object.
       * @param {boolean} [options.leading=false]
       *  Specify invoking on the leading edge of the timeout.
       * @param {number} [options.maxWait]
       *  The maximum time `func` is allowed to be delayed before it's invoked.
       * @param {boolean} [options.trailing=true]
       *  Specify invoking on the trailing edge of the timeout.
       * @returns {Function} Returns the new debounced function.
       * @example
       *
       * // Avoid costly calculations while the window size is in flux.
       * jQuery(window).on('resize', _.debounce(calculateLayout, 150));
       *
       * // Invoke `sendMail` when clicked, debouncing subsequent calls.
       * jQuery(element).on('click', _.debounce(sendMail, 300, {
       *   'leading': true,
       *   'trailing': false
       * }));
       *
       * // Ensure `batchLog` is invoked once after 1 second of debounced calls.
       * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });
       * var source = new EventSource('/stream');
       * jQuery(source).on('message', debounced);
       *
       * // Cancel the trailing debounced invocation.
       * jQuery(window).on('popstate', debounced.cancel);
       */
      function debounce(func, wait, options) {
        var lastArgs,
            lastThis,
            maxWait,
            result,
            timerId,
            lastCallTime,
            lastInvokeTime = 0,
            leading = false,
            maxing = false,
            trailing = true;

        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        wait = toNumber(wait) || 0;
        if (isObject(options)) {
          leading = !!options.leading;
          maxing = 'maxWait' in options;
          maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;
          trailing = 'trailing' in options ? !!options.trailing : trailing;
        }

        function invokeFunc(time) {
          var args = lastArgs,
              thisArg = lastThis;

          lastArgs = lastThis = undefined$1;
          lastInvokeTime = time;
          result = func.apply(thisArg, args);
          return result;
        }

        function leadingEdge(time) {
          // Reset any `maxWait` timer.
          lastInvokeTime = time;
          // Start the timer for the trailing edge.
          timerId = setTimeout(timerExpired, wait);
          // Invoke the leading edge.
          return leading ? invokeFunc(time) : result;
        }

        function remainingWait(time) {
          var timeSinceLastCall = time - lastCallTime,
              timeSinceLastInvoke = time - lastInvokeTime,
              timeWaiting = wait - timeSinceLastCall;

          return maxing
            ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)
            : timeWaiting;
        }

        function shouldInvoke(time) {
          var timeSinceLastCall = time - lastCallTime,
              timeSinceLastInvoke = time - lastInvokeTime;

          // Either this is the first call, activity has stopped and we're at the
          // trailing edge, the system time has gone backwards and we're treating
          // it as the trailing edge, or we've hit the `maxWait` limit.
          return (lastCallTime === undefined$1 || (timeSinceLastCall >= wait) ||
            (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));
        }

        function timerExpired() {
          var time = now();
          if (shouldInvoke(time)) {
            return trailingEdge(time);
          }
          // Restart the timer.
          timerId = setTimeout(timerExpired, remainingWait(time));
        }

        function trailingEdge(time) {
          timerId = undefined$1;

          // Only invoke if we have `lastArgs` which means `func` has been
          // debounced at least once.
          if (trailing && lastArgs) {
            return invokeFunc(time);
          }
          lastArgs = lastThis = undefined$1;
          return result;
        }

        function cancel() {
          if (timerId !== undefined$1) {
            clearTimeout(timerId);
          }
          lastInvokeTime = 0;
          lastArgs = lastCallTime = lastThis = timerId = undefined$1;
        }

        function flush() {
          return timerId === undefined$1 ? result : trailingEdge(now());
        }

        function debounced() {
          var time = now(),
              isInvoking = shouldInvoke(time);

          lastArgs = arguments;
          lastThis = this;
          lastCallTime = time;

          if (isInvoking) {
            if (timerId === undefined$1) {
              return leadingEdge(lastCallTime);
            }
            if (maxing) {
              // Handle invocations in a tight loop.
              clearTimeout(timerId);
              timerId = setTimeout(timerExpired, wait);
              return invokeFunc(lastCallTime);
            }
          }
          if (timerId === undefined$1) {
            timerId = setTimeout(timerExpired, wait);
          }
          return result;
        }
        debounced.cancel = cancel;
        debounced.flush = flush;
        return debounced;
      }

      /**
       * Defers invoking the `func` until the current call stack has cleared. Any
       * additional arguments are provided to `func` when it's invoked.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to defer.
       * @param {...*} [args] The arguments to invoke `func` with.
       * @returns {number} Returns the timer id.
       * @example
       *
       * _.defer(function(text) {
       *   console.log(text);
       * }, 'deferred');
       * // => Logs 'deferred' after one millisecond.
       */
      var defer = baseRest(function(func, args) {
        return baseDelay(func, 1, args);
      });

      /**
       * Invokes `func` after `wait` milliseconds. Any additional arguments are
       * provided to `func` when it's invoked.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to delay.
       * @param {number} wait The number of milliseconds to delay invocation.
       * @param {...*} [args] The arguments to invoke `func` with.
       * @returns {number} Returns the timer id.
       * @example
       *
       * _.delay(function(text) {
       *   console.log(text);
       * }, 1000, 'later');
       * // => Logs 'later' after one second.
       */
      var delay = baseRest(function(func, wait, args) {
        return baseDelay(func, toNumber(wait) || 0, args);
      });

      /**
       * Creates a function that invokes `func` with arguments reversed.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Function
       * @param {Function} func The function to flip arguments for.
       * @returns {Function} Returns the new flipped function.
       * @example
       *
       * var flipped = _.flip(function() {
       *   return _.toArray(arguments);
       * });
       *
       * flipped('a', 'b', 'c', 'd');
       * // => ['d', 'c', 'b', 'a']
       */
      function flip(func) {
        return createWrap(func, WRAP_FLIP_FLAG);
      }

      /**
       * Creates a function that memoizes the result of `func`. If `resolver` is
       * provided, it determines the cache key for storing the result based on the
       * arguments provided to the memoized function. By default, the first argument
       * provided to the memoized function is used as the map cache key. The `func`
       * is invoked with the `this` binding of the memoized function.
       *
       * **Note:** The cache is exposed as the `cache` property on the memoized
       * function. Its creation may be customized by replacing the `_.memoize.Cache`
       * constructor with one whose instances implement the
       * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)
       * method interface of `clear`, `delete`, `get`, `has`, and `set`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to have its output memoized.
       * @param {Function} [resolver] The function to resolve the cache key.
       * @returns {Function} Returns the new memoized function.
       * @example
       *
       * var object = { 'a': 1, 'b': 2 };
       * var other = { 'c': 3, 'd': 4 };
       *
       * var values = _.memoize(_.values);
       * values(object);
       * // => [1, 2]
       *
       * values(other);
       * // => [3, 4]
       *
       * object.a = 2;
       * values(object);
       * // => [1, 2]
       *
       * // Modify the result cache.
       * values.cache.set(object, ['a', 'b']);
       * values(object);
       * // => ['a', 'b']
       *
       * // Replace `_.memoize.Cache`.
       * _.memoize.Cache = WeakMap;
       */
      function memoize(func, resolver) {
        if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        var memoized = function() {
          var args = arguments,
              key = resolver ? resolver.apply(this, args) : args[0],
              cache = memoized.cache;

          if (cache.has(key)) {
            return cache.get(key);
          }
          var result = func.apply(this, args);
          memoized.cache = cache.set(key, result) || cache;
          return result;
        };
        memoized.cache = new (memoize.Cache || MapCache);
        return memoized;
      }

      // Expose `MapCache`.
      memoize.Cache = MapCache;

      /**
       * Creates a function that negates the result of the predicate `func`. The
       * `func` predicate is invoked with the `this` binding and arguments of the
       * created function.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Function
       * @param {Function} predicate The predicate to negate.
       * @returns {Function} Returns the new negated function.
       * @example
       *
       * function isEven(n) {
       *   return n % 2 == 0;
       * }
       *
       * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));
       * // => [1, 3, 5]
       */
      function negate(predicate) {
        if (typeof predicate != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        return function() {
          var args = arguments;
          switch (args.length) {
            case 0: return !predicate.call(this);
            case 1: return !predicate.call(this, args[0]);
            case 2: return !predicate.call(this, args[0], args[1]);
            case 3: return !predicate.call(this, args[0], args[1], args[2]);
          }
          return !predicate.apply(this, args);
        };
      }

      /**
       * Creates a function that is restricted to invoking `func` once. Repeat calls
       * to the function return the value of the first invocation. The `func` is
       * invoked with the `this` binding and arguments of the created function.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to restrict.
       * @returns {Function} Returns the new restricted function.
       * @example
       *
       * var initialize = _.once(createApplication);
       * initialize();
       * initialize();
       * // => `createApplication` is invoked once
       */
      function once(func) {
        return before(2, func);
      }

      /**
       * Creates a function that invokes `func` with its arguments transformed.
       *
       * @static
       * @since 4.0.0
       * @memberOf _
       * @category Function
       * @param {Function} func The function to wrap.
       * @param {...(Function|Function[])} [transforms=[_.identity]]
       *  The argument transforms.
       * @returns {Function} Returns the new function.
       * @example
       *
       * function doubled(n) {
       *   return n * 2;
       * }
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * var func = _.overArgs(function(x, y) {
       *   return [x, y];
       * }, [square, doubled]);
       *
       * func(9, 3);
       * // => [81, 6]
       *
       * func(10, 5);
       * // => [100, 10]
       */
      var overArgs = castRest(function(func, transforms) {
        transforms = (transforms.length == 1 && isArray(transforms[0]))
          ? arrayMap(transforms[0], baseUnary(getIteratee()))
          : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));

        var funcsLength = transforms.length;
        return baseRest(function(args) {
          var index = -1,
              length = nativeMin(args.length, funcsLength);

          while (++index < length) {
            args[index] = transforms[index].call(this, args[index]);
          }
          return apply(func, this, args);
        });
      });

      /**
       * Creates a function that invokes `func` with `partials` prepended to the
       * arguments it receives. This method is like `_.bind` except it does **not**
       * alter the `this` binding.
       *
       * The `_.partial.placeholder` value, which defaults to `_` in monolithic
       * builds, may be used as a placeholder for partially applied arguments.
       *
       * **Note:** This method doesn't set the "length" property of partially
       * applied functions.
       *
       * @static
       * @memberOf _
       * @since 0.2.0
       * @category Function
       * @param {Function} func The function to partially apply arguments to.
       * @param {...*} [partials] The arguments to be partially applied.
       * @returns {Function} Returns the new partially applied function.
       * @example
       *
       * function greet(greeting, name) {
       *   return greeting + ' ' + name;
       * }
       *
       * var sayHelloTo = _.partial(greet, 'hello');
       * sayHelloTo('fred');
       * // => 'hello fred'
       *
       * // Partially applied with placeholders.
       * var greetFred = _.partial(greet, _, 'fred');
       * greetFred('hi');
       * // => 'hi fred'
       */
      var partial = baseRest(function(func, partials) {
        var holders = replaceHolders(partials, getHolder(partial));
        return createWrap(func, WRAP_PARTIAL_FLAG, undefined$1, partials, holders);
      });

      /**
       * This method is like `_.partial` except that partially applied arguments
       * are appended to the arguments it receives.
       *
       * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic
       * builds, may be used as a placeholder for partially applied arguments.
       *
       * **Note:** This method doesn't set the "length" property of partially
       * applied functions.
       *
       * @static
       * @memberOf _
       * @since 1.0.0
       * @category Function
       * @param {Function} func The function to partially apply arguments to.
       * @param {...*} [partials] The arguments to be partially applied.
       * @returns {Function} Returns the new partially applied function.
       * @example
       *
       * function greet(greeting, name) {
       *   return greeting + ' ' + name;
       * }
       *
       * var greetFred = _.partialRight(greet, 'fred');
       * greetFred('hi');
       * // => 'hi fred'
       *
       * // Partially applied with placeholders.
       * var sayHelloTo = _.partialRight(greet, 'hello', _);
       * sayHelloTo('fred');
       * // => 'hello fred'
       */
      var partialRight = baseRest(function(func, partials) {
        var holders = replaceHolders(partials, getHolder(partialRight));
        return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined$1, partials, holders);
      });

      /**
       * Creates a function that invokes `func` with arguments arranged according
       * to the specified `indexes` where the argument value at the first index is
       * provided as the first argument, the argument value at the second index is
       * provided as the second argument, and so on.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Function
       * @param {Function} func The function to rearrange arguments for.
       * @param {...(number|number[])} indexes The arranged argument indexes.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var rearged = _.rearg(function(a, b, c) {
       *   return [a, b, c];
       * }, [2, 0, 1]);
       *
       * rearged('b', 'c', 'a')
       * // => ['a', 'b', 'c']
       */
      var rearg = flatRest(function(func, indexes) {
        return createWrap(func, WRAP_REARG_FLAG, undefined$1, undefined$1, undefined$1, indexes);
      });

      /**
       * Creates a function that invokes `func` with the `this` binding of the
       * created function and arguments from `start` and beyond provided as
       * an array.
       *
       * **Note:** This method is based on the
       * [rest parameter](https://mdn.io/rest_parameters).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Function
       * @param {Function} func The function to apply a rest parameter to.
       * @param {number} [start=func.length-1] The start position of the rest parameter.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var say = _.rest(function(what, names) {
       *   return what + ' ' + _.initial(names).join(', ') +
       *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);
       * });
       *
       * say('hello', 'fred', 'barney', 'pebbles');
       * // => 'hello fred, barney, & pebbles'
       */
      function rest(func, start) {
        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        start = start === undefined$1 ? start : toInteger(start);
        return baseRest(func, start);
      }

      /**
       * Creates a function that invokes `func` with the `this` binding of the
       * create function and an array of arguments much like
       * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).
       *
       * **Note:** This method is based on the
       * [spread operator](https://mdn.io/spread_operator).
       *
       * @static
       * @memberOf _
       * @since 3.2.0
       * @category Function
       * @param {Function} func The function to spread arguments over.
       * @param {number} [start=0] The start position of the spread.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var say = _.spread(function(who, what) {
       *   return who + ' says ' + what;
       * });
       *
       * say(['fred', 'hello']);
       * // => 'fred says hello'
       *
       * var numbers = Promise.all([
       *   Promise.resolve(40),
       *   Promise.resolve(36)
       * ]);
       *
       * numbers.then(_.spread(function(x, y) {
       *   return x + y;
       * }));
       * // => a Promise of 76
       */
      function spread(func, start) {
        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        start = start == null ? 0 : nativeMax(toInteger(start), 0);
        return baseRest(function(args) {
          var array = args[start],
              otherArgs = castSlice(args, 0, start);

          if (array) {
            arrayPush(otherArgs, array);
          }
          return apply(func, this, otherArgs);
        });
      }

      /**
       * Creates a throttled function that only invokes `func` at most once per
       * every `wait` milliseconds. The throttled function comes with a `cancel`
       * method to cancel delayed `func` invocations and a `flush` method to
       * immediately invoke them. Provide `options` to indicate whether `func`
       * should be invoked on the leading and/or trailing edge of the `wait`
       * timeout. The `func` is invoked with the last arguments provided to the
       * throttled function. Subsequent calls to the throttled function return the
       * result of the last `func` invocation.
       *
       * **Note:** If `leading` and `trailing` options are `true`, `func` is
       * invoked on the trailing edge of the timeout only if the throttled function
       * is invoked more than once during the `wait` timeout.
       *
       * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
       * until to the next tick, similar to `setTimeout` with a timeout of `0`.
       *
       * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
       * for details over the differences between `_.throttle` and `_.debounce`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {Function} func The function to throttle.
       * @param {number} [wait=0] The number of milliseconds to throttle invocations to.
       * @param {Object} [options={}] The options object.
       * @param {boolean} [options.leading=true]
       *  Specify invoking on the leading edge of the timeout.
       * @param {boolean} [options.trailing=true]
       *  Specify invoking on the trailing edge of the timeout.
       * @returns {Function} Returns the new throttled function.
       * @example
       *
       * // Avoid excessively updating the position while scrolling.
       * jQuery(window).on('scroll', _.throttle(updatePosition, 100));
       *
       * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.
       * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });
       * jQuery(element).on('click', throttled);
       *
       * // Cancel the trailing throttled invocation.
       * jQuery(window).on('popstate', throttled.cancel);
       */
      function throttle(func, wait, options) {
        var leading = true,
            trailing = true;

        if (typeof func != 'function') {
          throw new TypeError(FUNC_ERROR_TEXT);
        }
        if (isObject(options)) {
          leading = 'leading' in options ? !!options.leading : leading;
          trailing = 'trailing' in options ? !!options.trailing : trailing;
        }
        return debounce(func, wait, {
          'leading': leading,
          'maxWait': wait,
          'trailing': trailing
        });
      }

      /**
       * Creates a function that accepts up to one argument, ignoring any
       * additional arguments.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Function
       * @param {Function} func The function to cap arguments for.
       * @returns {Function} Returns the new capped function.
       * @example
       *
       * _.map(['6', '8', '10'], _.unary(parseInt));
       * // => [6, 8, 10]
       */
      function unary(func) {
        return ary(func, 1);
      }

      /**
       * Creates a function that provides `value` to `wrapper` as its first
       * argument. Any additional arguments provided to the function are appended
       * to those provided to the `wrapper`. The wrapper is invoked with the `this`
       * binding of the created function.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Function
       * @param {*} value The value to wrap.
       * @param {Function} [wrapper=identity] The wrapper function.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var p = _.wrap(_.escape, function(func, text) {
       *   return '<p>' + func(text) + '</p>';
       * });
       *
       * p('fred, barney, & pebbles');
       * // => '<p>fred, barney, &amp; pebbles</p>'
       */
      function wrap(value, wrapper) {
        return partial(castFunction(wrapper), value);
      }

      /*------------------------------------------------------------------------*/

      /**
       * Casts `value` as an array if it's not one.
       *
       * @static
       * @memberOf _
       * @since 4.4.0
       * @category Lang
       * @param {*} value The value to inspect.
       * @returns {Array} Returns the cast array.
       * @example
       *
       * _.castArray(1);
       * // => [1]
       *
       * _.castArray({ 'a': 1 });
       * // => [{ 'a': 1 }]
       *
       * _.castArray('abc');
       * // => ['abc']
       *
       * _.castArray(null);
       * // => [null]
       *
       * _.castArray(undefined);
       * // => [undefined]
       *
       * _.castArray();
       * // => []
       *
       * var array = [1, 2, 3];
       * console.log(_.castArray(array) === array);
       * // => true
       */
      function castArray() {
        if (!arguments.length) {
          return [];
        }
        var value = arguments[0];
        return isArray(value) ? value : [value];
      }

      /**
       * Creates a shallow clone of `value`.
       *
       * **Note:** This method is loosely based on the
       * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)
       * and supports cloning arrays, array buffers, booleans, date objects, maps,
       * numbers, `Object` objects, regexes, sets, strings, symbols, and typed
       * arrays. The own enumerable properties of `arguments` objects are cloned
       * as plain objects. An empty object is returned for uncloneable values such
       * as error objects, functions, DOM nodes, and WeakMaps.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to clone.
       * @returns {*} Returns the cloned value.
       * @see _.cloneDeep
       * @example
       *
       * var objects = [{ 'a': 1 }, { 'b': 2 }];
       *
       * var shallow = _.clone(objects);
       * console.log(shallow[0] === objects[0]);
       * // => true
       */
      function clone(value) {
        return baseClone(value, CLONE_SYMBOLS_FLAG);
      }

      /**
       * This method is like `_.clone` except that it accepts `customizer` which
       * is invoked to produce the cloned value. If `customizer` returns `undefined`,
       * cloning is handled by the method instead. The `customizer` is invoked with
       * up to four arguments; (value [, index|key, object, stack]).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to clone.
       * @param {Function} [customizer] The function to customize cloning.
       * @returns {*} Returns the cloned value.
       * @see _.cloneDeepWith
       * @example
       *
       * function customizer(value) {
       *   if (_.isElement(value)) {
       *     return value.cloneNode(false);
       *   }
       * }
       *
       * var el = _.cloneWith(document.body, customizer);
       *
       * console.log(el === document.body);
       * // => false
       * console.log(el.nodeName);
       * // => 'BODY'
       * console.log(el.childNodes.length);
       * // => 0
       */
      function cloneWith(value, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);
      }

      /**
       * This method is like `_.clone` except that it recursively clones `value`.
       *
       * @static
       * @memberOf _
       * @since 1.0.0
       * @category Lang
       * @param {*} value The value to recursively clone.
       * @returns {*} Returns the deep cloned value.
       * @see _.clone
       * @example
       *
       * var objects = [{ 'a': 1 }, { 'b': 2 }];
       *
       * var deep = _.cloneDeep(objects);
       * console.log(deep[0] === objects[0]);
       * // => false
       */
      function cloneDeep(value) {
        return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);
      }

      /**
       * This method is like `_.cloneWith` except that it recursively clones `value`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to recursively clone.
       * @param {Function} [customizer] The function to customize cloning.
       * @returns {*} Returns the deep cloned value.
       * @see _.cloneWith
       * @example
       *
       * function customizer(value) {
       *   if (_.isElement(value)) {
       *     return value.cloneNode(true);
       *   }
       * }
       *
       * var el = _.cloneDeepWith(document.body, customizer);
       *
       * console.log(el === document.body);
       * // => false
       * console.log(el.nodeName);
       * // => 'BODY'
       * console.log(el.childNodes.length);
       * // => 20
       */
      function cloneDeepWith(value, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);
      }

      /**
       * Checks if `object` conforms to `source` by invoking the predicate
       * properties of `source` with the corresponding property values of `object`.
       *
       * **Note:** This method is equivalent to `_.conforms` when `source` is
       * partially applied.
       *
       * @static
       * @memberOf _
       * @since 4.14.0
       * @category Lang
       * @param {Object} object The object to inspect.
       * @param {Object} source The object of property predicates to conform to.
       * @returns {boolean} Returns `true` if `object` conforms, else `false`.
       * @example
       *
       * var object = { 'a': 1, 'b': 2 };
       *
       * _.conformsTo(object, { 'b': function(n) { return n > 1; } });
       * // => true
       *
       * _.conformsTo(object, { 'b': function(n) { return n > 2; } });
       * // => false
       */
      function conformsTo(object, source) {
        return source == null || baseConformsTo(object, source, keys(source));
      }

      /**
       * Performs a
       * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
       * comparison between two values to determine if they are equivalent.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
       * @example
       *
       * var object = { 'a': 1 };
       * var other = { 'a': 1 };
       *
       * _.eq(object, object);
       * // => true
       *
       * _.eq(object, other);
       * // => false
       *
       * _.eq('a', 'a');
       * // => true
       *
       * _.eq('a', Object('a'));
       * // => false
       *
       * _.eq(NaN, NaN);
       * // => true
       */
      function eq(value, other) {
        return value === other || (value !== value && other !== other);
      }

      /**
       * Checks if `value` is greater than `other`.
       *
       * @static
       * @memberOf _
       * @since 3.9.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is greater than `other`,
       *  else `false`.
       * @see _.lt
       * @example
       *
       * _.gt(3, 1);
       * // => true
       *
       * _.gt(3, 3);
       * // => false
       *
       * _.gt(1, 3);
       * // => false
       */
      var gt = createRelationalOperation(baseGt);

      /**
       * Checks if `value` is greater than or equal to `other`.
       *
       * @static
       * @memberOf _
       * @since 3.9.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is greater than or equal to
       *  `other`, else `false`.
       * @see _.lte
       * @example
       *
       * _.gte(3, 1);
       * // => true
       *
       * _.gte(3, 3);
       * // => true
       *
       * _.gte(1, 3);
       * // => false
       */
      var gte = createRelationalOperation(function(value, other) {
        return value >= other;
      });

      /**
       * Checks if `value` is likely an `arguments` object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an `arguments` object,
       *  else `false`.
       * @example
       *
       * _.isArguments(function() { return arguments; }());
       * // => true
       *
       * _.isArguments([1, 2, 3]);
       * // => false
       */
      var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
        return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&
          !propertyIsEnumerable.call(value, 'callee');
      };

      /**
       * Checks if `value` is classified as an `Array` object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an array, else `false`.
       * @example
       *
       * _.isArray([1, 2, 3]);
       * // => true
       *
       * _.isArray(document.body.children);
       * // => false
       *
       * _.isArray('abc');
       * // => false
       *
       * _.isArray(_.noop);
       * // => false
       */
      var isArray = Array.isArray;

      /**
       * Checks if `value` is classified as an `ArrayBuffer` object.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.
       * @example
       *
       * _.isArrayBuffer(new ArrayBuffer(2));
       * // => true
       *
       * _.isArrayBuffer(new Array(2));
       * // => false
       */
      var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;

      /**
       * Checks if `value` is array-like. A value is considered array-like if it's
       * not a function and has a `value.length` that's an integer greater than or
       * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
       * @example
       *
       * _.isArrayLike([1, 2, 3]);
       * // => true
       *
       * _.isArrayLike(document.body.children);
       * // => true
       *
       * _.isArrayLike('abc');
       * // => true
       *
       * _.isArrayLike(_.noop);
       * // => false
       */
      function isArrayLike(value) {
        return value != null && isLength(value.length) && !isFunction(value);
      }

      /**
       * This method is like `_.isArrayLike` except that it also checks if `value`
       * is an object.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an array-like object,
       *  else `false`.
       * @example
       *
       * _.isArrayLikeObject([1, 2, 3]);
       * // => true
       *
       * _.isArrayLikeObject(document.body.children);
       * // => true
       *
       * _.isArrayLikeObject('abc');
       * // => false
       *
       * _.isArrayLikeObject(_.noop);
       * // => false
       */
      function isArrayLikeObject(value) {
        return isObjectLike(value) && isArrayLike(value);
      }

      /**
       * Checks if `value` is classified as a boolean primitive or object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.
       * @example
       *
       * _.isBoolean(false);
       * // => true
       *
       * _.isBoolean(null);
       * // => false
       */
      function isBoolean(value) {
        return value === true || value === false ||
          (isObjectLike(value) && baseGetTag(value) == boolTag);
      }

      /**
       * Checks if `value` is a buffer.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
       * @example
       *
       * _.isBuffer(new Buffer(2));
       * // => true
       *
       * _.isBuffer(new Uint8Array(2));
       * // => false
       */
      var isBuffer = nativeIsBuffer || stubFalse;

      /**
       * Checks if `value` is classified as a `Date` object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a date object, else `false`.
       * @example
       *
       * _.isDate(new Date);
       * // => true
       *
       * _.isDate('Mon April 23 2012');
       * // => false
       */
      var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;

      /**
       * Checks if `value` is likely a DOM element.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.
       * @example
       *
       * _.isElement(document.body);
       * // => true
       *
       * _.isElement('<body>');
       * // => false
       */
      function isElement(value) {
        return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);
      }

      /**
       * Checks if `value` is an empty object, collection, map, or set.
       *
       * Objects are considered empty if they have no own enumerable string keyed
       * properties.
       *
       * Array-like values such as `arguments` objects, arrays, buffers, strings, or
       * jQuery-like collections are considered empty if they have a `length` of `0`.
       * Similarly, maps and sets are considered empty if they have a `size` of `0`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is empty, else `false`.
       * @example
       *
       * _.isEmpty(null);
       * // => true
       *
       * _.isEmpty(true);
       * // => true
       *
       * _.isEmpty(1);
       * // => true
       *
       * _.isEmpty([1, 2, 3]);
       * // => false
       *
       * _.isEmpty({ 'a': 1 });
       * // => false
       */
      function isEmpty(value) {
        if (value == null) {
          return true;
        }
        if (isArrayLike(value) &&
            (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||
              isBuffer(value) || isTypedArray(value) || isArguments(value))) {
          return !value.length;
        }
        var tag = getTag(value);
        if (tag == mapTag || tag == setTag) {
          return !value.size;
        }
        if (isPrototype(value)) {
          return !baseKeys(value).length;
        }
        for (var key in value) {
          if (hasOwnProperty.call(value, key)) {
            return false;
          }
        }
        return true;
      }

      /**
       * Performs a deep comparison between two values to determine if they are
       * equivalent.
       *
       * **Note:** This method supports comparing arrays, array buffers, booleans,
       * date objects, error objects, maps, numbers, `Object` objects, regexes,
       * sets, strings, symbols, and typed arrays. `Object` objects are compared
       * by their own, not inherited, enumerable properties. Functions and DOM
       * nodes are compared by strict equality, i.e. `===`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
       * @example
       *
       * var object = { 'a': 1 };
       * var other = { 'a': 1 };
       *
       * _.isEqual(object, other);
       * // => true
       *
       * object === other;
       * // => false
       */
      function isEqual(value, other) {
        return baseIsEqual(value, other);
      }

      /**
       * This method is like `_.isEqual` except that it accepts `customizer` which
       * is invoked to compare values. If `customizer` returns `undefined`, comparisons
       * are handled by the method instead. The `customizer` is invoked with up to
       * six arguments: (objValue, othValue [, index|key, object, other, stack]).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @param {Function} [customizer] The function to customize comparisons.
       * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
       * @example
       *
       * function isGreeting(value) {
       *   return /^h(?:i|ello)$/.test(value);
       * }
       *
       * function customizer(objValue, othValue) {
       *   if (isGreeting(objValue) && isGreeting(othValue)) {
       *     return true;
       *   }
       * }
       *
       * var array = ['hello', 'goodbye'];
       * var other = ['hi', 'goodbye'];
       *
       * _.isEqualWith(array, other, customizer);
       * // => true
       */
      function isEqualWith(value, other, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        var result = customizer ? customizer(value, other) : undefined$1;
        return result === undefined$1 ? baseIsEqual(value, other, undefined$1, customizer) : !!result;
      }

      /**
       * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,
       * `SyntaxError`, `TypeError`, or `URIError` object.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an error object, else `false`.
       * @example
       *
       * _.isError(new Error);
       * // => true
       *
       * _.isError(Error);
       * // => false
       */
      function isError(value) {
        if (!isObjectLike(value)) {
          return false;
        }
        var tag = baseGetTag(value);
        return tag == errorTag || tag == domExcTag ||
          (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));
      }

      /**
       * Checks if `value` is a finite primitive number.
       *
       * **Note:** This method is based on
       * [`Number.isFinite`](https://mdn.io/Number/isFinite).
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.
       * @example
       *
       * _.isFinite(3);
       * // => true
       *
       * _.isFinite(Number.MIN_VALUE);
       * // => true
       *
       * _.isFinite(Infinity);
       * // => false
       *
       * _.isFinite('3');
       * // => false
       */
      function isFinite(value) {
        return typeof value == 'number' && nativeIsFinite(value);
      }

      /**
       * Checks if `value` is classified as a `Function` object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a function, else `false`.
       * @example
       *
       * _.isFunction(_);
       * // => true
       *
       * _.isFunction(/abc/);
       * // => false
       */
      function isFunction(value) {
        if (!isObject(value)) {
          return false;
        }
        // The use of `Object#toString` avoids issues with the `typeof` operator
        // in Safari 9 which returns 'object' for typed arrays and other constructors.
        var tag = baseGetTag(value);
        return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
      }

      /**
       * Checks if `value` is an integer.
       *
       * **Note:** This method is based on
       * [`Number.isInteger`](https://mdn.io/Number/isInteger).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an integer, else `false`.
       * @example
       *
       * _.isInteger(3);
       * // => true
       *
       * _.isInteger(Number.MIN_VALUE);
       * // => false
       *
       * _.isInteger(Infinity);
       * // => false
       *
       * _.isInteger('3');
       * // => false
       */
      function isInteger(value) {
        return typeof value == 'number' && value == toInteger(value);
      }

      /**
       * Checks if `value` is a valid array-like length.
       *
       * **Note:** This method is loosely based on
       * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
       * @example
       *
       * _.isLength(3);
       * // => true
       *
       * _.isLength(Number.MIN_VALUE);
       * // => false
       *
       * _.isLength(Infinity);
       * // => false
       *
       * _.isLength('3');
       * // => false
       */
      function isLength(value) {
        return typeof value == 'number' &&
          value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
      }

      /**
       * Checks if `value` is the
       * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
       * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is an object, else `false`.
       * @example
       *
       * _.isObject({});
       * // => true
       *
       * _.isObject([1, 2, 3]);
       * // => true
       *
       * _.isObject(_.noop);
       * // => true
       *
       * _.isObject(null);
       * // => false
       */
      function isObject(value) {
        var type = typeof value;
        return value != null && (type == 'object' || type == 'function');
      }

      /**
       * Checks if `value` is object-like. A value is object-like if it's not `null`
       * and has a `typeof` result of "object".
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
       * @example
       *
       * _.isObjectLike({});
       * // => true
       *
       * _.isObjectLike([1, 2, 3]);
       * // => true
       *
       * _.isObjectLike(_.noop);
       * // => false
       *
       * _.isObjectLike(null);
       * // => false
       */
      function isObjectLike(value) {
        return value != null && typeof value == 'object';
      }

      /**
       * Checks if `value` is classified as a `Map` object.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a map, else `false`.
       * @example
       *
       * _.isMap(new Map);
       * // => true
       *
       * _.isMap(new WeakMap);
       * // => false
       */
      var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;

      /**
       * Performs a partial deep comparison between `object` and `source` to
       * determine if `object` contains equivalent property values.
       *
       * **Note:** This method is equivalent to `_.matches` when `source` is
       * partially applied.
       *
       * Partial comparisons will match empty array and empty object `source`
       * values against any array or object value, respectively. See `_.isEqual`
       * for a list of supported value comparisons.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Lang
       * @param {Object} object The object to inspect.
       * @param {Object} source The object of property values to match.
       * @returns {boolean} Returns `true` if `object` is a match, else `false`.
       * @example
       *
       * var object = { 'a': 1, 'b': 2 };
       *
       * _.isMatch(object, { 'b': 2 });
       * // => true
       *
       * _.isMatch(object, { 'b': 1 });
       * // => false
       */
      function isMatch(object, source) {
        return object === source || baseIsMatch(object, source, getMatchData(source));
      }

      /**
       * This method is like `_.isMatch` except that it accepts `customizer` which
       * is invoked to compare values. If `customizer` returns `undefined`, comparisons
       * are handled by the method instead. The `customizer` is invoked with five
       * arguments: (objValue, srcValue, index|key, object, source).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {Object} object The object to inspect.
       * @param {Object} source The object of property values to match.
       * @param {Function} [customizer] The function to customize comparisons.
       * @returns {boolean} Returns `true` if `object` is a match, else `false`.
       * @example
       *
       * function isGreeting(value) {
       *   return /^h(?:i|ello)$/.test(value);
       * }
       *
       * function customizer(objValue, srcValue) {
       *   if (isGreeting(objValue) && isGreeting(srcValue)) {
       *     return true;
       *   }
       * }
       *
       * var object = { 'greeting': 'hello' };
       * var source = { 'greeting': 'hi' };
       *
       * _.isMatchWith(object, source, customizer);
       * // => true
       */
      function isMatchWith(object, source, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        return baseIsMatch(object, source, getMatchData(source), customizer);
      }

      /**
       * Checks if `value` is `NaN`.
       *
       * **Note:** This method is based on
       * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as
       * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for
       * `undefined` and other non-number values.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
       * @example
       *
       * _.isNaN(NaN);
       * // => true
       *
       * _.isNaN(new Number(NaN));
       * // => true
       *
       * isNaN(undefined);
       * // => true
       *
       * _.isNaN(undefined);
       * // => false
       */
      function isNaN(value) {
        // An `NaN` primitive is the only value that is not equal to itself.
        // Perform the `toStringTag` check first to avoid errors with some
        // ActiveX objects in IE.
        return isNumber(value) && value != +value;
      }

      /**
       * Checks if `value` is a pristine native function.
       *
       * **Note:** This method can't reliably detect native functions in the presence
       * of the core-js package because core-js circumvents this kind of detection.
       * Despite multiple requests, the core-js maintainer has made it clear: any
       * attempt to fix the detection will be obstructed. As a result, we're left
       * with little choice but to throw an error. Unfortunately, this also affects
       * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),
       * which rely on core-js.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a native function,
       *  else `false`.
       * @example
       *
       * _.isNative(Array.prototype.push);
       * // => true
       *
       * _.isNative(_);
       * // => false
       */
      function isNative(value) {
        if (isMaskable(value)) {
          throw new Error(CORE_ERROR_TEXT);
        }
        return baseIsNative(value);
      }

      /**
       * Checks if `value` is `null`.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is `null`, else `false`.
       * @example
       *
       * _.isNull(null);
       * // => true
       *
       * _.isNull(void 0);
       * // => false
       */
      function isNull(value) {
        return value === null;
      }

      /**
       * Checks if `value` is `null` or `undefined`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is nullish, else `false`.
       * @example
       *
       * _.isNil(null);
       * // => true
       *
       * _.isNil(void 0);
       * // => true
       *
       * _.isNil(NaN);
       * // => false
       */
      function isNil(value) {
        return value == null;
      }

      /**
       * Checks if `value` is classified as a `Number` primitive or object.
       *
       * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are
       * classified as numbers, use the `_.isFinite` method.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a number, else `false`.
       * @example
       *
       * _.isNumber(3);
       * // => true
       *
       * _.isNumber(Number.MIN_VALUE);
       * // => true
       *
       * _.isNumber(Infinity);
       * // => true
       *
       * _.isNumber('3');
       * // => false
       */
      function isNumber(value) {
        return typeof value == 'number' ||
          (isObjectLike(value) && baseGetTag(value) == numberTag);
      }

      /**
       * Checks if `value` is a plain object, that is, an object created by the
       * `Object` constructor or one with a `[[Prototype]]` of `null`.
       *
       * @static
       * @memberOf _
       * @since 0.8.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       * }
       *
       * _.isPlainObject(new Foo);
       * // => false
       *
       * _.isPlainObject([1, 2, 3]);
       * // => false
       *
       * _.isPlainObject({ 'x': 0, 'y': 0 });
       * // => true
       *
       * _.isPlainObject(Object.create(null));
       * // => true
       */
      function isPlainObject(value) {
        if (!isObjectLike(value) || baseGetTag(value) != objectTag) {
          return false;
        }
        var proto = getPrototype(value);
        if (proto === null) {
          return true;
        }
        var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;
        return typeof Ctor == 'function' && Ctor instanceof Ctor &&
          funcToString.call(Ctor) == objectCtorString;
      }

      /**
       * Checks if `value` is classified as a `RegExp` object.
       *
       * @static
       * @memberOf _
       * @since 0.1.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.
       * @example
       *
       * _.isRegExp(/abc/);
       * // => true
       *
       * _.isRegExp('/abc/');
       * // => false
       */
      var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;

      /**
       * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754
       * double precision number which isn't the result of a rounded unsafe integer.
       *
       * **Note:** This method is based on
       * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.
       * @example
       *
       * _.isSafeInteger(3);
       * // => true
       *
       * _.isSafeInteger(Number.MIN_VALUE);
       * // => false
       *
       * _.isSafeInteger(Infinity);
       * // => false
       *
       * _.isSafeInteger('3');
       * // => false
       */
      function isSafeInteger(value) {
        return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;
      }

      /**
       * Checks if `value` is classified as a `Set` object.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a set, else `false`.
       * @example
       *
       * _.isSet(new Set);
       * // => true
       *
       * _.isSet(new WeakSet);
       * // => false
       */
      var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;

      /**
       * Checks if `value` is classified as a `String` primitive or object.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a string, else `false`.
       * @example
       *
       * _.isString('abc');
       * // => true
       *
       * _.isString(1);
       * // => false
       */
      function isString(value) {
        return typeof value == 'string' ||
          (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);
      }

      /**
       * Checks if `value` is classified as a `Symbol` primitive or object.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
       * @example
       *
       * _.isSymbol(Symbol.iterator);
       * // => true
       *
       * _.isSymbol('abc');
       * // => false
       */
      function isSymbol(value) {
        return typeof value == 'symbol' ||
          (isObjectLike(value) && baseGetTag(value) == symbolTag);
      }

      /**
       * Checks if `value` is classified as a typed array.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
       * @example
       *
       * _.isTypedArray(new Uint8Array);
       * // => true
       *
       * _.isTypedArray([]);
       * // => false
       */
      var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

      /**
       * Checks if `value` is `undefined`.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.
       * @example
       *
       * _.isUndefined(void 0);
       * // => true
       *
       * _.isUndefined(null);
       * // => false
       */
      function isUndefined(value) {
        return value === undefined$1;
      }

      /**
       * Checks if `value` is classified as a `WeakMap` object.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.
       * @example
       *
       * _.isWeakMap(new WeakMap);
       * // => true
       *
       * _.isWeakMap(new Map);
       * // => false
       */
      function isWeakMap(value) {
        return isObjectLike(value) && getTag(value) == weakMapTag;
      }

      /**
       * Checks if `value` is classified as a `WeakSet` object.
       *
       * @static
       * @memberOf _
       * @since 4.3.0
       * @category Lang
       * @param {*} value The value to check.
       * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.
       * @example
       *
       * _.isWeakSet(new WeakSet);
       * // => true
       *
       * _.isWeakSet(new Set);
       * // => false
       */
      function isWeakSet(value) {
        return isObjectLike(value) && baseGetTag(value) == weakSetTag;
      }

      /**
       * Checks if `value` is less than `other`.
       *
       * @static
       * @memberOf _
       * @since 3.9.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is less than `other`,
       *  else `false`.
       * @see _.gt
       * @example
       *
       * _.lt(1, 3);
       * // => true
       *
       * _.lt(3, 3);
       * // => false
       *
       * _.lt(3, 1);
       * // => false
       */
      var lt = createRelationalOperation(baseLt);

      /**
       * Checks if `value` is less than or equal to `other`.
       *
       * @static
       * @memberOf _
       * @since 3.9.0
       * @category Lang
       * @param {*} value The value to compare.
       * @param {*} other The other value to compare.
       * @returns {boolean} Returns `true` if `value` is less than or equal to
       *  `other`, else `false`.
       * @see _.gte
       * @example
       *
       * _.lte(1, 3);
       * // => true
       *
       * _.lte(3, 3);
       * // => true
       *
       * _.lte(3, 1);
       * // => false
       */
      var lte = createRelationalOperation(function(value, other) {
        return value <= other;
      });

      /**
       * Converts `value` to an array.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {Array} Returns the converted array.
       * @example
       *
       * _.toArray({ 'a': 1, 'b': 2 });
       * // => [1, 2]
       *
       * _.toArray('abc');
       * // => ['a', 'b', 'c']
       *
       * _.toArray(1);
       * // => []
       *
       * _.toArray(null);
       * // => []
       */
      function toArray(value) {
        if (!value) {
          return [];
        }
        if (isArrayLike(value)) {
          return isString(value) ? stringToArray(value) : copyArray(value);
        }
        if (symIterator && value[symIterator]) {
          return iteratorToArray(value[symIterator]());
        }
        var tag = getTag(value),
            func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);

        return func(value);
      }

      /**
       * Converts `value` to a finite number.
       *
       * @static
       * @memberOf _
       * @since 4.12.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {number} Returns the converted number.
       * @example
       *
       * _.toFinite(3.2);
       * // => 3.2
       *
       * _.toFinite(Number.MIN_VALUE);
       * // => 5e-324
       *
       * _.toFinite(Infinity);
       * // => 1.7976931348623157e+308
       *
       * _.toFinite('3.2');
       * // => 3.2
       */
      function toFinite(value) {
        if (!value) {
          return value === 0 ? value : 0;
        }
        value = toNumber(value);
        if (value === INFINITY || value === -INFINITY) {
          var sign = (value < 0 ? -1 : 1);
          return sign * MAX_INTEGER;
        }
        return value === value ? value : 0;
      }

      /**
       * Converts `value` to an integer.
       *
       * **Note:** This method is loosely based on
       * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {number} Returns the converted integer.
       * @example
       *
       * _.toInteger(3.2);
       * // => 3
       *
       * _.toInteger(Number.MIN_VALUE);
       * // => 0
       *
       * _.toInteger(Infinity);
       * // => 1.7976931348623157e+308
       *
       * _.toInteger('3.2');
       * // => 3
       */
      function toInteger(value) {
        var result = toFinite(value),
            remainder = result % 1;

        return result === result ? (remainder ? result - remainder : result) : 0;
      }

      /**
       * Converts `value` to an integer suitable for use as the length of an
       * array-like object.
       *
       * **Note:** This method is based on
       * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {number} Returns the converted integer.
       * @example
       *
       * _.toLength(3.2);
       * // => 3
       *
       * _.toLength(Number.MIN_VALUE);
       * // => 0
       *
       * _.toLength(Infinity);
       * // => 4294967295
       *
       * _.toLength('3.2');
       * // => 3
       */
      function toLength(value) {
        return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;
      }

      /**
       * Converts `value` to a number.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to process.
       * @returns {number} Returns the number.
       * @example
       *
       * _.toNumber(3.2);
       * // => 3.2
       *
       * _.toNumber(Number.MIN_VALUE);
       * // => 5e-324
       *
       * _.toNumber(Infinity);
       * // => Infinity
       *
       * _.toNumber('3.2');
       * // => 3.2
       */
      function toNumber(value) {
        if (typeof value == 'number') {
          return value;
        }
        if (isSymbol(value)) {
          return NAN;
        }
        if (isObject(value)) {
          var other = typeof value.valueOf == 'function' ? value.valueOf() : value;
          value = isObject(other) ? (other + '') : other;
        }
        if (typeof value != 'string') {
          return value === 0 ? value : +value;
        }
        value = baseTrim(value);
        var isBinary = reIsBinary.test(value);
        return (isBinary || reIsOctal.test(value))
          ? freeParseInt(value.slice(2), isBinary ? 2 : 8)
          : (reIsBadHex.test(value) ? NAN : +value);
      }

      /**
       * Converts `value` to a plain object flattening inherited enumerable string
       * keyed properties of `value` to own properties of the plain object.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {Object} Returns the converted plain object.
       * @example
       *
       * function Foo() {
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.assign({ 'a': 1 }, new Foo);
       * // => { 'a': 1, 'b': 2 }
       *
       * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));
       * // => { 'a': 1, 'b': 2, 'c': 3 }
       */
      function toPlainObject(value) {
        return copyObject(value, keysIn(value));
      }

      /**
       * Converts `value` to a safe integer. A safe integer can be compared and
       * represented correctly.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {number} Returns the converted integer.
       * @example
       *
       * _.toSafeInteger(3.2);
       * // => 3
       *
       * _.toSafeInteger(Number.MIN_VALUE);
       * // => 0
       *
       * _.toSafeInteger(Infinity);
       * // => 9007199254740991
       *
       * _.toSafeInteger('3.2');
       * // => 3
       */
      function toSafeInteger(value) {
        return value
          ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)
          : (value === 0 ? value : 0);
      }

      /**
       * Converts `value` to a string. An empty string is returned for `null`
       * and `undefined` values. The sign of `-0` is preserved.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Lang
       * @param {*} value The value to convert.
       * @returns {string} Returns the converted string.
       * @example
       *
       * _.toString(null);
       * // => ''
       *
       * _.toString(-0);
       * // => '-0'
       *
       * _.toString([1, 2, 3]);
       * // => '1,2,3'
       */
      function toString(value) {
        return value == null ? '' : baseToString(value);
      }

      /*------------------------------------------------------------------------*/

      /**
       * Assigns own enumerable string keyed properties of source objects to the
       * destination object. Source objects are applied from left to right.
       * Subsequent sources overwrite property assignments of previous sources.
       *
       * **Note:** This method mutates `object` and is loosely based on
       * [`Object.assign`](https://mdn.io/Object/assign).
       *
       * @static
       * @memberOf _
       * @since 0.10.0
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} [sources] The source objects.
       * @returns {Object} Returns `object`.
       * @see _.assignIn
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       * }
       *
       * function Bar() {
       *   this.c = 3;
       * }
       *
       * Foo.prototype.b = 2;
       * Bar.prototype.d = 4;
       *
       * _.assign({ 'a': 0 }, new Foo, new Bar);
       * // => { 'a': 1, 'c': 3 }
       */
      var assign = createAssigner(function(object, source) {
        if (isPrototype(source) || isArrayLike(source)) {
          copyObject(source, keys(source), object);
          return;
        }
        for (var key in source) {
          if (hasOwnProperty.call(source, key)) {
            assignValue(object, key, source[key]);
          }
        }
      });

      /**
       * This method is like `_.assign` except that it iterates over own and
       * inherited source properties.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @alias extend
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} [sources] The source objects.
       * @returns {Object} Returns `object`.
       * @see _.assign
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       * }
       *
       * function Bar() {
       *   this.c = 3;
       * }
       *
       * Foo.prototype.b = 2;
       * Bar.prototype.d = 4;
       *
       * _.assignIn({ 'a': 0 }, new Foo, new Bar);
       * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }
       */
      var assignIn = createAssigner(function(object, source) {
        copyObject(source, keysIn(source), object);
      });

      /**
       * This method is like `_.assignIn` except that it accepts `customizer`
       * which is invoked to produce the assigned values. If `customizer` returns
       * `undefined`, assignment is handled by the method instead. The `customizer`
       * is invoked with five arguments: (objValue, srcValue, key, object, source).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @alias extendWith
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} sources The source objects.
       * @param {Function} [customizer] The function to customize assigned values.
       * @returns {Object} Returns `object`.
       * @see _.assignWith
       * @example
       *
       * function customizer(objValue, srcValue) {
       *   return _.isUndefined(objValue) ? srcValue : objValue;
       * }
       *
       * var defaults = _.partialRight(_.assignInWith, customizer);
       *
       * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
       * // => { 'a': 1, 'b': 2 }
       */
      var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {
        copyObject(source, keysIn(source), object, customizer);
      });

      /**
       * This method is like `_.assign` except that it accepts `customizer`
       * which is invoked to produce the assigned values. If `customizer` returns
       * `undefined`, assignment is handled by the method instead. The `customizer`
       * is invoked with five arguments: (objValue, srcValue, key, object, source).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} sources The source objects.
       * @param {Function} [customizer] The function to customize assigned values.
       * @returns {Object} Returns `object`.
       * @see _.assignInWith
       * @example
       *
       * function customizer(objValue, srcValue) {
       *   return _.isUndefined(objValue) ? srcValue : objValue;
       * }
       *
       * var defaults = _.partialRight(_.assignWith, customizer);
       *
       * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
       * // => { 'a': 1, 'b': 2 }
       */
      var assignWith = createAssigner(function(object, source, srcIndex, customizer) {
        copyObject(source, keys(source), object, customizer);
      });

      /**
       * Creates an array of values corresponding to `paths` of `object`.
       *
       * @static
       * @memberOf _
       * @since 1.0.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {...(string|string[])} [paths] The property paths to pick.
       * @returns {Array} Returns the picked values.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };
       *
       * _.at(object, ['a[0].b.c', 'a[1]']);
       * // => [3, 4]
       */
      var at = flatRest(baseAt);

      /**
       * Creates an object that inherits from the `prototype` object. If a
       * `properties` object is given, its own enumerable string keyed properties
       * are assigned to the created object.
       *
       * @static
       * @memberOf _
       * @since 2.3.0
       * @category Object
       * @param {Object} prototype The object to inherit from.
       * @param {Object} [properties] The properties to assign to the object.
       * @returns {Object} Returns the new object.
       * @example
       *
       * function Shape() {
       *   this.x = 0;
       *   this.y = 0;
       * }
       *
       * function Circle() {
       *   Shape.call(this);
       * }
       *
       * Circle.prototype = _.create(Shape.prototype, {
       *   'constructor': Circle
       * });
       *
       * var circle = new Circle;
       * circle instanceof Circle;
       * // => true
       *
       * circle instanceof Shape;
       * // => true
       */
      function create(prototype, properties) {
        var result = baseCreate(prototype);
        return properties == null ? result : baseAssign(result, properties);
      }

      /**
       * Assigns own and inherited enumerable string keyed properties of source
       * objects to the destination object for all destination properties that
       * resolve to `undefined`. Source objects are applied from left to right.
       * Once a property is set, additional values of the same property are ignored.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} [sources] The source objects.
       * @returns {Object} Returns `object`.
       * @see _.defaultsDeep
       * @example
       *
       * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });
       * // => { 'a': 1, 'b': 2 }
       */
      var defaults = baseRest(function(object, sources) {
        object = Object(object);

        var index = -1;
        var length = sources.length;
        var guard = length > 2 ? sources[2] : undefined$1;

        if (guard && isIterateeCall(sources[0], sources[1], guard)) {
          length = 1;
        }

        while (++index < length) {
          var source = sources[index];
          var props = keysIn(source);
          var propsIndex = -1;
          var propsLength = props.length;

          while (++propsIndex < propsLength) {
            var key = props[propsIndex];
            var value = object[key];

            if (value === undefined$1 ||
                (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {
              object[key] = source[key];
            }
          }
        }

        return object;
      });

      /**
       * This method is like `_.defaults` except that it recursively assigns
       * default properties.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 3.10.0
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} [sources] The source objects.
       * @returns {Object} Returns `object`.
       * @see _.defaults
       * @example
       *
       * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });
       * // => { 'a': { 'b': 2, 'c': 3 } }
       */
      var defaultsDeep = baseRest(function(args) {
        args.push(undefined$1, customDefaultsMerge);
        return apply(mergeWith, undefined$1, args);
      });

      /**
       * This method is like `_.find` except that it returns the key of the first
       * element `predicate` returns truthy for instead of the element itself.
       *
       * @static
       * @memberOf _
       * @since 1.1.0
       * @category Object
       * @param {Object} object The object to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {string|undefined} Returns the key of the matched element,
       *  else `undefined`.
       * @example
       *
       * var users = {
       *   'barney':  { 'age': 36, 'active': true },
       *   'fred':    { 'age': 40, 'active': false },
       *   'pebbles': { 'age': 1,  'active': true }
       * };
       *
       * _.findKey(users, function(o) { return o.age < 40; });
       * // => 'barney' (iteration order is not guaranteed)
       *
       * // The `_.matches` iteratee shorthand.
       * _.findKey(users, { 'age': 1, 'active': true });
       * // => 'pebbles'
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.findKey(users, ['active', false]);
       * // => 'fred'
       *
       * // The `_.property` iteratee shorthand.
       * _.findKey(users, 'active');
       * // => 'barney'
       */
      function findKey(object, predicate) {
        return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);
      }

      /**
       * This method is like `_.findKey` except that it iterates over elements of
       * a collection in the opposite order.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Object
       * @param {Object} object The object to inspect.
       * @param {Function} [predicate=_.identity] The function invoked per iteration.
       * @returns {string|undefined} Returns the key of the matched element,
       *  else `undefined`.
       * @example
       *
       * var users = {
       *   'barney':  { 'age': 36, 'active': true },
       *   'fred':    { 'age': 40, 'active': false },
       *   'pebbles': { 'age': 1,  'active': true }
       * };
       *
       * _.findLastKey(users, function(o) { return o.age < 40; });
       * // => returns 'pebbles' assuming `_.findKey` returns 'barney'
       *
       * // The `_.matches` iteratee shorthand.
       * _.findLastKey(users, { 'age': 36, 'active': true });
       * // => 'barney'
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.findLastKey(users, ['active', false]);
       * // => 'fred'
       *
       * // The `_.property` iteratee shorthand.
       * _.findLastKey(users, 'active');
       * // => 'pebbles'
       */
      function findLastKey(object, predicate) {
        return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);
      }

      /**
       * Iterates over own and inherited enumerable string keyed properties of an
       * object and invokes `iteratee` for each property. The iteratee is invoked
       * with three arguments: (value, key, object). Iteratee functions may exit
       * iteration early by explicitly returning `false`.
       *
       * @static
       * @memberOf _
       * @since 0.3.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns `object`.
       * @see _.forInRight
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.forIn(new Foo, function(value, key) {
       *   console.log(key);
       * });
       * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).
       */
      function forIn(object, iteratee) {
        return object == null
          ? object
          : baseFor(object, getIteratee(iteratee, 3), keysIn);
      }

      /**
       * This method is like `_.forIn` except that it iterates over properties of
       * `object` in the opposite order.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns `object`.
       * @see _.forIn
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.forInRight(new Foo, function(value, key) {
       *   console.log(key);
       * });
       * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.
       */
      function forInRight(object, iteratee) {
        return object == null
          ? object
          : baseForRight(object, getIteratee(iteratee, 3), keysIn);
      }

      /**
       * Iterates over own enumerable string keyed properties of an object and
       * invokes `iteratee` for each property. The iteratee is invoked with three
       * arguments: (value, key, object). Iteratee functions may exit iteration
       * early by explicitly returning `false`.
       *
       * @static
       * @memberOf _
       * @since 0.3.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns `object`.
       * @see _.forOwnRight
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.forOwn(new Foo, function(value, key) {
       *   console.log(key);
       * });
       * // => Logs 'a' then 'b' (iteration order is not guaranteed).
       */
      function forOwn(object, iteratee) {
        return object && baseForOwn(object, getIteratee(iteratee, 3));
      }

      /**
       * This method is like `_.forOwn` except that it iterates over properties of
       * `object` in the opposite order.
       *
       * @static
       * @memberOf _
       * @since 2.0.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns `object`.
       * @see _.forOwn
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.forOwnRight(new Foo, function(value, key) {
       *   console.log(key);
       * });
       * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.
       */
      function forOwnRight(object, iteratee) {
        return object && baseForOwnRight(object, getIteratee(iteratee, 3));
      }

      /**
       * Creates an array of function property names from own enumerable properties
       * of `object`.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The object to inspect.
       * @returns {Array} Returns the function names.
       * @see _.functionsIn
       * @example
       *
       * function Foo() {
       *   this.a = _.constant('a');
       *   this.b = _.constant('b');
       * }
       *
       * Foo.prototype.c = _.constant('c');
       *
       * _.functions(new Foo);
       * // => ['a', 'b']
       */
      function functions(object) {
        return object == null ? [] : baseFunctions(object, keys(object));
      }

      /**
       * Creates an array of function property names from own and inherited
       * enumerable properties of `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The object to inspect.
       * @returns {Array} Returns the function names.
       * @see _.functions
       * @example
       *
       * function Foo() {
       *   this.a = _.constant('a');
       *   this.b = _.constant('b');
       * }
       *
       * Foo.prototype.c = _.constant('c');
       *
       * _.functionsIn(new Foo);
       * // => ['a', 'b', 'c']
       */
      function functionsIn(object) {
        return object == null ? [] : baseFunctions(object, keysIn(object));
      }

      /**
       * Gets the value at `path` of `object`. If the resolved value is
       * `undefined`, the `defaultValue` is returned in its place.
       *
       * @static
       * @memberOf _
       * @since 3.7.0
       * @category Object
       * @param {Object} object The object to query.
       * @param {Array|string} path The path of the property to get.
       * @param {*} [defaultValue] The value returned for `undefined` resolved values.
       * @returns {*} Returns the resolved value.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 3 } }] };
       *
       * _.get(object, 'a[0].b.c');
       * // => 3
       *
       * _.get(object, ['a', '0', 'b', 'c']);
       * // => 3
       *
       * _.get(object, 'a.b.c', 'default');
       * // => 'default'
       */
      function get(object, path, defaultValue) {
        var result = object == null ? undefined$1 : baseGet(object, path);
        return result === undefined$1 ? defaultValue : result;
      }

      /**
       * Checks if `path` is a direct property of `object`.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The object to query.
       * @param {Array|string} path The path to check.
       * @returns {boolean} Returns `true` if `path` exists, else `false`.
       * @example
       *
       * var object = { 'a': { 'b': 2 } };
       * var other = _.create({ 'a': _.create({ 'b': 2 }) });
       *
       * _.has(object, 'a');
       * // => true
       *
       * _.has(object, 'a.b');
       * // => true
       *
       * _.has(object, ['a', 'b']);
       * // => true
       *
       * _.has(other, 'a');
       * // => false
       */
      function has(object, path) {
        return object != null && hasPath(object, path, baseHas);
      }

      /**
       * Checks if `path` is a direct or inherited property of `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The object to query.
       * @param {Array|string} path The path to check.
       * @returns {boolean} Returns `true` if `path` exists, else `false`.
       * @example
       *
       * var object = _.create({ 'a': _.create({ 'b': 2 }) });
       *
       * _.hasIn(object, 'a');
       * // => true
       *
       * _.hasIn(object, 'a.b');
       * // => true
       *
       * _.hasIn(object, ['a', 'b']);
       * // => true
       *
       * _.hasIn(object, 'b');
       * // => false
       */
      function hasIn(object, path) {
        return object != null && hasPath(object, path, baseHasIn);
      }

      /**
       * Creates an object composed of the inverted keys and values of `object`.
       * If `object` contains duplicate values, subsequent values overwrite
       * property assignments of previous values.
       *
       * @static
       * @memberOf _
       * @since 0.7.0
       * @category Object
       * @param {Object} object The object to invert.
       * @returns {Object} Returns the new inverted object.
       * @example
       *
       * var object = { 'a': 1, 'b': 2, 'c': 1 };
       *
       * _.invert(object);
       * // => { '1': 'c', '2': 'b' }
       */
      var invert = createInverter(function(result, value, key) {
        if (value != null &&
            typeof value.toString != 'function') {
          value = nativeObjectToString.call(value);
        }

        result[value] = key;
      }, constant(identity));

      /**
       * This method is like `_.invert` except that the inverted object is generated
       * from the results of running each element of `object` thru `iteratee`. The
       * corresponding inverted value of each inverted key is an array of keys
       * responsible for generating the inverted value. The iteratee is invoked
       * with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.1.0
       * @category Object
       * @param {Object} object The object to invert.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {Object} Returns the new inverted object.
       * @example
       *
       * var object = { 'a': 1, 'b': 2, 'c': 1 };
       *
       * _.invertBy(object);
       * // => { '1': ['a', 'c'], '2': ['b'] }
       *
       * _.invertBy(object, function(value) {
       *   return 'group' + value;
       * });
       * // => { 'group1': ['a', 'c'], 'group2': ['b'] }
       */
      var invertBy = createInverter(function(result, value, key) {
        if (value != null &&
            typeof value.toString != 'function') {
          value = nativeObjectToString.call(value);
        }

        if (hasOwnProperty.call(result, value)) {
          result[value].push(key);
        } else {
          result[value] = [key];
        }
      }, getIteratee);

      /**
       * Invokes the method at `path` of `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The object to query.
       * @param {Array|string} path The path of the method to invoke.
       * @param {...*} [args] The arguments to invoke the method with.
       * @returns {*} Returns the result of the invoked method.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };
       *
       * _.invoke(object, 'a[0].b.c.slice', 1, 3);
       * // => [2, 3]
       */
      var invoke = baseRest(baseInvoke);

      /**
       * Creates an array of the own enumerable property names of `object`.
       *
       * **Note:** Non-object values are coerced to objects. See the
       * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
       * for more details.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.keys(new Foo);
       * // => ['a', 'b'] (iteration order is not guaranteed)
       *
       * _.keys('hi');
       * // => ['0', '1']
       */
      function keys(object) {
        return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);
      }

      /**
       * Creates an array of the own and inherited enumerable property names of `object`.
       *
       * **Note:** Non-object values are coerced to objects.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property names.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.keysIn(new Foo);
       * // => ['a', 'b', 'c'] (iteration order is not guaranteed)
       */
      function keysIn(object) {
        return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);
      }

      /**
       * The opposite of `_.mapValues`; this method creates an object with the
       * same values as `object` and keys generated by running each own enumerable
       * string keyed property of `object` thru `iteratee`. The iteratee is invoked
       * with three arguments: (value, key, object).
       *
       * @static
       * @memberOf _
       * @since 3.8.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns the new mapped object.
       * @see _.mapValues
       * @example
       *
       * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {
       *   return key + value;
       * });
       * // => { 'a1': 1, 'b2': 2 }
       */
      function mapKeys(object, iteratee) {
        var result = {};
        iteratee = getIteratee(iteratee, 3);

        baseForOwn(object, function(value, key, object) {
          baseAssignValue(result, iteratee(value, key, object), value);
        });
        return result;
      }

      /**
       * Creates an object with the same keys as `object` and values generated
       * by running each own enumerable string keyed property of `object` thru
       * `iteratee`. The iteratee is invoked with three arguments:
       * (value, key, object).
       *
       * @static
       * @memberOf _
       * @since 2.4.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Object} Returns the new mapped object.
       * @see _.mapKeys
       * @example
       *
       * var users = {
       *   'fred':    { 'user': 'fred',    'age': 40 },
       *   'pebbles': { 'user': 'pebbles', 'age': 1 }
       * };
       *
       * _.mapValues(users, function(o) { return o.age; });
       * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
       *
       * // The `_.property` iteratee shorthand.
       * _.mapValues(users, 'age');
       * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
       */
      function mapValues(object, iteratee) {
        var result = {};
        iteratee = getIteratee(iteratee, 3);

        baseForOwn(object, function(value, key, object) {
          baseAssignValue(result, key, iteratee(value, key, object));
        });
        return result;
      }

      /**
       * This method is like `_.assign` except that it recursively merges own and
       * inherited enumerable string keyed properties of source objects into the
       * destination object. Source properties that resolve to `undefined` are
       * skipped if a destination value exists. Array and plain object properties
       * are merged recursively. Other objects and value types are overridden by
       * assignment. Source objects are applied from left to right. Subsequent
       * sources overwrite property assignments of previous sources.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 0.5.0
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} [sources] The source objects.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var object = {
       *   'a': [{ 'b': 2 }, { 'd': 4 }]
       * };
       *
       * var other = {
       *   'a': [{ 'c': 3 }, { 'e': 5 }]
       * };
       *
       * _.merge(object, other);
       * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }
       */
      var merge = createAssigner(function(object, source, srcIndex) {
        baseMerge(object, source, srcIndex);
      });

      /**
       * This method is like `_.merge` except that it accepts `customizer` which
       * is invoked to produce the merged values of the destination and source
       * properties. If `customizer` returns `undefined`, merging is handled by the
       * method instead. The `customizer` is invoked with six arguments:
       * (objValue, srcValue, key, object, source, stack).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The destination object.
       * @param {...Object} sources The source objects.
       * @param {Function} customizer The function to customize assigned values.
       * @returns {Object} Returns `object`.
       * @example
       *
       * function customizer(objValue, srcValue) {
       *   if (_.isArray(objValue)) {
       *     return objValue.concat(srcValue);
       *   }
       * }
       *
       * var object = { 'a': [1], 'b': [2] };
       * var other = { 'a': [3], 'b': [4] };
       *
       * _.mergeWith(object, other, customizer);
       * // => { 'a': [1, 3], 'b': [2, 4] }
       */
      var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {
        baseMerge(object, source, srcIndex, customizer);
      });

      /**
       * The opposite of `_.pick`; this method creates an object composed of the
       * own and inherited enumerable property paths of `object` that are not omitted.
       *
       * **Note:** This method is considerably slower than `_.pick`.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The source object.
       * @param {...(string|string[])} [paths] The property paths to omit.
       * @returns {Object} Returns the new object.
       * @example
       *
       * var object = { 'a': 1, 'b': '2', 'c': 3 };
       *
       * _.omit(object, ['a', 'c']);
       * // => { 'b': '2' }
       */
      var omit = flatRest(function(object, paths) {
        var result = {};
        if (object == null) {
          return result;
        }
        var isDeep = false;
        paths = arrayMap(paths, function(path) {
          path = castPath(path, object);
          isDeep || (isDeep = path.length > 1);
          return path;
        });
        copyObject(object, getAllKeysIn(object), result);
        if (isDeep) {
          result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);
        }
        var length = paths.length;
        while (length--) {
          baseUnset(result, paths[length]);
        }
        return result;
      });

      /**
       * The opposite of `_.pickBy`; this method creates an object composed of
       * the own and inherited enumerable string keyed properties of `object` that
       * `predicate` doesn't return truthy for. The predicate is invoked with two
       * arguments: (value, key).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The source object.
       * @param {Function} [predicate=_.identity] The function invoked per property.
       * @returns {Object} Returns the new object.
       * @example
       *
       * var object = { 'a': 1, 'b': '2', 'c': 3 };
       *
       * _.omitBy(object, _.isNumber);
       * // => { 'b': '2' }
       */
      function omitBy(object, predicate) {
        return pickBy(object, negate(getIteratee(predicate)));
      }

      /**
       * Creates an object composed of the picked `object` properties.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The source object.
       * @param {...(string|string[])} [paths] The property paths to pick.
       * @returns {Object} Returns the new object.
       * @example
       *
       * var object = { 'a': 1, 'b': '2', 'c': 3 };
       *
       * _.pick(object, ['a', 'c']);
       * // => { 'a': 1, 'c': 3 }
       */
      var pick = flatRest(function(object, paths) {
        return object == null ? {} : basePick(object, paths);
      });

      /**
       * Creates an object composed of the `object` properties `predicate` returns
       * truthy for. The predicate is invoked with two arguments: (value, key).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The source object.
       * @param {Function} [predicate=_.identity] The function invoked per property.
       * @returns {Object} Returns the new object.
       * @example
       *
       * var object = { 'a': 1, 'b': '2', 'c': 3 };
       *
       * _.pickBy(object, _.isNumber);
       * // => { 'a': 1, 'c': 3 }
       */
      function pickBy(object, predicate) {
        if (object == null) {
          return {};
        }
        var props = arrayMap(getAllKeysIn(object), function(prop) {
          return [prop];
        });
        predicate = getIteratee(predicate);
        return basePickBy(object, props, function(value, path) {
          return predicate(value, path[0]);
        });
      }

      /**
       * This method is like `_.get` except that if the resolved value is a
       * function it's invoked with the `this` binding of its parent object and
       * its result is returned.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The object to query.
       * @param {Array|string} path The path of the property to resolve.
       * @param {*} [defaultValue] The value returned for `undefined` resolved values.
       * @returns {*} Returns the resolved value.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };
       *
       * _.result(object, 'a[0].b.c1');
       * // => 3
       *
       * _.result(object, 'a[0].b.c2');
       * // => 4
       *
       * _.result(object, 'a[0].b.c3', 'default');
       * // => 'default'
       *
       * _.result(object, 'a[0].b.c3', _.constant('default'));
       * // => 'default'
       */
      function result(object, path, defaultValue) {
        path = castPath(path, object);

        var index = -1,
            length = path.length;

        // Ensure the loop is entered when path is empty.
        if (!length) {
          length = 1;
          object = undefined$1;
        }
        while (++index < length) {
          var value = object == null ? undefined$1 : object[toKey(path[index])];
          if (value === undefined$1) {
            index = length;
            value = defaultValue;
          }
          object = isFunction(value) ? value.call(object) : value;
        }
        return object;
      }

      /**
       * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,
       * it's created. Arrays are created for missing index properties while objects
       * are created for all other missing properties. Use `_.setWith` to customize
       * `path` creation.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 3.7.0
       * @category Object
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to set.
       * @param {*} value The value to set.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 3 } }] };
       *
       * _.set(object, 'a[0].b.c', 4);
       * console.log(object.a[0].b.c);
       * // => 4
       *
       * _.set(object, ['x', '0', 'y', 'z'], 5);
       * console.log(object.x[0].y.z);
       * // => 5
       */
      function set(object, path, value) {
        return object == null ? object : baseSet(object, path, value);
      }

      /**
       * This method is like `_.set` except that it accepts `customizer` which is
       * invoked to produce the objects of `path`.  If `customizer` returns `undefined`
       * path creation is handled by the method instead. The `customizer` is invoked
       * with three arguments: (nsValue, key, nsObject).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to set.
       * @param {*} value The value to set.
       * @param {Function} [customizer] The function to customize assigned values.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var object = {};
       *
       * _.setWith(object, '[0][1]', 'a', Object);
       * // => { '0': { '1': 'a' } }
       */
      function setWith(object, path, value, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        return object == null ? object : baseSet(object, path, value, customizer);
      }

      /**
       * Creates an array of own enumerable string keyed-value pairs for `object`
       * which can be consumed by `_.fromPairs`. If `object` is a map or set, its
       * entries are returned.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @alias entries
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the key-value pairs.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.toPairs(new Foo);
       * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)
       */
      var toPairs = createToPairs(keys);

      /**
       * Creates an array of own and inherited enumerable string keyed-value pairs
       * for `object` which can be consumed by `_.fromPairs`. If `object` is a map
       * or set, its entries are returned.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @alias entriesIn
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the key-value pairs.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.toPairsIn(new Foo);
       * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)
       */
      var toPairsIn = createToPairs(keysIn);

      /**
       * An alternative to `_.reduce`; this method transforms `object` to a new
       * `accumulator` object which is the result of running each of its own
       * enumerable string keyed properties thru `iteratee`, with each invocation
       * potentially mutating the `accumulator` object. If `accumulator` is not
       * provided, a new object with the same `[[Prototype]]` will be used. The
       * iteratee is invoked with four arguments: (accumulator, value, key, object).
       * Iteratee functions may exit iteration early by explicitly returning `false`.
       *
       * @static
       * @memberOf _
       * @since 1.3.0
       * @category Object
       * @param {Object} object The object to iterate over.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @param {*} [accumulator] The custom accumulator value.
       * @returns {*} Returns the accumulated value.
       * @example
       *
       * _.transform([2, 3, 4], function(result, n) {
       *   result.push(n *= n);
       *   return n % 2 == 0;
       * }, []);
       * // => [4, 9]
       *
       * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {
       *   (result[value] || (result[value] = [])).push(key);
       * }, {});
       * // => { '1': ['a', 'c'], '2': ['b'] }
       */
      function transform(object, iteratee, accumulator) {
        var isArr = isArray(object),
            isArrLike = isArr || isBuffer(object) || isTypedArray(object);

        iteratee = getIteratee(iteratee, 4);
        if (accumulator == null) {
          var Ctor = object && object.constructor;
          if (isArrLike) {
            accumulator = isArr ? new Ctor : [];
          }
          else if (isObject(object)) {
            accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};
          }
          else {
            accumulator = {};
          }
        }
        (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {
          return iteratee(accumulator, value, index, object);
        });
        return accumulator;
      }

      /**
       * Removes the property at `path` of `object`.
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Object
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to unset.
       * @returns {boolean} Returns `true` if the property is deleted, else `false`.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 7 } }] };
       * _.unset(object, 'a[0].b.c');
       * // => true
       *
       * console.log(object);
       * // => { 'a': [{ 'b': {} }] };
       *
       * _.unset(object, ['a', '0', 'b', 'c']);
       * // => true
       *
       * console.log(object);
       * // => { 'a': [{ 'b': {} }] };
       */
      function unset(object, path) {
        return object == null ? true : baseUnset(object, path);
      }

      /**
       * This method is like `_.set` except that accepts `updater` to produce the
       * value to set. Use `_.updateWith` to customize `path` creation. The `updater`
       * is invoked with one argument: (value).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.6.0
       * @category Object
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to set.
       * @param {Function} updater The function to produce the updated value.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var object = { 'a': [{ 'b': { 'c': 3 } }] };
       *
       * _.update(object, 'a[0].b.c', function(n) { return n * n; });
       * console.log(object.a[0].b.c);
       * // => 9
       *
       * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });
       * console.log(object.x[0].y.z);
       * // => 0
       */
      function update(object, path, updater) {
        return object == null ? object : baseUpdate(object, path, castFunction(updater));
      }

      /**
       * This method is like `_.update` except that it accepts `customizer` which is
       * invoked to produce the objects of `path`.  If `customizer` returns `undefined`
       * path creation is handled by the method instead. The `customizer` is invoked
       * with three arguments: (nsValue, key, nsObject).
       *
       * **Note:** This method mutates `object`.
       *
       * @static
       * @memberOf _
       * @since 4.6.0
       * @category Object
       * @param {Object} object The object to modify.
       * @param {Array|string} path The path of the property to set.
       * @param {Function} updater The function to produce the updated value.
       * @param {Function} [customizer] The function to customize assigned values.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var object = {};
       *
       * _.updateWith(object, '[0][1]', _.constant('a'), Object);
       * // => { '0': { '1': 'a' } }
       */
      function updateWith(object, path, updater, customizer) {
        customizer = typeof customizer == 'function' ? customizer : undefined$1;
        return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);
      }

      /**
       * Creates an array of the own enumerable string keyed property values of `object`.
       *
       * **Note:** Non-object values are coerced to objects.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property values.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.values(new Foo);
       * // => [1, 2] (iteration order is not guaranteed)
       *
       * _.values('hi');
       * // => ['h', 'i']
       */
      function values(object) {
        return object == null ? [] : baseValues(object, keys(object));
      }

      /**
       * Creates an array of the own and inherited enumerable string keyed property
       * values of `object`.
       *
       * **Note:** Non-object values are coerced to objects.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Object
       * @param {Object} object The object to query.
       * @returns {Array} Returns the array of property values.
       * @example
       *
       * function Foo() {
       *   this.a = 1;
       *   this.b = 2;
       * }
       *
       * Foo.prototype.c = 3;
       *
       * _.valuesIn(new Foo);
       * // => [1, 2, 3] (iteration order is not guaranteed)
       */
      function valuesIn(object) {
        return object == null ? [] : baseValues(object, keysIn(object));
      }

      /*------------------------------------------------------------------------*/

      /**
       * Clamps `number` within the inclusive `lower` and `upper` bounds.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Number
       * @param {number} number The number to clamp.
       * @param {number} [lower] The lower bound.
       * @param {number} upper The upper bound.
       * @returns {number} Returns the clamped number.
       * @example
       *
       * _.clamp(-10, -5, 5);
       * // => -5
       *
       * _.clamp(10, -5, 5);
       * // => 5
       */
      function clamp(number, lower, upper) {
        if (upper === undefined$1) {
          upper = lower;
          lower = undefined$1;
        }
        if (upper !== undefined$1) {
          upper = toNumber(upper);
          upper = upper === upper ? upper : 0;
        }
        if (lower !== undefined$1) {
          lower = toNumber(lower);
          lower = lower === lower ? lower : 0;
        }
        return baseClamp(toNumber(number), lower, upper);
      }

      /**
       * Checks if `n` is between `start` and up to, but not including, `end`. If
       * `end` is not specified, it's set to `start` with `start` then set to `0`.
       * If `start` is greater than `end` the params are swapped to support
       * negative ranges.
       *
       * @static
       * @memberOf _
       * @since 3.3.0
       * @category Number
       * @param {number} number The number to check.
       * @param {number} [start=0] The start of the range.
       * @param {number} end The end of the range.
       * @returns {boolean} Returns `true` if `number` is in the range, else `false`.
       * @see _.range, _.rangeRight
       * @example
       *
       * _.inRange(3, 2, 4);
       * // => true
       *
       * _.inRange(4, 8);
       * // => true
       *
       * _.inRange(4, 2);
       * // => false
       *
       * _.inRange(2, 2);
       * // => false
       *
       * _.inRange(1.2, 2);
       * // => true
       *
       * _.inRange(5.2, 4);
       * // => false
       *
       * _.inRange(-3, -2, -6);
       * // => true
       */
      function inRange(number, start, end) {
        start = toFinite(start);
        if (end === undefined$1) {
          end = start;
          start = 0;
        } else {
          end = toFinite(end);
        }
        number = toNumber(number);
        return baseInRange(number, start, end);
      }

      /**
       * Produces a random number between the inclusive `lower` and `upper` bounds.
       * If only one argument is provided a number between `0` and the given number
       * is returned. If `floating` is `true`, or either `lower` or `upper` are
       * floats, a floating-point number is returned instead of an integer.
       *
       * **Note:** JavaScript follows the IEEE-754 standard for resolving
       * floating-point values which can produce unexpected results.
       *
       * @static
       * @memberOf _
       * @since 0.7.0
       * @category Number
       * @param {number} [lower=0] The lower bound.
       * @param {number} [upper=1] The upper bound.
       * @param {boolean} [floating] Specify returning a floating-point number.
       * @returns {number} Returns the random number.
       * @example
       *
       * _.random(0, 5);
       * // => an integer between 0 and 5
       *
       * _.random(5);
       * // => also an integer between 0 and 5
       *
       * _.random(5, true);
       * // => a floating-point number between 0 and 5
       *
       * _.random(1.2, 5.2);
       * // => a floating-point number between 1.2 and 5.2
       */
      function random(lower, upper, floating) {
        if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {
          upper = floating = undefined$1;
        }
        if (floating === undefined$1) {
          if (typeof upper == 'boolean') {
            floating = upper;
            upper = undefined$1;
          }
          else if (typeof lower == 'boolean') {
            floating = lower;
            lower = undefined$1;
          }
        }
        if (lower === undefined$1 && upper === undefined$1) {
          lower = 0;
          upper = 1;
        }
        else {
          lower = toFinite(lower);
          if (upper === undefined$1) {
            upper = lower;
            lower = 0;
          } else {
            upper = toFinite(upper);
          }
        }
        if (lower > upper) {
          var temp = lower;
          lower = upper;
          upper = temp;
        }
        if (floating || lower % 1 || upper % 1) {
          var rand = nativeRandom();
          return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);
        }
        return baseRandom(lower, upper);
      }

      /*------------------------------------------------------------------------*/

      /**
       * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the camel cased string.
       * @example
       *
       * _.camelCase('Foo Bar');
       * // => 'fooBar'
       *
       * _.camelCase('--foo-bar--');
       * // => 'fooBar'
       *
       * _.camelCase('__FOO_BAR__');
       * // => 'fooBar'
       */
      var camelCase = createCompounder(function(result, word, index) {
        word = word.toLowerCase();
        return result + (index ? capitalize(word) : word);
      });

      /**
       * Converts the first character of `string` to upper case and the remaining
       * to lower case.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to capitalize.
       * @returns {string} Returns the capitalized string.
       * @example
       *
       * _.capitalize('FRED');
       * // => 'Fred'
       */
      function capitalize(string) {
        return upperFirst(toString(string).toLowerCase());
      }

      /**
       * Deburrs `string` by converting
       * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)
       * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)
       * letters to basic Latin letters and removing
       * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to deburr.
       * @returns {string} Returns the deburred string.
       * @example
       *
       * _.deburr('dj vu');
       * // => 'deja vu'
       */
      function deburr(string) {
        string = toString(string);
        return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');
      }

      /**
       * Checks if `string` ends with the given target string.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to inspect.
       * @param {string} [target] The string to search for.
       * @param {number} [position=string.length] The position to search up to.
       * @returns {boolean} Returns `true` if `string` ends with `target`,
       *  else `false`.
       * @example
       *
       * _.endsWith('abc', 'c');
       * // => true
       *
       * _.endsWith('abc', 'b');
       * // => false
       *
       * _.endsWith('abc', 'b', 2);
       * // => true
       */
      function endsWith(string, target, position) {
        string = toString(string);
        target = baseToString(target);

        var length = string.length;
        position = position === undefined$1
          ? length
          : baseClamp(toInteger(position), 0, length);

        var end = position;
        position -= target.length;
        return position >= 0 && string.slice(position, end) == target;
      }

      /**
       * Converts the characters "&", "<", ">", '"', and "'" in `string` to their
       * corresponding HTML entities.
       *
       * **Note:** No other characters are escaped. To escape additional
       * characters use a third-party library like [_he_](https://mths.be/he).
       *
       * Though the ">" character is escaped for symmetry, characters like
       * ">" and "/" don't need escaping in HTML and have no special meaning
       * unless they're part of a tag or unquoted attribute value. See
       * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)
       * (under "semi-related fun fact") for more details.
       *
       * When working with HTML you should always
       * [quote attribute values](http://wonko.com/post/html-escaping) to reduce
       * XSS vectors.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category String
       * @param {string} [string=''] The string to escape.
       * @returns {string} Returns the escaped string.
       * @example
       *
       * _.escape('fred, barney, & pebbles');
       * // => 'fred, barney, &amp; pebbles'
       */
      function escape(string) {
        string = toString(string);
        return (string && reHasUnescapedHtml.test(string))
          ? string.replace(reUnescapedHtml, escapeHtmlChar)
          : string;
      }

      /**
       * Escapes the `RegExp` special characters "^", "$", "\", ".", "*", "+",
       * "?", "(", ")", "[", "]", "{", "}", and "|" in `string`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to escape.
       * @returns {string} Returns the escaped string.
       * @example
       *
       * _.escapeRegExp('[lodash](https://lodash.com/)');
       * // => '\[lodash\]\(https://lodash\.com/\)'
       */
      function escapeRegExp(string) {
        string = toString(string);
        return (string && reHasRegExpChar.test(string))
          ? string.replace(reRegExpChar, '\\$&')
          : string;
      }

      /**
       * Converts `string` to
       * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the kebab cased string.
       * @example
       *
       * _.kebabCase('Foo Bar');
       * // => 'foo-bar'
       *
       * _.kebabCase('fooBar');
       * // => 'foo-bar'
       *
       * _.kebabCase('__FOO_BAR__');
       * // => 'foo-bar'
       */
      var kebabCase = createCompounder(function(result, word, index) {
        return result + (index ? '-' : '') + word.toLowerCase();
      });

      /**
       * Converts `string`, as space separated words, to lower case.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the lower cased string.
       * @example
       *
       * _.lowerCase('--Foo-Bar--');
       * // => 'foo bar'
       *
       * _.lowerCase('fooBar');
       * // => 'foo bar'
       *
       * _.lowerCase('__FOO_BAR__');
       * // => 'foo bar'
       */
      var lowerCase = createCompounder(function(result, word, index) {
        return result + (index ? ' ' : '') + word.toLowerCase();
      });

      /**
       * Converts the first character of `string` to lower case.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the converted string.
       * @example
       *
       * _.lowerFirst('Fred');
       * // => 'fred'
       *
       * _.lowerFirst('FRED');
       * // => 'fRED'
       */
      var lowerFirst = createCaseFirst('toLowerCase');

      /**
       * Pads `string` on the left and right sides if it's shorter than `length`.
       * Padding characters are truncated if they can't be evenly divided by `length`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to pad.
       * @param {number} [length=0] The padding length.
       * @param {string} [chars=' '] The string used as padding.
       * @returns {string} Returns the padded string.
       * @example
       *
       * _.pad('abc', 8);
       * // => '  abc   '
       *
       * _.pad('abc', 8, '_-');
       * // => '_-abc_-_'
       *
       * _.pad('abc', 3);
       * // => 'abc'
       */
      function pad(string, length, chars) {
        string = toString(string);
        length = toInteger(length);

        var strLength = length ? stringSize(string) : 0;
        if (!length || strLength >= length) {
          return string;
        }
        var mid = (length - strLength) / 2;
        return (
          createPadding(nativeFloor(mid), chars) +
          string +
          createPadding(nativeCeil(mid), chars)
        );
      }

      /**
       * Pads `string` on the right side if it's shorter than `length`. Padding
       * characters are truncated if they exceed `length`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to pad.
       * @param {number} [length=0] The padding length.
       * @param {string} [chars=' '] The string used as padding.
       * @returns {string} Returns the padded string.
       * @example
       *
       * _.padEnd('abc', 6);
       * // => 'abc   '
       *
       * _.padEnd('abc', 6, '_-');
       * // => 'abc_-_'
       *
       * _.padEnd('abc', 3);
       * // => 'abc'
       */
      function padEnd(string, length, chars) {
        string = toString(string);
        length = toInteger(length);

        var strLength = length ? stringSize(string) : 0;
        return (length && strLength < length)
          ? (string + createPadding(length - strLength, chars))
          : string;
      }

      /**
       * Pads `string` on the left side if it's shorter than `length`. Padding
       * characters are truncated if they exceed `length`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to pad.
       * @param {number} [length=0] The padding length.
       * @param {string} [chars=' '] The string used as padding.
       * @returns {string} Returns the padded string.
       * @example
       *
       * _.padStart('abc', 6);
       * // => '   abc'
       *
       * _.padStart('abc', 6, '_-');
       * // => '_-_abc'
       *
       * _.padStart('abc', 3);
       * // => 'abc'
       */
      function padStart(string, length, chars) {
        string = toString(string);
        length = toInteger(length);

        var strLength = length ? stringSize(string) : 0;
        return (length && strLength < length)
          ? (createPadding(length - strLength, chars) + string)
          : string;
      }

      /**
       * Converts `string` to an integer of the specified radix. If `radix` is
       * `undefined` or `0`, a `radix` of `10` is used unless `value` is a
       * hexadecimal, in which case a `radix` of `16` is used.
       *
       * **Note:** This method aligns with the
       * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.
       *
       * @static
       * @memberOf _
       * @since 1.1.0
       * @category String
       * @param {string} string The string to convert.
       * @param {number} [radix=10] The radix to interpret `value` by.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {number} Returns the converted integer.
       * @example
       *
       * _.parseInt('08');
       * // => 8
       *
       * _.map(['6', '08', '10'], _.parseInt);
       * // => [6, 8, 10]
       */
      function parseInt(string, radix, guard) {
        if (guard || radix == null) {
          radix = 0;
        } else if (radix) {
          radix = +radix;
        }
        return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);
      }

      /**
       * Repeats the given string `n` times.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to repeat.
       * @param {number} [n=1] The number of times to repeat the string.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {string} Returns the repeated string.
       * @example
       *
       * _.repeat('*', 3);
       * // => '***'
       *
       * _.repeat('abc', 2);
       * // => 'abcabc'
       *
       * _.repeat('abc', 0);
       * // => ''
       */
      function repeat(string, n, guard) {
        if ((guard ? isIterateeCall(string, n, guard) : n === undefined$1)) {
          n = 1;
        } else {
          n = toInteger(n);
        }
        return baseRepeat(toString(string), n);
      }

      /**
       * Replaces matches for `pattern` in `string` with `replacement`.
       *
       * **Note:** This method is based on
       * [`String#replace`](https://mdn.io/String/replace).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to modify.
       * @param {RegExp|string} pattern The pattern to replace.
       * @param {Function|string} replacement The match replacement.
       * @returns {string} Returns the modified string.
       * @example
       *
       * _.replace('Hi Fred', 'Fred', 'Barney');
       * // => 'Hi Barney'
       */
      function replace() {
        var args = arguments,
            string = toString(args[0]);

        return args.length < 3 ? string : string.replace(args[1], args[2]);
      }

      /**
       * Converts `string` to
       * [snake case](https://en.wikipedia.org/wiki/Snake_case).
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the snake cased string.
       * @example
       *
       * _.snakeCase('Foo Bar');
       * // => 'foo_bar'
       *
       * _.snakeCase('fooBar');
       * // => 'foo_bar'
       *
       * _.snakeCase('--FOO-BAR--');
       * // => 'foo_bar'
       */
      var snakeCase = createCompounder(function(result, word, index) {
        return result + (index ? '_' : '') + word.toLowerCase();
      });

      /**
       * Splits `string` by `separator`.
       *
       * **Note:** This method is based on
       * [`String#split`](https://mdn.io/String/split).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to split.
       * @param {RegExp|string} separator The separator pattern to split by.
       * @param {number} [limit] The length to truncate results to.
       * @returns {Array} Returns the string segments.
       * @example
       *
       * _.split('a-b-c', '-', 2);
       * // => ['a', 'b']
       */
      function split(string, separator, limit) {
        if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {
          separator = limit = undefined$1;
        }
        limit = limit === undefined$1 ? MAX_ARRAY_LENGTH : limit >>> 0;
        if (!limit) {
          return [];
        }
        string = toString(string);
        if (string && (
              typeof separator == 'string' ||
              (separator != null && !isRegExp(separator))
            )) {
          separator = baseToString(separator);
          if (!separator && hasUnicode(string)) {
            return castSlice(stringToArray(string), 0, limit);
          }
        }
        return string.split(separator, limit);
      }

      /**
       * Converts `string` to
       * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).
       *
       * @static
       * @memberOf _
       * @since 3.1.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the start cased string.
       * @example
       *
       * _.startCase('--foo-bar--');
       * // => 'Foo Bar'
       *
       * _.startCase('fooBar');
       * // => 'Foo Bar'
       *
       * _.startCase('__FOO_BAR__');
       * // => 'FOO BAR'
       */
      var startCase = createCompounder(function(result, word, index) {
        return result + (index ? ' ' : '') + upperFirst(word);
      });

      /**
       * Checks if `string` starts with the given target string.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to inspect.
       * @param {string} [target] The string to search for.
       * @param {number} [position=0] The position to search from.
       * @returns {boolean} Returns `true` if `string` starts with `target`,
       *  else `false`.
       * @example
       *
       * _.startsWith('abc', 'a');
       * // => true
       *
       * _.startsWith('abc', 'b');
       * // => false
       *
       * _.startsWith('abc', 'b', 1);
       * // => true
       */
      function startsWith(string, target, position) {
        string = toString(string);
        position = position == null
          ? 0
          : baseClamp(toInteger(position), 0, string.length);

        target = baseToString(target);
        return string.slice(position, position + target.length) == target;
      }

      /**
       * Creates a compiled template function that can interpolate data properties
       * in "interpolate" delimiters, HTML-escape interpolated data properties in
       * "escape" delimiters, and execute JavaScript in "evaluate" delimiters. Data
       * properties may be accessed as free variables in the template. If a setting
       * object is given, it takes precedence over `_.templateSettings` values.
       *
       * **Note:** In the development build `_.template` utilizes
       * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)
       * for easier debugging.
       *
       * For more information on precompiling templates see
       * [lodash's custom builds documentation](https://lodash.com/custom-builds).
       *
       * For more information on Chrome extension sandboxes see
       * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category String
       * @param {string} [string=''] The template string.
       * @param {Object} [options={}] The options object.
       * @param {RegExp} [options.escape=_.templateSettings.escape]
       *  The HTML "escape" delimiter.
       * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]
       *  The "evaluate" delimiter.
       * @param {Object} [options.imports=_.templateSettings.imports]
       *  An object to import into the template as free variables.
       * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]
       *  The "interpolate" delimiter.
       * @param {string} [options.sourceURL='lodash.templateSources[n]']
       *  The sourceURL of the compiled template.
       * @param {string} [options.variable='obj']
       *  The data object variable name.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Function} Returns the compiled template function.
       * @example
       *
       * // Use the "interpolate" delimiter to create a compiled template.
       * var compiled = _.template('hello <%= user %>!');
       * compiled({ 'user': 'fred' });
       * // => 'hello fred!'
       *
       * // Use the HTML "escape" delimiter to escape data property values.
       * var compiled = _.template('<b><%- value %></b>');
       * compiled({ 'value': '<script>' });
       * // => '<b>&lt;script&gt;</b>'
       *
       * // Use the "evaluate" delimiter to execute JavaScript and generate HTML.
       * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');
       * compiled({ 'users': ['fred', 'barney'] });
       * // => '<li>fred</li><li>barney</li>'
       *
       * // Use the internal `print` function in "evaluate" delimiters.
       * var compiled = _.template('<% print("hello " + user); %>!');
       * compiled({ 'user': 'barney' });
       * // => 'hello barney!'
       *
       * // Use the ES template literal delimiter as an "interpolate" delimiter.
       * // Disable support by replacing the "interpolate" delimiter.
       * var compiled = _.template('hello ${ user }!');
       * compiled({ 'user': 'pebbles' });
       * // => 'hello pebbles!'
       *
       * // Use backslashes to treat delimiters as plain text.
       * var compiled = _.template('<%= "\\<%- value %\\>" %>');
       * compiled({ 'value': 'ignored' });
       * // => '<%- value %>'
       *
       * // Use the `imports` option to import `jQuery` as `jq`.
       * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';
       * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });
       * compiled({ 'users': ['fred', 'barney'] });
       * // => '<li>fred</li><li>barney</li>'
       *
       * // Use the `sourceURL` option to specify a custom sourceURL for the template.
       * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });
       * compiled(data);
       * // => Find the source of "greeting.jst" under the Sources tab or Resources panel of the web inspector.
       *
       * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.
       * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });
       * compiled.source;
       * // => function(data) {
       * //   var __t, __p = '';
       * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';
       * //   return __p;
       * // }
       *
       * // Use custom template delimiters.
       * _.templateSettings.interpolate = /{{([\s\S]+?)}}/g;
       * var compiled = _.template('hello {{ user }}!');
       * compiled({ 'user': 'mustache' });
       * // => 'hello mustache!'
       *
       * // Use the `source` property to inline compiled templates for meaningful
       * // line numbers in error messages and stack traces.
       * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\
       *   var JST = {\
       *     "main": ' + _.template(mainText).source + '\
       *   };\
       * ');
       */
      function template(string, options, guard) {
        // Based on John Resig's `tmpl` implementation
        // (http://ejohn.org/blog/javascript-micro-templating/)
        // and Laura Doktorova's doT.js (https://github.com/olado/doT).
        var settings = lodash.templateSettings;

        if (guard && isIterateeCall(string, options, guard)) {
          options = undefined$1;
        }
        string = toString(string);
        options = assignInWith({}, options, settings, customDefaultsAssignIn);

        var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),
            importsKeys = keys(imports),
            importsValues = baseValues(imports, importsKeys);

        var isEscaping,
            isEvaluating,
            index = 0,
            interpolate = options.interpolate || reNoMatch,
            source = "__p += '";

        // Compile the regexp to match each delimiter.
        var reDelimiters = RegExp(
          (options.escape || reNoMatch).source + '|' +
          interpolate.source + '|' +
          (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +
          (options.evaluate || reNoMatch).source + '|$'
        , 'g');

        // Use a sourceURL for easier debugging.
        // The sourceURL gets injected into the source that's eval-ed, so be careful
        // to normalize all kinds of whitespace, so e.g. newlines (and unicode versions of it) can't sneak in
        // and escape the comment, thus injecting code that gets evaled.
        var sourceURL = '//# sourceURL=' +
          (hasOwnProperty.call(options, 'sourceURL')
            ? (options.sourceURL + '').replace(/\s/g, ' ')
            : ('lodash.templateSources[' + (++templateCounter) + ']')
          ) + '\n';

        string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {
          interpolateValue || (interpolateValue = esTemplateValue);

          // Escape characters that can't be included in string literals.
          source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);

          // Replace delimiters with snippets.
          if (escapeValue) {
            isEscaping = true;
            source += "' +\n__e(" + escapeValue + ") +\n'";
          }
          if (evaluateValue) {
            isEvaluating = true;
            source += "';\n" + evaluateValue + ";\n__p += '";
          }
          if (interpolateValue) {
            source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'";
          }
          index = offset + match.length;

          // The JS engine embedded in Adobe products needs `match` returned in
          // order to produce the correct `offset` value.
          return match;
        });

        source += "';\n";

        // If `variable` is not specified wrap a with-statement around the generated
        // code to add the data object to the top of the scope chain.
        var variable = hasOwnProperty.call(options, 'variable') && options.variable;
        if (!variable) {
          source = 'with (obj) {\n' + source + '\n}\n';
        }
        // Throw an error if a forbidden character was found in `variable`, to prevent
        // potential command injection attacks.
        else if (reForbiddenIdentifierChars.test(variable)) {
          throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT);
        }

        // Cleanup code by stripping empty strings.
        source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)
          .replace(reEmptyStringMiddle, '$1')
          .replace(reEmptyStringTrailing, '$1;');

        // Frame code as the function body.
        source = 'function(' + (variable || 'obj') + ') {\n' +
          (variable
            ? ''
            : 'obj || (obj = {});\n'
          ) +
          "var __t, __p = ''" +
          (isEscaping
             ? ', __e = _.escape'
             : ''
          ) +
          (isEvaluating
            ? ', __j = Array.prototype.join;\n' +
              "function print() { __p += __j.call(arguments, '') }\n"
            : ';\n'
          ) +
          source +
          'return __p\n}';

        var result = attempt(function() {
          return Function(importsKeys, sourceURL + 'return ' + source)
            .apply(undefined$1, importsValues);
        });

        // Provide the compiled function's source by its `toString` method or
        // the `source` property as a convenience for inlining compiled templates.
        result.source = source;
        if (isError(result)) {
          throw result;
        }
        return result;
      }

      /**
       * Converts `string`, as a whole, to lower case just like
       * [String#toLowerCase](https://mdn.io/toLowerCase).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the lower cased string.
       * @example
       *
       * _.toLower('--Foo-Bar--');
       * // => '--foo-bar--'
       *
       * _.toLower('fooBar');
       * // => 'foobar'
       *
       * _.toLower('__FOO_BAR__');
       * // => '__foo_bar__'
       */
      function toLower(value) {
        return toString(value).toLowerCase();
      }

      /**
       * Converts `string`, as a whole, to upper case just like
       * [String#toUpperCase](https://mdn.io/toUpperCase).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the upper cased string.
       * @example
       *
       * _.toUpper('--foo-bar--');
       * // => '--FOO-BAR--'
       *
       * _.toUpper('fooBar');
       * // => 'FOOBAR'
       *
       * _.toUpper('__foo_bar__');
       * // => '__FOO_BAR__'
       */
      function toUpper(value) {
        return toString(value).toUpperCase();
      }

      /**
       * Removes leading and trailing whitespace or specified characters from `string`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to trim.
       * @param {string} [chars=whitespace] The characters to trim.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {string} Returns the trimmed string.
       * @example
       *
       * _.trim('  abc  ');
       * // => 'abc'
       *
       * _.trim('-_-abc-_-', '_-');
       * // => 'abc'
       *
       * _.map(['  foo  ', '  bar  '], _.trim);
       * // => ['foo', 'bar']
       */
      function trim(string, chars, guard) {
        string = toString(string);
        if (string && (guard || chars === undefined$1)) {
          return baseTrim(string);
        }
        if (!string || !(chars = baseToString(chars))) {
          return string;
        }
        var strSymbols = stringToArray(string),
            chrSymbols = stringToArray(chars),
            start = charsStartIndex(strSymbols, chrSymbols),
            end = charsEndIndex(strSymbols, chrSymbols) + 1;

        return castSlice(strSymbols, start, end).join('');
      }

      /**
       * Removes trailing whitespace or specified characters from `string`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to trim.
       * @param {string} [chars=whitespace] The characters to trim.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {string} Returns the trimmed string.
       * @example
       *
       * _.trimEnd('  abc  ');
       * // => '  abc'
       *
       * _.trimEnd('-_-abc-_-', '_-');
       * // => '-_-abc'
       */
      function trimEnd(string, chars, guard) {
        string = toString(string);
        if (string && (guard || chars === undefined$1)) {
          return string.slice(0, trimmedEndIndex(string) + 1);
        }
        if (!string || !(chars = baseToString(chars))) {
          return string;
        }
        var strSymbols = stringToArray(string),
            end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;

        return castSlice(strSymbols, 0, end).join('');
      }

      /**
       * Removes leading whitespace or specified characters from `string`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to trim.
       * @param {string} [chars=whitespace] The characters to trim.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {string} Returns the trimmed string.
       * @example
       *
       * _.trimStart('  abc  ');
       * // => 'abc  '
       *
       * _.trimStart('-_-abc-_-', '_-');
       * // => 'abc-_-'
       */
      function trimStart(string, chars, guard) {
        string = toString(string);
        if (string && (guard || chars === undefined$1)) {
          return string.replace(reTrimStart, '');
        }
        if (!string || !(chars = baseToString(chars))) {
          return string;
        }
        var strSymbols = stringToArray(string),
            start = charsStartIndex(strSymbols, stringToArray(chars));

        return castSlice(strSymbols, start).join('');
      }

      /**
       * Truncates `string` if it's longer than the given maximum string length.
       * The last characters of the truncated string are replaced with the omission
       * string which defaults to "...".
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to truncate.
       * @param {Object} [options={}] The options object.
       * @param {number} [options.length=30] The maximum string length.
       * @param {string} [options.omission='...'] The string to indicate text is omitted.
       * @param {RegExp|string} [options.separator] The separator pattern to truncate to.
       * @returns {string} Returns the truncated string.
       * @example
       *
       * _.truncate('hi-diddly-ho there, neighborino');
       * // => 'hi-diddly-ho there, neighbo...'
       *
       * _.truncate('hi-diddly-ho there, neighborino', {
       *   'length': 24,
       *   'separator': ' '
       * });
       * // => 'hi-diddly-ho there,...'
       *
       * _.truncate('hi-diddly-ho there, neighborino', {
       *   'length': 24,
       *   'separator': /,? +/
       * });
       * // => 'hi-diddly-ho there...'
       *
       * _.truncate('hi-diddly-ho there, neighborino', {
       *   'omission': ' [...]'
       * });
       * // => 'hi-diddly-ho there, neig [...]'
       */
      function truncate(string, options) {
        var length = DEFAULT_TRUNC_LENGTH,
            omission = DEFAULT_TRUNC_OMISSION;

        if (isObject(options)) {
          var separator = 'separator' in options ? options.separator : separator;
          length = 'length' in options ? toInteger(options.length) : length;
          omission = 'omission' in options ? baseToString(options.omission) : omission;
        }
        string = toString(string);

        var strLength = string.length;
        if (hasUnicode(string)) {
          var strSymbols = stringToArray(string);
          strLength = strSymbols.length;
        }
        if (length >= strLength) {
          return string;
        }
        var end = length - stringSize(omission);
        if (end < 1) {
          return omission;
        }
        var result = strSymbols
          ? castSlice(strSymbols, 0, end).join('')
          : string.slice(0, end);

        if (separator === undefined$1) {
          return result + omission;
        }
        if (strSymbols) {
          end += (result.length - end);
        }
        if (isRegExp(separator)) {
          if (string.slice(end).search(separator)) {
            var match,
                substring = result;

            if (!separator.global) {
              separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');
            }
            separator.lastIndex = 0;
            while ((match = separator.exec(substring))) {
              var newEnd = match.index;
            }
            result = result.slice(0, newEnd === undefined$1 ? end : newEnd);
          }
        } else if (string.indexOf(baseToString(separator), end) != end) {
          var index = result.lastIndexOf(separator);
          if (index > -1) {
            result = result.slice(0, index);
          }
        }
        return result + omission;
      }

      /**
       * The inverse of `_.escape`; this method converts the HTML entities
       * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to
       * their corresponding characters.
       *
       * **Note:** No other HTML entities are unescaped. To unescape additional
       * HTML entities use a third-party library like [_he_](https://mths.be/he).
       *
       * @static
       * @memberOf _
       * @since 0.6.0
       * @category String
       * @param {string} [string=''] The string to unescape.
       * @returns {string} Returns the unescaped string.
       * @example
       *
       * _.unescape('fred, barney, &amp; pebbles');
       * // => 'fred, barney, & pebbles'
       */
      function unescape(string) {
        string = toString(string);
        return (string && reHasEscapedHtml.test(string))
          ? string.replace(reEscapedHtml, unescapeHtmlChar)
          : string;
      }

      /**
       * Converts `string`, as space separated words, to upper case.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the upper cased string.
       * @example
       *
       * _.upperCase('--foo-bar');
       * // => 'FOO BAR'
       *
       * _.upperCase('fooBar');
       * // => 'FOO BAR'
       *
       * _.upperCase('__foo_bar__');
       * // => 'FOO BAR'
       */
      var upperCase = createCompounder(function(result, word, index) {
        return result + (index ? ' ' : '') + word.toUpperCase();
      });

      /**
       * Converts the first character of `string` to upper case.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category String
       * @param {string} [string=''] The string to convert.
       * @returns {string} Returns the converted string.
       * @example
       *
       * _.upperFirst('fred');
       * // => 'Fred'
       *
       * _.upperFirst('FRED');
       * // => 'FRED'
       */
      var upperFirst = createCaseFirst('toUpperCase');

      /**
       * Splits `string` into an array of its words.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category String
       * @param {string} [string=''] The string to inspect.
       * @param {RegExp|string} [pattern] The pattern to match words.
       * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.
       * @returns {Array} Returns the words of `string`.
       * @example
       *
       * _.words('fred, barney, & pebbles');
       * // => ['fred', 'barney', 'pebbles']
       *
       * _.words('fred, barney, & pebbles', /[^, ]+/g);
       * // => ['fred', 'barney', '&', 'pebbles']
       */
      function words(string, pattern, guard) {
        string = toString(string);
        pattern = guard ? undefined$1 : pattern;

        if (pattern === undefined$1) {
          return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);
        }
        return string.match(pattern) || [];
      }

      /*------------------------------------------------------------------------*/

      /**
       * Attempts to invoke `func`, returning either the result or the caught error
       * object. Any additional arguments are provided to `func` when it's invoked.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Util
       * @param {Function} func The function to attempt.
       * @param {...*} [args] The arguments to invoke `func` with.
       * @returns {*} Returns the `func` result or error object.
       * @example
       *
       * // Avoid throwing errors for invalid selectors.
       * var elements = _.attempt(function(selector) {
       *   return document.querySelectorAll(selector);
       * }, '>_>');
       *
       * if (_.isError(elements)) {
       *   elements = [];
       * }
       */
      var attempt = baseRest(function(func, args) {
        try {
          return apply(func, undefined$1, args);
        } catch (e) {
          return isError(e) ? e : new Error(e);
        }
      });

      /**
       * Binds methods of an object to the object itself, overwriting the existing
       * method.
       *
       * **Note:** This method doesn't set the "length" property of bound functions.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {Object} object The object to bind and assign the bound methods to.
       * @param {...(string|string[])} methodNames The object method names to bind.
       * @returns {Object} Returns `object`.
       * @example
       *
       * var view = {
       *   'label': 'docs',
       *   'click': function() {
       *     console.log('clicked ' + this.label);
       *   }
       * };
       *
       * _.bindAll(view, ['click']);
       * jQuery(element).on('click', view.click);
       * // => Logs 'clicked docs' when clicked.
       */
      var bindAll = flatRest(function(object, methodNames) {
        arrayEach(methodNames, function(key) {
          key = toKey(key);
          baseAssignValue(object, key, bind(object[key], object));
        });
        return object;
      });

      /**
       * Creates a function that iterates over `pairs` and invokes the corresponding
       * function of the first predicate to return truthy. The predicate-function
       * pairs are invoked with the `this` binding and arguments of the created
       * function.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {Array} pairs The predicate-function pairs.
       * @returns {Function} Returns the new composite function.
       * @example
       *
       * var func = _.cond([
       *   [_.matches({ 'a': 1 }),           _.constant('matches A')],
       *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],
       *   [_.stubTrue,                      _.constant('no match')]
       * ]);
       *
       * func({ 'a': 1, 'b': 2 });
       * // => 'matches A'
       *
       * func({ 'a': 0, 'b': 1 });
       * // => 'matches B'
       *
       * func({ 'a': '1', 'b': '2' });
       * // => 'no match'
       */
      function cond(pairs) {
        var length = pairs == null ? 0 : pairs.length,
            toIteratee = getIteratee();

        pairs = !length ? [] : arrayMap(pairs, function(pair) {
          if (typeof pair[1] != 'function') {
            throw new TypeError(FUNC_ERROR_TEXT);
          }
          return [toIteratee(pair[0]), pair[1]];
        });

        return baseRest(function(args) {
          var index = -1;
          while (++index < length) {
            var pair = pairs[index];
            if (apply(pair[0], this, args)) {
              return apply(pair[1], this, args);
            }
          }
        });
      }

      /**
       * Creates a function that invokes the predicate properties of `source` with
       * the corresponding property values of a given object, returning `true` if
       * all predicates return truthy, else `false`.
       *
       * **Note:** The created function is equivalent to `_.conformsTo` with
       * `source` partially applied.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {Object} source The object of property predicates to conform to.
       * @returns {Function} Returns the new spec function.
       * @example
       *
       * var objects = [
       *   { 'a': 2, 'b': 1 },
       *   { 'a': 1, 'b': 2 }
       * ];
       *
       * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));
       * // => [{ 'a': 1, 'b': 2 }]
       */
      function conforms(source) {
        return baseConforms(baseClone(source, CLONE_DEEP_FLAG));
      }

      /**
       * Creates a function that returns `value`.
       *
       * @static
       * @memberOf _
       * @since 2.4.0
       * @category Util
       * @param {*} value The value to return from the new function.
       * @returns {Function} Returns the new constant function.
       * @example
       *
       * var objects = _.times(2, _.constant({ 'a': 1 }));
       *
       * console.log(objects);
       * // => [{ 'a': 1 }, { 'a': 1 }]
       *
       * console.log(objects[0] === objects[1]);
       * // => true
       */
      function constant(value) {
        return function() {
          return value;
        };
      }

      /**
       * Checks `value` to determine whether a default value should be returned in
       * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,
       * or `undefined`.
       *
       * @static
       * @memberOf _
       * @since 4.14.0
       * @category Util
       * @param {*} value The value to check.
       * @param {*} defaultValue The default value.
       * @returns {*} Returns the resolved value.
       * @example
       *
       * _.defaultTo(1, 10);
       * // => 1
       *
       * _.defaultTo(undefined, 10);
       * // => 10
       */
      function defaultTo(value, defaultValue) {
        return (value == null || value !== value) ? defaultValue : value;
      }

      /**
       * Creates a function that returns the result of invoking the given functions
       * with the `this` binding of the created function, where each successive
       * invocation is supplied the return value of the previous.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Util
       * @param {...(Function|Function[])} [funcs] The functions to invoke.
       * @returns {Function} Returns the new composite function.
       * @see _.flowRight
       * @example
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * var addSquare = _.flow([_.add, square]);
       * addSquare(1, 2);
       * // => 9
       */
      var flow = createFlow();

      /**
       * This method is like `_.flow` except that it creates a function that
       * invokes the given functions from right to left.
       *
       * @static
       * @since 3.0.0
       * @memberOf _
       * @category Util
       * @param {...(Function|Function[])} [funcs] The functions to invoke.
       * @returns {Function} Returns the new composite function.
       * @see _.flow
       * @example
       *
       * function square(n) {
       *   return n * n;
       * }
       *
       * var addSquare = _.flowRight([square, _.add]);
       * addSquare(1, 2);
       * // => 9
       */
      var flowRight = createFlow(true);

      /**
       * This method returns the first argument it receives.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {*} value Any value.
       * @returns {*} Returns `value`.
       * @example
       *
       * var object = { 'a': 1 };
       *
       * console.log(_.identity(object) === object);
       * // => true
       */
      function identity(value) {
        return value;
      }

      /**
       * Creates a function that invokes `func` with the arguments of the created
       * function. If `func` is a property name, the created function returns the
       * property value for a given element. If `func` is an array or object, the
       * created function returns `true` for elements that contain the equivalent
       * source properties, otherwise it returns `false`.
       *
       * @static
       * @since 4.0.0
       * @memberOf _
       * @category Util
       * @param {*} [func=_.identity] The value to convert to a callback.
       * @returns {Function} Returns the callback.
       * @example
       *
       * var users = [
       *   { 'user': 'barney', 'age': 36, 'active': true },
       *   { 'user': 'fred',   'age': 40, 'active': false }
       * ];
       *
       * // The `_.matches` iteratee shorthand.
       * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));
       * // => [{ 'user': 'barney', 'age': 36, 'active': true }]
       *
       * // The `_.matchesProperty` iteratee shorthand.
       * _.filter(users, _.iteratee(['user', 'fred']));
       * // => [{ 'user': 'fred', 'age': 40 }]
       *
       * // The `_.property` iteratee shorthand.
       * _.map(users, _.iteratee('user'));
       * // => ['barney', 'fred']
       *
       * // Create custom iteratee shorthands.
       * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {
       *   return !_.isRegExp(func) ? iteratee(func) : function(string) {
       *     return func.test(string);
       *   };
       * });
       *
       * _.filter(['abc', 'def'], /ef/);
       * // => ['def']
       */
      function iteratee(func) {
        return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));
      }

      /**
       * Creates a function that performs a partial deep comparison between a given
       * object and `source`, returning `true` if the given object has equivalent
       * property values, else `false`.
       *
       * **Note:** The created function is equivalent to `_.isMatch` with `source`
       * partially applied.
       *
       * Partial comparisons will match empty array and empty object `source`
       * values against any array or object value, respectively. See `_.isEqual`
       * for a list of supported value comparisons.
       *
       * **Note:** Multiple values can be checked by combining several matchers
       * using `_.overSome`
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Util
       * @param {Object} source The object of property values to match.
       * @returns {Function} Returns the new spec function.
       * @example
       *
       * var objects = [
       *   { 'a': 1, 'b': 2, 'c': 3 },
       *   { 'a': 4, 'b': 5, 'c': 6 }
       * ];
       *
       * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));
       * // => [{ 'a': 4, 'b': 5, 'c': 6 }]
       *
       * // Checking for several possible values
       * _.filter(objects, _.overSome([_.matches({ 'a': 1 }), _.matches({ 'a': 4 })]));
       * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]
       */
      function matches(source) {
        return baseMatches(baseClone(source, CLONE_DEEP_FLAG));
      }

      /**
       * Creates a function that performs a partial deep comparison between the
       * value at `path` of a given object to `srcValue`, returning `true` if the
       * object value is equivalent, else `false`.
       *
       * **Note:** Partial comparisons will match empty array and empty object
       * `srcValue` values against any array or object value, respectively. See
       * `_.isEqual` for a list of supported value comparisons.
       *
       * **Note:** Multiple values can be checked by combining several matchers
       * using `_.overSome`
       *
       * @static
       * @memberOf _
       * @since 3.2.0
       * @category Util
       * @param {Array|string} path The path of the property to get.
       * @param {*} srcValue The value to match.
       * @returns {Function} Returns the new spec function.
       * @example
       *
       * var objects = [
       *   { 'a': 1, 'b': 2, 'c': 3 },
       *   { 'a': 4, 'b': 5, 'c': 6 }
       * ];
       *
       * _.find(objects, _.matchesProperty('a', 4));
       * // => { 'a': 4, 'b': 5, 'c': 6 }
       *
       * // Checking for several possible values
       * _.filter(objects, _.overSome([_.matchesProperty('a', 1), _.matchesProperty('a', 4)]));
       * // => [{ 'a': 1, 'b': 2, 'c': 3 }, { 'a': 4, 'b': 5, 'c': 6 }]
       */
      function matchesProperty(path, srcValue) {
        return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));
      }

      /**
       * Creates a function that invokes the method at `path` of a given object.
       * Any additional arguments are provided to the invoked method.
       *
       * @static
       * @memberOf _
       * @since 3.7.0
       * @category Util
       * @param {Array|string} path The path of the method to invoke.
       * @param {...*} [args] The arguments to invoke the method with.
       * @returns {Function} Returns the new invoker function.
       * @example
       *
       * var objects = [
       *   { 'a': { 'b': _.constant(2) } },
       *   { 'a': { 'b': _.constant(1) } }
       * ];
       *
       * _.map(objects, _.method('a.b'));
       * // => [2, 1]
       *
       * _.map(objects, _.method(['a', 'b']));
       * // => [2, 1]
       */
      var method = baseRest(function(path, args) {
        return function(object) {
          return baseInvoke(object, path, args);
        };
      });

      /**
       * The opposite of `_.method`; this method creates a function that invokes
       * the method at a given path of `object`. Any additional arguments are
       * provided to the invoked method.
       *
       * @static
       * @memberOf _
       * @since 3.7.0
       * @category Util
       * @param {Object} object The object to query.
       * @param {...*} [args] The arguments to invoke the method with.
       * @returns {Function} Returns the new invoker function.
       * @example
       *
       * var array = _.times(3, _.constant),
       *     object = { 'a': array, 'b': array, 'c': array };
       *
       * _.map(['a[2]', 'c[0]'], _.methodOf(object));
       * // => [2, 0]
       *
       * _.map([['a', '2'], ['c', '0']], _.methodOf(object));
       * // => [2, 0]
       */
      var methodOf = baseRest(function(object, args) {
        return function(path) {
          return baseInvoke(object, path, args);
        };
      });

      /**
       * Adds all own enumerable string keyed function properties of a source
       * object to the destination object. If `object` is a function, then methods
       * are added to its prototype as well.
       *
       * **Note:** Use `_.runInContext` to create a pristine `lodash` function to
       * avoid conflicts caused by modifying the original.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {Function|Object} [object=lodash] The destination object.
       * @param {Object} source The object of functions to add.
       * @param {Object} [options={}] The options object.
       * @param {boolean} [options.chain=true] Specify whether mixins are chainable.
       * @returns {Function|Object} Returns `object`.
       * @example
       *
       * function vowels(string) {
       *   return _.filter(string, function(v) {
       *     return /[aeiou]/i.test(v);
       *   });
       * }
       *
       * _.mixin({ 'vowels': vowels });
       * _.vowels('fred');
       * // => ['e']
       *
       * _('fred').vowels().value();
       * // => ['e']
       *
       * _.mixin({ 'vowels': vowels }, { 'chain': false });
       * _('fred').vowels();
       * // => ['e']
       */
      function mixin(object, source, options) {
        var props = keys(source),
            methodNames = baseFunctions(source, props);

        if (options == null &&
            !(isObject(source) && (methodNames.length || !props.length))) {
          options = source;
          source = object;
          object = this;
          methodNames = baseFunctions(source, keys(source));
        }
        var chain = !(isObject(options) && 'chain' in options) || !!options.chain,
            isFunc = isFunction(object);

        arrayEach(methodNames, function(methodName) {
          var func = source[methodName];
          object[methodName] = func;
          if (isFunc) {
            object.prototype[methodName] = function() {
              var chainAll = this.__chain__;
              if (chain || chainAll) {
                var result = object(this.__wrapped__),
                    actions = result.__actions__ = copyArray(this.__actions__);

                actions.push({ 'func': func, 'args': arguments, 'thisArg': object });
                result.__chain__ = chainAll;
                return result;
              }
              return func.apply(object, arrayPush([this.value()], arguments));
            };
          }
        });

        return object;
      }

      /**
       * Reverts the `_` variable to its previous value and returns a reference to
       * the `lodash` function.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @returns {Function} Returns the `lodash` function.
       * @example
       *
       * var lodash = _.noConflict();
       */
      function noConflict() {
        if (root._ === this) {
          root._ = oldDash;
        }
        return this;
      }

      /**
       * This method returns `undefined`.
       *
       * @static
       * @memberOf _
       * @since 2.3.0
       * @category Util
       * @example
       *
       * _.times(2, _.noop);
       * // => [undefined, undefined]
       */
      function noop() {
        // No operation performed.
      }

      /**
       * Creates a function that gets the argument at index `n`. If `n` is negative,
       * the nth argument from the end is returned.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {number} [n=0] The index of the argument to return.
       * @returns {Function} Returns the new pass-thru function.
       * @example
       *
       * var func = _.nthArg(1);
       * func('a', 'b', 'c', 'd');
       * // => 'b'
       *
       * var func = _.nthArg(-2);
       * func('a', 'b', 'c', 'd');
       * // => 'c'
       */
      function nthArg(n) {
        n = toInteger(n);
        return baseRest(function(args) {
          return baseNth(args, n);
        });
      }

      /**
       * Creates a function that invokes `iteratees` with the arguments it receives
       * and returns their results.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {...(Function|Function[])} [iteratees=[_.identity]]
       *  The iteratees to invoke.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var func = _.over([Math.max, Math.min]);
       *
       * func(1, 2, 3, 4);
       * // => [4, 1]
       */
      var over = createOver(arrayMap);

      /**
       * Creates a function that checks if **all** of the `predicates` return
       * truthy when invoked with the arguments it receives.
       *
       * Following shorthands are possible for providing predicates.
       * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.
       * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {...(Function|Function[])} [predicates=[_.identity]]
       *  The predicates to check.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var func = _.overEvery([Boolean, isFinite]);
       *
       * func('1');
       * // => true
       *
       * func(null);
       * // => false
       *
       * func(NaN);
       * // => false
       */
      var overEvery = createOver(arrayEvery);

      /**
       * Creates a function that checks if **any** of the `predicates` return
       * truthy when invoked with the arguments it receives.
       *
       * Following shorthands are possible for providing predicates.
       * Pass an `Object` and it will be used as an parameter for `_.matches` to create the predicate.
       * Pass an `Array` of parameters for `_.matchesProperty` and the predicate will be created using them.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {...(Function|Function[])} [predicates=[_.identity]]
       *  The predicates to check.
       * @returns {Function} Returns the new function.
       * @example
       *
       * var func = _.overSome([Boolean, isFinite]);
       *
       * func('1');
       * // => true
       *
       * func(null);
       * // => true
       *
       * func(NaN);
       * // => false
       *
       * var matchesFunc = _.overSome([{ 'a': 1 }, { 'a': 2 }])
       * var matchesPropertyFunc = _.overSome([['a', 1], ['a', 2]])
       */
      var overSome = createOver(arraySome);

      /**
       * Creates a function that returns the value at `path` of a given object.
       *
       * @static
       * @memberOf _
       * @since 2.4.0
       * @category Util
       * @param {Array|string} path The path of the property to get.
       * @returns {Function} Returns the new accessor function.
       * @example
       *
       * var objects = [
       *   { 'a': { 'b': 2 } },
       *   { 'a': { 'b': 1 } }
       * ];
       *
       * _.map(objects, _.property('a.b'));
       * // => [2, 1]
       *
       * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');
       * // => [1, 2]
       */
      function property(path) {
        return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);
      }

      /**
       * The opposite of `_.property`; this method creates a function that returns
       * the value at a given path of `object`.
       *
       * @static
       * @memberOf _
       * @since 3.0.0
       * @category Util
       * @param {Object} object The object to query.
       * @returns {Function} Returns the new accessor function.
       * @example
       *
       * var array = [0, 1, 2],
       *     object = { 'a': array, 'b': array, 'c': array };
       *
       * _.map(['a[2]', 'c[0]'], _.propertyOf(object));
       * // => [2, 0]
       *
       * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));
       * // => [2, 0]
       */
      function propertyOf(object) {
        return function(path) {
          return object == null ? undefined$1 : baseGet(object, path);
        };
      }

      /**
       * Creates an array of numbers (positive and/or negative) progressing from
       * `start` up to, but not including, `end`. A step of `-1` is used if a negative
       * `start` is specified without an `end` or `step`. If `end` is not specified,
       * it's set to `start` with `start` then set to `0`.
       *
       * **Note:** JavaScript follows the IEEE-754 standard for resolving
       * floating-point values which can produce unexpected results.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {number} [start=0] The start of the range.
       * @param {number} end The end of the range.
       * @param {number} [step=1] The value to increment or decrement by.
       * @returns {Array} Returns the range of numbers.
       * @see _.inRange, _.rangeRight
       * @example
       *
       * _.range(4);
       * // => [0, 1, 2, 3]
       *
       * _.range(-4);
       * // => [0, -1, -2, -3]
       *
       * _.range(1, 5);
       * // => [1, 2, 3, 4]
       *
       * _.range(0, 20, 5);
       * // => [0, 5, 10, 15]
       *
       * _.range(0, -4, -1);
       * // => [0, -1, -2, -3]
       *
       * _.range(1, 4, 0);
       * // => [1, 1, 1]
       *
       * _.range(0);
       * // => []
       */
      var range = createRange();

      /**
       * This method is like `_.range` except that it populates values in
       * descending order.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {number} [start=0] The start of the range.
       * @param {number} end The end of the range.
       * @param {number} [step=1] The value to increment or decrement by.
       * @returns {Array} Returns the range of numbers.
       * @see _.inRange, _.range
       * @example
       *
       * _.rangeRight(4);
       * // => [3, 2, 1, 0]
       *
       * _.rangeRight(-4);
       * // => [-3, -2, -1, 0]
       *
       * _.rangeRight(1, 5);
       * // => [4, 3, 2, 1]
       *
       * _.rangeRight(0, 20, 5);
       * // => [15, 10, 5, 0]
       *
       * _.rangeRight(0, -4, -1);
       * // => [-3, -2, -1, 0]
       *
       * _.rangeRight(1, 4, 0);
       * // => [1, 1, 1]
       *
       * _.rangeRight(0);
       * // => []
       */
      var rangeRight = createRange(true);

      /**
       * This method returns a new empty array.
       *
       * @static
       * @memberOf _
       * @since 4.13.0
       * @category Util
       * @returns {Array} Returns the new empty array.
       * @example
       *
       * var arrays = _.times(2, _.stubArray);
       *
       * console.log(arrays);
       * // => [[], []]
       *
       * console.log(arrays[0] === arrays[1]);
       * // => false
       */
      function stubArray() {
        return [];
      }

      /**
       * This method returns `false`.
       *
       * @static
       * @memberOf _
       * @since 4.13.0
       * @category Util
       * @returns {boolean} Returns `false`.
       * @example
       *
       * _.times(2, _.stubFalse);
       * // => [false, false]
       */
      function stubFalse() {
        return false;
      }

      /**
       * This method returns a new empty object.
       *
       * @static
       * @memberOf _
       * @since 4.13.0
       * @category Util
       * @returns {Object} Returns the new empty object.
       * @example
       *
       * var objects = _.times(2, _.stubObject);
       *
       * console.log(objects);
       * // => [{}, {}]
       *
       * console.log(objects[0] === objects[1]);
       * // => false
       */
      function stubObject() {
        return {};
      }

      /**
       * This method returns an empty string.
       *
       * @static
       * @memberOf _
       * @since 4.13.0
       * @category Util
       * @returns {string} Returns the empty string.
       * @example
       *
       * _.times(2, _.stubString);
       * // => ['', '']
       */
      function stubString() {
        return '';
      }

      /**
       * This method returns `true`.
       *
       * @static
       * @memberOf _
       * @since 4.13.0
       * @category Util
       * @returns {boolean} Returns `true`.
       * @example
       *
       * _.times(2, _.stubTrue);
       * // => [true, true]
       */
      function stubTrue() {
        return true;
      }

      /**
       * Invokes the iteratee `n` times, returning an array of the results of
       * each invocation. The iteratee is invoked with one argument; (index).
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {number} n The number of times to invoke `iteratee`.
       * @param {Function} [iteratee=_.identity] The function invoked per iteration.
       * @returns {Array} Returns the array of results.
       * @example
       *
       * _.times(3, String);
       * // => ['0', '1', '2']
       *
       *  _.times(4, _.constant(0));
       * // => [0, 0, 0, 0]
       */
      function times(n, iteratee) {
        n = toInteger(n);
        if (n < 1 || n > MAX_SAFE_INTEGER) {
          return [];
        }
        var index = MAX_ARRAY_LENGTH,
            length = nativeMin(n, MAX_ARRAY_LENGTH);

        iteratee = getIteratee(iteratee);
        n -= MAX_ARRAY_LENGTH;

        var result = baseTimes(length, iteratee);
        while (++index < n) {
          iteratee(index);
        }
        return result;
      }

      /**
       * Converts `value` to a property path array.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Util
       * @param {*} value The value to convert.
       * @returns {Array} Returns the new property path array.
       * @example
       *
       * _.toPath('a.b.c');
       * // => ['a', 'b', 'c']
       *
       * _.toPath('a[0].b.c');
       * // => ['a', '0', 'b', 'c']
       */
      function toPath(value) {
        if (isArray(value)) {
          return arrayMap(value, toKey);
        }
        return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));
      }

      /**
       * Generates a unique ID. If `prefix` is given, the ID is appended to it.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Util
       * @param {string} [prefix=''] The value to prefix the ID with.
       * @returns {string} Returns the unique ID.
       * @example
       *
       * _.uniqueId('contact_');
       * // => 'contact_104'
       *
       * _.uniqueId();
       * // => '105'
       */
      function uniqueId(prefix) {
        var id = ++idCounter;
        return toString(prefix) + id;
      }

      /*------------------------------------------------------------------------*/

      /**
       * Adds two numbers.
       *
       * @static
       * @memberOf _
       * @since 3.4.0
       * @category Math
       * @param {number} augend The first number in an addition.
       * @param {number} addend The second number in an addition.
       * @returns {number} Returns the total.
       * @example
       *
       * _.add(6, 4);
       * // => 10
       */
      var add = createMathOperation(function(augend, addend) {
        return augend + addend;
      }, 0);

      /**
       * Computes `number` rounded up to `precision`.
       *
       * @static
       * @memberOf _
       * @since 3.10.0
       * @category Math
       * @param {number} number The number to round up.
       * @param {number} [precision=0] The precision to round up to.
       * @returns {number} Returns the rounded up number.
       * @example
       *
       * _.ceil(4.006);
       * // => 5
       *
       * _.ceil(6.004, 2);
       * // => 6.01
       *
       * _.ceil(6040, -2);
       * // => 6100
       */
      var ceil = createRound('ceil');

      /**
       * Divide two numbers.
       *
       * @static
       * @memberOf _
       * @since 4.7.0
       * @category Math
       * @param {number} dividend The first number in a division.
       * @param {number} divisor The second number in a division.
       * @returns {number} Returns the quotient.
       * @example
       *
       * _.divide(6, 4);
       * // => 1.5
       */
      var divide = createMathOperation(function(dividend, divisor) {
        return dividend / divisor;
      }, 1);

      /**
       * Computes `number` rounded down to `precision`.
       *
       * @static
       * @memberOf _
       * @since 3.10.0
       * @category Math
       * @param {number} number The number to round down.
       * @param {number} [precision=0] The precision to round down to.
       * @returns {number} Returns the rounded down number.
       * @example
       *
       * _.floor(4.006);
       * // => 4
       *
       * _.floor(0.046, 2);
       * // => 0.04
       *
       * _.floor(4060, -2);
       * // => 4000
       */
      var floor = createRound('floor');

      /**
       * Computes the maximum value of `array`. If `array` is empty or falsey,
       * `undefined` is returned.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Math
       * @param {Array} array The array to iterate over.
       * @returns {*} Returns the maximum value.
       * @example
       *
       * _.max([4, 2, 8, 6]);
       * // => 8
       *
       * _.max([]);
       * // => undefined
       */
      function max(array) {
        return (array && array.length)
          ? baseExtremum(array, identity, baseGt)
          : undefined$1;
      }

      /**
       * This method is like `_.max` except that it accepts `iteratee` which is
       * invoked for each element in `array` to generate the criterion by which
       * the value is ranked. The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {*} Returns the maximum value.
       * @example
       *
       * var objects = [{ 'n': 1 }, { 'n': 2 }];
       *
       * _.maxBy(objects, function(o) { return o.n; });
       * // => { 'n': 2 }
       *
       * // The `_.property` iteratee shorthand.
       * _.maxBy(objects, 'n');
       * // => { 'n': 2 }
       */
      function maxBy(array, iteratee) {
        return (array && array.length)
          ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)
          : undefined$1;
      }

      /**
       * Computes the mean of the values in `array`.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @returns {number} Returns the mean.
       * @example
       *
       * _.mean([4, 2, 8, 6]);
       * // => 5
       */
      function mean(array) {
        return baseMean(array, identity);
      }

      /**
       * This method is like `_.mean` except that it accepts `iteratee` which is
       * invoked for each element in `array` to generate the value to be averaged.
       * The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.7.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {number} Returns the mean.
       * @example
       *
       * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];
       *
       * _.meanBy(objects, function(o) { return o.n; });
       * // => 5
       *
       * // The `_.property` iteratee shorthand.
       * _.meanBy(objects, 'n');
       * // => 5
       */
      function meanBy(array, iteratee) {
        return baseMean(array, getIteratee(iteratee, 2));
      }

      /**
       * Computes the minimum value of `array`. If `array` is empty or falsey,
       * `undefined` is returned.
       *
       * @static
       * @since 0.1.0
       * @memberOf _
       * @category Math
       * @param {Array} array The array to iterate over.
       * @returns {*} Returns the minimum value.
       * @example
       *
       * _.min([4, 2, 8, 6]);
       * // => 2
       *
       * _.min([]);
       * // => undefined
       */
      function min(array) {
        return (array && array.length)
          ? baseExtremum(array, identity, baseLt)
          : undefined$1;
      }

      /**
       * This method is like `_.min` except that it accepts `iteratee` which is
       * invoked for each element in `array` to generate the criterion by which
       * the value is ranked. The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {*} Returns the minimum value.
       * @example
       *
       * var objects = [{ 'n': 1 }, { 'n': 2 }];
       *
       * _.minBy(objects, function(o) { return o.n; });
       * // => { 'n': 1 }
       *
       * // The `_.property` iteratee shorthand.
       * _.minBy(objects, 'n');
       * // => { 'n': 1 }
       */
      function minBy(array, iteratee) {
        return (array && array.length)
          ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)
          : undefined$1;
      }

      /**
       * Multiply two numbers.
       *
       * @static
       * @memberOf _
       * @since 4.7.0
       * @category Math
       * @param {number} multiplier The first number in a multiplication.
       * @param {number} multiplicand The second number in a multiplication.
       * @returns {number} Returns the product.
       * @example
       *
       * _.multiply(6, 4);
       * // => 24
       */
      var multiply = createMathOperation(function(multiplier, multiplicand) {
        return multiplier * multiplicand;
      }, 1);

      /**
       * Computes `number` rounded to `precision`.
       *
       * @static
       * @memberOf _
       * @since 3.10.0
       * @category Math
       * @param {number} number The number to round.
       * @param {number} [precision=0] The precision to round to.
       * @returns {number} Returns the rounded number.
       * @example
       *
       * _.round(4.006);
       * // => 4
       *
       * _.round(4.006, 2);
       * // => 4.01
       *
       * _.round(4060, -2);
       * // => 4100
       */
      var round = createRound('round');

      /**
       * Subtract two numbers.
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Math
       * @param {number} minuend The first number in a subtraction.
       * @param {number} subtrahend The second number in a subtraction.
       * @returns {number} Returns the difference.
       * @example
       *
       * _.subtract(6, 4);
       * // => 2
       */
      var subtract = createMathOperation(function(minuend, subtrahend) {
        return minuend - subtrahend;
      }, 0);

      /**
       * Computes the sum of the values in `array`.
       *
       * @static
       * @memberOf _
       * @since 3.4.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @returns {number} Returns the sum.
       * @example
       *
       * _.sum([4, 2, 8, 6]);
       * // => 20
       */
      function sum(array) {
        return (array && array.length)
          ? baseSum(array, identity)
          : 0;
      }

      /**
       * This method is like `_.sum` except that it accepts `iteratee` which is
       * invoked for each element in `array` to generate the value to be summed.
       * The iteratee is invoked with one argument: (value).
       *
       * @static
       * @memberOf _
       * @since 4.0.0
       * @category Math
       * @param {Array} array The array to iterate over.
       * @param {Function} [iteratee=_.identity] The iteratee invoked per element.
       * @returns {number} Returns the sum.
       * @example
       *
       * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];
       *
       * _.sumBy(objects, function(o) { return o.n; });
       * // => 20
       *
       * // The `_.property` iteratee shorthand.
       * _.sumBy(objects, 'n');
       * // => 20
       */
      function sumBy(array, iteratee) {
        return (array && array.length)
          ? baseSum(array, getIteratee(iteratee, 2))
          : 0;
      }

      /*------------------------------------------------------------------------*/

      // Add methods that return wrapped values in chain sequences.
      lodash.after = after;
      lodash.ary = ary;
      lodash.assign = assign;
      lodash.assignIn = assignIn;
      lodash.assignInWith = assignInWith;
      lodash.assignWith = assignWith;
      lodash.at = at;
      lodash.before = before;
      lodash.bind = bind;
      lodash.bindAll = bindAll;
      lodash.bindKey = bindKey;
      lodash.castArray = castArray;
      lodash.chain = chain;
      lodash.chunk = chunk;
      lodash.compact = compact;
      lodash.concat = concat;
      lodash.cond = cond;
      lodash.conforms = conforms;
      lodash.constant = constant;
      lodash.countBy = countBy;
      lodash.create = create;
      lodash.curry = curry;
      lodash.curryRight = curryRight;
      lodash.debounce = debounce;
      lodash.defaults = defaults;
      lodash.defaultsDeep = defaultsDeep;
      lodash.defer = defer;
      lodash.delay = delay;
      lodash.difference = difference;
      lodash.differenceBy = differenceBy;
      lodash.differenceWith = differenceWith;
      lodash.drop = drop;
      lodash.dropRight = dropRight;
      lodash.dropRightWhile = dropRightWhile;
      lodash.dropWhile = dropWhile;
      lodash.fill = fill;
      lodash.filter = filter;
      lodash.flatMap = flatMap;
      lodash.flatMapDeep = flatMapDeep;
      lodash.flatMapDepth = flatMapDepth;
      lodash.flatten = flatten;
      lodash.flattenDeep = flattenDeep;
      lodash.flattenDepth = flattenDepth;
      lodash.flip = flip;
      lodash.flow = flow;
      lodash.flowRight = flowRight;
      lodash.fromPairs = fromPairs;
      lodash.functions = functions;
      lodash.functionsIn = functionsIn;
      lodash.groupBy = groupBy;
      lodash.initial = initial;
      lodash.intersection = intersection;
      lodash.intersectionBy = intersectionBy;
      lodash.intersectionWith = intersectionWith;
      lodash.invert = invert;
      lodash.invertBy = invertBy;
      lodash.invokeMap = invokeMap;
      lodash.iteratee = iteratee;
      lodash.keyBy = keyBy;
      lodash.keys = keys;
      lodash.keysIn = keysIn;
      lodash.map = map;
      lodash.mapKeys = mapKeys;
      lodash.mapValues = mapValues;
      lodash.matches = matches;
      lodash.matchesProperty = matchesProperty;
      lodash.memoize = memoize;
      lodash.merge = merge;
      lodash.mergeWith = mergeWith;
      lodash.method = method;
      lodash.methodOf = methodOf;
      lodash.mixin = mixin;
      lodash.negate = negate;
      lodash.nthArg = nthArg;
      lodash.omit = omit;
      lodash.omitBy = omitBy;
      lodash.once = once;
      lodash.orderBy = orderBy;
      lodash.over = over;
      lodash.overArgs = overArgs;
      lodash.overEvery = overEvery;
      lodash.overSome = overSome;
      lodash.partial = partial;
      lodash.partialRight = partialRight;
      lodash.partition = partition;
      lodash.pick = pick;
      lodash.pickBy = pickBy;
      lodash.property = property;
      lodash.propertyOf = propertyOf;
      lodash.pull = pull;
      lodash.pullAll = pullAll;
      lodash.pullAllBy = pullAllBy;
      lodash.pullAllWith = pullAllWith;
      lodash.pullAt = pullAt;
      lodash.range = range;
      lodash.rangeRight = rangeRight;
      lodash.rearg = rearg;
      lodash.reject = reject;
      lodash.remove = remove;
      lodash.rest = rest;
      lodash.reverse = reverse;
      lodash.sampleSize = sampleSize;
      lodash.set = set;
      lodash.setWith = setWith;
      lodash.shuffle = shuffle;
      lodash.slice = slice;
      lodash.sortBy = sortBy;
      lodash.sortedUniq = sortedUniq;
      lodash.sortedUniqBy = sortedUniqBy;
      lodash.split = split;
      lodash.spread = spread;
      lodash.tail = tail;
      lodash.take = take;
      lodash.takeRight = takeRight;
      lodash.takeRightWhile = takeRightWhile;
      lodash.takeWhile = takeWhile;
      lodash.tap = tap;
      lodash.throttle = throttle;
      lodash.thru = thru;
      lodash.toArray = toArray;
      lodash.toPairs = toPairs;
      lodash.toPairsIn = toPairsIn;
      lodash.toPath = toPath;
      lodash.toPlainObject = toPlainObject;
      lodash.transform = transform;
      lodash.unary = unary;
      lodash.union = union;
      lodash.unionBy = unionBy;
      lodash.unionWith = unionWith;
      lodash.uniq = uniq;
      lodash.uniqBy = uniqBy;
      lodash.uniqWith = uniqWith;
      lodash.unset = unset;
      lodash.unzip = unzip;
      lodash.unzipWith = unzipWith;
      lodash.update = update;
      lodash.updateWith = updateWith;
      lodash.values = values;
      lodash.valuesIn = valuesIn;
      lodash.without = without;
      lodash.words = words;
      lodash.wrap = wrap;
      lodash.xor = xor;
      lodash.xorBy = xorBy;
      lodash.xorWith = xorWith;
      lodash.zip = zip;
      lodash.zipObject = zipObject;
      lodash.zipObjectDeep = zipObjectDeep;
      lodash.zipWith = zipWith;

      // Add aliases.
      lodash.entries = toPairs;
      lodash.entriesIn = toPairsIn;
      lodash.extend = assignIn;
      lodash.extendWith = assignInWith;

      // Add methods to `lodash.prototype`.
      mixin(lodash, lodash);

      /*------------------------------------------------------------------------*/

      // Add methods that return unwrapped values in chain sequences.
      lodash.add = add;
      lodash.attempt = attempt;
      lodash.camelCase = camelCase;
      lodash.capitalize = capitalize;
      lodash.ceil = ceil;
      lodash.clamp = clamp;
      lodash.clone = clone;
      lodash.cloneDeep = cloneDeep;
      lodash.cloneDeepWith = cloneDeepWith;
      lodash.cloneWith = cloneWith;
      lodash.conformsTo = conformsTo;
      lodash.deburr = deburr;
      lodash.defaultTo = defaultTo;
      lodash.divide = divide;
      lodash.endsWith = endsWith;
      lodash.eq = eq;
      lodash.escape = escape;
      lodash.escapeRegExp = escapeRegExp;
      lodash.every = every;
      lodash.find = find;
      lodash.findIndex = findIndex;
      lodash.findKey = findKey;
      lodash.findLast = findLast;
      lodash.findLastIndex = findLastIndex;
      lodash.findLastKey = findLastKey;
      lodash.floor = floor;
      lodash.forEach = forEach;
      lodash.forEachRight = forEachRight;
      lodash.forIn = forIn;
      lodash.forInRight = forInRight;
      lodash.forOwn = forOwn;
      lodash.forOwnRight = forOwnRight;
      lodash.get = get;
      lodash.gt = gt;
      lodash.gte = gte;
      lodash.has = has;
      lodash.hasIn = hasIn;
      lodash.head = head;
      lodash.identity = identity;
      lodash.includes = includes;
      lodash.indexOf = indexOf;
      lodash.inRange = inRange;
      lodash.invoke = invoke;
      lodash.isArguments = isArguments;
      lodash.isArray = isArray;
      lodash.isArrayBuffer = isArrayBuffer;
      lodash.isArrayLike = isArrayLike;
      lodash.isArrayLikeObject = isArrayLikeObject;
      lodash.isBoolean = isBoolean;
      lodash.isBuffer = isBuffer;
      lodash.isDate = isDate;
      lodash.isElement = isElement;
      lodash.isEmpty = isEmpty;
      lodash.isEqual = isEqual;
      lodash.isEqualWith = isEqualWith;
      lodash.isError = isError;
      lodash.isFinite = isFinite;
      lodash.isFunction = isFunction;
      lodash.isInteger = isInteger;
      lodash.isLength = isLength;
      lodash.isMap = isMap;
      lodash.isMatch = isMatch;
      lodash.isMatchWith = isMatchWith;
      lodash.isNaN = isNaN;
      lodash.isNative = isNative;
      lodash.isNil = isNil;
      lodash.isNull = isNull;
      lodash.isNumber = isNumber;
      lodash.isObject = isObject;
      lodash.isObjectLike = isObjectLike;
      lodash.isPlainObject = isPlainObject;
      lodash.isRegExp = isRegExp;
      lodash.isSafeInteger = isSafeInteger;
      lodash.isSet = isSet;
      lodash.isString = isString;
      lodash.isSymbol = isSymbol;
      lodash.isTypedArray = isTypedArray;
      lodash.isUndefined = isUndefined;
      lodash.isWeakMap = isWeakMap;
      lodash.isWeakSet = isWeakSet;
      lodash.join = join;
      lodash.kebabCase = kebabCase;
      lodash.last = last;
      lodash.lastIndexOf = lastIndexOf;
      lodash.lowerCase = lowerCase;
      lodash.lowerFirst = lowerFirst;
      lodash.lt = lt;
      lodash.lte = lte;
      lodash.max = max;
      lodash.maxBy = maxBy;
      lodash.mean = mean;
      lodash.meanBy = meanBy;
      lodash.min = min;
      lodash.minBy = minBy;
      lodash.stubArray = stubArray;
      lodash.stubFalse = stubFalse;
      lodash.stubObject = stubObject;
      lodash.stubString = stubString;
      lodash.stubTrue = stubTrue;
      lodash.multiply = multiply;
      lodash.nth = nth;
      lodash.noConflict = noConflict;
      lodash.noop = noop;
      lodash.now = now;
      lodash.pad = pad;
      lodash.padEnd = padEnd;
      lodash.padStart = padStart;
      lodash.parseInt = parseInt;
      lodash.random = random;
      lodash.reduce = reduce;
      lodash.reduceRight = reduceRight;
      lodash.repeat = repeat;
      lodash.replace = replace;
      lodash.result = result;
      lodash.round = round;
      lodash.runInContext = runInContext;
      lodash.sample = sample;
      lodash.size = size;
      lodash.snakeCase = snakeCase;
      lodash.some = some;
      lodash.sortedIndex = sortedIndex;
      lodash.sortedIndexBy = sortedIndexBy;
      lodash.sortedIndexOf = sortedIndexOf;
      lodash.sortedLastIndex = sortedLastIndex;
      lodash.sortedLastIndexBy = sortedLastIndexBy;
      lodash.sortedLastIndexOf = sortedLastIndexOf;
      lodash.startCase = startCase;
      lodash.startsWith = startsWith;
      lodash.subtract = subtract;
      lodash.sum = sum;
      lodash.sumBy = sumBy;
      lodash.template = template;
      lodash.times = times;
      lodash.toFinite = toFinite;
      lodash.toInteger = toInteger;
      lodash.toLength = toLength;
      lodash.toLower = toLower;
      lodash.toNumber = toNumber;
      lodash.toSafeInteger = toSafeInteger;
      lodash.toString = toString;
      lodash.toUpper = toUpper;
      lodash.trim = trim;
      lodash.trimEnd = trimEnd;
      lodash.trimStart = trimStart;
      lodash.truncate = truncate;
      lodash.unescape = unescape;
      lodash.uniqueId = uniqueId;
      lodash.upperCase = upperCase;
      lodash.upperFirst = upperFirst;

      // Add aliases.
      lodash.each = forEach;
      lodash.eachRight = forEachRight;
      lodash.first = head;

      mixin(lodash, (function() {
        var source = {};
        baseForOwn(lodash, function(func, methodName) {
          if (!hasOwnProperty.call(lodash.prototype, methodName)) {
            source[methodName] = func;
          }
        });
        return source;
      }()), { 'chain': false });

      /*------------------------------------------------------------------------*/

      /**
       * The semantic version number.
       *
       * @static
       * @memberOf _
       * @type {string}
       */
      lodash.VERSION = VERSION;

      // Assign default placeholders.
      arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {
        lodash[methodName].placeholder = lodash;
      });

      // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.
      arrayEach(['drop', 'take'], function(methodName, index) {
        LazyWrapper.prototype[methodName] = function(n) {
          n = n === undefined$1 ? 1 : nativeMax(toInteger(n), 0);

          var result = (this.__filtered__ && !index)
            ? new LazyWrapper(this)
            : this.clone();

          if (result.__filtered__) {
            result.__takeCount__ = nativeMin(n, result.__takeCount__);
          } else {
            result.__views__.push({
              'size': nativeMin(n, MAX_ARRAY_LENGTH),
              'type': methodName + (result.__dir__ < 0 ? 'Right' : '')
            });
          }
          return result;
        };

        LazyWrapper.prototype[methodName + 'Right'] = function(n) {
          return this.reverse()[methodName](n).reverse();
        };
      });

      // Add `LazyWrapper` methods that accept an `iteratee` value.
      arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {
        var type = index + 1,
            isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;

        LazyWrapper.prototype[methodName] = function(iteratee) {
          var result = this.clone();
          result.__iteratees__.push({
            'iteratee': getIteratee(iteratee, 3),
            'type': type
          });
          result.__filtered__ = result.__filtered__ || isFilter;
          return result;
        };
      });

      // Add `LazyWrapper` methods for `_.head` and `_.last`.
      arrayEach(['head', 'last'], function(methodName, index) {
        var takeName = 'take' + (index ? 'Right' : '');

        LazyWrapper.prototype[methodName] = function() {
          return this[takeName](1).value()[0];
        };
      });

      // Add `LazyWrapper` methods for `_.initial` and `_.tail`.
      arrayEach(['initial', 'tail'], function(methodName, index) {
        var dropName = 'drop' + (index ? '' : 'Right');

        LazyWrapper.prototype[methodName] = function() {
          return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);
        };
      });

      LazyWrapper.prototype.compact = function() {
        return this.filter(identity);
      };

      LazyWrapper.prototype.find = function(predicate) {
        return this.filter(predicate).head();
      };

      LazyWrapper.prototype.findLast = function(predicate) {
        return this.reverse().find(predicate);
      };

      LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {
        if (typeof path == 'function') {
          return new LazyWrapper(this);
        }
        return this.map(function(value) {
          return baseInvoke(value, path, args);
        });
      });

      LazyWrapper.prototype.reject = function(predicate) {
        return this.filter(negate(getIteratee(predicate)));
      };

      LazyWrapper.prototype.slice = function(start, end) {
        start = toInteger(start);

        var result = this;
        if (result.__filtered__ && (start > 0 || end < 0)) {
          return new LazyWrapper(result);
        }
        if (start < 0) {
          result = result.takeRight(-start);
        } else if (start) {
          result = result.drop(start);
        }
        if (end !== undefined$1) {
          end = toInteger(end);
          result = end < 0 ? result.dropRight(-end) : result.take(end - start);
        }
        return result;
      };

      LazyWrapper.prototype.takeRightWhile = function(predicate) {
        return this.reverse().takeWhile(predicate).reverse();
      };

      LazyWrapper.prototype.toArray = function() {
        return this.take(MAX_ARRAY_LENGTH);
      };

      // Add `LazyWrapper` methods to `lodash.prototype`.
      baseForOwn(LazyWrapper.prototype, function(func, methodName) {
        var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),
            isTaker = /^(?:head|last)$/.test(methodName),
            lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],
            retUnwrapped = isTaker || /^find/.test(methodName);

        if (!lodashFunc) {
          return;
        }
        lodash.prototype[methodName] = function() {
          var value = this.__wrapped__,
              args = isTaker ? [1] : arguments,
              isLazy = value instanceof LazyWrapper,
              iteratee = args[0],
              useLazy = isLazy || isArray(value);

          var interceptor = function(value) {
            var result = lodashFunc.apply(lodash, arrayPush([value], args));
            return (isTaker && chainAll) ? result[0] : result;
          };

          if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {
            // Avoid lazy use if the iteratee has a "length" value other than `1`.
            isLazy = useLazy = false;
          }
          var chainAll = this.__chain__,
              isHybrid = !!this.__actions__.length,
              isUnwrapped = retUnwrapped && !chainAll,
              onlyLazy = isLazy && !isHybrid;

          if (!retUnwrapped && useLazy) {
            value = onlyLazy ? value : new LazyWrapper(this);
            var result = func.apply(value, args);
            result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined$1 });
            return new LodashWrapper(result, chainAll);
          }
          if (isUnwrapped && onlyLazy) {
            return func.apply(this, args);
          }
          result = this.thru(interceptor);
          return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;
        };
      });

      // Add `Array` methods to `lodash.prototype`.
      arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {
        var func = arrayProto[methodName],
            chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',
            retUnwrapped = /^(?:pop|shift)$/.test(methodName);

        lodash.prototype[methodName] = function() {
          var args = arguments;
          if (retUnwrapped && !this.__chain__) {
            var value = this.value();
            return func.apply(isArray(value) ? value : [], args);
          }
          return this[chainName](function(value) {
            return func.apply(isArray(value) ? value : [], args);
          });
        };
      });

      // Map minified method names to their real names.
      baseForOwn(LazyWrapper.prototype, function(func, methodName) {
        var lodashFunc = lodash[methodName];
        if (lodashFunc) {
          var key = lodashFunc.name + '';
          if (!hasOwnProperty.call(realNames, key)) {
            realNames[key] = [];
          }
          realNames[key].push({ 'name': methodName, 'func': lodashFunc });
        }
      });

      realNames[createHybrid(undefined$1, WRAP_BIND_KEY_FLAG).name] = [{
        'name': 'wrapper',
        'func': undefined$1
      }];

      // Add methods to `LazyWrapper`.
      LazyWrapper.prototype.clone = lazyClone;
      LazyWrapper.prototype.reverse = lazyReverse;
      LazyWrapper.prototype.value = lazyValue;

      // Add chain sequence methods to the `lodash` wrapper.
      lodash.prototype.at = wrapperAt;
      lodash.prototype.chain = wrapperChain;
      lodash.prototype.commit = wrapperCommit;
      lodash.prototype.next = wrapperNext;
      lodash.prototype.plant = wrapperPlant;
      lodash.prototype.reverse = wrapperReverse;
      lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;

      // Add lazy aliases.
      lodash.prototype.first = lodash.prototype.head;

      if (symIterator) {
        lodash.prototype[symIterator] = wrapperToIterator;
      }
      return lodash;
    });

    /*--------------------------------------------------------------------------*/

    // Export lodash.
    var _ = runInContext();

    // Some AMD build optimizers, like r.js, check for condition patterns like:
    if (freeModule) {
      // Export for Node.js.
      (freeModule.exports = _)._ = _;
      // Export for CommonJS support.
      freeExports._ = _;
    }
    else {
      // Export to the global object.
      root._ = _;
    }
  }.call(commonjsGlobal));
  });

  var numeral = createCommonjsModule(function (module) {
  /*! @preserve
   * numeral.js
   * version : 2.0.6
   * author : Adam Draper
   * license : MIT
   * http://adamwdraper.github.com/Numeral-js/
   */

  (function (global, factory) {
      if ( module.exports) {
          module.exports = factory();
      } else {
          global.numeral = factory();
      }
  }(commonjsGlobal, function () {
      /************************************
          Variables
      ************************************/

      var numeral,
          _,
          VERSION = '2.0.6',
          formats = {},
          locales = {},
          defaults = {
              currentLocale: 'en',
              zeroFormat: null,
              nullFormat: null,
              defaultFormat: '0,0',
              scalePercentBy100: true
          },
          options = {
              currentLocale: defaults.currentLocale,
              zeroFormat: defaults.zeroFormat,
              nullFormat: defaults.nullFormat,
              defaultFormat: defaults.defaultFormat,
              scalePercentBy100: defaults.scalePercentBy100
          };


      /************************************
          Constructors
      ************************************/

      // Numeral prototype object
      function Numeral(input, number) {
          this._input = input;

          this._value = number;
      }

      numeral = function(input) {
          var value,
              kind,
              unformatFunction,
              regexp;

          if (numeral.isNumeral(input)) {
              value = input.value();
          } else if (input === 0 || typeof input === 'undefined') {
              value = 0;
          } else if (input === null || _.isNaN(input)) {
              value = null;
          } else if (typeof input === 'string') {
              if (options.zeroFormat && input === options.zeroFormat) {
                  value = 0;
              } else if (options.nullFormat && input === options.nullFormat || !input.replace(/[^0-9]+/g, '').length) {
                  value = null;
              } else {
                  for (kind in formats) {
                      regexp = typeof formats[kind].regexps.unformat === 'function' ? formats[kind].regexps.unformat() : formats[kind].regexps.unformat;

                      if (regexp && input.match(regexp)) {
                          unformatFunction = formats[kind].unformat;

                          break;
                      }
                  }

                  unformatFunction = unformatFunction || numeral._.stringToNumber;

                  value = unformatFunction(input);
              }
          } else {
              value = Number(input)|| null;
          }

          return new Numeral(input, value);
      };

      // version number
      numeral.version = VERSION;

      // compare numeral object
      numeral.isNumeral = function(obj) {
          return obj instanceof Numeral;
      };

      // helper functions
      numeral._ = _ = {
          // formats numbers separators, decimals places, signs, abbreviations
          numberToFormat: function(value, format, roundingFunction) {
              var locale = locales[numeral.options.currentLocale],
                  negP = false,
                  optDec = false,
                  leadingCount = 0,
                  abbr = '',
                  trillion = 1000000000000,
                  billion = 1000000000,
                  million = 1000000,
                  thousand = 1000,
                  decimal = '',
                  neg = false,
                  abbrForce, // force abbreviation
                  abs,
                  int,
                  precision,
                  signed,
                  thousands,
                  output;

              // make sure we never format a null value
              value = value || 0;

              abs = Math.abs(value);

              // see if we should use parentheses for negative number or if we should prefix with a sign
              // if both are present we default to parentheses
              if (numeral._.includes(format, '(')) {
                  negP = true;
                  format = format.replace(/[\(|\)]/g, '');
              } else if (numeral._.includes(format, '+') || numeral._.includes(format, '-')) {
                  signed = numeral._.includes(format, '+') ? format.indexOf('+') : value < 0 ? format.indexOf('-') : -1;
                  format = format.replace(/[\+|\-]/g, '');
              }

              // see if abbreviation is wanted
              if (numeral._.includes(format, 'a')) {
                  abbrForce = format.match(/a(k|m|b|t)?/);

                  abbrForce = abbrForce ? abbrForce[1] : false;

                  // check for space before abbreviation
                  if (numeral._.includes(format, ' a')) {
                      abbr = ' ';
                  }

                  format = format.replace(new RegExp(abbr + 'a[kmbt]?'), '');

                  if (abs >= trillion && !abbrForce || abbrForce === 't') {
                      // trillion
                      abbr += locale.abbreviations.trillion;
                      value = value / trillion;
                  } else if (abs < trillion && abs >= billion && !abbrForce || abbrForce === 'b') {
                      // billion
                      abbr += locale.abbreviations.billion;
                      value = value / billion;
                  } else if (abs < billion && abs >= million && !abbrForce || abbrForce === 'm') {
                      // million
                      abbr += locale.abbreviations.million;
                      value = value / million;
                  } else if (abs < million && abs >= thousand && !abbrForce || abbrForce === 'k') {
                      // thousand
                      abbr += locale.abbreviations.thousand;
                      value = value / thousand;
                  }
              }

              // check for optional decimals
              if (numeral._.includes(format, '[.]')) {
                  optDec = true;
                  format = format.replace('[.]', '.');
              }

              // break number and format
              int = value.toString().split('.')[0];
              precision = format.split('.')[1];
              thousands = format.indexOf(',');
              leadingCount = (format.split('.')[0].split(',')[0].match(/0/g) || []).length;

              if (precision) {
                  if (numeral._.includes(precision, '[')) {
                      precision = precision.replace(']', '');
                      precision = precision.split('[');
                      decimal = numeral._.toFixed(value, (precision[0].length + precision[1].length), roundingFunction, precision[1].length);
                  } else {
                      decimal = numeral._.toFixed(value, precision.length, roundingFunction);
                  }

                  int = decimal.split('.')[0];

                  if (numeral._.includes(decimal, '.')) {
                      decimal = locale.delimiters.decimal + decimal.split('.')[1];
                  } else {
                      decimal = '';
                  }

                  if (optDec && Number(decimal.slice(1)) === 0) {
                      decimal = '';
                  }
              } else {
                  int = numeral._.toFixed(value, 0, roundingFunction);
              }

              // check abbreviation again after rounding
              if (abbr && !abbrForce && Number(int) >= 1000 && abbr !== locale.abbreviations.trillion) {
                  int = String(Number(int) / 1000);

                  switch (abbr) {
                      case locale.abbreviations.thousand:
                          abbr = locale.abbreviations.million;
                          break;
                      case locale.abbreviations.million:
                          abbr = locale.abbreviations.billion;
                          break;
                      case locale.abbreviations.billion:
                          abbr = locale.abbreviations.trillion;
                          break;
                  }
              }


              // format number
              if (numeral._.includes(int, '-')) {
                  int = int.slice(1);
                  neg = true;
              }

              if (int.length < leadingCount) {
                  for (var i = leadingCount - int.length; i > 0; i--) {
                      int = '0' + int;
                  }
              }

              if (thousands > -1) {
                  int = int.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + locale.delimiters.thousands);
              }

              if (format.indexOf('.') === 0) {
                  int = '';
              }

              output = int + decimal + (abbr ? abbr : '');

              if (negP) {
                  output = (negP && neg ? '(' : '') + output + (negP && neg ? ')' : '');
              } else {
                  if (signed >= 0) {
                      output = signed === 0 ? (neg ? '-' : '+') + output : output + (neg ? '-' : '+');
                  } else if (neg) {
                      output = '-' + output;
                  }
              }

              return output;
          },
          // unformats numbers separators, decimals places, signs, abbreviations
          stringToNumber: function(string) {
              var locale = locales[options.currentLocale],
                  stringOriginal = string,
                  abbreviations = {
                      thousand: 3,
                      million: 6,
                      billion: 9,
                      trillion: 12
                  },
                  abbreviation,
                  value,
                  regexp;

              if (options.zeroFormat && string === options.zeroFormat) {
                  value = 0;
              } else if (options.nullFormat && string === options.nullFormat || !string.replace(/[^0-9]+/g, '').length) {
                  value = null;
              } else {
                  value = 1;

                  if (locale.delimiters.decimal !== '.') {
                      string = string.replace(/\./g, '').replace(locale.delimiters.decimal, '.');
                  }

                  for (abbreviation in abbreviations) {
                      regexp = new RegExp('[^a-zA-Z]' + locale.abbreviations[abbreviation] + '(?:\\)|(\\' + locale.currency.symbol + ')?(?:\\))?)?$');

                      if (stringOriginal.match(regexp)) {
                          value *= Math.pow(10, abbreviations[abbreviation]);
                          break;
                      }
                  }

                  // check for negative number
                  value *= (string.split('-').length + Math.min(string.split('(').length - 1, string.split(')').length - 1)) % 2 ? 1 : -1;

                  // remove non numbers
                  string = string.replace(/[^0-9\.]+/g, '');

                  value *= Number(string);
              }

              return value;
          },
          isNaN: function(value) {
              return typeof value === 'number' && isNaN(value);
          },
          includes: function(string, search) {
              return string.indexOf(search) !== -1;
          },
          insert: function(string, subString, start) {
              return string.slice(0, start) + subString + string.slice(start);
          },
          reduce: function(array, callback /*, initialValue*/) {
              if (this === null) {
                  throw new TypeError('Array.prototype.reduce called on null or undefined');
              }

              if (typeof callback !== 'function') {
                  throw new TypeError(callback + ' is not a function');
              }

              var t = Object(array),
                  len = t.length >>> 0,
                  k = 0,
                  value;

              if (arguments.length === 3) {
                  value = arguments[2];
              } else {
                  while (k < len && !(k in t)) {
                      k++;
                  }

                  if (k >= len) {
                      throw new TypeError('Reduce of empty array with no initial value');
                  }

                  value = t[k++];
              }
              for (; k < len; k++) {
                  if (k in t) {
                      value = callback(value, t[k], k, t);
                  }
              }
              return value;
          },
          /**
           * Computes the multiplier necessary to make x >= 1,
           * effectively eliminating miscalculations caused by
           * finite precision.
           */
          multiplier: function (x) {
              var parts = x.toString().split('.');

              return parts.length < 2 ? 1 : Math.pow(10, parts[1].length);
          },
          /**
           * Given a variable number of arguments, returns the maximum
           * multiplier that must be used to normalize an operation involving
           * all of them.
           */
          correctionFactor: function () {
              var args = Array.prototype.slice.call(arguments);

              return args.reduce(function(accum, next) {
                  var mn = _.multiplier(next);
                  return accum > mn ? accum : mn;
              }, 1);
          },
          /**
           * Implementation of toFixed() that treats floats more like decimals
           *
           * Fixes binary rounding issues (eg. (0.615).toFixed(2) === '0.61') that present
           * problems for accounting- and finance-related software.
           */
          toFixed: function(value, maxDecimals, roundingFunction, optionals) {
              var splitValue = value.toString().split('.'),
                  minDecimals = maxDecimals - (optionals || 0),
                  boundedPrecision,
                  optionalsRegExp,
                  power,
                  output;

              // Use the smallest precision value possible to avoid errors from floating point representation
              if (splitValue.length === 2) {
                boundedPrecision = Math.min(Math.max(splitValue[1].length, minDecimals), maxDecimals);
              } else {
                boundedPrecision = minDecimals;
              }

              power = Math.pow(10, boundedPrecision);

              // Multiply up by precision, round accurately, then divide and use native toFixed():
              output = (roundingFunction(value + 'e+' + boundedPrecision) / power).toFixed(boundedPrecision);

              if (optionals > maxDecimals - boundedPrecision) {
                  optionalsRegExp = new RegExp('\\.?0{1,' + (optionals - (maxDecimals - boundedPrecision)) + '}$');
                  output = output.replace(optionalsRegExp, '');
              }

              return output;
          }
      };

      // avaliable options
      numeral.options = options;

      // avaliable formats
      numeral.formats = formats;

      // avaliable formats
      numeral.locales = locales;

      // This function sets the current locale.  If
      // no arguments are passed in, it will simply return the current global
      // locale key.
      numeral.locale = function(key) {
          if (key) {
              options.currentLocale = key.toLowerCase();
          }

          return options.currentLocale;
      };

      // This function provides access to the loaded locale data.  If
      // no arguments are passed in, it will simply return the current
      // global locale object.
      numeral.localeData = function(key) {
          if (!key) {
              return locales[options.currentLocale];
          }

          key = key.toLowerCase();

          if (!locales[key]) {
              throw new Error('Unknown locale : ' + key);
          }

          return locales[key];
      };

      numeral.reset = function() {
          for (var property in defaults) {
              options[property] = defaults[property];
          }
      };

      numeral.zeroFormat = function(format) {
          options.zeroFormat = typeof(format) === 'string' ? format : null;
      };

      numeral.nullFormat = function (format) {
          options.nullFormat = typeof(format) === 'string' ? format : null;
      };

      numeral.defaultFormat = function(format) {
          options.defaultFormat = typeof(format) === 'string' ? format : '0.0';
      };

      numeral.register = function(type, name, format) {
          name = name.toLowerCase();

          if (this[type + 's'][name]) {
              throw new TypeError(name + ' ' + type + ' already registered.');
          }

          this[type + 's'][name] = format;

          return format;
      };


      numeral.validate = function(val, culture) {
          var _decimalSep,
              _thousandSep,
              _currSymbol,
              _valArray,
              _abbrObj,
              _thousandRegEx,
              localeData,
              temp;

          //coerce val to string
          if (typeof val !== 'string') {
              val += '';

              if (console.warn) {
                  console.warn('Numeral.js: Value is not string. It has been co-erced to: ', val);
              }
          }

          //trim whitespaces from either sides
          val = val.trim();

          //if val is just digits return true
          if (!!val.match(/^\d+$/)) {
              return true;
          }

          //if val is empty return false
          if (val === '') {
              return false;
          }

          //get the decimal and thousands separator from numeral.localeData
          try {
              //check if the culture is understood by numeral. if not, default it to current locale
              localeData = numeral.localeData(culture);
          } catch (e) {
              localeData = numeral.localeData(numeral.locale());
          }

          //setup the delimiters and currency symbol based on culture/locale
          _currSymbol = localeData.currency.symbol;
          _abbrObj = localeData.abbreviations;
          _decimalSep = localeData.delimiters.decimal;
          if (localeData.delimiters.thousands === '.') {
              _thousandSep = '\\.';
          } else {
              _thousandSep = localeData.delimiters.thousands;
          }

          // validating currency symbol
          temp = val.match(/^[^\d]+/);
          if (temp !== null) {
              val = val.substr(1);
              if (temp[0] !== _currSymbol) {
                  return false;
              }
          }

          //validating abbreviation symbol
          temp = val.match(/[^\d]+$/);
          if (temp !== null) {
              val = val.slice(0, -1);
              if (temp[0] !== _abbrObj.thousand && temp[0] !== _abbrObj.million && temp[0] !== _abbrObj.billion && temp[0] !== _abbrObj.trillion) {
                  return false;
              }
          }

          _thousandRegEx = new RegExp(_thousandSep + '{2}');

          if (!val.match(/[^\d.,]/g)) {
              _valArray = val.split(_decimalSep);
              if (_valArray.length > 2) {
                  return false;
              } else {
                  if (_valArray.length < 2) {
                      return ( !! _valArray[0].match(/^\d+.*\d$/) && !_valArray[0].match(_thousandRegEx));
                  } else {
                      if (_valArray[0].length === 1) {
                          return ( !! _valArray[0].match(/^\d+$/) && !_valArray[0].match(_thousandRegEx) && !! _valArray[1].match(/^\d+$/));
                      } else {
                          return ( !! _valArray[0].match(/^\d+.*\d$/) && !_valArray[0].match(_thousandRegEx) && !! _valArray[1].match(/^\d+$/));
                      }
                  }
              }
          }

          return false;
      };


      /************************************
          Numeral Prototype
      ************************************/

      numeral.fn = Numeral.prototype = {
          clone: function() {
              return numeral(this);
          },
          format: function(inputString, roundingFunction) {
              var value = this._value,
                  format = inputString || options.defaultFormat,
                  kind,
                  output,
                  formatFunction;

              // make sure we have a roundingFunction
              roundingFunction = roundingFunction || Math.round;

              // format based on value
              if (value === 0 && options.zeroFormat !== null) {
                  output = options.zeroFormat;
              } else if (value === null && options.nullFormat !== null) {
                  output = options.nullFormat;
              } else {
                  for (kind in formats) {
                      if (format.match(formats[kind].regexps.format)) {
                          formatFunction = formats[kind].format;

                          break;
                      }
                  }

                  formatFunction = formatFunction || numeral._.numberToFormat;

                  output = formatFunction(value, format, roundingFunction);
              }

              return output;
          },
          value: function() {
              return this._value;
          },
          input: function() {
              return this._input;
          },
          set: function(value) {
              this._value = Number(value);

              return this;
          },
          add: function(value) {
              var corrFactor = _.correctionFactor.call(null, this._value, value);

              function cback(accum, curr, currI, O) {
                  return accum + Math.round(corrFactor * curr);
              }

              this._value = _.reduce([this._value, value], cback, 0) / corrFactor;

              return this;
          },
          subtract: function(value) {
              var corrFactor = _.correctionFactor.call(null, this._value, value);

              function cback(accum, curr, currI, O) {
                  return accum - Math.round(corrFactor * curr);
              }

              this._value = _.reduce([value], cback, Math.round(this._value * corrFactor)) / corrFactor;

              return this;
          },
          multiply: function(value) {
              function cback(accum, curr, currI, O) {
                  var corrFactor = _.correctionFactor(accum, curr);
                  return Math.round(accum * corrFactor) * Math.round(curr * corrFactor) / Math.round(corrFactor * corrFactor);
              }

              this._value = _.reduce([this._value, value], cback, 1);

              return this;
          },
          divide: function(value) {
              function cback(accum, curr, currI, O) {
                  var corrFactor = _.correctionFactor(accum, curr);
                  return Math.round(accum * corrFactor) / Math.round(curr * corrFactor);
              }

              this._value = _.reduce([this._value, value], cback);

              return this;
          },
          difference: function(value) {
              return Math.abs(numeral(this._value).subtract(value).value());
          }
      };

      /************************************
          Default Locale && Format
      ************************************/

      numeral.register('locale', 'en', {
          delimiters: {
              thousands: ',',
              decimal: '.'
          },
          abbreviations: {
              thousand: 'k',
              million: 'm',
              billion: 'b',
              trillion: 't'
          },
          ordinal: function(number) {
              var b = number % 10;
              return (~~(number % 100 / 10) === 1) ? 'th' :
                  (b === 1) ? 'st' :
                  (b === 2) ? 'nd' :
                  (b === 3) ? 'rd' : 'th';
          },
          currency: {
              symbol: '$'
          }
      });

      

  (function() {
          numeral.register('format', 'bps', {
              regexps: {
                  format: /(BPS)/,
                  unformat: /(BPS)/
              },
              format: function(value, format, roundingFunction) {
                  var space = numeral._.includes(format, ' BPS') ? ' ' : '',
                      output;

                  value = value * 10000;

                  // check for space before BPS
                  format = format.replace(/\s?BPS/, '');

                  output = numeral._.numberToFormat(value, format, roundingFunction);

                  if (numeral._.includes(output, ')')) {
                      output = output.split('');

                      output.splice(-1, 0, space + 'BPS');

                      output = output.join('');
                  } else {
                      output = output + space + 'BPS';
                  }

                  return output;
              },
              unformat: function(string) {
                  return +(numeral._.stringToNumber(string) * 0.0001).toFixed(15);
              }
          });
  })();


  (function() {
          var decimal = {
              base: 1000,
              suffixes: ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']
          },
          binary = {
              base: 1024,
              suffixes: ['B', 'KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB']
          };

      var allSuffixes =  decimal.suffixes.concat(binary.suffixes.filter(function (item) {
              return decimal.suffixes.indexOf(item) < 0;
          }));
          var unformatRegex = allSuffixes.join('|');
          // Allow support for BPS (http://www.investopedia.com/terms/b/basispoint.asp)
          unformatRegex = '(' + unformatRegex.replace('B', 'B(?!PS)') + ')';

      numeral.register('format', 'bytes', {
          regexps: {
              format: /([0\s]i?b)/,
              unformat: new RegExp(unformatRegex)
          },
          format: function(value, format, roundingFunction) {
              var output,
                  bytes = numeral._.includes(format, 'ib') ? binary : decimal,
                  suffix = numeral._.includes(format, ' b') || numeral._.includes(format, ' ib') ? ' ' : '',
                  power,
                  min,
                  max;

              // check for space before
              format = format.replace(/\s?i?b/, '');

              for (power = 0; power <= bytes.suffixes.length; power++) {
                  min = Math.pow(bytes.base, power);
                  max = Math.pow(bytes.base, power + 1);

                  if (value === null || value === 0 || value >= min && value < max) {
                      suffix += bytes.suffixes[power];

                      if (min > 0) {
                          value = value / min;
                      }

                      break;
                  }
              }

              output = numeral._.numberToFormat(value, format, roundingFunction);

              return output + suffix;
          },
          unformat: function(string) {
              var value = numeral._.stringToNumber(string),
                  power,
                  bytesMultiplier;

              if (value) {
                  for (power = decimal.suffixes.length - 1; power >= 0; power--) {
                      if (numeral._.includes(string, decimal.suffixes[power])) {
                          bytesMultiplier = Math.pow(decimal.base, power);

                          break;
                      }

                      if (numeral._.includes(string, binary.suffixes[power])) {
                          bytesMultiplier = Math.pow(binary.base, power);

                          break;
                      }
                  }

                  value *= (bytesMultiplier || 1);
              }

              return value;
          }
      });
  })();


  (function() {
          numeral.register('format', 'currency', {
          regexps: {
              format: /(\$)/
          },
          format: function(value, format, roundingFunction) {
              var locale = numeral.locales[numeral.options.currentLocale],
                  symbols = {
                      before: format.match(/^([\+|\-|\(|\s|\$]*)/)[0],
                      after: format.match(/([\+|\-|\)|\s|\$]*)$/)[0]
                  },
                  output,
                  symbol,
                  i;

              // strip format of spaces and $
              format = format.replace(/\s?\$\s?/, '');

              // format the number
              output = numeral._.numberToFormat(value, format, roundingFunction);

              // update the before and after based on value
              if (value >= 0) {
                  symbols.before = symbols.before.replace(/[\-\(]/, '');
                  symbols.after = symbols.after.replace(/[\-\)]/, '');
              } else if (value < 0 && (!numeral._.includes(symbols.before, '-') && !numeral._.includes(symbols.before, '('))) {
                  symbols.before = '-' + symbols.before;
              }

              // loop through each before symbol
              for (i = 0; i < symbols.before.length; i++) {
                  symbol = symbols.before[i];

                  switch (symbol) {
                      case '$':
                          output = numeral._.insert(output, locale.currency.symbol, i);
                          break;
                      case ' ':
                          output = numeral._.insert(output, ' ', i + locale.currency.symbol.length - 1);
                          break;
                  }
              }

              // loop through each after symbol
              for (i = symbols.after.length - 1; i >= 0; i--) {
                  symbol = symbols.after[i];

                  switch (symbol) {
                      case '$':
                          output = i === symbols.after.length - 1 ? output + locale.currency.symbol : numeral._.insert(output, locale.currency.symbol, -(symbols.after.length - (1 + i)));
                          break;
                      case ' ':
                          output = i === symbols.after.length - 1 ? output + ' ' : numeral._.insert(output, ' ', -(symbols.after.length - (1 + i) + locale.currency.symbol.length - 1));
                          break;
                  }
              }


              return output;
          }
      });
  })();


  (function() {
          numeral.register('format', 'exponential', {
          regexps: {
              format: /(e\+|e-)/,
              unformat: /(e\+|e-)/
          },
          format: function(value, format, roundingFunction) {
              var output,
                  exponential = typeof value === 'number' && !numeral._.isNaN(value) ? value.toExponential() : '0e+0',
                  parts = exponential.split('e');

              format = format.replace(/e[\+|\-]{1}0/, '');

              output = numeral._.numberToFormat(Number(parts[0]), format, roundingFunction);

              return output + 'e' + parts[1];
          },
          unformat: function(string) {
              var parts = numeral._.includes(string, 'e+') ? string.split('e+') : string.split('e-'),
                  value = Number(parts[0]),
                  power = Number(parts[1]);

              power = numeral._.includes(string, 'e-') ? power *= -1 : power;

              function cback(accum, curr, currI, O) {
                  var corrFactor = numeral._.correctionFactor(accum, curr),
                      num = (accum * corrFactor) * (curr * corrFactor) / (corrFactor * corrFactor);
                  return num;
              }

              return numeral._.reduce([value, Math.pow(10, power)], cback, 1);
          }
      });
  })();


  (function() {
          numeral.register('format', 'ordinal', {
          regexps: {
              format: /(o)/
          },
          format: function(value, format, roundingFunction) {
              var locale = numeral.locales[numeral.options.currentLocale],
                  output,
                  ordinal = numeral._.includes(format, ' o') ? ' ' : '';

              // check for space before
              format = format.replace(/\s?o/, '');

              ordinal += locale.ordinal(value);

              output = numeral._.numberToFormat(value, format, roundingFunction);

              return output + ordinal;
          }
      });
  })();


  (function() {
          numeral.register('format', 'percentage', {
          regexps: {
              format: /(%)/,
              unformat: /(%)/
          },
          format: function(value, format, roundingFunction) {
              var space = numeral._.includes(format, ' %') ? ' ' : '',
                  output;

              if (numeral.options.scalePercentBy100) {
                  value = value * 100;
              }

              // check for space before %
              format = format.replace(/\s?\%/, '');

              output = numeral._.numberToFormat(value, format, roundingFunction);

              if (numeral._.includes(output, ')')) {
                  output = output.split('');

                  output.splice(-1, 0, space + '%');

                  output = output.join('');
              } else {
                  output = output + space + '%';
              }

              return output;
          },
          unformat: function(string) {
              var number = numeral._.stringToNumber(string);
              if (numeral.options.scalePercentBy100) {
                  return number * 0.01;
              }
              return number;
          }
      });
  })();


  (function() {
          numeral.register('format', 'time', {
          regexps: {
              format: /(:)/,
              unformat: /(:)/
          },
          format: function(value, format, roundingFunction) {
              var hours = Math.floor(value / 60 / 60),
                  minutes = Math.floor((value - (hours * 60 * 60)) / 60),
                  seconds = Math.round(value - (hours * 60 * 60) - (minutes * 60));

              return hours + ':' + (minutes < 10 ? '0' + minutes : minutes) + ':' + (seconds < 10 ? '0' + seconds : seconds);
          },
          unformat: function(string) {
              var timeArray = string.split(':'),
                  seconds = 0;

              // turn hours and minutes into seconds and add them all up
              if (timeArray.length === 3) {
                  // hours
                  seconds = seconds + (Number(timeArray[0]) * 60 * 60);
                  // minutes
                  seconds = seconds + (Number(timeArray[1]) * 60);
                  // seconds
                  seconds = seconds + Number(timeArray[2]);
              } else if (timeArray.length === 2) {
                  // minutes
                  seconds = seconds + (Number(timeArray[0]) * 60);
                  // seconds
                  seconds = seconds + Number(timeArray[1]);
              }
              return Number(seconds);
          }
      });
  })();

  return numeral;
  }));
  });

  var dayjs_min = createCommonjsModule(function (module, exports) {
  !function(t,e){module.exports=e();}(commonjsGlobal,(function(){var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",s="minute",u="hour",a="day",o="week",f="month",h="quarter",c="year",d="date",$="Invalid Date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(t,e,n){var r=String(t);return !r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},g={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return (e<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return -t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return +(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return {M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},v="en",D={};D[v]=M;var p=function(t){return t instanceof _},S=function t(e,n,r){var i;if(!e)return v;if("string"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split("-");if(!i&&u.length>1)return t(u[0])}else {var a=e.name;D[a]=e,i=a;}return !r&&i&&(v=i),i||!r&&v},w=function(t,e){if(p(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=g;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t);}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(l);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init();},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds();},m.$utils=function(){return O},m.isValid=function(){return !(this.$d.toString()===$)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),$=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},l=function(t,e){return O.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(h){case c:return r?$(1,0):$(31,11);case f:return r?$(1,M):$(0,M+1);case o:var v=this.$locale().weekStart||0,D=(y<v?y+7:y)-v;return $(r?m-D:m+(6-D),M);case a:case d:return l(g+"Hours",0);case u:return l(g+"Minutes",1);case s:return l(g+"Seconds",2);case i:return l(g+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h="set"+(this.$u?"UTC":""),$=(n={},n[a]=h+"Date",n[d]=h+"Date",n[f]=h+"Month",n[c]=h+"FullYear",n[u]=h+"Hours",n[s]=h+"Minutes",n[i]=h+"Seconds",n[r]=h+"Milliseconds",n)[o],l=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[$](l),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d;}else $&&this.$d[$](l);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,$=this;r=Number(r);var l=O.p(h),y=function(t){var e=w($);return O.w(e.date(e.date()+Math.round(t*r)),$)};if(l===f)return this.set(f,this.$M+r);if(l===c)return this.set(c,this.$y+r);if(l===a)return y(1);if(l===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[l]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||$;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].substr(0,s)},c=function(t){return O.s(s%12||12,t,"0")},d=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:O.s(a+1,2,"0"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,"0"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:i};return r.replace(y,(function(t,e){return e||l[t]||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,$){var l,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,g=this-M,v=O.m(this,M);return v=(l={},l[c]=v/12,l[f]=v,l[h]=v/3,l[o]=(g-m)/6048e5,l[a]=(g-m)/864e5,l[u]=g/n,l[s]=g/e,l[i]=g/t,l)[y]||g,$?v:O.a(v)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),b=_.prototype;return w.prototype=b,[["$ms",r],["$s",i],["$m",s],["$H",u],["$W",a],["$M",f],["$y",c],["$D",d]].forEach((function(t){b[t[1]]=function(e){return this.$g(e,t[0],t[1])};})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=D[v],w.Ls=D,w.p={},w}));
  });

  function E () {
    // Keep this empty so it's easier to inherit from
    // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)
  }

  E.prototype = {
    on: function (name, callback, ctx) {
      var e = this.e || (this.e = {});

      (e[name] || (e[name] = [])).push({
        fn: callback,
        ctx: ctx
      });

      return this;
    },

    once: function (name, callback, ctx) {
      var self = this;
      function listener () {
        self.off(name, listener);
        callback.apply(ctx, arguments);
      }
      listener._ = callback;
      return this.on(name, listener, ctx);
    },

    emit: function (name) {
      var data = [].slice.call(arguments, 1);
      var evtArr = ((this.e || (this.e = {}))[name] || []).slice();
      var i = 0;
      var len = evtArr.length;

      for (i; i < len; i++) {
        evtArr[i].fn.apply(evtArr[i].ctx, data);
      }

      return this;
    },

    off: function (name, callback) {
      var e = this.e || (this.e = {});
      var evts = e[name];
      var liveEvents = [];

      if (evts && callback) {
        for (var i = 0, len = evts.length; i < len; i++) {
          if (evts[i].fn !== callback && evts[i].fn._ !== callback)
            liveEvents.push(evts[i]);
        }
      }

      // Remove event from queue to prevent memory leak
      // Suggested by https://github.com/lazd
      // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910

      (liveEvents.length)
        ? e[name] = liveEvents
        : delete e[name];

      return this;
    }
  };

  var tinyEmitter = E;
  var TinyEmitter = E;
  tinyEmitter.TinyEmitter = TinyEmitter;

  /**
   * Convert value into number.
   *
   * @param {String|Number} number
   * @returns {*}
   */
  function toNumber(number) {
    var result;

    if (typeof number === 'number') {
      result = number;
    } else if (typeof number === 'string') {
      result = number.indexOf('.') > -1 ? parseFloat(number) : parseInt(number, 10);
    }

    return result;
  }
  /**
   * Invert provided number.
   *
   * @param {Number} number
   * @returns {Number} Returns inverted number.
   */

  function invertNumber(number) {
    return -1 * toNumber(number);
  }

  var _errors;

  function _defineProperty$1(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  var ERROR = 'ERROR';
  var ERROR_DIV_ZERO = 'DIV/0';
  var ERROR_NAME = 'NAME';
  var ERROR_NOT_AVAILABLE = 'N/A';
  var ERROR_NULL = 'NULL';
  var ERROR_NUM = 'NUM';
  var ERROR_REF = 'REF';
  var ERROR_VALUE = 'VALUE';
  var errors = (_errors = {}, _defineProperty$1(_errors, ERROR, '#ERROR!'), _defineProperty$1(_errors, ERROR_DIV_ZERO, '#DIV/0!'), _defineProperty$1(_errors, ERROR_NAME, '#NAME?'), _defineProperty$1(_errors, ERROR_NOT_AVAILABLE, '#N/A'), _defineProperty$1(_errors, ERROR_NULL, '#NULL!'), _defineProperty$1(_errors, ERROR_NUM, '#NUM!'), _defineProperty$1(_errors, ERROR_REF, '#REF!'), _defineProperty$1(_errors, ERROR_VALUE, '#VALUE!'), _errors);
  /**
   * Return error type based on provided error id.
   *
   * @param {String} type Error type.
   * @returns {String|null} Returns error id.
   */

  function error(type) {
    var result;
    type = (type + '').replace(/#|!|\?/g, '');

    if (errors[type]) {
      result = errors[type];
    }

    return result ? result : null;
  }
  /**
   * Check if error type is strict valid with knows errors.
   *
   * @param {String} Error type.
   * @return {Boolean}
   */

  function isValidStrict(type) {
    var valid = false;

    for (var i in errors) {
      if (Object.prototype.hasOwnProperty.call(errors, i) && errors[i] === type) {
        valid = true;
        break;
      }
    }

    return valid;
  }

  var SYMBOL = '+';
  function func(first) {
    for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      rest[_key - 1] = arguments[_key];
    }

    var result = rest.reduce(function (acc, value) {
      return acc + toNumber(value);
    }, toNumber(first));

    if (isNaN(result)) {
      throw Error(ERROR_VALUE);
    }

    return result;
  }
  func.SYMBOL = SYMBOL;

  var SYMBOL$1 = '&';
  function func$1() {
    for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {
      params[_key] = arguments[_key];
    }

    return params.reduce(function (acc, value) {
      return acc + value.toString();
    }, '');
  }
  func$1.SYMBOL = SYMBOL$1;

  var SYMBOL$2 = '/';
  function func$2(first) {
    for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      rest[_key - 1] = arguments[_key];
    }

    var result = rest.reduce(function (acc, value) {
      return acc / toNumber(value);
    }, toNumber(first));

    if (result === Infinity) {
      throw Error(ERROR_DIV_ZERO);
    }

    if (isNaN(result)) {
      throw Error(ERROR_VALUE);
    }

    return result;
  }
  func$2.SYMBOL = SYMBOL$2;

  var SYMBOL$3 = '=';
  function func$3(exp1, exp2) {
    return exp1 === exp2;
  }
  func$3.SYMBOL = SYMBOL$3;

  var nil = new Error('#NULL!');
  var div0 = new Error('#DIV/0!');
  var value = new Error('#VALUE!');
  var ref = new Error('#REF!');
  var name = new Error('#NAME?');
  var num = new Error('#NUM!');
  var na = new Error('#N/A');
  var error_1 = new Error('#ERROR!');
  var data = new Error('#GETTING_DATA');

  var error$1 = {
  	nil: nil,
  	div0: div0,
  	value: value,
  	ref: ref,
  	name: name,
  	num: num,
  	na: na,
  	error: error_1,
  	data: data
  };

  var common = createCommonjsModule(function (module, exports) {
  exports.flattenShallow = function(array) {
    if (!array || !array.reduce) {
      return array;
    }

    return array.reduce(function(a, b) {
      var aIsArray = Array.isArray(a);
      var bIsArray = Array.isArray(b);

      if (aIsArray && bIsArray ) {
        return a.concat(b);
      }
      if (aIsArray) {
        a.push(b);

        return a;
      }
      if (bIsArray) {
        return [a].concat(b);
      }

      return [a, b];
    });
  };

  exports.isFlat = function(array) {
    if (!array) {
      return false;
    }

    for (var i = 0; i < array.length; ++i) {
      if (Array.isArray(array[i])) {
        return false;
      }
    }

    return true;
  };

  exports.flatten = function() {
    var result = exports.argsToArray.apply(null, arguments);

    while (!exports.isFlat(result)) {
      result = exports.flattenShallow(result);
    }

    return result;
  };

  exports.argsToArray = function(args) {
    var result = [];

    exports.arrayEach(args, function(value) {
      result.push(value);
    });

    return result;
  };

  exports.numbers = function() {
    var possibleNumbers = this.flatten.apply(null, arguments);
    return possibleNumbers.filter(function(el) {
      return typeof el === 'number';
    });
  };

  exports.cleanFloat = function(number) {
    var power = 1e14;
    return Math.round(number * power) / power;
  };

  exports.parseBool = function(bool) {
    if (typeof bool === 'boolean') {
      return bool;
    }

    if (bool instanceof Error) {
      return bool;
    }

    if (typeof bool === 'number') {
      return bool !== 0;
    }

    if (typeof bool === 'string') {
      var up = bool.toUpperCase();
      if (up === 'TRUE') {
        return true;
      }

      if (up === 'FALSE') {
        return false;
      }
    }

    if (bool instanceof Date && !isNaN(bool)) {
      return true;
    }

    return error$1.value;
  };

  exports.parseNumber = function(string) {
    if (string instanceof Error) {
      return string;
    }
    if (string === undefined || string === null || string === '') {
      return 0;
    }
    if (typeof string === "boolean") {
      string = +string;
    }
    if (!isNaN(string)) {
      return parseFloat(string);
    }

    return error$1.value;
  };

  exports.parseString = function(string) {
    if (string instanceof Error) {
      return string;
    }
    if (string === undefined || string === null) {
      return '';
    }

    return string.toString();
  };

  exports.parseNumberArray = function(arr) {
    var len;

    if (!arr || (len = arr.length) === 0) {
      return error$1.value;
    }

    var parsed;

    while (len--) {
      if (arr[len] instanceof Error) {
        return arr[len];
      }
      parsed = exports.parseNumber(arr[len]);
      if (parsed instanceof Error) {
        return parsed;
      }
      arr[len] = parsed;
    }

    return arr;
  };

  exports.parseMatrix = function(matrix) {
    var n;

    if (!matrix || (n = matrix.length) === 0) {
      return error$1.value;
    }
    var pnarr;

    for (var i = 0; i < matrix.length; i++) {
      pnarr = exports.parseNumberArray(matrix[i]);
      matrix[i] = pnarr;

      if (pnarr instanceof Error) {
        return pnarr;
      }
    }

    return matrix;
  };

  function serialNumberToDate(serial) {
    if (serial < 60) {
      serial += 1;
    }
    var utc_days = Math.floor(serial - 25569);
    var utc_value = utc_days * 86400;
    var date_info = new Date(utc_value * 1000);

    var fractional_day = serial - Math.floor(serial) + 0.0000001;

    var total_seconds = Math.floor(86400 * fractional_day);

    var seconds = total_seconds % 60;

    total_seconds -= seconds;

    var hours = Math.floor(total_seconds / (60 * 60));
    var minutes = Math.floor(total_seconds / 60) % 60;
    var days = date_info.getDate();
    var month = date_info.getMonth();

    if (serial >= 60 && serial < 61) {
      var days = 29;
      var month = 1;
    }

    return new Date(date_info.getFullYear(), month, days, hours, minutes, seconds);
  }

  exports.parseDate = function (date) {
    if (!isNaN(date)) {
      if (date instanceof Date) {
        return new Date(date);
      }
      var d = parseFloat(date);
      if (d < 0 || d >= 2958466) {
        return error$1.num;
      }
      return serialNumberToDate(d);
    }
    if (typeof date === 'string') {
      date = new Date(date);
      if (!isNaN(date)) {
        return date;
      }
    }
    return error$1.value;
  };

  exports.parseDateArray = function(arr) {
    var len = arr.length;
    var parsed;
    while (len--) {
      parsed = this.parseDate(arr[len]);
      if (parsed === error$1.value) {
        return parsed;
      }
      arr[len] = parsed;
    }
    return arr;
  };

  exports.anyError = function() {
    for (var n = 0; n < arguments.length; n++) {
      if (arguments[n] instanceof Error) {
        return arguments[n];
      }
    }
    return undefined;
  };

  exports.isDefined = function (arg) {
    return arg !== undefined && arg !== null;
  };

  exports.anyIsError = function() {
    var n = arguments.length;
    while (n--) {
      if (arguments[n] instanceof Error) {
        return true;
      }
    }
    return false;
  };

  exports.anyIsString = function() {
    var n = arguments.length;
    while (n--) {
      if (typeof arguments[n] === 'string') {
        return true;
      }
    }
    return false;
  };

  exports.arrayValuesToNumbers = function(arr) {
    var n = arr.length;
    var el;
    while (n--) {
      el = arr[n];
      if (typeof el === 'number') {
        continue;
      }
      if (el === true) {
        arr[n] = 1;
        continue;
      }
      if (el === false) {
        arr[n] = 0;
        continue;
      }
      if (typeof el === 'string') {
        var number = this.parseNumber(el);
        if (number instanceof Error) {
          arr[n] = 0;
        } else {
          arr[n] = number;
        }
      }
    }
    return arr;
  };

  exports.rest = function(array, idx) {
    idx = idx || 1;
    if (!array || typeof array.slice !== 'function') {
      return array;
    }
    return array.slice(idx);
  };

  exports.initial = function(array, idx) {
    idx = idx || 1;
    if (!array || typeof array.slice !== 'function') {
      return array;
    }
    return array.slice(0, array.length - idx);
  };

  exports.arrayEach = function(array, iteratee) {
    var index = -1, length = array.length;

    while (++index < length) {
      if (iteratee(array[index], index, array) === false) {
        break;
      }
    }

    return array;
  };

  exports.transpose = function(matrix) {
    if(!matrix) {
      return error$1.value;
    }

    return matrix[0].map(function(col, i) {
      return matrix.map(function(row) {
        return row[i];
      });
    });
  };
  });

  var text = createCommonjsModule(function (module, exports) {
  //TODO
  exports.ASC = function() {
    throw new Error('ASC is not implemented');
  };

  //TODO
  exports.BAHTTEXT = function() {
    throw new Error('BAHTTEXT is not implemented');
  };

  exports.CHAR = function(number) {
    number = common.parseNumber(number);
    if (number === 0) {
      return error$1.value;
    }
    if (number instanceof Error) {
      return number;
    }
    return String.fromCharCode(number);
  };

  exports.CLEAN = function(text) {
    if (common.anyIsError(text)) {
      return text;
    }
    text = text || '';
    var re = /[\0-\x1F]/g;
    return text.replace(re, "");
  };

  exports.CODE = function(text) {
    if (common.anyIsError(text)) {
      return text;
    }
    text = text || '';
    var result = text.charCodeAt(0);

    if (isNaN(result)) {
      result = error$1.value;
    }
    return result;
  };

  exports.CONCATENATE = function() {
    var args = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, args);
    if (someError) {
      return someError;
    }
    var trueFound = 0;
    while ((trueFound = args.indexOf(true)) > -1) {
      args[trueFound] = 'TRUE';
    }

    var falseFound = 0;
    while ((falseFound = args.indexOf(false)) > -1) {
      args[falseFound] = 'FALSE';
    }

    return args.join('');
  };

  exports.CONCAT = exports.CONCATENATE;

  //TODO
  exports.DBCS = function() {
    throw new Error('DBCS is not implemented');
  };

  //TODO
  exports.DOLLAR = function() {
    throw new Error('DOLLAR is not implemented');
  };

  exports.EXACT = function(text1, text2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }
    var someError = common.anyError(text1, text2);
    if (someError) {
      return someError;
    }
    text1 = common.parseString(text1);
    text2 = common.parseString(text2);
    return text1 === text2;
  };

  exports.FIND = function(find_text, within_text, position) {
    if (arguments.length < 2) {
      return error$1.na;
    }
    find_text = common.parseString(find_text);
    within_text = common.parseString(within_text);
    position = (position === undefined) ? 0 : position;
    var found_index = within_text.indexOf(find_text, position - 1);
    if (found_index === -1) {
      return error$1.value;
    }
    return found_index + 1;
  };

  //TODO
  exports.FIXED = function() {
    throw new Error('FIXED is not implemented');
  };

  exports.HTML2TEXT = function (value) {
    if (common.anyIsError(value)) {
      return value;
    }
    var result = '';

    if (value) {
      if (value instanceof Array) {
        value.forEach(function (line) {
          if (result !== '') {
            result += '\n';
          }
          result += (line.replace(/<(?:.|\n)*?>/gm, ''));
        });
      } else {
        result = value.replace(/<(?:.|\n)*?>/gm, '');
      }
    }

    return result;
  };

  exports.LEFT = function(text, number) {
    var someError = common.anyError(text, number);
    if (someError) {
      return someError;
    }
    text = common.parseString(text);
    number = (number === undefined) ? 1 : number;
    number = common.parseNumber(number);
    if (number instanceof Error || typeof text !== 'string') {
      return error$1.value;
    }
    return text.substring(0, number);
  };

  exports.LEN = function(text) {
    if (arguments.length === 0) {
      return error$1.error;
    }

    if (text instanceof Error) {
      return text;
    }

    if (Array.isArray(text)) {
      return error$1.value;
    }

    var textAsString = common.parseString(text);
    return textAsString.length;
  };

  exports.LOWER = function(text) {
    if (arguments.length !== 1) {
      return error$1.value;
    }
    text = common.parseString(text);
    if (common.anyIsError(text)) {
      return text;
    }
    return text.toLowerCase();
  };

  exports.MID = function(text, start, number) {
    if (start === undefined || start === null) {
      return error$1.value;
    }
    start = common.parseNumber(start);
    number = common.parseNumber(number);
    if (common.anyIsError(start, number) || typeof text !== 'string') {
      return number;
    }

    var begin = start - 1;
    var end = begin + number;

    return text.substring(begin, end);
  };

  // TODO
  exports.NUMBERVALUE = function (text, decimal_separator, group_separator)  {
    decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;
    group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;
    return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));
  };

  // TODO
  exports.PRONETIC = function() {
    throw new Error('PRONETIC is not implemented');
  };

  exports.PROPER = function(text) {
    if (common.anyIsError(text)) {
      return text;
    }
    if (isNaN(text) && typeof text === 'number') {
      return error$1.value;
    }
    text = common.parseString(text);

    return text.replace(/\w\S*/g, function(txt) {
      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
    });
  };

  exports.REGEXEXTRACT = function (text, regular_expression) {
    if (arguments.length < 2) {
      return error$1.na;
    }
    var match = text.match(new RegExp(regular_expression));
    return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;
  };

  exports.REGEXMATCH = function (text, regular_expression, full) {
    if (arguments.length < 2) {
      return error$1.na;
    }
    var match = text.match(new RegExp(regular_expression));
    return full ? match : !!match;
  };

  exports.REGEXREPLACE = function (text, regular_expression, replacement) {
    if (arguments.length < 3) {
      return error$1.na;
    }
    return text.replace(new RegExp(regular_expression), replacement);
  };

  exports.REPLACE = function(text, position, length, new_text) {
    position = common.parseNumber(position);
    length = common.parseNumber(length);
    if (common.anyIsError(position, length) ||
      typeof text !== 'string' ||
      typeof new_text !== 'string') {
      return error$1.value;
    }
    return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);
  };

  exports.REPT = function(text, number) {
    var someError = common.anyError(text, number);
    if (someError) {
      return someError;
    }
    text = common.parseString(text);
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return new Array(number + 1).join(text);
  };

  exports.RIGHT = function(text, number) {
    var someError = common.anyError(text, number);
    if (someError) {
      return someError;
    }
    text = common.parseString(text);
    number = (number === undefined) ? 1 : number;
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return text.substring(text.length - number);
  };

  exports.SEARCH = function(find_text, within_text, position) {
    var foundAt;
    if (typeof find_text !== 'string' || typeof within_text !== 'string') {
      return error$1.value;
    }
    position = (position === undefined) ? 0 : position;
    foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;
    return (foundAt === 0)?error$1.value:foundAt;
  };

  exports.SPLIT = function (text, separator) {
    return text.split(separator);
  };

  exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {
    if (arguments.length < 3) {
      return error$1.na;
    }
    if (!text || !old_text) {
      return text;
    } else if (occurrence === undefined) {
      return text.split(old_text).join(new_text);
    } else {
      occurrence = Math.floor(Number(occurrence));
      if (Number.isNaN(occurrence) || occurrence <= 0) {
        return error$1.value;
      }
      var index = 0;
      var i = 0;
      while (index > -1 && text.indexOf(old_text, index) > -1) {
        index = text.indexOf(old_text, index + 1);
        i++;
        if (index > -1 && i === occurrence) {
          return text.substring(0, index) + new_text + text.substring(index + old_text.length);
        }
      }
      return text;
    }
  };

  exports.T = function(value) {
    if (value instanceof Error) {
      return value;
    }
    return (typeof value === "string") ? value : '';
  };

  // TODO incomplete implementation
  exports.TEXT = function() {
    throw new Error('TEXT is not implemented');
  };

  exports.TRIM = function(text) {
    text = common.parseString(text);
    if (text instanceof Error) {
      return text;
    }
    return text.replace(/\s+/g, ' ').trim();
  };

  exports.UNICHAR = exports.CHAR;

  exports.UNICODE = exports.CODE;

  exports.UPPER = function(text) {
    text = common.parseString(text);
    if (text instanceof Error) {
      return text;
    }
    return text.toUpperCase();
  };

  exports.VALUE = function(num) {
    var anyError = common.anyError(num);
    if (anyError) {
      return anyError;
    }

    if (typeof num !== 'string') {
      return error$1.value;
    }

    var isPercent = /(%)$/.test(num) || /^(%)/.test(num);
    num = num.replace(/^[^0-9-]{0,3}/, '');
    num = num.replace(/[^0-9]{0,3}$/, '');
    num = num.replace(/[\ ,]/g,'');

    if(num ===''){
      return error$1.value;
    }

    var output =  Number(num);

    if(isNaN(output)){
      return error$1.value;
    }

    output = output || 0;

    if(isPercent) {
      output = output * 0.01;
    }

    return output;
  };
  });

  var jstat = createCommonjsModule(function (module, exports) {
  (function (window, factory) {
      {
          module.exports = factory();
      }
  })(commonjsGlobal, function () {
  var jStat = (function(Math, undefined$1) {

  // For quick reference.
  var concat = Array.prototype.concat;
  var slice = Array.prototype.slice;
  var toString = Object.prototype.toString;

  // Calculate correction for IEEE error
  // TODO: This calculation can be improved.
  function calcRdx(n, m) {
    var val = n > m ? n : m;
    return Math.pow(10,
                    17 - ~~(Math.log(((val > 0) ? val : -val)) * Math.LOG10E));
  }


  var isArray = Array.isArray || function isArray(arg) {
    return toString.call(arg) === '[object Array]';
  };


  function isFunction(arg) {
    return toString.call(arg) === '[object Function]';
  }


  function isNumber(num) {
    return (typeof num === 'number') ? num - num === 0 : false;
  }


  // Converts the jStat matrix to vector.
  function toVector(arr) {
    return concat.apply([], arr);
  }


  // The one and only jStat constructor.
  function jStat() {
    return new jStat._init(arguments);
  }


  // TODO: Remove after all references in src files have been removed.
  jStat.fn = jStat.prototype;


  // By separating the initializer from the constructor it's easier to handle
  // always returning a new instance whether "new" was used or not.
  jStat._init = function _init(args) {
    // If first argument is an array, must be vector or matrix.
    if (isArray(args[0])) {
      // Check if matrix.
      if (isArray(args[0][0])) {
        // See if a mapping function was also passed.
        if (isFunction(args[1]))
          args[0] = jStat.map(args[0], args[1]);
        // Iterate over each is faster than this.push.apply(this, args[0].
        for (var i = 0; i < args[0].length; i++)
          this[i] = args[0][i];
        this.length = args[0].length;

      // Otherwise must be a vector.
      } else {
        this[0] = isFunction(args[1]) ? jStat.map(args[0], args[1]) : args[0];
        this.length = 1;
      }

    // If first argument is number, assume creation of sequence.
    } else if (isNumber(args[0])) {
      this[0] = jStat.seq.apply(null, args);
      this.length = 1;

    // Handle case when jStat object is passed to jStat.
    } else if (args[0] instanceof jStat) {
      // Duplicate the object and pass it back.
      return jStat(args[0].toArray());

    // Unexpected argument value, return empty jStat object.
    // TODO: This is strange behavior. Shouldn't this throw or some such to let
    // the user know they had bad arguments?
    } else {
      this[0] = [];
      this.length = 1;
    }

    return this;
  };
  jStat._init.prototype = jStat.prototype;
  jStat._init.constructor = jStat;


  // Utility functions.
  // TODO: for internal use only?
  jStat.utils = {
    calcRdx: calcRdx,
    isArray: isArray,
    isFunction: isFunction,
    isNumber: isNumber,
    toVector: toVector
  };


  jStat._random_fn = Math.random;
  jStat.setRandom = function setRandom(fn) {
    if (typeof fn !== 'function')
      throw new TypeError('fn is not a function');
    jStat._random_fn = fn;
  };


  // Easily extend the jStat object.
  // TODO: is this seriously necessary?
  jStat.extend = function extend(obj) {
    var i, j;

    if (arguments.length === 1) {
      for (j in obj)
        jStat[j] = obj[j];
      return this;
    }

    for (i = 1; i < arguments.length; i++) {
      for (j in arguments[i])
        obj[j] = arguments[i][j];
    }

    return obj;
  };


  // Returns the number of rows in the matrix.
  jStat.rows = function rows(arr) {
    return arr.length || 1;
  };


  // Returns the number of columns in the matrix.
  jStat.cols = function cols(arr) {
    return arr[0].length || 1;
  };


  // Returns the dimensions of the object { rows: i, cols: j }
  jStat.dimensions = function dimensions(arr) {
    return {
      rows: jStat.rows(arr),
      cols: jStat.cols(arr)
    };
  };


  // Returns a specified row as a vector or return a sub matrix by pick some rows
  jStat.row = function row(arr, index) {
    if (isArray(index)) {
      return index.map(function(i) {
        return jStat.row(arr, i);
      })
    }
    return arr[index];
  };


  // return row as array
  // rowa([[1,2],[3,4]],0) -> [1,2]
  jStat.rowa = function rowa(arr, i) {
    return jStat.row(arr, i);
  };


  // Returns the specified column as a vector or return a sub matrix by pick some
  // columns
  jStat.col = function col(arr, index) {
    if (isArray(index)) {
      var submat = jStat.arange(arr.length).map(function() {
        return new Array(index.length);
      });
      index.forEach(function(ind, i){
        jStat.arange(arr.length).forEach(function(j) {
          submat[j][i] = arr[j][ind];
        });
      });
      return submat;
    }
    var column = new Array(arr.length);
    for (var i = 0; i < arr.length; i++)
      column[i] = [arr[i][index]];
    return column;
  };


  // return column as array
  // cola([[1,2],[3,4]],0) -> [1,3]
  jStat.cola = function cola(arr, i) {
    return jStat.col(arr, i).map(function(a){ return a[0] });
  };


  // Returns the diagonal of the matrix
  jStat.diag = function diag(arr) {
    var nrow = jStat.rows(arr);
    var res = new Array(nrow);
    for (var row = 0; row < nrow; row++)
      res[row] = [arr[row][row]];
    return res;
  };


  // Returns the anti-diagonal of the matrix
  jStat.antidiag = function antidiag(arr) {
    var nrow = jStat.rows(arr) - 1;
    var res = new Array(nrow);
    for (var i = 0; nrow >= 0; nrow--, i++)
      res[i] = [arr[i][nrow]];
    return res;
  };

  // Transpose a matrix or array.
  jStat.transpose = function transpose(arr) {
    var obj = [];
    var objArr, rows, cols, j, i;

    // Make sure arr is in matrix format.
    if (!isArray(arr[0]))
      arr = [arr];

    rows = arr.length;
    cols = arr[0].length;

    for (i = 0; i < cols; i++) {
      objArr = new Array(rows);
      for (j = 0; j < rows; j++)
        objArr[j] = arr[j][i];
      obj.push(objArr);
    }

    // If obj is vector, return only single array.
    return obj.length === 1 ? obj[0] : obj;
  };


  // Map a function to an array or array of arrays.
  // "toAlter" is an internal variable.
  jStat.map = function map(arr, func, toAlter) {
    var row, nrow, ncol, res, col;

    if (!isArray(arr[0]))
      arr = [arr];

    nrow = arr.length;
    ncol = arr[0].length;
    res = toAlter ? arr : new Array(nrow);

    for (row = 0; row < nrow; row++) {
      // if the row doesn't exist, create it
      if (!res[row])
        res[row] = new Array(ncol);
      for (col = 0; col < ncol; col++)
        res[row][col] = func(arr[row][col], row, col);
    }

    return res.length === 1 ? res[0] : res;
  };


  // Cumulatively combine the elements of an array or array of arrays using a function.
  jStat.cumreduce = function cumreduce(arr, func, toAlter) {
    var row, nrow, ncol, res, col;

    if (!isArray(arr[0]))
      arr = [arr];

    nrow = arr.length;
    ncol = arr[0].length;
    res = toAlter ? arr : new Array(nrow);

    for (row = 0; row < nrow; row++) {
      // if the row doesn't exist, create it
      if (!res[row])
        res[row] = new Array(ncol);
      if (ncol > 0)
        res[row][0] = arr[row][0];
      for (col = 1; col < ncol; col++)
        res[row][col] = func(res[row][col-1], arr[row][col]);
    }
    return res.length === 1 ? res[0] : res;
  };


  // Destructively alter an array.
  jStat.alter = function alter(arr, func) {
    return jStat.map(arr, func, true);
  };


  // Generate a rows x cols matrix according to the supplied function.
  jStat.create = function  create(rows, cols, func) {
    var res = new Array(rows);
    var i, j;

    if (isFunction(cols)) {
      func = cols;
      cols = rows;
    }

    for (i = 0; i < rows; i++) {
      res[i] = new Array(cols);
      for (j = 0; j < cols; j++)
        res[i][j] = func(i, j);
    }

    return res;
  };


  function retZero() { return 0; }


  // Generate a rows x cols matrix of zeros.
  jStat.zeros = function zeros(rows, cols) {
    if (!isNumber(cols))
      cols = rows;
    return jStat.create(rows, cols, retZero);
  };


  function retOne() { return 1; }


  // Generate a rows x cols matrix of ones.
  jStat.ones = function ones(rows, cols) {
    if (!isNumber(cols))
      cols = rows;
    return jStat.create(rows, cols, retOne);
  };


  // Generate a rows x cols matrix of uniformly random numbers.
  jStat.rand = function rand(rows, cols) {
    if (!isNumber(cols))
      cols = rows;
    return jStat.create(rows, cols, jStat._random_fn);
  };


  function retIdent(i, j) { return i === j ? 1 : 0; }


  // Generate an identity matrix of size row x cols.
  jStat.identity = function identity(rows, cols) {
    if (!isNumber(cols))
      cols = rows;
    return jStat.create(rows, cols, retIdent);
  };


  // Tests whether a matrix is symmetric
  jStat.symmetric = function symmetric(arr) {
    var size = arr.length;
    var row, col;

    if (arr.length !== arr[0].length)
      return false;

    for (row = 0; row < size; row++) {
      for (col = 0; col < size; col++)
        if (arr[col][row] !== arr[row][col])
          return false;
    }

    return true;
  };


  // Set all values to zero.
  jStat.clear = function clear(arr) {
    return jStat.alter(arr, retZero);
  };


  // Generate sequence.
  jStat.seq = function seq(min, max, length, func) {
    if (!isFunction(func))
      func = false;

    var arr = [];
    var hival = calcRdx(min, max);
    var step = (max * hival - min * hival) / ((length - 1) * hival);
    var current = min;
    var cnt;

    // Current is assigned using a technique to compensate for IEEE error.
    // TODO: Needs better implementation.
    for (cnt = 0;
         current <= max && cnt < length;
         cnt++, current = (min * hival + step * hival * cnt) / hival) {
      arr.push((func ? func(current, cnt) : current));
    }

    return arr;
  };


  // arange(5) -> [0,1,2,3,4]
  // arange(1,5) -> [1,2,3,4]
  // arange(5,1,-1) -> [5,4,3,2]
  jStat.arange = function arange(start, end, step) {
    var rl = [];
    var i;
    step = step || 1;
    if (end === undefined$1) {
      end = start;
      start = 0;
    }
    if (start === end || step === 0) {
      return [];
    }
    if (start < end && step < 0) {
      return [];
    }
    if (start > end && step > 0) {
      return [];
    }
    if (step > 0) {
      for (i = start; i < end; i += step) {
        rl.push(i);
      }
    } else {
      for (i = start; i > end; i += step) {
        rl.push(i);
      }
    }
    return rl;
  };


  // A=[[1,2,3],[4,5,6],[7,8,9]]
  // slice(A,{row:{end:2},col:{start:1}}) -> [[2,3],[5,6]]
  // slice(A,1,{start:1}) -> [5,6]
  // as numpy code A[:2,1:]
  jStat.slice = (function(){
    function _slice(list, start, end, step) {
      // note it's not equal to range.map mode it's a bug
      var i;
      var rl = [];
      var length = list.length;
      if (start === undefined$1 && end === undefined$1 && step === undefined$1) {
        return jStat.copy(list);
      }

      start = start || 0;
      end = end || list.length;
      start = start >= 0 ? start : length + start;
      end = end >= 0 ? end : length + end;
      step = step || 1;
      if (start === end || step === 0) {
        return [];
      }
      if (start < end && step < 0) {
        return [];
      }
      if (start > end && step > 0) {
        return [];
      }
      if (step > 0) {
        for (i = start; i < end; i += step) {
          rl.push(list[i]);
        }
      } else {
        for (i = start; i > end;i += step) {
          rl.push(list[i]);
        }
      }
      return rl;
    }

    function slice(list, rcSlice) {
      var colSlice, rowSlice;
      rcSlice = rcSlice || {};
      if (isNumber(rcSlice.row)) {
        if (isNumber(rcSlice.col))
          return list[rcSlice.row][rcSlice.col];
        var row = jStat.rowa(list, rcSlice.row);
        colSlice = rcSlice.col || {};
        return _slice(row, colSlice.start, colSlice.end, colSlice.step);
      }

      if (isNumber(rcSlice.col)) {
        var col = jStat.cola(list, rcSlice.col);
        rowSlice = rcSlice.row || {};
        return _slice(col, rowSlice.start, rowSlice.end, rowSlice.step);
      }

      rowSlice = rcSlice.row || {};
      colSlice = rcSlice.col || {};
      var rows = _slice(list, rowSlice.start, rowSlice.end, rowSlice.step);
      return rows.map(function(row) {
        return _slice(row, colSlice.start, colSlice.end, colSlice.step);
      });
    }

    return slice;
  }());


  // A=[[1,2,3],[4,5,6],[7,8,9]]
  // sliceAssign(A,{row:{start:1},col:{start:1}},[[0,0],[0,0]])
  // A=[[1,2,3],[4,0,0],[7,0,0]]
  jStat.sliceAssign = function sliceAssign(A, rcSlice, B) {
    var nl, ml;
    if (isNumber(rcSlice.row)) {
      if (isNumber(rcSlice.col))
        return A[rcSlice.row][rcSlice.col] = B;
      rcSlice.col = rcSlice.col || {};
      rcSlice.col.start = rcSlice.col.start || 0;
      rcSlice.col.end = rcSlice.col.end || A[0].length;
      rcSlice.col.step = rcSlice.col.step || 1;
      nl = jStat.arange(rcSlice.col.start,
                            Math.min(A.length, rcSlice.col.end),
                            rcSlice.col.step);
      var m = rcSlice.row;
      nl.forEach(function(n, i) {
        A[m][n] = B[i];
      });
      return A;
    }

    if (isNumber(rcSlice.col)) {
      rcSlice.row = rcSlice.row || {};
      rcSlice.row.start = rcSlice.row.start || 0;
      rcSlice.row.end = rcSlice.row.end || A.length;
      rcSlice.row.step = rcSlice.row.step || 1;
      ml = jStat.arange(rcSlice.row.start,
                            Math.min(A[0].length, rcSlice.row.end),
                            rcSlice.row.step);
      var n = rcSlice.col;
      ml.forEach(function(m, j) {
        A[m][n] = B[j];
      });
      return A;
    }

    if (B[0].length === undefined$1) {
      B = [B];
    }
    rcSlice.row.start = rcSlice.row.start || 0;
    rcSlice.row.end = rcSlice.row.end || A.length;
    rcSlice.row.step = rcSlice.row.step || 1;
    rcSlice.col.start = rcSlice.col.start || 0;
    rcSlice.col.end = rcSlice.col.end || A[0].length;
    rcSlice.col.step = rcSlice.col.step || 1;
    ml = jStat.arange(rcSlice.row.start,
                          Math.min(A.length, rcSlice.row.end),
                          rcSlice.row.step);
    nl = jStat.arange(rcSlice.col.start,
                          Math.min(A[0].length, rcSlice.col.end),
                          rcSlice.col.step);
    ml.forEach(function(m, i) {
      nl.forEach(function(n, j) {
        A[m][n] = B[i][j];
      });
    });
    return A;
  };


  // [1,2,3] ->
  // [[1,0,0],[0,2,0],[0,0,3]]
  jStat.diagonal = function diagonal(diagArray) {
    var mat = jStat.zeros(diagArray.length, diagArray.length);
    diagArray.forEach(function(t, i) {
      mat[i][i] = t;
    });
    return mat;
  };


  // return copy of A
  jStat.copy = function copy(A) {
    return A.map(function(row) {
      if (isNumber(row))
        return row;
      return row.map(function(t) {
        return t;
      });
    });
  };


  // TODO: Go over this entire implementation. Seems a tragic waste of resources
  // doing all this work. Instead, and while ugly, use new Function() to generate
  // a custom function for each static method.

  // Quick reference.
  var jProto = jStat.prototype;

  // Default length.
  jProto.length = 0;

  // For internal use only.
  // TODO: Check if they're actually used, and if they are then rename them
  // to _*
  jProto.push = Array.prototype.push;
  jProto.sort = Array.prototype.sort;
  jProto.splice = Array.prototype.splice;
  jProto.slice = Array.prototype.slice;


  // Return a clean array.
  jProto.toArray = function toArray() {
    return this.length > 1 ? slice.call(this) : slice.call(this)[0];
  };


  // Map a function to a matrix or vector.
  jProto.map = function map(func, toAlter) {
    return jStat(jStat.map(this, func, toAlter));
  };


  // Cumulatively combine the elements of a matrix or vector using a function.
  jProto.cumreduce = function cumreduce(func, toAlter) {
    return jStat(jStat.cumreduce(this, func, toAlter));
  };


  // Destructively alter an array.
  jProto.alter = function alter(func) {
    jStat.alter(this, func);
    return this;
  };


  // Extend prototype with methods that have no argument.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jProto[passfunc] = function(func) {
        var self = this,
        results;
        // Check for callback.
        if (func) {
          setTimeout(function() {
            func.call(self, jProto[passfunc].call(self));
          });
          return this;
        }
        results = jStat[passfunc](this);
        return isArray(results) ? jStat(results) : results;
      };
    })(funcs[i]);
  })('transpose clear symmetric rows cols dimensions diag antidiag'.split(' '));


  // Extend prototype with methods that have one argument.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jProto[passfunc] = function(index, func) {
        var self = this;
        // check for callback
        if (func) {
          setTimeout(function() {
            func.call(self, jProto[passfunc].call(self, index));
          });
          return this;
        }
        return jStat(jStat[passfunc](this, index));
      };
    })(funcs[i]);
  })('row col'.split(' '));


  // Extend prototype with simple shortcut methods.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jProto[passfunc] = function() {
        return jStat(jStat[passfunc].apply(null, arguments));
      };
    })(funcs[i]);
  })('create zeros ones rand identity'.split(' '));


  // Exposing jStat.
  return jStat;

  }(Math));
  (function(jStat, Math) {

  var isFunction = jStat.utils.isFunction;

  // Ascending functions for sort
  function ascNum(a, b) { return a - b; }

  function clip(arg, min, max) {
    return Math.max(min, Math.min(arg, max));
  }


  // sum of an array
  jStat.sum = function sum(arr) {
    var sum = 0;
    var i = arr.length;
    while (--i >= 0)
      sum += arr[i];
    return sum;
  };


  // sum squared
  jStat.sumsqrd = function sumsqrd(arr) {
    var sum = 0;
    var i = arr.length;
    while (--i >= 0)
      sum += arr[i] * arr[i];
    return sum;
  };


  // sum of squared errors of prediction (SSE)
  jStat.sumsqerr = function sumsqerr(arr) {
    var mean = jStat.mean(arr);
    var sum = 0;
    var i = arr.length;
    var tmp;
    while (--i >= 0) {
      tmp = arr[i] - mean;
      sum += tmp * tmp;
    }
    return sum;
  };

  // sum of an array in each row
  jStat.sumrow = function sumrow(arr) {
    var sum = 0;
    var i = arr.length;
    while (--i >= 0)
      sum += arr[i];
    return sum;
  };

  // product of an array
  jStat.product = function product(arr) {
    var prod = 1;
    var i = arr.length;
    while (--i >= 0)
      prod *= arr[i];
    return prod;
  };


  // minimum value of an array
  jStat.min = function min(arr) {
    var low = arr[0];
    var i = 0;
    while (++i < arr.length)
      if (arr[i] < low)
        low = arr[i];
    return low;
  };


  // maximum value of an array
  jStat.max = function max(arr) {
    var high = arr[0];
    var i = 0;
    while (++i < arr.length)
      if (arr[i] > high)
        high = arr[i];
    return high;
  };


  // unique values of an array
  jStat.unique = function unique(arr) {
    var hash = {}, _arr = [];
    for(var i = 0; i < arr.length; i++) {
      if (!hash[arr[i]]) {
        hash[arr[i]] = true;
        _arr.push(arr[i]);
      }
    }
    return _arr;
  };


  // mean value of an array
  jStat.mean = function mean(arr) {
    return jStat.sum(arr) / arr.length;
  };


  // mean squared error (MSE)
  jStat.meansqerr = function meansqerr(arr) {
    return jStat.sumsqerr(arr) / arr.length;
  };


  // geometric mean of an array
  jStat.geomean = function geomean(arr) {
    return Math.pow(jStat.product(arr), 1 / arr.length);
  };


  // median of an array
  jStat.median = function median(arr) {
    var arrlen = arr.length;
    var _arr = arr.slice().sort(ascNum);
    // check if array is even or odd, then return the appropriate
    return !(arrlen & 1)
      ? (_arr[(arrlen / 2) - 1 ] + _arr[(arrlen / 2)]) / 2
      : _arr[(arrlen / 2) | 0 ];
  };


  // cumulative sum of an array
  jStat.cumsum = function cumsum(arr) {
    return jStat.cumreduce(arr, function (a, b) { return a + b; });
  };


  // cumulative product of an array
  jStat.cumprod = function cumprod(arr) {
    return jStat.cumreduce(arr, function (a, b) { return a * b; });
  };


  // successive differences of a sequence
  jStat.diff = function diff(arr) {
    var diffs = [];
    var arrLen = arr.length;
    var i;
    for (i = 1; i < arrLen; i++)
      diffs.push(arr[i] - arr[i - 1]);
    return diffs;
  };


  // ranks of an array
  jStat.rank = function (arr) {
    var i;
    var distinctNumbers = [];
    var numberCounts = {};
    for (i = 0; i < arr.length; i++) {
      var number = arr[i];
      if (numberCounts[number]) {
        numberCounts[number]++;
      } else {
        numberCounts[number] = 1;
        distinctNumbers.push(number);
      }
    }

    var sortedDistinctNumbers = distinctNumbers.sort(ascNum);
    var numberRanks = {};
    var currentRank = 1;
    for (i = 0; i < sortedDistinctNumbers.length; i++) {
      var number = sortedDistinctNumbers[i];
      var count = numberCounts[number];
      var first = currentRank;
      var last = currentRank + count - 1;
      var rank = (first + last) / 2;
      numberRanks[number] = rank;
      currentRank += count;
    }

    return arr.map(function (number) {
      return numberRanks[number];
    });
  };


  // mode of an array
  // if there are multiple modes of an array, return all of them
  // is this the appropriate way of handling it?
  jStat.mode = function mode(arr) {
    var arrLen = arr.length;
    var _arr = arr.slice().sort(ascNum);
    var count = 1;
    var maxCount = 0;
    var numMaxCount = 0;
    var mode_arr = [];
    var i;

    for (i = 0; i < arrLen; i++) {
      if (_arr[i] === _arr[i + 1]) {
        count++;
      } else {
        if (count > maxCount) {
          mode_arr = [_arr[i]];
          maxCount = count;
          numMaxCount = 0;
        }
        // are there multiple max counts
        else if (count === maxCount) {
          mode_arr.push(_arr[i]);
          numMaxCount++;
        }
        // resetting count for new value in array
        count = 1;
      }
    }

    return numMaxCount === 0 ? mode_arr[0] : mode_arr;
  };


  // range of an array
  jStat.range = function range(arr) {
    return jStat.max(arr) - jStat.min(arr);
  };

  // variance of an array
  // flag = true indicates sample instead of population
  jStat.variance = function variance(arr, flag) {
    return jStat.sumsqerr(arr) / (arr.length - (flag ? 1 : 0));
  };

  // pooled variance of an array of arrays
  jStat.pooledvariance = function pooledvariance(arr) {
    var sumsqerr = arr.reduce(function (a, samples) {return a + jStat.sumsqerr(samples);}, 0);
    var count = arr.reduce(function (a, samples) {return a + samples.length;}, 0);
    return sumsqerr / (count - arr.length);
  };

  // deviation of an array
  jStat.deviation = function (arr) {
    var mean = jStat.mean(arr);
    var arrlen = arr.length;
    var dev = new Array(arrlen);
    for (var i = 0; i < arrlen; i++) {
      dev[i] = arr[i] - mean;
    }
    return dev;
  };

  // standard deviation of an array
  // flag = true indicates sample instead of population
  jStat.stdev = function stdev(arr, flag) {
    return Math.sqrt(jStat.variance(arr, flag));
  };

  // pooled standard deviation of an array of arrays
  jStat.pooledstdev = function pooledstdev(arr) {
    return Math.sqrt(jStat.pooledvariance(arr));
  };

  // mean deviation (mean absolute deviation) of an array
  jStat.meandev = function meandev(arr) {
    var mean = jStat.mean(arr);
    var a = [];
    for (var i = arr.length - 1; i >= 0; i--) {
      a.push(Math.abs(arr[i] - mean));
    }
    return jStat.mean(a);
  };


  // median deviation (median absolute deviation) of an array
  jStat.meddev = function meddev(arr) {
    var median = jStat.median(arr);
    var a = [];
    for (var i = arr.length - 1; i >= 0; i--) {
      a.push(Math.abs(arr[i] - median));
    }
    return jStat.median(a);
  };


  // coefficient of variation
  jStat.coeffvar = function coeffvar(arr) {
    return jStat.stdev(arr) / jStat.mean(arr);
  };


  // quartiles of an array
  jStat.quartiles = function quartiles(arr) {
    var arrlen = arr.length;
    var _arr = arr.slice().sort(ascNum);
    return [
      _arr[ Math.round((arrlen) / 4) - 1 ],
      _arr[ Math.round((arrlen) / 2) - 1 ],
      _arr[ Math.round((arrlen) * 3 / 4) - 1 ]
    ];
  };


  // Arbitary quantiles of an array. Direct port of the scipy.stats
  // implementation by Pierre GF Gerard-Marchant.
  jStat.quantiles = function quantiles(arr, quantilesArray, alphap, betap) {
    var sortedArray = arr.slice().sort(ascNum);
    var quantileVals = [quantilesArray.length];
    var n = arr.length;
    var i, p, m, aleph, k, gamma;

    if (typeof alphap === 'undefined')
      alphap = 3 / 8;
    if (typeof betap === 'undefined')
      betap = 3 / 8;

    for (i = 0; i < quantilesArray.length; i++) {
      p = quantilesArray[i];
      m = alphap + p * (1 - alphap - betap);
      aleph = n * p + m;
      k = Math.floor(clip(aleph, 1, n - 1));
      gamma = clip(aleph - k, 0, 1);
      quantileVals[i] = (1 - gamma) * sortedArray[k - 1] + gamma * sortedArray[k];
    }

    return quantileVals;
  };

  // Return the k-th percentile of values in a range, where k is in the range 0..1, inclusive.
  // Passing true for the exclusive parameter excludes both endpoints of the range.
  jStat.percentile = function percentile(arr, k, exclusive) {
    var _arr = arr.slice().sort(ascNum);
    var realIndex = k * (_arr.length + (exclusive ? 1 : -1)) + (exclusive ? 0 : 1);
    var index = parseInt(realIndex);
    var frac = realIndex - index;
    if (index + 1 < _arr.length) {
      return _arr[index - 1] + frac * (_arr[index] - _arr[index - 1]);
    } else {
      return _arr[index - 1];
    }
  };

  // The percentile rank of score in a given array. Returns the percentage
  // of all values in the input array that are less than (kind='strict') or
  // less or equal than (kind='weak') score. Default is weak.
  jStat.percentileOfScore = function percentileOfScore(arr, score, kind) {
    var counter = 0;
    var len = arr.length;
    var strict = false;
    var value, i;

    if (kind === 'strict')
      strict = true;

    for (i = 0; i < len; i++) {
      value = arr[i];
      if ((strict && value < score) ||
          (!strict && value <= score)) {
        counter++;
      }
    }

    return counter / len;
  };


  // Histogram (bin count) data
  jStat.histogram = function histogram(arr, binCnt) {
    binCnt = binCnt || 4;
    var first = jStat.min(arr);
    var binWidth = (jStat.max(arr) - first) / binCnt;
    var len = arr.length;
    var bins = [];
    var i;

    for (i = 0; i < binCnt; i++)
      bins[i] = 0;
    for (i = 0; i < len; i++)
      bins[Math.min(Math.floor(((arr[i] - first) / binWidth)), binCnt - 1)] += 1;

    return bins;
  };


  // covariance of two arrays
  jStat.covariance = function covariance(arr1, arr2) {
    var u = jStat.mean(arr1);
    var v = jStat.mean(arr2);
    var arr1Len = arr1.length;
    var sq_dev = new Array(arr1Len);
    var i;

    for (i = 0; i < arr1Len; i++)
      sq_dev[i] = (arr1[i] - u) * (arr2[i] - v);

    return jStat.sum(sq_dev) / (arr1Len - 1);
  };


  // (pearson's) population correlation coefficient, rho
  jStat.corrcoeff = function corrcoeff(arr1, arr2) {
    return jStat.covariance(arr1, arr2) /
        jStat.stdev(arr1, 1) /
        jStat.stdev(arr2, 1);
  };

    // (spearman's) rank correlation coefficient, sp
  jStat.spearmancoeff =  function (arr1, arr2) {
    arr1 = jStat.rank(arr1);
    arr2 = jStat.rank(arr2);
    //return pearson's correlation of the ranks:
    return jStat.corrcoeff(arr1, arr2);
  };


  // statistical standardized moments (general form of skew/kurt)
  jStat.stanMoment = function stanMoment(arr, n) {
    var mu = jStat.mean(arr);
    var sigma = jStat.stdev(arr);
    var len = arr.length;
    var skewSum = 0;

    for (var i = 0; i < len; i++)
      skewSum += Math.pow((arr[i] - mu) / sigma, n);

    return skewSum / arr.length;
  };

  // (pearson's) moment coefficient of skewness
  jStat.skewness = function skewness(arr) {
    return jStat.stanMoment(arr, 3);
  };

  // (pearson's) (excess) kurtosis
  jStat.kurtosis = function kurtosis(arr) {
    return jStat.stanMoment(arr, 4) - 3;
  };


  var jProto = jStat.prototype;


  // Extend jProto with method for calculating cumulative sums and products.
  // This differs from the similar extension below as cumsum and cumprod should
  // not be run again in the case fullbool === true.
  // If a matrix is passed, automatically assume operation should be done on the
  // columns.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      // If a matrix is passed, automatically assume operation should be done on
      // the columns.
      jProto[passfunc] = function(fullbool, func) {
        var arr = [];
        var i = 0;
        var tmpthis = this;
        // Assignment reassignation depending on how parameters were passed in.
        if (isFunction(fullbool)) {
          func = fullbool;
          fullbool = false;
        }
        // Check if a callback was passed with the function.
        if (func) {
          setTimeout(function() {
            func.call(tmpthis, jProto[passfunc].call(tmpthis, fullbool));
          });
          return this;
        }
        // Check if matrix and run calculations.
        if (this.length > 1) {
          tmpthis = fullbool === true ? this : this.transpose();
          for (; i < tmpthis.length; i++)
            arr[i] = jStat[passfunc](tmpthis[i]);
          return arr;
        }
        // Pass fullbool if only vector, not a matrix. for variance and stdev.
        return jStat[passfunc](this[0], fullbool);
      };
    })(funcs[i]);
  })(('cumsum cumprod').split(' '));


  // Extend jProto with methods which don't require arguments and work on columns.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      // If a matrix is passed, automatically assume operation should be done on
      // the columns.
      jProto[passfunc] = function(fullbool, func) {
        var arr = [];
        var i = 0;
        var tmpthis = this;
        // Assignment reassignation depending on how parameters were passed in.
        if (isFunction(fullbool)) {
          func = fullbool;
          fullbool = false;
        }
        // Check if a callback was passed with the function.
        if (func) {
          setTimeout(function() {
            func.call(tmpthis, jProto[passfunc].call(tmpthis, fullbool));
          });
          return this;
        }
        // Check if matrix and run calculations.
        if (this.length > 1) {
          if (passfunc !== 'sumrow')
            tmpthis = fullbool === true ? this : this.transpose();
          for (; i < tmpthis.length; i++)
            arr[i] = jStat[passfunc](tmpthis[i]);
          return fullbool === true
              ? jStat[passfunc](jStat.utils.toVector(arr))
              : arr;
        }
        // Pass fullbool if only vector, not a matrix. for variance and stdev.
        return jStat[passfunc](this[0], fullbool);
      };
    })(funcs[i]);
  })(('sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr ' +
      'geomean median diff rank mode range variance deviation stdev meandev ' +
      'meddev coeffvar quartiles histogram skewness kurtosis').split(' '));


  // Extend jProto with functions that take arguments. Operations on matrices are
  // done on columns.
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jProto[passfunc] = function() {
        var arr = [];
        var i = 0;
        var tmpthis = this;
        var args = Array.prototype.slice.call(arguments);
        var callbackFunction;

        // If the last argument is a function, we assume it's a callback; we
        // strip the callback out and call the function again.
        if (isFunction(args[args.length - 1])) {
          callbackFunction = args[args.length - 1];
          var argsToPass = args.slice(0, args.length - 1);

          setTimeout(function() {
            callbackFunction.call(tmpthis,
                                  jProto[passfunc].apply(tmpthis, argsToPass));
          });
          return this;

        // Otherwise we curry the function args and call normally.
        } else {
          callbackFunction = undefined;
          var curriedFunction = function curriedFunction(vector) {
            return jStat[passfunc].apply(tmpthis, [vector].concat(args));
          };
        }

        // If this is a matrix, run column-by-column.
        if (this.length > 1) {
          tmpthis = tmpthis.transpose();
          for (; i < tmpthis.length; i++)
            arr[i] = curriedFunction(tmpthis[i]);
          return arr;
        }

        // Otherwise run on the vector.
        return curriedFunction(this[0]);
      };
    })(funcs[i]);
  })('quantiles percentileOfScore'.split(' '));

  }(jStat, Math));
  // Special functions //
  (function(jStat, Math) {

  // Log-gamma function
  jStat.gammaln = function gammaln(x) {
    var j = 0;
    var cof = [
      76.18009172947146, -86.50532032941677, 24.01409824083091,
      -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5
    ];
    var ser = 1.000000000190015;
    var xx, y, tmp;
    tmp = (y = xx = x) + 5.5;
    tmp -= (xx + 0.5) * Math.log(tmp);
    for (; j < 6; j++)
      ser += cof[j] / ++y;
    return Math.log(2.5066282746310005 * ser / xx) - tmp;
  };

  /*
   * log-gamma function to support poisson distribution sampling. The
   * algorithm comes from SPECFUN by Shanjie Zhang and Jianming Jin and their
   * book "Computation of Special Functions", 1996, John Wiley & Sons, Inc.
   */
  jStat.loggam = function loggam(x) {
    var x0, x2, xp, gl, gl0;
    var k, n;

    var a = [8.333333333333333e-02, -2.777777777777778e-03,
            7.936507936507937e-04, -5.952380952380952e-04,
            8.417508417508418e-04, -1.917526917526918e-03,
            6.410256410256410e-03, -2.955065359477124e-02,
            1.796443723688307e-01, -1.39243221690590e+00];
    x0 = x;
    n = 0;
    if ((x == 1.0) || (x == 2.0)) {
        return 0.0;
    }
    if (x <= 7.0) {
        n = Math.floor(7 - x);
        x0 = x + n;
    }
    x2 = 1.0 / (x0 * x0);
    xp = 2 * Math.PI;
    gl0 = a[9];
    for (k = 8; k >= 0; k--) {
        gl0 *= x2;
        gl0 += a[k];
    }
    gl = gl0 / x0 + 0.5 * Math.log(xp) + (x0 - 0.5) * Math.log(x0) - x0;
    if (x <= 7.0) {
        for (k = 1; k <= n; k++) {
            gl -= Math.log(x0 - 1.0);
            x0 -= 1.0;
        }
    }
    return gl;
  };

  // gamma of x
  jStat.gammafn = function gammafn(x) {
    var p = [-1.716185138865495, 24.76565080557592, -379.80425647094563,
             629.3311553128184, 866.9662027904133, -31451.272968848367,
             -36144.413418691176, 66456.14382024054
    ];
    var q = [-30.8402300119739, 315.35062697960416, -1015.1563674902192,
             -3107.771671572311, 22538.118420980151, 4755.8462775278811,
             -134659.9598649693, -115132.2596755535];
    var fact = false;
    var n = 0;
    var xden = 0;
    var xnum = 0;
    var y = x;
    var i, z, yi, res;
    if (x > 171.6243769536076) {
      return Infinity;
    }
    if (y <= 0) {
      res = y % 1 + 3.6e-16;
      if (res) {
        fact = (!(y & 1) ? 1 : -1) * Math.PI / Math.sin(Math.PI * res);
        y = 1 - y;
      } else {
        return Infinity;
      }
    }
    yi = y;
    if (y < 1) {
      z = y++;
    } else {
      z = (y -= n = (y | 0) - 1) - 1;
    }
    for (i = 0; i < 8; ++i) {
      xnum = (xnum + p[i]) * z;
      xden = xden * z + q[i];
    }
    res = xnum / xden + 1;
    if (yi < y) {
      res /= yi;
    } else if (yi > y) {
      for (i = 0; i < n; ++i) {
        res *= y;
        y++;
      }
    }
    if (fact) {
      res = fact / res;
    }
    return res;
  };


  // lower incomplete gamma function, which is usually typeset with a
  // lower-case greek gamma as the function symbol
  jStat.gammap = function gammap(a, x) {
    return jStat.lowRegGamma(a, x) * jStat.gammafn(a);
  };


  // The lower regularized incomplete gamma function, usually written P(a,x)
  jStat.lowRegGamma = function lowRegGamma(a, x) {
    var aln = jStat.gammaln(a);
    var ap = a;
    var sum = 1 / a;
    var del = sum;
    var b = x + 1 - a;
    var c = 1 / 1.0e-30;
    var d = 1 / b;
    var h = d;
    var i = 1;
    // calculate maximum number of itterations required for a
    var ITMAX = -~(Math.log((a >= 1) ? a : 1 / a) * 8.5 + a * 0.4 + 17);
    var an;

    if (x < 0 || a <= 0) {
      return NaN;
    } else if (x < a + 1) {
      for (; i <= ITMAX; i++) {
        sum += del *= x / ++ap;
      }
      return (sum * Math.exp(-x + a * Math.log(x) - (aln)));
    }

    for (; i <= ITMAX; i++) {
      an = -i * (i - a);
      b += 2;
      d = an * d + b;
      c = b + an / c;
      d = 1 / d;
      h *= d * c;
    }

    return (1 - h * Math.exp(-x + a * Math.log(x) - (aln)));
  };

  // natural log factorial of n
  jStat.factorialln = function factorialln(n) {
    return n < 0 ? NaN : jStat.gammaln(n + 1);
  };

  // factorial of n
  jStat.factorial = function factorial(n) {
    return n < 0 ? NaN : jStat.gammafn(n + 1);
  };

  // combinations of n, m
  jStat.combination = function combination(n, m) {
    // make sure n or m don't exceed the upper limit of usable values
    return (n > 170 || m > 170)
        ? Math.exp(jStat.combinationln(n, m))
        : (jStat.factorial(n) / jStat.factorial(m)) / jStat.factorial(n - m);
  };


  jStat.combinationln = function combinationln(n, m){
    return jStat.factorialln(n) - jStat.factorialln(m) - jStat.factorialln(n - m);
  };


  // permutations of n, m
  jStat.permutation = function permutation(n, m) {
    return jStat.factorial(n) / jStat.factorial(n - m);
  };


  // beta function
  jStat.betafn = function betafn(x, y) {
    // ensure arguments are positive
    if (x <= 0 || y <= 0)
      return undefined;
    // make sure x + y doesn't exceed the upper limit of usable values
    return (x + y > 170)
        ? Math.exp(jStat.betaln(x, y))
        : jStat.gammafn(x) * jStat.gammafn(y) / jStat.gammafn(x + y);
  };


  // natural logarithm of beta function
  jStat.betaln = function betaln(x, y) {
    return jStat.gammaln(x) + jStat.gammaln(y) - jStat.gammaln(x + y);
  };


  // Evaluates the continued fraction for incomplete beta function by modified
  // Lentz's method.
  jStat.betacf = function betacf(x, a, b) {
    var fpmin = 1e-30;
    var m = 1;
    var qab = a + b;
    var qap = a + 1;
    var qam = a - 1;
    var c = 1;
    var d = 1 - qab * x / qap;
    var m2, aa, del, h;

    // These q's will be used in factors that occur in the coefficients
    if (Math.abs(d) < fpmin)
      d = fpmin;
    d = 1 / d;
    h = d;

    for (; m <= 100; m++) {
      m2 = 2 * m;
      aa = m * (b - m) * x / ((qam + m2) * (a + m2));
      // One step (the even one) of the recurrence
      d = 1 + aa * d;
      if (Math.abs(d) < fpmin)
        d = fpmin;
      c = 1 + aa / c;
      if (Math.abs(c) < fpmin)
        c = fpmin;
      d = 1 / d;
      h *= d * c;
      aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
      // Next step of the recurrence (the odd one)
      d = 1 + aa * d;
      if (Math.abs(d) < fpmin)
        d = fpmin;
      c = 1 + aa / c;
      if (Math.abs(c) < fpmin)
        c = fpmin;
      d = 1 / d;
      del = d * c;
      h *= del;
      if (Math.abs(del - 1.0) < 3e-7)
        break;
    }

    return h;
  };


  // Returns the inverse of the lower regularized inomplete gamma function
  jStat.gammapinv = function gammapinv(p, a) {
    var j = 0;
    var a1 = a - 1;
    var EPS = 1e-8;
    var gln = jStat.gammaln(a);
    var x, err, t, u, pp, lna1, afac;

    if (p >= 1)
      return Math.max(100, a + 100 * Math.sqrt(a));
    if (p <= 0)
      return 0;
    if (a > 1) {
      lna1 = Math.log(a1);
      afac = Math.exp(a1 * (lna1 - 1) - gln);
      pp = (p < 0.5) ? p : 1 - p;
      t = Math.sqrt(-2 * Math.log(pp));
      x = (2.30753 + t * 0.27061) / (1 + t * (0.99229 + t * 0.04481)) - t;
      if (p < 0.5)
        x = -x;
      x = Math.max(1e-3,
                   a * Math.pow(1 - 1 / (9 * a) - x / (3 * Math.sqrt(a)), 3));
    } else {
      t = 1 - a * (0.253 + a * 0.12);
      if (p < t)
        x = Math.pow(p / t, 1 / a);
      else
        x = 1 - Math.log(1 - (p - t) / (1 - t));
    }

    for(; j < 12; j++) {
      if (x <= 0)
        return 0;
      err = jStat.lowRegGamma(a, x) - p;
      if (a > 1)
        t = afac * Math.exp(-(x - a1) + a1 * (Math.log(x) - lna1));
      else
        t = Math.exp(-x + a1 * Math.log(x) - gln);
      u = err / t;
      x -= (t = u / (1 - 0.5 * Math.min(1, u * ((a - 1) / x - 1))));
      if (x <= 0)
        x = 0.5 * (x + t);
      if (Math.abs(t) < EPS * x)
        break;
    }

    return x;
  };


  // Returns the error function erf(x)
  jStat.erf = function erf(x) {
    var cof = [-1.3026537197817094, 6.4196979235649026e-1, 1.9476473204185836e-2,
               -9.561514786808631e-3, -9.46595344482036e-4, 3.66839497852761e-4,
               4.2523324806907e-5, -2.0278578112534e-5, -1.624290004647e-6,
               1.303655835580e-6, 1.5626441722e-8, -8.5238095915e-8,
               6.529054439e-9, 5.059343495e-9, -9.91364156e-10,
               -2.27365122e-10, 9.6467911e-11, 2.394038e-12,
               -6.886027e-12, 8.94487e-13, 3.13092e-13,
               -1.12708e-13, 3.81e-16, 7.106e-15,
               -1.523e-15, -9.4e-17, 1.21e-16,
               -2.8e-17];
    var j = cof.length - 1;
    var isneg = false;
    var d = 0;
    var dd = 0;
    var t, ty, tmp, res;

    if (x < 0) {
      x = -x;
      isneg = true;
    }

    t = 2 / (2 + x);
    ty = 4 * t - 2;

    for(; j > 0; j--) {
      tmp = d;
      d = ty * d - dd + cof[j];
      dd = tmp;
    }

    res = t * Math.exp(-x * x + 0.5 * (cof[0] + ty * d) - dd);
    return isneg ? res - 1 : 1 - res;
  };


  // Returns the complmentary error function erfc(x)
  jStat.erfc = function erfc(x) {
    return 1 - jStat.erf(x);
  };


  // Returns the inverse of the complementary error function
  jStat.erfcinv = function erfcinv(p) {
    var j = 0;
    var x, err, t, pp;
    if (p >= 2)
      return -100;
    if (p <= 0)
      return 100;
    pp = (p < 1) ? p : 2 - p;
    t = Math.sqrt(-2 * Math.log(pp / 2));
    x = -0.70711 * ((2.30753 + t * 0.27061) /
                    (1 + t * (0.99229 + t * 0.04481)) - t);
    for (; j < 2; j++) {
      err = jStat.erfc(x) - pp;
      x += err / (1.12837916709551257 * Math.exp(-x * x) - x * err);
    }
    return (p < 1) ? x : -x;
  };


  // Returns the inverse of the incomplete beta function
  jStat.ibetainv = function ibetainv(p, a, b) {
    var EPS = 1e-8;
    var a1 = a - 1;
    var b1 = b - 1;
    var j = 0;
    var lna, lnb, pp, t, u, err, x, al, h, w, afac;
    if (p <= 0)
      return 0;
    if (p >= 1)
      return 1;
    if (a >= 1 && b >= 1) {
      pp = (p < 0.5) ? p : 1 - p;
      t = Math.sqrt(-2 * Math.log(pp));
      x = (2.30753 + t * 0.27061) / (1 + t* (0.99229 + t * 0.04481)) - t;
      if (p < 0.5)
        x = -x;
      al = (x * x - 3) / 6;
      h = 2 / (1 / (2 * a - 1)  + 1 / (2 * b - 1));
      w = (x * Math.sqrt(al + h) / h) - (1 / (2 * b - 1) - 1 / (2 * a - 1)) *
          (al + 5 / 6 - 2 / (3 * h));
      x = a / (a + b * Math.exp(2 * w));
    } else {
      lna = Math.log(a / (a + b));
      lnb = Math.log(b / (a + b));
      t = Math.exp(a * lna) / a;
      u = Math.exp(b * lnb) / b;
      w = t + u;
      if (p < t / w)
        x = Math.pow(a * w * p, 1 / a);
      else
        x = 1 - Math.pow(b * w * (1 - p), 1 / b);
    }
    afac = -jStat.gammaln(a) - jStat.gammaln(b) + jStat.gammaln(a + b);
    for(; j < 10; j++) {
      if (x === 0 || x === 1)
        return x;
      err = jStat.ibeta(x, a, b) - p;
      t = Math.exp(a1 * Math.log(x) + b1 * Math.log(1 - x) + afac);
      u = err / t;
      x -= (t = u / (1 - 0.5 * Math.min(1, u * (a1 / x - b1 / (1 - x)))));
      if (x <= 0)
        x = 0.5 * (x + t);
      if (x >= 1)
        x = 0.5 * (x + t + 1);
      if (Math.abs(t) < EPS * x && j > 0)
        break;
    }
    return x;
  };


  // Returns the incomplete beta function I_x(a,b)
  jStat.ibeta = function ibeta(x, a, b) {
    // Factors in front of the continued fraction.
    var bt = (x === 0 || x === 1) ?  0 :
      Math.exp(jStat.gammaln(a + b) - jStat.gammaln(a) -
               jStat.gammaln(b) + a * Math.log(x) + b *
               Math.log(1 - x));
    if (x < 0 || x > 1)
      return false;
    if (x < (a + 1) / (a + b + 2))
      // Use continued fraction directly.
      return bt * jStat.betacf(x, a, b) / a;
    // else use continued fraction after making the symmetry transformation.
    return 1 - bt * jStat.betacf(1 - x, b, a) / b;
  };


  // Returns a normal deviate (mu=0, sigma=1).
  // If n and m are specified it returns a object of normal deviates.
  jStat.randn = function randn(n, m) {
    var u, v, x, y, q;
    if (!m)
      m = n;
    if (n)
      return jStat.create(n, m, function() { return jStat.randn(); });
    do {
      u = jStat._random_fn();
      v = 1.7156 * (jStat._random_fn() - 0.5);
      x = u - 0.449871;
      y = Math.abs(v) + 0.386595;
      q = x * x + y * (0.19600 * y - 0.25472 * x);
    } while (q > 0.27597 && (q > 0.27846 || v * v > -4 * Math.log(u) * u * u));
    return v / u;
  };


  // Returns a gamma deviate by the method of Marsaglia and Tsang.
  jStat.randg = function randg(shape, n, m) {
    var oalph = shape;
    var a1, a2, u, v, x, mat;
    if (!m)
      m = n;
    if (!shape)
      shape = 1;
    if (n) {
      mat = jStat.zeros(n,m);
      mat.alter(function() { return jStat.randg(shape); });
      return mat;
    }
    if (shape < 1)
      shape += 1;
    a1 = shape - 1 / 3;
    a2 = 1 / Math.sqrt(9 * a1);
    do {
      do {
        x = jStat.randn();
        v = 1 + a2 * x;
      } while(v <= 0);
      v = v * v * v;
      u = jStat._random_fn();
    } while(u > 1 - 0.331 * Math.pow(x, 4) &&
            Math.log(u) > 0.5 * x*x + a1 * (1 - v + Math.log(v)));
    // alpha > 1
    if (shape == oalph)
      return a1 * v;
    // alpha < 1
    do {
      u = jStat._random_fn();
    } while(u === 0);
    return Math.pow(u, 1 / oalph) * a1 * v;
  };


  // making use of static methods on the instance
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jStat.fn[passfunc] = function() {
        return jStat(
            jStat.map(this, function(value) { return jStat[passfunc](value); }));
      };
    })(funcs[i]);
  })('gammaln gammafn factorial factorialln'.split(' '));


  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jStat.fn[passfunc] = function() {
        return jStat(jStat[passfunc].apply(null, arguments));
      };
    })(funcs[i]);
  })('randn'.split(' '));

  }(jStat, Math));
  (function(jStat, Math) {

  // generate all distribution instance methods
  (function(list) {
    for (var i = 0; i < list.length; i++) (function(func) {
      // distribution instance method
      jStat[func] = function f(a, b, c) {
        if (!(this instanceof f))
          return new f(a, b, c);
        this._a = a;
        this._b = b;
        this._c = c;
        return this;
      };
      // distribution method to be used on a jStat instance
      jStat.fn[func] = function(a, b, c) {
        var newthis = jStat[func](a, b, c);
        newthis.data = this;
        return newthis;
      };
      // sample instance method
      jStat[func].prototype.sample = function(arr) {
        var a = this._a;
        var b = this._b;
        var c = this._c;
        if (arr)
          return jStat.alter(arr, function() {
            return jStat[func].sample(a, b, c);
          });
        else
          return jStat[func].sample(a, b, c);
      };
      // generate the pdf, cdf and inv instance methods
      (function(vals) {
        for (var i = 0; i < vals.length; i++) (function(fnfunc) {
          jStat[func].prototype[fnfunc] = function(x) {
            var a = this._a;
            var b = this._b;
            var c = this._c;
            if (!x && x !== 0)
              x = this.data;
            if (typeof x !== 'number') {
              return jStat.fn.map.call(x, function(x) {
                return jStat[func][fnfunc](x, a, b, c);
              });
            }
            return jStat[func][fnfunc](x, a, b, c);
          };
        })(vals[i]);
      })('pdf cdf inv'.split(' '));
      // generate the mean, median, mode and variance instance methods
      (function(vals) {
        for (var i = 0; i < vals.length; i++) (function(fnfunc) {
          jStat[func].prototype[fnfunc] = function() {
            return jStat[func][fnfunc](this._a, this._b, this._c);
          };
        })(vals[i]);
      })('mean median mode variance'.split(' '));
    })(list[i]);
  })((
    'beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy ' +
    'laplace lognormal noncentralt normal pareto studentt weibull uniform ' +
    'binomial negbin hypgeom poisson triangular tukey arcsine'
  ).split(' '));



  // extend beta function with static methods
  jStat.extend(jStat.beta, {
    pdf: function pdf(x, alpha, beta) {
      // PDF is zero outside the support
      if (x > 1 || x < 0)
        return 0;
      // PDF is one for the uniform case
      if (alpha == 1 && beta == 1)
        return 1;

      if (alpha < 512 && beta < 512) {
        return (Math.pow(x, alpha - 1) * Math.pow(1 - x, beta - 1)) /
            jStat.betafn(alpha, beta);
      } else {
        return Math.exp((alpha - 1) * Math.log(x) +
                        (beta - 1) * Math.log(1 - x) -
                        jStat.betaln(alpha, beta));
      }
    },

    cdf: function cdf(x, alpha, beta) {
      return (x > 1 || x < 0) ? (x > 1) * 1 : jStat.ibeta(x, alpha, beta);
    },

    inv: function inv(x, alpha, beta) {
      return jStat.ibetainv(x, alpha, beta);
    },

    mean: function mean(alpha, beta) {
      return alpha / (alpha + beta);
    },

    median: function median(alpha, beta) {
      return jStat.ibetainv(0.5, alpha, beta);
    },

    mode: function mode(alpha, beta) {
      return (alpha - 1 ) / ( alpha + beta - 2);
    },

    // return a random sample
    sample: function sample(alpha, beta) {
      var u = jStat.randg(alpha);
      return u / (u + jStat.randg(beta));
    },

    variance: function variance(alpha, beta) {
      return (alpha * beta) / (Math.pow(alpha + beta, 2) * (alpha + beta + 1));
    }
  });

  // extend F function with static methods
  jStat.extend(jStat.centralF, {
    // This implementation of the pdf function avoids float overflow
    // See the way that R calculates this value:
    // https://svn.r-project.org/R/trunk/src/nmath/df.c
    pdf: function pdf(x, df1, df2) {
      var p, q, f;

      if (x < 0)
        return 0;

      if (df1 <= 2) {
        if (x === 0 && df1 < 2) {
          return Infinity;
        }
        if (x === 0 && df1 === 2) {
          return 1;
        }
        return (1 / jStat.betafn(df1 / 2, df2 / 2)) *
                Math.pow(df1 / df2, df1 / 2) *
                Math.pow(x, (df1/2) - 1) *
                Math.pow((1 + (df1 / df2) * x), -(df1 + df2) / 2);
      }

      p = (df1 * x) / (df2 + x * df1);
      q = df2 / (df2 + x * df1);
      f = df1 * q / 2.0;
      return f * jStat.binomial.pdf((df1 - 2) / 2, (df1 + df2 - 2) / 2, p);
    },

    cdf: function cdf(x, df1, df2) {
      if (x < 0)
        return 0;
      return jStat.ibeta((df1 * x) / (df1 * x + df2), df1 / 2, df2 / 2);
    },

    inv: function inv(x, df1, df2) {
      return df2 / (df1 * (1 / jStat.ibetainv(x, df1 / 2, df2 / 2) - 1));
    },

    mean: function mean(df1, df2) {
      return (df2 > 2) ? df2 / (df2 - 2) : undefined;
    },

    mode: function mode(df1, df2) {
      return (df1 > 2) ? (df2 * (df1 - 2)) / (df1 * (df2 + 2)) : undefined;
    },

    // return a random sample
    sample: function sample(df1, df2) {
      var x1 = jStat.randg(df1 / 2) * 2;
      var x2 = jStat.randg(df2 / 2) * 2;
      return (x1 / df1) / (x2 / df2);
    },

    variance: function variance(df1, df2) {
      if (df2 <= 4)
        return undefined;
      return 2 * df2 * df2 * (df1 + df2 - 2) /
          (df1 * (df2 - 2) * (df2 - 2) * (df2 - 4));
    }
  });


  // extend cauchy function with static methods
  jStat.extend(jStat.cauchy, {
    pdf: function pdf(x, local, scale) {
      if (scale < 0) { return 0; }

      return (scale / (Math.pow(x - local, 2) + Math.pow(scale, 2))) / Math.PI;
    },

    cdf: function cdf(x, local, scale) {
      return Math.atan((x - local) / scale) / Math.PI + 0.5;
    },

    inv: function(p, local, scale) {
      return local + scale * Math.tan(Math.PI * (p - 0.5));
    },

    median: function median(local/*, scale*/) {
      return local;
    },

    mode: function mode(local/*, scale*/) {
      return local;
    },

    sample: function sample(local, scale) {
      return jStat.randn() *
          Math.sqrt(1 / (2 * jStat.randg(0.5))) * scale + local;
    }
  });



  // extend chisquare function with static methods
  jStat.extend(jStat.chisquare, {
    pdf: function pdf(x, dof) {
      if (x < 0)
        return 0;
      return (x === 0 && dof === 2) ? 0.5 :
          Math.exp((dof / 2 - 1) * Math.log(x) - x / 2 - (dof / 2) *
                   Math.log(2) - jStat.gammaln(dof / 2));
    },

    cdf: function cdf(x, dof) {
      if (x < 0)
        return 0;
      return jStat.lowRegGamma(dof / 2, x / 2);
    },

    inv: function(p, dof) {
      return 2 * jStat.gammapinv(p, 0.5 * dof);
    },

    mean : function(dof) {
      return dof;
    },

    // TODO: this is an approximation (is there a better way?)
    median: function median(dof) {
      return dof * Math.pow(1 - (2 / (9 * dof)), 3);
    },

    mode: function mode(dof) {
      return (dof - 2 > 0) ? dof - 2 : 0;
    },

    sample: function sample(dof) {
      return jStat.randg(dof / 2) * 2;
    },

    variance: function variance(dof) {
      return 2 * dof;
    }
  });



  // extend exponential function with static methods
  jStat.extend(jStat.exponential, {
    pdf: function pdf(x, rate) {
      return x < 0 ? 0 : rate * Math.exp(-rate * x);
    },

    cdf: function cdf(x, rate) {
      return x < 0 ? 0 : 1 - Math.exp(-rate * x);
    },

    inv: function(p, rate) {
      return -Math.log(1 - p) / rate;
    },

    mean : function(rate) {
      return 1 / rate;
    },

    median: function (rate) {
      return (1 / rate) * Math.log(2);
    },

    mode: function mode(/*rate*/) {
      return 0;
    },

    sample: function sample(rate) {
      return -1 / rate * Math.log(jStat._random_fn());
    },

    variance : function(rate) {
      return Math.pow(rate, -2);
    }
  });



  // extend gamma function with static methods
  jStat.extend(jStat.gamma, {
    pdf: function pdf(x, shape, scale) {
      if (x < 0)
        return 0;
      return (x === 0 && shape === 1) ? 1 / scale :
              Math.exp((shape - 1) * Math.log(x) - x / scale -
                      jStat.gammaln(shape) - shape * Math.log(scale));
    },

    cdf: function cdf(x, shape, scale) {
      if (x < 0)
        return 0;
      return jStat.lowRegGamma(shape, x / scale);
    },

    inv: function(p, shape, scale) {
      return jStat.gammapinv(p, shape) * scale;
    },

    mean : function(shape, scale) {
      return shape * scale;
    },

    mode: function mode(shape, scale) {
      if(shape > 1) return (shape - 1) * scale;
      return undefined;
    },

    sample: function sample(shape, scale) {
      return jStat.randg(shape) * scale;
    },

    variance: function variance(shape, scale) {
      return shape * scale * scale;
    }
  });

  // extend inverse gamma function with static methods
  jStat.extend(jStat.invgamma, {
    pdf: function pdf(x, shape, scale) {
      if (x <= 0)
        return 0;
      return Math.exp(-(shape + 1) * Math.log(x) - scale / x -
                      jStat.gammaln(shape) + shape * Math.log(scale));
    },

    cdf: function cdf(x, shape, scale) {
      if (x <= 0)
        return 0;
      return 1 - jStat.lowRegGamma(shape, scale / x);
    },

    inv: function(p, shape, scale) {
      return scale / jStat.gammapinv(1 - p, shape);
    },

    mean : function(shape, scale) {
      return (shape > 1) ? scale / (shape - 1) : undefined;
    },

    mode: function mode(shape, scale) {
      return scale / (shape + 1);
    },

    sample: function sample(shape, scale) {
      return scale / jStat.randg(shape);
    },

    variance: function variance(shape, scale) {
      if (shape <= 2)
        return undefined;
      return scale * scale / ((shape - 1) * (shape - 1) * (shape - 2));
    }
  });


  // extend kumaraswamy function with static methods
  jStat.extend(jStat.kumaraswamy, {
    pdf: function pdf(x, alpha, beta) {
      if (x === 0 && alpha === 1)
        return beta;
      else if (x === 1 && beta === 1)
        return alpha;
      return Math.exp(Math.log(alpha) + Math.log(beta) + (alpha - 1) *
                      Math.log(x) + (beta - 1) *
                      Math.log(1 - Math.pow(x, alpha)));
    },

    cdf: function cdf(x, alpha, beta) {
      if (x < 0)
        return 0;
      else if (x > 1)
        return 1;
      return (1 - Math.pow(1 - Math.pow(x, alpha), beta));
    },

    inv: function inv(p, alpha, beta) {
      return Math.pow(1 - Math.pow(1 - p, 1 / beta), 1 / alpha);
    },

    mean : function(alpha, beta) {
      return (beta * jStat.gammafn(1 + 1 / alpha) *
              jStat.gammafn(beta)) / (jStat.gammafn(1 + 1 / alpha + beta));
    },

    median: function median(alpha, beta) {
      return Math.pow(1 - Math.pow(2, -1 / beta), 1 / alpha);
    },

    mode: function mode(alpha, beta) {
      if (!(alpha >= 1 && beta >= 1 && (alpha !== 1 && beta !== 1)))
        return undefined;
      return Math.pow((alpha - 1) / (alpha * beta - 1), 1 / alpha);
    },

    variance: function variance(/*alpha, beta*/) {
      throw new Error('variance not yet implemented');
      // TODO: complete this
    }
  });



  // extend lognormal function with static methods
  jStat.extend(jStat.lognormal, {
    pdf: function pdf(x, mu, sigma) {
      if (x <= 0)
        return 0;
      return Math.exp(-Math.log(x) - 0.5 * Math.log(2 * Math.PI) -
                      Math.log(sigma) - Math.pow(Math.log(x) - mu, 2) /
                      (2 * sigma * sigma));
    },

    cdf: function cdf(x, mu, sigma) {
      if (x < 0)
        return 0;
      return 0.5 +
          (0.5 * jStat.erf((Math.log(x) - mu) / Math.sqrt(2 * sigma * sigma)));
    },

    inv: function(p, mu, sigma) {
      return Math.exp(-1.41421356237309505 * sigma * jStat.erfcinv(2 * p) + mu);
    },

    mean: function mean(mu, sigma) {
      return Math.exp(mu + sigma * sigma / 2);
    },

    median: function median(mu/*, sigma*/) {
      return Math.exp(mu);
    },

    mode: function mode(mu, sigma) {
      return Math.exp(mu - sigma * sigma);
    },

    sample: function sample(mu, sigma) {
      return Math.exp(jStat.randn() * sigma + mu);
    },

    variance: function variance(mu, sigma) {
      return (Math.exp(sigma * sigma) - 1) * Math.exp(2 * mu + sigma * sigma);
    }
  });



  // extend noncentralt function with static methods
  jStat.extend(jStat.noncentralt, {
    pdf: function pdf(x, dof, ncp) {
      var tol = 1e-14;
      if (Math.abs(ncp) < tol)  // ncp approx 0; use student-t
        return jStat.studentt.pdf(x, dof)

      if (Math.abs(x) < tol) {  // different formula for x == 0
        return Math.exp(jStat.gammaln((dof + 1) / 2) - ncp * ncp / 2 -
                        0.5 * Math.log(Math.PI * dof) - jStat.gammaln(dof / 2));
      }

      // formula for x != 0
      return dof / x *
          (jStat.noncentralt.cdf(x * Math.sqrt(1 + 2 / dof), dof+2, ncp) -
           jStat.noncentralt.cdf(x, dof, ncp));
    },

    cdf: function cdf(x, dof, ncp) {
      var tol = 1e-14;
      var min_iterations = 200;

      if (Math.abs(ncp) < tol)  // ncp approx 0; use student-t
        return jStat.studentt.cdf(x, dof);

      // turn negative x into positive and flip result afterwards
      var flip = false;
      if (x < 0) {
        flip = true;
        ncp = -ncp;
      }

      var prob = jStat.normal.cdf(-ncp, 0, 1);
      var value = tol + 1;
      // use value at last two steps to determine convergence
      var lastvalue = value;
      var y = x * x / (x * x + dof);
      var j = 0;
      var p = Math.exp(-ncp * ncp / 2);
      var q = Math.exp(-ncp * ncp / 2 - 0.5 * Math.log(2) -
                       jStat.gammaln(3 / 2)) * ncp;
      while (j < min_iterations || lastvalue > tol || value > tol) {
        lastvalue = value;
        if (j > 0) {
          p *= (ncp * ncp) / (2 * j);
          q *= (ncp * ncp) / (2 * (j + 1 / 2));
        }
        value = p * jStat.beta.cdf(y, j + 0.5, dof / 2) +
            q * jStat.beta.cdf(y, j+1, dof/2);
        prob += 0.5 * value;
        j++;
      }

      return flip ? (1 - prob) : prob;
    }
  });


  // extend normal function with static methods
  jStat.extend(jStat.normal, {
    pdf: function pdf(x, mean, std) {
      return Math.exp(-0.5 * Math.log(2 * Math.PI) -
                      Math.log(std) - Math.pow(x - mean, 2) / (2 * std * std));
    },

    cdf: function cdf(x, mean, std) {
      return 0.5 * (1 + jStat.erf((x - mean) / Math.sqrt(2 * std * std)));
    },

    inv: function(p, mean, std) {
      return -1.41421356237309505 * std * jStat.erfcinv(2 * p) + mean;
    },

    mean : function(mean/*, std*/) {
      return mean;
    },

    median: function median(mean/*, std*/) {
      return mean;
    },

    mode: function (mean/*, std*/) {
      return mean;
    },

    sample: function sample(mean, std) {
      return jStat.randn() * std + mean;
    },

    variance : function(mean, std) {
      return std * std;
    }
  });



  // extend pareto function with static methods
  jStat.extend(jStat.pareto, {
    pdf: function pdf(x, scale, shape) {
      if (x < scale)
        return 0;
      return (shape * Math.pow(scale, shape)) / Math.pow(x, shape + 1);
    },

    cdf: function cdf(x, scale, shape) {
      if (x < scale)
        return 0;
      return 1 - Math.pow(scale / x, shape);
    },

    inv: function inv(p, scale, shape) {
      return scale / Math.pow(1 - p, 1 / shape);
    },

    mean: function mean(scale, shape) {
      if (shape <= 1)
        return undefined;
      return (shape * Math.pow(scale, shape)) / (shape - 1);
    },

    median: function median(scale, shape) {
      return scale * (shape * Math.SQRT2);
    },

    mode: function mode(scale/*, shape*/) {
      return scale;
    },

    variance : function(scale, shape) {
      if (shape <= 2)
        return undefined;
      return (scale*scale * shape) / (Math.pow(shape - 1, 2) * (shape - 2));
    }
  });



  // extend studentt function with static methods
  jStat.extend(jStat.studentt, {
    pdf: function pdf(x, dof) {
      dof = dof > 1e100 ? 1e100 : dof;
      return (1/(Math.sqrt(dof) * jStat.betafn(0.5, dof/2))) *
          Math.pow(1 + ((x * x) / dof), -((dof + 1) / 2));
    },

    cdf: function cdf(x, dof) {
      var dof2 = dof / 2;
      return jStat.ibeta((x + Math.sqrt(x * x + dof)) /
                         (2 * Math.sqrt(x * x + dof)), dof2, dof2);
    },

    inv: function(p, dof) {
      var x = jStat.ibetainv(2 * Math.min(p, 1 - p), 0.5 * dof, 0.5);
      x = Math.sqrt(dof * (1 - x) / x);
      return (p > 0.5) ? x : -x;
    },

    mean: function mean(dof) {
      return (dof > 1) ? 0 : undefined;
    },

    median: function median(/*dof*/) {
      return 0;
    },

    mode: function mode(/*dof*/) {
      return 0;
    },

    sample: function sample(dof) {
      return jStat.randn() * Math.sqrt(dof / (2 * jStat.randg(dof / 2)));
    },

    variance: function variance(dof) {
      return (dof  > 2) ? dof / (dof - 2) : (dof > 1) ? Infinity : undefined;
    }
  });



  // extend weibull function with static methods
  jStat.extend(jStat.weibull, {
    pdf: function pdf(x, scale, shape) {
      if (x < 0 || scale < 0 || shape < 0)
        return 0;
      return (shape / scale) * Math.pow((x / scale), (shape - 1)) *
          Math.exp(-(Math.pow((x / scale), shape)));
    },

    cdf: function cdf(x, scale, shape) {
      return x < 0 ? 0 : 1 - Math.exp(-Math.pow((x / scale), shape));
    },

    inv: function(p, scale, shape) {
      return scale * Math.pow(-Math.log(1 - p), 1 / shape);
    },

    mean : function(scale, shape) {
      return scale * jStat.gammafn(1 + 1 / shape);
    },

    median: function median(scale, shape) {
      return scale * Math.pow(Math.log(2), 1 / shape);
    },

    mode: function mode(scale, shape) {
      if (shape <= 1)
        return 0;
      return scale * Math.pow((shape - 1) / shape, 1 / shape);
    },

    sample: function sample(scale, shape) {
      return scale * Math.pow(-Math.log(jStat._random_fn()), 1 / shape);
    },

    variance: function variance(scale, shape) {
      return scale * scale * jStat.gammafn(1 + 2 / shape) -
          Math.pow(jStat.weibull.mean(scale, shape), 2);
    }
  });



  // extend uniform function with static methods
  jStat.extend(jStat.uniform, {
    pdf: function pdf(x, a, b) {
      return (x < a || x > b) ? 0 : 1 / (b - a);
    },

    cdf: function cdf(x, a, b) {
      if (x < a)
        return 0;
      else if (x < b)
        return (x - a) / (b - a);
      return 1;
    },

    inv: function(p, a, b) {
      return a + (p * (b - a));
    },

    mean: function mean(a, b) {
      return 0.5 * (a + b);
    },

    median: function median(a, b) {
      return jStat.mean(a, b);
    },

    mode: function mode(/*a, b*/) {
      throw new Error('mode is not yet implemented');
    },

    sample: function sample(a, b) {
      return (a / 2 + b / 2) + (b / 2 - a / 2) * (2 * jStat._random_fn() - 1);
    },

    variance: function variance(a, b) {
      return Math.pow(b - a, 2) / 12;
    }
  });


  // Got this from http://www.math.ucla.edu/~tom/distributions/binomial.html
  function betinc(x, a, b, eps) {
    var a0 = 0;
    var b0 = 1;
    var a1 = 1;
    var b1 = 1;
    var m9 = 0;
    var a2 = 0;
    var c9;

    while (Math.abs((a1 - a2) / a1) > eps) {
      a2 = a1;
      c9 = -(a + m9) * (a + b + m9) * x / (a + 2 * m9) / (a + 2 * m9 + 1);
      a0 = a1 + c9 * a0;
      b0 = b1 + c9 * b0;
      m9 = m9 + 1;
      c9 = m9 * (b - m9) * x / (a + 2 * m9 - 1) / (a + 2 * m9);
      a1 = a0 + c9 * a1;
      b1 = b0 + c9 * b1;
      a0 = a0 / b1;
      b0 = b0 / b1;
      a1 = a1 / b1;
      b1 = 1;
    }

    return a1 / a;
  }


  // extend uniform function with static methods
  jStat.extend(jStat.binomial, {
    pdf: function pdf(k, n, p) {
      return (p === 0 || p === 1) ?
        ((n * p) === k ? 1 : 0) :
        jStat.combination(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);
    },

    cdf: function cdf(x, n, p) {
      var betacdf;
      var eps = 1e-10;

      if (x < 0)
        return 0;
      if (x >= n)
        return 1;
      if (p < 0 || p > 1 || n <= 0)
        return NaN;

      x = Math.floor(x);
      var z = p;
      var a = x + 1;
      var b = n - x;
      var s = a + b;
      var bt = Math.exp(jStat.gammaln(s) - jStat.gammaln(b) -
                        jStat.gammaln(a) + a * Math.log(z) + b * Math.log(1 - z));

      if (z < (a + 1) / (s + 2))
        betacdf = bt * betinc(z, a, b, eps);
      else
        betacdf = 1 - bt * betinc(1 - z, b, a, eps);

      return Math.round((1 - betacdf) * (1 / eps)) / (1 / eps);
    }
  });



  // extend uniform function with static methods
  jStat.extend(jStat.negbin, {
    pdf: function pdf(k, r, p) {
      if (k !== k >>> 0)
        return false;
      if (k < 0)
        return 0;
      return jStat.combination(k + r - 1, r - 1) *
          Math.pow(1 - p, k) * Math.pow(p, r);
    },

    cdf: function cdf(x, r, p) {
      var sum = 0,
      k = 0;
      if (x < 0) return 0;
      for (; k <= x; k++) {
        sum += jStat.negbin.pdf(k, r, p);
      }
      return sum;
    }
  });



  // extend uniform function with static methods
  jStat.extend(jStat.hypgeom, {
    pdf: function pdf(k, N, m, n) {
      // Hypergeometric PDF.

      // A simplification of the CDF algorithm below.

      // k = number of successes drawn
      // N = population size
      // m = number of successes in population
      // n = number of items drawn from population

      if(k !== k | 0) {
        return false;
      } else if(k < 0 || k < m - (N - n)) {
        // It's impossible to have this few successes drawn.
        return 0;
      } else if(k > n || k > m) {
        // It's impossible to have this many successes drawn.
        return 0;
      } else if (m * 2 > N) {
        // More than half the population is successes.

        if(n * 2 > N) {
          // More than half the population is sampled.

          return jStat.hypgeom.pdf(N - m - n + k, N, N - m, N - n)
        } else {
          // Half or less of the population is sampled.

          return jStat.hypgeom.pdf(n - k, N, N - m, n);
        }

      } else if(n * 2 > N) {
        // Half or less is successes.

        return jStat.hypgeom.pdf(m - k, N, m, N - n);

      } else if(m < n) {
        // We want to have the number of things sampled to be less than the
        // successes available. So swap the definitions of successful and sampled.
        return jStat.hypgeom.pdf(k, N, n, m);
      } else {
        // If we get here, half or less of the population was sampled, half or
        // less of it was successes, and we had fewer sampled things than
        // successes. Now we can do this complicated iterative algorithm in an
        // efficient way.

        // The basic premise of the algorithm is that we partially normalize our
        // intermediate product to keep it in a numerically good region, and then
        // finish the normalization at the end.

        // This variable holds the scaled probability of the current number of
        // successes.
        var scaledPDF = 1;

        // This keeps track of how much we have normalized.
        var samplesDone = 0;

        for(var i = 0; i < k; i++) {
          // For every possible number of successes up to that observed...

          while(scaledPDF > 1 && samplesDone < n) {
            // Intermediate result is growing too big. Apply some of the
            // normalization to shrink everything.

            scaledPDF *= 1 - (m / (N - samplesDone));

            // Say we've normalized by this sample already.
            samplesDone++;
          }

          // Work out the partially-normalized hypergeometric PDF for the next
          // number of successes
          scaledPDF *= (n - i) * (m - i) / ((i + 1) * (N - m - n + i + 1));
        }

        for(; samplesDone < n; samplesDone++) {
          // Apply all the rest of the normalization
          scaledPDF *= 1 - (m / (N - samplesDone));
        }

        // Bound answer sanely before returning.
        return Math.min(1, Math.max(0, scaledPDF));
      }
    },

    cdf: function cdf(x, N, m, n) {
      // Hypergeometric CDF.

      // This algorithm is due to Prof. Thomas S. Ferguson, <tom@math.ucla.edu>,
      // and comes from his hypergeometric test calculator at
      // <http://www.math.ucla.edu/~tom/distributions/Hypergeometric.html>.

      // x = number of successes drawn
      // N = population size
      // m = number of successes in population
      // n = number of items drawn from population

      if(x < 0 || x < m - (N - n)) {
        // It's impossible to have this few successes drawn or fewer.
        return 0;
      } else if(x >= n || x >= m) {
        // We will always have this many successes or fewer.
        return 1;
      } else if (m * 2 > N) {
        // More than half the population is successes.

        if(n * 2 > N) {
          // More than half the population is sampled.

          return jStat.hypgeom.cdf(N - m - n + x, N, N - m, N - n)
        } else {
          // Half or less of the population is sampled.

          return 1 - jStat.hypgeom.cdf(n - x - 1, N, N - m, n);
        }

      } else if(n * 2 > N) {
        // Half or less is successes.

        return 1 - jStat.hypgeom.cdf(m - x - 1, N, m, N - n);

      } else if(m < n) {
        // We want to have the number of things sampled to be less than the
        // successes available. So swap the definitions of successful and sampled.
        return jStat.hypgeom.cdf(x, N, n, m);
      } else {
        // If we get here, half or less of the population was sampled, half or
        // less of it was successes, and we had fewer sampled things than
        // successes. Now we can do this complicated iterative algorithm in an
        // efficient way.

        // The basic premise of the algorithm is that we partially normalize our
        // intermediate sum to keep it in a numerically good region, and then
        // finish the normalization at the end.

        // Holds the intermediate, scaled total CDF.
        var scaledCDF = 1;

        // This variable holds the scaled probability of the current number of
        // successes.
        var scaledPDF = 1;

        // This keeps track of how much we have normalized.
        var samplesDone = 0;

        for(var i = 0; i < x; i++) {
          // For every possible number of successes up to that observed...

          while(scaledCDF > 1 && samplesDone < n) {
            // Intermediate result is growing too big. Apply some of the
            // normalization to shrink everything.

            var factor = 1 - (m / (N - samplesDone));

            scaledPDF *= factor;
            scaledCDF *= factor;

            // Say we've normalized by this sample already.
            samplesDone++;
          }

          // Work out the partially-normalized hypergeometric PDF for the next
          // number of successes
          scaledPDF *= (n - i) * (m - i) / ((i + 1) * (N - m - n + i + 1));

          // Add to the CDF answer.
          scaledCDF += scaledPDF;
        }

        for(; samplesDone < n; samplesDone++) {
          // Apply all the rest of the normalization
          scaledCDF *= 1 - (m / (N - samplesDone));
        }

        // Bound answer sanely before returning.
        return Math.min(1, Math.max(0, scaledCDF));
      }
    }
  });



  // extend uniform function with static methods
  jStat.extend(jStat.poisson, {
    pdf: function pdf(k, l) {
      if (l < 0 || (k % 1) !== 0 || k < 0) {
        return 0;
      }

      return Math.pow(l, k) * Math.exp(-l) / jStat.factorial(k);
    },

    cdf: function cdf(x, l) {
      var sumarr = [],
      k = 0;
      if (x < 0) return 0;
      for (; k <= x; k++) {
        sumarr.push(jStat.poisson.pdf(k, l));
      }
      return jStat.sum(sumarr);
    },

    mean : function(l) {
      return l;
    },

    variance : function(l) {
      return l;
    },

    sampleSmall: function sampleSmall(l) {
      var p = 1, k = 0, L = Math.exp(-l);
      do {
        k++;
        p *= jStat._random_fn();
      } while (p > L);
      return k - 1;
    },

    sampleLarge: function sampleLarge(l) {
      var lam = l;
      var k;
      var U, V, slam, loglam, a, b, invalpha, vr, us;

      slam = Math.sqrt(lam);
      loglam = Math.log(lam);
      b = 0.931 + 2.53 * slam;
      a = -0.059 + 0.02483 * b;
      invalpha = 1.1239 + 1.1328 / (b - 3.4);
      vr = 0.9277 - 3.6224 / (b - 2);

      while (1) {
        U = Math.random() - 0.5;
        V = Math.random();
        us = 0.5 - Math.abs(U);
        k = Math.floor((2 * a / us + b) * U + lam + 0.43);
        if ((us >= 0.07) && (V <= vr)) {
            return k;
        }
        if ((k < 0) || ((us < 0.013) && (V > us))) {
            continue;
        }
        /* log(V) == log(0.0) ok here */
        /* if U==0.0 so that us==0.0, log is ok since always returns */
        if ((Math.log(V) + Math.log(invalpha) - Math.log(a / (us * us) + b)) <= (-lam + k * loglam - jStat.loggam(k + 1))) {
            return k;
        }
      }
    },

    sample: function sample(l) {
      if (l < 10)
        return this.sampleSmall(l);
      else
        return this.sampleLarge(l);
    }
  });

  // extend triangular function with static methods
  jStat.extend(jStat.triangular, {
    pdf: function pdf(x, a, b, c) {
      if (b <= a || c < a || c > b) {
        return NaN;
      } else {
        if (x < a || x > b) {
          return 0;
        } else if (x < c) {
            return (2 * (x - a)) / ((b - a) * (c - a));
        } else if (x === c) {
            return (2 / (b - a));
        } else { // x > c
            return (2 * (b - x)) / ((b - a) * (b - c));
        }
      }
    },

    cdf: function cdf(x, a, b, c) {
      if (b <= a || c < a || c > b)
        return NaN;
      if (x <= a)
        return 0;
      else if (x >= b)
        return 1;
      if (x <= c)
        return Math.pow(x - a, 2) / ((b - a) * (c - a));
      else // x > c
        return 1 - Math.pow(b - x, 2) / ((b - a) * (b - c));
    },

    inv: function inv(p, a, b, c) {
      if (b <= a || c < a || c > b) {
        return NaN;
      } else {
        if (p <= ((c - a) / (b - a))) {
          return a + (b - a) * Math.sqrt(p * ((c - a) / (b - a)));
        } else { // p > ((c - a) / (b - a))
          return a + (b - a) * (1 - Math.sqrt((1 - p) * (1 - ((c - a) / (b - a)))));
        }
      }
    },

    mean: function mean(a, b, c) {
      return (a + b + c) / 3;
    },

    median: function median(a, b, c) {
      if (c <= (a + b) / 2) {
        return b - Math.sqrt((b - a) * (b - c)) / Math.sqrt(2);
      } else if (c > (a + b) / 2) {
        return a + Math.sqrt((b - a) * (c - a)) / Math.sqrt(2);
      }
    },

    mode: function mode(a, b, c) {
      return c;
    },

    sample: function sample(a, b, c) {
      var u = jStat._random_fn();
      if (u < ((c - a) / (b - a)))
        return a + Math.sqrt(u * (b - a) * (c - a))
      return b - Math.sqrt((1 - u) * (b - a) * (b - c));
    },

    variance: function variance(a, b, c) {
      return (a * a + b * b + c * c - a * b - a * c - b * c) / 18;
    }
  });


  // extend arcsine function with static methods
  jStat.extend(jStat.arcsine, {
    pdf: function pdf(x, a, b) {
      if (b <= a) return NaN;

      return (x <= a || x >= b) ? 0 :
        (2 / Math.PI) *
          Math.pow(Math.pow(b - a, 2) -
                    Math.pow(2 * x - a - b, 2), -0.5);
    },

    cdf: function cdf(x, a, b) {
      if (x < a)
        return 0;
      else if (x < b)
        return (2 / Math.PI) * Math.asin(Math.sqrt((x - a)/(b - a)));
      return 1;
    },

    inv: function(p, a, b) {
      return a + (0.5 - 0.5 * Math.cos(Math.PI * p)) * (b - a);
    },

    mean: function mean(a, b) {
      if (b <= a) return NaN;
      return (a + b) / 2;
    },

    median: function median(a, b) {
      if (b <= a) return NaN;
      return (a + b) / 2;
    },

    mode: function mode(/*a, b*/) {
      throw new Error('mode is not yet implemented');
    },

    sample: function sample(a, b) {
      return ((a + b) / 2) + ((b - a) / 2) *
        Math.sin(2 * Math.PI * jStat.uniform.sample(0, 1));
    },

    variance: function variance(a, b) {
      if (b <= a) return NaN;
      return Math.pow(b - a, 2) / 8;
    }
  });


  function laplaceSign(x) { return x / Math.abs(x); }

  jStat.extend(jStat.laplace, {
    pdf: function pdf(x, mu, b) {
      return (b <= 0) ? 0 : (Math.exp(-Math.abs(x - mu) / b)) / (2 * b);
    },

    cdf: function cdf(x, mu, b) {
      if (b <= 0) { return 0; }

      if(x < mu) {
        return 0.5 * Math.exp((x - mu) / b);
      } else {
        return 1 - 0.5 * Math.exp(- (x - mu) / b);
      }
    },

    mean: function(mu/*, b*/) {
      return mu;
    },

    median: function(mu/*, b*/) {
      return mu;
    },

    mode: function(mu/*, b*/) {
      return mu;
    },

    variance: function(mu, b) {
      return 2 * b * b;
    },

    sample: function sample(mu, b) {
      var u = jStat._random_fn() - 0.5;

      return mu - (b * laplaceSign(u) * Math.log(1 - (2 * Math.abs(u))));
    }
  });

  function tukeyWprob(w, rr, cc) {
    var nleg = 12;
    var ihalf = 6;

    var C1 = -30;
    var C2 = -50;
    var C3 = 60;
    var bb   = 8;
    var wlar = 3;
    var wincr1 = 2;
    var wincr2 = 3;
    var xleg = [
      0.981560634246719250690549090149,
      0.904117256370474856678465866119,
      0.769902674194304687036893833213,
      0.587317954286617447296702418941,
      0.367831498998180193752691536644,
      0.125233408511468915472441369464
    ];
    var aleg = [
      0.047175336386511827194615961485,
      0.106939325995318430960254718194,
      0.160078328543346226334652529543,
      0.203167426723065921749064455810,
      0.233492536538354808760849898925,
      0.249147045813402785000562436043
    ];

    var qsqz = w * 0.5;

    // if w >= 16 then the integral lower bound (occurs for c=20)
    // is 0.99999999999995 so return a value of 1.

    if (qsqz >= bb)
      return 1.0;

    // find (f(w/2) - 1) ^ cc
    // (first term in integral of hartley's form).

    var pr_w = 2 * jStat.normal.cdf(qsqz, 0, 1, 1, 0) - 1; // erf(qsqz / M_SQRT2)
    // if pr_w ^ cc < 2e-22 then set pr_w = 0
    if (pr_w >= Math.exp(C2 / cc))
      pr_w = Math.pow(pr_w, cc);
    else
      pr_w = 0.0;

    // if w is large then the second component of the
    // integral is small, so fewer intervals are needed.

    var wincr;
    if (w > wlar)
      wincr = wincr1;
    else
      wincr = wincr2;

    // find the integral of second term of hartley's form
    // for the integral of the range for equal-length
    // intervals using legendre quadrature.  limits of
    // integration are from (w/2, 8).  two or three
    // equal-length intervals are used.

    // blb and bub are lower and upper limits of integration.

    var blb = qsqz;
    var binc = (bb - qsqz) / wincr;
    var bub = blb + binc;
    var einsum = 0.0;

    // integrate over each interval

    var cc1 = cc - 1.0;
    for (var wi = 1; wi <= wincr; wi++) {
      var elsum = 0.0;
      var a = 0.5 * (bub + blb);

      // legendre quadrature with order = nleg

      var b = 0.5 * (bub - blb);

      for (var jj = 1; jj <= nleg; jj++) {
        var j, xx;
        if (ihalf < jj) {
          j = (nleg - jj) + 1;
          xx = xleg[j-1];
        } else {
          j = jj;
          xx = -xleg[j-1];
        }
        var c = b * xx;
        var ac = a + c;

        // if exp(-qexpo/2) < 9e-14,
        // then doesn't contribute to integral

        var qexpo = ac * ac;
        if (qexpo > C3)
          break;

        var pplus = 2 * jStat.normal.cdf(ac, 0, 1, 1, 0);
        var pminus= 2 * jStat.normal.cdf(ac, w, 1, 1, 0);

        // if rinsum ^ (cc-1) < 9e-14,
        // then doesn't contribute to integral

        var rinsum = (pplus * 0.5) - (pminus * 0.5);
        if (rinsum >= Math.exp(C1 / cc1)) {
          rinsum = (aleg[j-1] * Math.exp(-(0.5 * qexpo))) * Math.pow(rinsum, cc1);
          elsum += rinsum;
        }
      }
      elsum *= (((2.0 * b) * cc) / Math.sqrt(2 * Math.PI));
      einsum += elsum;
      blb = bub;
      bub += binc;
    }

    // if pr_w ^ rr < 9e-14, then return 0
    pr_w += einsum;
    if (pr_w <= Math.exp(C1 / rr))
      return 0;

    pr_w = Math.pow(pr_w, rr);
    if (pr_w >= 1) // 1 was iMax was eps
      return 1;
    return pr_w;
  }

  function tukeyQinv(p, c, v) {
    var p0 = 0.322232421088;
    var q0 = 0.993484626060e-01;
    var p1 = -1.0;
    var q1 = 0.588581570495;
    var p2 = -0.342242088547;
    var q2 = 0.531103462366;
    var p3 = -0.204231210125;
    var q3 = 0.103537752850;
    var p4 = -0.453642210148e-04;
    var q4 = 0.38560700634e-02;
    var c1 = 0.8832;
    var c2 = 0.2368;
    var c3 = 1.214;
    var c4 = 1.208;
    var c5 = 1.4142;
    var vmax = 120.0;

    var ps = 0.5 - 0.5 * p;
    var yi = Math.sqrt(Math.log(1.0 / (ps * ps)));
    var t = yi + (((( yi * p4 + p3) * yi + p2) * yi + p1) * yi + p0)
       / (((( yi * q4 + q3) * yi + q2) * yi + q1) * yi + q0);
    if (v < vmax) t += (t * t * t + t) / v / 4.0;
    var q = c1 - c2 * t;
    if (v < vmax) q += -c3 / v + c4 * t / v;
    return t * (q * Math.log(c - 1.0) + c5);
  }

  jStat.extend(jStat.tukey, {
    cdf: function cdf(q, nmeans, df) {
      // Identical implementation as the R ptukey() function as of commit 68947
      var rr = 1;
      var cc = nmeans;

      var nlegq = 16;
      var ihalfq = 8;

      var eps1 = -30.0;
      var eps2 = 1.0e-14;
      var dhaf  = 100.0;
      var dquar = 800.0;
      var deigh = 5000.0;
      var dlarg = 25000.0;
      var ulen1 = 1.0;
      var ulen2 = 0.5;
      var ulen3 = 0.25;
      var ulen4 = 0.125;
      var xlegq = [
        0.989400934991649932596154173450,
        0.944575023073232576077988415535,
        0.865631202387831743880467897712,
        0.755404408355003033895101194847,
        0.617876244402643748446671764049,
        0.458016777657227386342419442984,
        0.281603550779258913230460501460,
        0.950125098376374401853193354250e-1
      ];
      var alegq = [
        0.271524594117540948517805724560e-1,
        0.622535239386478928628438369944e-1,
        0.951585116824927848099251076022e-1,
        0.124628971255533872052476282192,
        0.149595988816576732081501730547,
        0.169156519395002538189312079030,
        0.182603415044923588866763667969,
        0.189450610455068496285396723208
      ];

      if (q <= 0)
        return 0;

      // df must be > 1
      // there must be at least two values

      if (df < 2 || rr < 1 || cc < 2) return NaN;

      if (!Number.isFinite(q))
        return 1;

      if (df > dlarg)
        return tukeyWprob(q, rr, cc);

      // calculate leading constant

      var f2 = df * 0.5;
      var f2lf = ((f2 * Math.log(df)) - (df * Math.log(2))) - jStat.gammaln(f2);
      var f21 = f2 - 1.0;

      // integral is divided into unit, half-unit, quarter-unit, or
      // eighth-unit length intervals depending on the value of the
      // degrees of freedom.

      var ff4 = df * 0.25;
      var ulen;
      if      (df <= dhaf)  ulen = ulen1;
      else if (df <= dquar) ulen = ulen2;
      else if (df <= deigh) ulen = ulen3;
      else                  ulen = ulen4;

      f2lf += Math.log(ulen);

      // integrate over each subinterval

      var ans = 0.0;

      for (var i = 1; i <= 50; i++) {
        var otsum = 0.0;

        // legendre quadrature with order = nlegq
        // nodes (stored in xlegq) are symmetric around zero.

        var twa1 = (2 * i - 1) * ulen;

        for (var jj = 1; jj <= nlegq; jj++) {
          var j, t1;
          if (ihalfq < jj) {
            j = jj - ihalfq - 1;
            t1 = (f2lf + (f21 * Math.log(twa1 + (xlegq[j] * ulen))))
                - (((xlegq[j] * ulen) + twa1) * ff4);
          } else {
            j = jj - 1;
            t1 = (f2lf + (f21 * Math.log(twa1 - (xlegq[j] * ulen))))
                + (((xlegq[j] * ulen) - twa1) * ff4);
          }

          // if exp(t1) < 9e-14, then doesn't contribute to integral
          var qsqz;
          if (t1 >= eps1) {
            if (ihalfq < jj) {
              qsqz = q * Math.sqrt(((xlegq[j] * ulen) + twa1) * 0.5);
            } else {
              qsqz = q * Math.sqrt(((-(xlegq[j] * ulen)) + twa1) * 0.5);
            }

            // call wprob to find integral of range portion

            var wprb = tukeyWprob(qsqz, rr, cc);
            var rotsum = (wprb * alegq[j]) * Math.exp(t1);
            otsum += rotsum;
          }
          // end legendre integral for interval i
          // L200:
        }

        // if integral for interval i < 1e-14, then stop.
        // However, in order to avoid small area under left tail,
        // at least  1 / ulen  intervals are calculated.
        if (i * ulen >= 1.0 && otsum <= eps2)
          break;

        // end of interval i
        // L330:

        ans += otsum;
      }

      if (otsum > eps2) { // not converged
        throw new Error('tukey.cdf failed to converge');
      }
      if (ans > 1)
        ans = 1;
      return ans;
    },

    inv: function(p, nmeans, df) {
      // Identical implementation as the R qtukey() function as of commit 68947
      var rr = 1;
      var cc = nmeans;

      var eps = 0.0001;
      var maxiter = 50;

      // df must be > 1 ; there must be at least two values
      if (df < 2 || rr < 1 || cc < 2) return NaN;

      if (p < 0 || p > 1) return NaN;
      if (p === 0) return 0;
      if (p === 1) return Infinity;

      // Initial value

      var x0 = tukeyQinv(p, cc, df);

      // Find prob(value < x0)

      var valx0 = jStat.tukey.cdf(x0, nmeans, df) - p;

      // Find the second iterate and prob(value < x1).
      // If the first iterate has probability value
      // exceeding p then second iterate is 1 less than
      // first iterate; otherwise it is 1 greater.

      var x1;
      if (valx0 > 0.0)
        x1 = Math.max(0.0, x0 - 1.0);
      else
        x1 = x0 + 1.0;
      var valx1 = jStat.tukey.cdf(x1, nmeans, df) - p;

      // Find new iterate

      var ans;
      for(var iter = 1; iter < maxiter; iter++) {
        ans = x1 - ((valx1 * (x1 - x0)) / (valx1 - valx0));
        valx0 = valx1;

        // New iterate must be >= 0

        x0 = x1;
        if (ans < 0.0) {
          ans = 0.0;
          valx1 = -p;
        }
        // Find prob(value < new iterate)

        valx1 = jStat.tukey.cdf(ans, nmeans, df) - p;
        x1 = ans;

        // If the difference between two successive
        // iterates is less than eps, stop

        var xabs = Math.abs(x1 - x0);
        if (xabs < eps)
          return ans;
      }

      throw new Error('tukey.inv failed to converge');
    }
  });

  }(jStat, Math));
  /* Provides functions for the solution of linear system of equations, integration, extrapolation,
   * interpolation, eigenvalue problems, differential equations and PCA analysis. */

  (function(jStat, Math) {

  var push = Array.prototype.push;
  var isArray = jStat.utils.isArray;

  function isUsable(arg) {
    return isArray(arg) || arg instanceof jStat;
  }

  jStat.extend({

    // add a vector/matrix to a vector/matrix or scalar
    add: function add(arr, arg) {
      // check if arg is a vector or scalar
      if (isUsable(arg)) {
        if (!isUsable(arg[0])) arg = [ arg ];
        return jStat.map(arr, function(value, row, col) {
          return value + arg[row][col];
        });
      }
      return jStat.map(arr, function(value) { return value + arg; });
    },

    // subtract a vector or scalar from the vector
    subtract: function subtract(arr, arg) {
      // check if arg is a vector or scalar
      if (isUsable(arg)) {
        if (!isUsable(arg[0])) arg = [ arg ];
        return jStat.map(arr, function(value, row, col) {
          return value - arg[row][col] || 0;
        });
      }
      return jStat.map(arr, function(value) { return value - arg; });
    },

    // matrix division
    divide: function divide(arr, arg) {
      if (isUsable(arg)) {
        if (!isUsable(arg[0])) arg = [ arg ];
        return jStat.multiply(arr, jStat.inv(arg));
      }
      return jStat.map(arr, function(value) { return value / arg; });
    },

    // matrix multiplication
    multiply: function multiply(arr, arg) {
      var row, col, nrescols, sum, nrow, ncol, res, rescols;
      // eg: arr = 2 arg = 3 -> 6 for res[0][0] statement closure
      if (arr.length === undefined && arg.length === undefined) {
        return arr * arg;
      }
      nrow = arr.length,
      ncol = arr[0].length,
      res = jStat.zeros(nrow, nrescols = (isUsable(arg)) ? arg[0].length : ncol),
      rescols = 0;
      if (isUsable(arg)) {
        for (; rescols < nrescols; rescols++) {
          for (row = 0; row < nrow; row++) {
            sum = 0;
            for (col = 0; col < ncol; col++)
            sum += arr[row][col] * arg[col][rescols];
            res[row][rescols] = sum;
          }
        }
        return (nrow === 1 && rescols === 1) ? res[0][0] : res;
      }
      return jStat.map(arr, function(value) { return value * arg; });
    },

    // outer([1,2,3],[4,5,6])
    // ===
    // [[1],[2],[3]] times [[4,5,6]]
    // ->
    // [[4,5,6],[8,10,12],[12,15,18]]
    outer:function outer(A, B) {
      return jStat.multiply(A.map(function(t){ return [t] }), [B]);
    },


    // Returns the dot product of two matricies
    dot: function dot(arr, arg) {
      if (!isUsable(arr[0])) arr = [ arr ];
      if (!isUsable(arg[0])) arg = [ arg ];
      // convert column to row vector
      var left = (arr[0].length === 1 && arr.length !== 1) ? jStat.transpose(arr) : arr,
      right = (arg[0].length === 1 && arg.length !== 1) ? jStat.transpose(arg) : arg,
      res = [],
      row = 0,
      nrow = left.length,
      ncol = left[0].length,
      sum, col;
      for (; row < nrow; row++) {
        res[row] = [];
        sum = 0;
        for (col = 0; col < ncol; col++)
        sum += left[row][col] * right[row][col];
        res[row] = sum;
      }
      return (res.length === 1) ? res[0] : res;
    },

    // raise every element by a scalar
    pow: function pow(arr, arg) {
      return jStat.map(arr, function(value) { return Math.pow(value, arg); });
    },

    // exponentiate every element
    exp: function exp(arr) {
      return jStat.map(arr, function(value) { return Math.exp(value); });
    },

    // generate the natural log of every element
    log: function exp(arr) {
      return jStat.map(arr, function(value) { return Math.log(value); });
    },

    // generate the absolute values of the vector
    abs: function abs(arr) {
      return jStat.map(arr, function(value) { return Math.abs(value); });
    },

    // computes the p-norm of the vector
    // In the case that a matrix is passed, uses the first row as the vector
    norm: function norm(arr, p) {
      var nnorm = 0,
      i = 0;
      // check the p-value of the norm, and set for most common case
      if (isNaN(p)) p = 2;
      // check if multi-dimensional array, and make vector correction
      if (isUsable(arr[0])) arr = arr[0];
      // vector norm
      for (; i < arr.length; i++) {
        nnorm += Math.pow(Math.abs(arr[i]), p);
      }
      return Math.pow(nnorm, 1 / p);
    },

    // computes the angle between two vectors in rads
    // In case a matrix is passed, this uses the first row as the vector
    angle: function angle(arr, arg) {
      return Math.acos(jStat.dot(arr, arg) / (jStat.norm(arr) * jStat.norm(arg)));
    },

    // augment one matrix by another
    // Note: this function returns a matrix, not a jStat object
    aug: function aug(a, b) {
      var newarr = [];
      var i;
      for (i = 0; i < a.length; i++) {
        newarr.push(a[i].slice());
      }
      for (i = 0; i < newarr.length; i++) {
        push.apply(newarr[i], b[i]);
      }
      return newarr;
    },

    // The inv() function calculates the inverse of a matrix
    // Create the inverse by augmenting the matrix by the identity matrix of the
    // appropriate size, and then use G-J elimination on the augmented matrix.
    inv: function inv(a) {
      var rows = a.length;
      var cols = a[0].length;
      var b = jStat.identity(rows, cols);
      var c = jStat.gauss_jordan(a, b);
      var result = [];
      var i = 0;
      var j;

      //We need to copy the inverse portion to a new matrix to rid G-J artifacts
      for (; i < rows; i++) {
        result[i] = [];
        for (j = cols; j < c[0].length; j++)
          result[i][j - cols] = c[i][j];
      }
      return result;
    },

    // calculate the determinant of a matrix
    det: function det(a) {
      var alen = a.length,
      alend = alen * 2,
      vals = new Array(alend),
      rowshift = alen - 1,
      colshift = alend - 1,
      mrow = rowshift - alen + 1,
      mcol = colshift,
      i = 0,
      result = 0,
      j;
      // check for special 2x2 case
      if (alen === 2) {
        return a[0][0] * a[1][1] - a[0][1] * a[1][0];
      }
      for (; i < alend; i++) {
        vals[i] = 1;
      }
      for (i = 0; i < alen; i++) {
        for (j = 0; j < alen; j++) {
          vals[(mrow < 0) ? mrow + alen : mrow ] *= a[i][j];
          vals[(mcol < alen) ? mcol + alen : mcol ] *= a[i][j];
          mrow++;
          mcol--;
        }
        mrow = --rowshift - alen + 1;
        mcol = --colshift;
      }
      for (i = 0; i < alen; i++) {
        result += vals[i];
      }
      for (; i < alend; i++) {
        result -= vals[i];
      }
      return result;
    },

    gauss_elimination: function gauss_elimination(a, b) {
      var i = 0,
      j = 0,
      n = a.length,
      m = a[0].length,
      factor = 1,
      sum = 0,
      x = [],
      maug, pivot, temp, k;
      a = jStat.aug(a, b);
      maug = a[0].length;
      for(i = 0; i < n; i++) {
        pivot = a[i][i];
        j = i;
        for (k = i + 1; k < m; k++) {
          if (pivot < Math.abs(a[k][i])) {
            pivot = a[k][i];
            j = k;
          }
        }
        if (j != i) {
          for(k = 0; k < maug; k++) {
            temp = a[i][k];
            a[i][k] = a[j][k];
            a[j][k] = temp;
          }
        }
        for (j = i + 1; j < n; j++) {
          factor = a[j][i] / a[i][i];
          for(k = i; k < maug; k++) {
            a[j][k] = a[j][k] - factor * a[i][k];
          }
        }
      }
      for (i = n - 1; i >= 0; i--) {
        sum = 0;
        for (j = i + 1; j<= n - 1; j++) {
          sum = sum + x[j] * a[i][j];
        }
        x[i] =(a[i][maug - 1] - sum) / a[i][i];
      }
      return x;
    },

    gauss_jordan: function gauss_jordan(a, b) {
      var m = jStat.aug(a, b);
      var h = m.length;
      var w = m[0].length;
      var c = 0;
      var x, y, y2;
      // find max pivot
      for (y = 0; y < h; y++) {
        var maxrow = y;
        for (y2 = y+1; y2 < h; y2++) {
          if (Math.abs(m[y2][y]) > Math.abs(m[maxrow][y]))
            maxrow = y2;
        }
        var tmp = m[y];
        m[y] = m[maxrow];
        m[maxrow] = tmp;
        for (y2 = y+1; y2 < h; y2++) {
          c = m[y2][y] / m[y][y];
          for (x = y; x < w; x++) {
            m[y2][x] -= m[y][x] * c;
          }
        }
      }
      // backsubstitute
      for (y = h-1; y >= 0; y--) {
        c = m[y][y];
        for (y2 = 0; y2 < y; y2++) {
          for (x = w-1; x > y-1; x--) {
            m[y2][x] -= m[y][x] * m[y2][y] / c;
          }
        }
        m[y][y] /= c;
        for (x = h; x < w; x++) {
          m[y][x] /= c;
        }
      }
      return m;
    },

    // solve equation
    // Ax=b
    // A is upper triangular matrix
    // A=[[1,2,3],[0,4,5],[0,6,7]]
    // b=[1,2,3]
    // triaUpSolve(A,b) // -> [2.666,0.1666,1.666]
    // if you use matrix style
    // A=[[1,2,3],[0,4,5],[0,6,7]]
    // b=[[1],[2],[3]]
    // will return [[2.666],[0.1666],[1.666]]
    triaUpSolve: function triaUpSolve(A, b) {
      var size = A[0].length;
      var x = jStat.zeros(1, size)[0];
      var parts;
      var matrix_mode = false;

      if (b[0].length != undefined) {
        b = b.map(function(i){ return i[0] });
        matrix_mode = true;
      }

      jStat.arange(size - 1, -1, -1).forEach(function(i) {
        parts = jStat.arange(i + 1, size).map(function(j) {
          return x[j] * A[i][j];
        });
        x[i] = (b[i] - jStat.sum(parts)) / A[i][i];
      });

      if (matrix_mode)
        return x.map(function(i){ return [i] });
      return x;
    },

    triaLowSolve: function triaLowSolve(A, b) {
      // like to triaUpSolve but A is lower triangular matrix
      var size = A[0].length;
      var x = jStat.zeros(1, size)[0];
      var parts;

      var matrix_mode=false;
      if (b[0].length != undefined) {
        b = b.map(function(i){ return i[0] });
        matrix_mode = true;
      }

      jStat.arange(size).forEach(function(i) {
        parts = jStat.arange(i).map(function(j) {
          return A[i][j] * x[j];
        });
        x[i] = (b[i] - jStat.sum(parts)) / A[i][i];
      });

      if (matrix_mode)
        return x.map(function(i){ return [i] });
      return x;
    },


    // A -> [L,U]
    // A=LU
    // L is lower triangular matrix
    // U is upper triangular matrix
    lu: function lu(A) {
      var size = A.length;
      //var L=jStat.diagonal(jStat.ones(1,size)[0]);
      var L = jStat.identity(size);
      var R = jStat.zeros(A.length, A[0].length);
      var parts;
      jStat.arange(size).forEach(function(t) {
        R[0][t] = A[0][t];
      });
      jStat.arange(1, size).forEach(function(l) {
        jStat.arange(l).forEach(function(i) {
          parts = jStat.arange(i).map(function(jj) {
            return L[l][jj] * R[jj][i];
          });
          L[l][i] = (A[l][i] - jStat.sum(parts)) / R[i][i];
        });
        jStat.arange(l, size).forEach(function(j) {
          parts = jStat.arange(l).map(function(jj) {
            return L[l][jj] * R[jj][j];
          });
          R[l][j] = A[parts.length][j] - jStat.sum(parts);
        });
      });
      return [L, R];
    },

    // A -> T
    // A=TT'
    // T is lower triangular matrix
    cholesky: function cholesky(A) {
      var size = A.length;
      var T = jStat.zeros(A.length, A[0].length);
      var parts;
      jStat.arange(size).forEach(function(i) {
        parts = jStat.arange(i).map(function(t) {
          return Math.pow(T[i][t],2);
        });
        T[i][i] = Math.sqrt(A[i][i] - jStat.sum(parts));
        jStat.arange(i + 1, size).forEach(function(j) {
          parts = jStat.arange(i).map(function(t) {
            return T[i][t] * T[j][t];
          });
          T[j][i] = (A[i][j] - jStat.sum(parts)) / T[i][i];
        });
      });
      return T;
    },


    gauss_jacobi: function gauss_jacobi(a, b, x, r) {
      var i = 0;
      var j = 0;
      var n = a.length;
      var l = [];
      var u = [];
      var d = [];
      var xv, c, h, xk;
      for (; i < n; i++) {
        l[i] = [];
        u[i] = [];
        d[i] = [];
        for (j = 0; j < n; j++) {
          if (i > j) {
            l[i][j] = a[i][j];
            u[i][j] = d[i][j] = 0;
          } else if (i < j) {
            u[i][j] = a[i][j];
            l[i][j] = d[i][j] = 0;
          } else {
            d[i][j] = a[i][j];
            l[i][j] = u[i][j] = 0;
          }
        }
      }
      h = jStat.multiply(jStat.multiply(jStat.inv(d), jStat.add(l, u)), -1);
      c = jStat.multiply(jStat.inv(d), b);
      xv = x;
      xk = jStat.add(jStat.multiply(h, x), c);
      i = 2;
      while (Math.abs(jStat.norm(jStat.subtract(xk,xv))) > r) {
        xv = xk;
        xk = jStat.add(jStat.multiply(h, xv), c);
        i++;
      }
      return xk;
    },

    gauss_seidel: function gauss_seidel(a, b, x, r) {
      var i = 0;
      var n = a.length;
      var l = [];
      var u = [];
      var d = [];
      var j, xv, c, h, xk;
      for (; i < n; i++) {
        l[i] = [];
        u[i] = [];
        d[i] = [];
        for (j = 0; j < n; j++) {
          if (i > j) {
            l[i][j] = a[i][j];
            u[i][j] = d[i][j] = 0;
          } else if (i < j) {
            u[i][j] = a[i][j];
            l[i][j] = d[i][j] = 0;
          } else {
            d[i][j] = a[i][j];
            l[i][j] = u[i][j] = 0;
          }
        }
      }
      h = jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d, l)), u), -1);
      c = jStat.multiply(jStat.inv(jStat.add(d, l)), b);
      xv = x;
      xk = jStat.add(jStat.multiply(h, x), c);
      i = 2;
      while (Math.abs(jStat.norm(jStat.subtract(xk, xv))) > r) {
        xv = xk;
        xk = jStat.add(jStat.multiply(h, xv), c);
        i = i + 1;
      }
      return xk;
    },

    SOR: function SOR(a, b, x, r, w) {
      var i = 0;
      var n = a.length;
      var l = [];
      var u = [];
      var d = [];
      var j, xv, c, h, xk;
      for (; i < n; i++) {
        l[i] = [];
        u[i] = [];
        d[i] = [];
        for (j = 0; j < n; j++) {
          if (i > j) {
            l[i][j] = a[i][j];
            u[i][j] = d[i][j] = 0;
          } else if (i < j) {
            u[i][j] = a[i][j];
            l[i][j] = d[i][j] = 0;
          } else {
            d[i][j] = a[i][j];
            l[i][j] = u[i][j] = 0;
          }
        }
      }
      h = jStat.multiply(jStat.inv(jStat.add(d, jStat.multiply(l, w))),
                         jStat.subtract(jStat.multiply(d, 1 - w),
                                        jStat.multiply(u, w)));
      c = jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,
          jStat.multiply(l, w))), b), w);
      xv = x;
      xk = jStat.add(jStat.multiply(h, x), c);
      i = 2;
      while (Math.abs(jStat.norm(jStat.subtract(xk, xv))) > r) {
        xv = xk;
        xk = jStat.add(jStat.multiply(h, xv), c);
        i++;
      }
      return xk;
    },

    householder: function householder(a) {
      var m = a.length;
      var n = a[0].length;
      var i = 0;
      var w = [];
      var p = [];
      var alpha, r, k, j, factor;
      for (; i < m - 1; i++) {
        alpha = 0;
        for (j = i + 1; j < n; j++)
        alpha += (a[j][i] * a[j][i]);
        factor = (a[i + 1][i] > 0) ? -1 : 1;
        alpha = factor * Math.sqrt(alpha);
        r = Math.sqrt((((alpha * alpha) - a[i + 1][i] * alpha) / 2));
        w = jStat.zeros(m, 1);
        w[i + 1][0] = (a[i + 1][i] - alpha) / (2 * r);
        for (k = i + 2; k < m; k++) w[k][0] = a[k][i] / (2 * r);
        p = jStat.subtract(jStat.identity(m, n),
            jStat.multiply(jStat.multiply(w, jStat.transpose(w)), 2));
        a = jStat.multiply(p, jStat.multiply(a, p));
      }
      return a;
    },

    // A -> [Q,R]
    // Q is orthogonal matrix
    // R is upper triangular
    QR: (function() {
      // x -> Q
      // find a orthogonal matrix Q st.
      // Qx=y
      // y is [||x||,0,0,...]

      // quick ref
      var sum   = jStat.sum;
      var range = jStat.arange;

      function qr2(x) {
        // quick impletation
        // https://www.stat.wisc.edu/~larget/math496/qr.html

        var n = x.length;
        var p = x[0].length;

        var r = jStat.zeros(p, p);
        x = jStat.copy(x);

        var i,j,k;
        for(j = 0; j < p; j++){
          r[j][j] = Math.sqrt(sum(range(n).map(function(i){
            return x[i][j] * x[i][j];
          })));
          for(i = 0; i < n; i++){
            x[i][j] = x[i][j] / r[j][j];
          }
          for(k = j+1; k < p; k++){
            r[j][k] = sum(range(n).map(function(i){
              return x[i][j] * x[i][k];
            }));
            for(i = 0; i < n; i++){
              x[i][k] = x[i][k] - x[i][j]*r[j][k];
            }
          }
        }
        return [x, r];
      }

      return qr2;
    }()),

    lstsq: (function() {
      // solve least squard problem for Ax=b as QR decomposition way if b is
      // [[b1],[b2],[b3]] form will return [[x1],[x2],[x3]] array form solution
      // else b is [b1,b2,b3] form will return [x1,x2,x3] array form solution
      function R_I(A) {
        A = jStat.copy(A);
        var size = A.length;
        var I = jStat.identity(size);
        jStat.arange(size - 1, -1, -1).forEach(function(i) {
          jStat.sliceAssign(
              I, { row: i }, jStat.divide(jStat.slice(I, { row: i }), A[i][i]));
          jStat.sliceAssign(
              A, { row: i }, jStat.divide(jStat.slice(A, { row: i }), A[i][i]));
          jStat.arange(i).forEach(function(j) {
            var c = jStat.multiply(A[j][i], -1);
            var Aj = jStat.slice(A, { row: j });
            var cAi = jStat.multiply(jStat.slice(A, { row: i }), c);
            jStat.sliceAssign(A, { row: j }, jStat.add(Aj, cAi));
            var Ij = jStat.slice(I, { row: j });
            var cIi = jStat.multiply(jStat.slice(I, { row: i }), c);
            jStat.sliceAssign(I, { row: j }, jStat.add(Ij, cIi));
          });
        });
        return I;
      }

      function qr_solve(A, b){
        var array_mode = false;
        if (b[0].length === undefined) {
          // [c1,c2,c3] mode
          b = b.map(function(x){ return [x] });
          array_mode = true;
        }
        var QR = jStat.QR(A);
        var Q = QR[0];
        var R = QR[1];
        var attrs = A[0].length;
        var Q1 = jStat.slice(Q,{col:{end:attrs}});
        var R1 = jStat.slice(R,{row:{end:attrs}});
        var RI = R_I(R1);
        var Q2 = jStat.transpose(Q1);

        if(Q2[0].length === undefined){
          Q2 = [Q2]; // The confusing jStat.multifly implementation threat nature process again.
        }

        var x = jStat.multiply(jStat.multiply(RI, Q2), b);

        if(x.length === undefined){
          x = [[x]]; // The confusing jStat.multifly implementation threat nature process again.
        }


        if (array_mode)
          return x.map(function(i){ return i[0] });
        return x;
      }

      return qr_solve;
    }()),

    jacobi: function jacobi(a) {
      var condition = 1;
      var n = a.length;
      var e = jStat.identity(n, n);
      var ev = [];
      var b, i, j, p, q, maxim, theta, s;
      // condition === 1 only if tolerance is not reached
      while (condition === 1) {
        maxim = a[0][1];
        p = 0;
        q = 1;
        for (i = 0; i < n; i++) {
          for (j = 0; j < n; j++) {
            if (i != j) {
              if (maxim < Math.abs(a[i][j])) {
                maxim = Math.abs(a[i][j]);
                p = i;
                q = j;
              }
            }
          }
        }
        if (a[p][p] === a[q][q])
          theta = (a[p][q] > 0) ? Math.PI / 4 : -Math.PI / 4;
        else
          theta = Math.atan(2 * a[p][q] / (a[p][p] - a[q][q])) / 2;
        s = jStat.identity(n, n);
        s[p][p] = Math.cos(theta);
        s[p][q] = -Math.sin(theta);
        s[q][p] = Math.sin(theta);
        s[q][q] = Math.cos(theta);
        // eigen vector matrix
        e = jStat.multiply(e, s);
        b = jStat.multiply(jStat.multiply(jStat.inv(s), a), s);
        a = b;
        condition = 0;
        for (i = 1; i < n; i++) {
          for (j = 1; j < n; j++) {
            if (i != j && Math.abs(a[i][j]) > 0.001) {
              condition = 1;
            }
          }
        }
      }
      for (i = 0; i < n; i++) ev.push(a[i][i]);
      //returns both the eigenvalue and eigenmatrix
      return [e, ev];
    },

    rungekutta: function rungekutta(f, h, p, t_j, u_j, order) {
      var k1, k2, u_j1, k3, k4;
      if (order === 2) {
        while (t_j <= p) {
          k1 = h * f(t_j, u_j);
          k2 = h * f(t_j + h, u_j + k1);
          u_j1 = u_j + (k1 + k2) / 2;
          u_j = u_j1;
          t_j = t_j + h;
        }
      }
      if (order === 4) {
        while (t_j <= p) {
          k1 = h * f(t_j, u_j);
          k2 = h * f(t_j + h / 2, u_j + k1 / 2);
          k3 = h * f(t_j + h / 2, u_j + k2 / 2);
          k4 = h * f(t_j +h, u_j + k3);
          u_j1 = u_j + (k1 + 2 * k2 + 2 * k3 + k4) / 6;
          u_j = u_j1;
          t_j = t_j + h;
        }
      }
      return u_j;
    },

    romberg: function romberg(f, a, b, order) {
      var i = 0;
      var h = (b - a) / 2;
      var x = [];
      var h1 = [];
      var g = [];
      var m, a1, j, k, I;
      while (i < order / 2) {
        I = f(a);
        for (j = a, k = 0; j <= b; j = j + h, k++) x[k] = j;
        m = x.length;
        for (j = 1; j < m - 1; j++) {
          I += (((j % 2) !== 0) ? 4 : 2) * f(x[j]);
        }
        I = (h / 3) * (I + f(b));
        g[i] = I;
        h /= 2;
        i++;
      }
      a1 = g.length;
      m = 1;
      while (a1 !== 1) {
        for (j = 0; j < a1 - 1; j++)
        h1[j] = ((Math.pow(4, m)) * g[j + 1] - g[j]) / (Math.pow(4, m) - 1);
        a1 = h1.length;
        g = h1;
        h1 = [];
        m++;
      }
      return g;
    },

    richardson: function richardson(X, f, x, h) {
      function pos(X, x) {
        var i = 0;
        var n = X.length;
        var p;
        for (; i < n; i++)
          if (X[i] === x) p = i;
        return p;
      }
      var h_min = Math.abs(x - X[pos(X, x) + 1]);
      var i = 0;
      var g = [];
      var h1 = [];
      var y1, y2, m, a, j;
      while (h >= h_min) {
        y1 = pos(X, x + h);
        y2 = pos(X, x);
        g[i] = (f[y1] - 2 * f[y2] + f[2 * y2 - y1]) / (h * h);
        h /= 2;
        i++;
      }
      a = g.length;
      m = 1;
      while (a != 1) {
        for (j = 0; j < a - 1; j++)
          h1[j] = ((Math.pow(4, m)) * g[j + 1] - g[j]) / (Math.pow(4, m) - 1);
        a = h1.length;
        g = h1;
        h1 = [];
        m++;
      }
      return g;
    },

    simpson: function simpson(f, a, b, n) {
      var h = (b - a) / n;
      var I = f(a);
      var x = [];
      var j = a;
      var k = 0;
      var i = 1;
      var m;
      for (; j <= b; j = j + h, k++)
        x[k] = j;
      m = x.length;
      for (; i < m - 1; i++) {
        I += ((i % 2 !== 0) ? 4 : 2) * f(x[i]);
      }
      return (h / 3) * (I + f(b));
    },

    hermite: function hermite(X, F, dF, value) {
      var n = X.length;
      var p = 0;
      var i = 0;
      var l = [];
      var dl = [];
      var A = [];
      var B = [];
      var j;
      for (; i < n; i++) {
        l[i] = 1;
        for (j = 0; j < n; j++) {
          if (i != j) l[i] *= (value - X[j]) / (X[i] - X[j]);
        }
        dl[i] = 0;
        for (j = 0; j < n; j++) {
          if (i != j) dl[i] += 1 / (X [i] - X[j]);
        }
        A[i] = (1 - 2 * (value - X[i]) * dl[i]) * (l[i] * l[i]);
        B[i] = (value - X[i]) * (l[i] * l[i]);
        p += (A[i] * F[i] + B[i] * dF[i]);
      }
      return p;
    },

    lagrange: function lagrange(X, F, value) {
      var p = 0;
      var i = 0;
      var j, l;
      var n = X.length;
      for (; i < n; i++) {
        l = F[i];
        for (j = 0; j < n; j++) {
          // calculating the lagrange polynomial L_i
          if (i != j) l *= (value - X[j]) / (X[i] - X[j]);
        }
        // adding the lagrange polynomials found above
        p += l;
      }
      return p;
    },

    cubic_spline: function cubic_spline(X, F, value) {
      var n = X.length;
      var i = 0, j;
      var A = [];
      var B = [];
      var alpha = [];
      var c = [];
      var h = [];
      var b = [];
      var d = [];
      for (; i < n - 1; i++)
        h[i] = X[i + 1] - X[i];
      alpha[0] = 0;
      for (i = 1; i < n - 1; i++) {
        alpha[i] = (3 / h[i]) * (F[i + 1] - F[i]) -
            (3 / h[i-1]) * (F[i] - F[i-1]);
      }
      for (i = 1; i < n - 1; i++) {
        A[i] = [];
        B[i] = [];
        A[i][i-1] = h[i-1];
        A[i][i] = 2 * (h[i - 1] + h[i]);
        A[i][i+1] = h[i];
        B[i][0] = alpha[i];
      }
      c = jStat.multiply(jStat.inv(A), B);
      for (j = 0; j < n - 1; j++) {
        b[j] = (F[j + 1] - F[j]) / h[j] - h[j] * (c[j + 1][0] + 2 * c[j][0]) / 3;
        d[j] = (c[j + 1][0] - c[j][0]) / (3 * h[j]);
      }
      for (j = 0; j < n; j++) {
        if (X[j] > value) break;
      }
      j -= 1;
      return F[j] + (value - X[j]) * b[j] + jStat.sq(value-X[j]) *
          c[j] + (value - X[j]) * jStat.sq(value - X[j]) * d[j];
    },

    gauss_quadrature: function gauss_quadrature() {
      throw new Error('gauss_quadrature not yet implemented');
    },

    PCA: function PCA(X) {
      var m = X.length;
      var n = X[0].length;
      var i = 0;
      var j, temp1;
      var u = [];
      var D = [];
      var result = [];
      var temp2 = [];
      var Y = [];
      var Bt = [];
      var B = [];
      var C = [];
      var V = [];
      var Vt = [];
      for (i = 0; i < m; i++) {
        u[i] = jStat.sum(X[i]) / n;
      }
      for (i = 0; i < n; i++) {
        B[i] = [];
        for(j = 0; j < m; j++) {
          B[i][j] = X[j][i] - u[j];
        }
      }
      B = jStat.transpose(B);
      for (i = 0; i < m; i++) {
        C[i] = [];
        for (j = 0; j < m; j++) {
          C[i][j] = (jStat.dot([B[i]], [B[j]])) / (n - 1);
        }
      }
      result = jStat.jacobi(C);
      V = result[0];
      D = result[1];
      Vt = jStat.transpose(V);
      for (i = 0; i < D.length; i++) {
        for (j = i; j < D.length; j++) {
          if(D[i] < D[j])  {
            temp1 = D[i];
            D[i] = D[j];
            D[j] = temp1;
            temp2 = Vt[i];
            Vt[i] = Vt[j];
            Vt[j] = temp2;
          }
        }
      }
      Bt = jStat.transpose(B);
      for (i = 0; i < m; i++) {
        Y[i] = [];
        for (j = 0; j < Bt.length; j++) {
          Y[i][j] = jStat.dot([Vt[i]], [Bt[j]]);
        }
      }
      return [X, D, Vt, Y];
    }
  });

  // extend jStat.fn with methods that require one argument
  (function(funcs) {
    for (var i = 0; i < funcs.length; i++) (function(passfunc) {
      jStat.fn[passfunc] = function(arg, func) {
        var tmpthis = this;
        // check for callback
        if (func) {
          setTimeout(function() {
            func.call(tmpthis, jStat.fn[passfunc].call(tmpthis, arg));
          }, 15);
          return this;
        }
        if (typeof jStat[passfunc](this, arg) === 'number')
          return jStat[passfunc](this, arg);
        else
          return jStat(jStat[passfunc](this, arg));
      };
    }(funcs[i]));
  }('add divide multiply subtract dot pow exp log abs norm angle'.split(' ')));

  }(jStat, Math));
  (function(jStat, Math) {

  var slice = [].slice;
  var isNumber = jStat.utils.isNumber;
  var isArray = jStat.utils.isArray;

  // flag==true denotes use of sample standard deviation
  // Z Statistics
  jStat.extend({
    // 2 different parameter lists:
    // (value, mean, sd)
    // (value, array, flag)
    zscore: function zscore() {
      var args = slice.call(arguments);
      if (isNumber(args[1])) {
        return (args[0] - args[1]) / args[2];
      }
      return (args[0] - jStat.mean(args[1])) / jStat.stdev(args[1], args[2]);
    },

    // 3 different paramter lists:
    // (value, mean, sd, sides)
    // (zscore, sides)
    // (value, array, sides, flag)
    ztest: function ztest() {
      var args = slice.call(arguments);
      var z;
      if (isArray(args[1])) {
        // (value, array, sides, flag)
        z = jStat.zscore(args[0],args[1],args[3]);
        return (args[2] === 1) ?
          (jStat.normal.cdf(-Math.abs(z), 0, 1)) :
          (jStat.normal.cdf(-Math.abs(z), 0, 1)*2);
      } else {
        if (args.length > 2) {
          // (value, mean, sd, sides)
          z = jStat.zscore(args[0],args[1],args[2]);
          return (args[3] === 1) ?
            (jStat.normal.cdf(-Math.abs(z),0,1)) :
            (jStat.normal.cdf(-Math.abs(z),0,1)* 2);
        } else {
          // (zscore, sides)
          z = args[0];
          return (args[1] === 1) ?
            (jStat.normal.cdf(-Math.abs(z),0,1)) :
            (jStat.normal.cdf(-Math.abs(z),0,1)*2);
        }
      }
    }
  });

  jStat.extend(jStat.fn, {
    zscore: function zscore(value, flag) {
      return (value - this.mean()) / this.stdev(flag);
    },

    ztest: function ztest(value, sides, flag) {
      var zscore = Math.abs(this.zscore(value, flag));
      return (sides === 1) ?
        (jStat.normal.cdf(-zscore, 0, 1)) :
        (jStat.normal.cdf(-zscore, 0, 1) * 2);
    }
  });

  // T Statistics
  jStat.extend({
    // 2 parameter lists
    // (value, mean, sd, n)
    // (value, array)
    tscore: function tscore() {
      var args = slice.call(arguments);
      return (args.length === 4) ?
        ((args[0] - args[1]) / (args[2] / Math.sqrt(args[3]))) :
        ((args[0] - jStat.mean(args[1])) /
         (jStat.stdev(args[1], true) / Math.sqrt(args[1].length)));
    },

    // 3 different paramter lists:
    // (value, mean, sd, n, sides)
    // (tscore, n, sides)
    // (value, array, sides)
    ttest: function ttest() {
      var args = slice.call(arguments);
      var tscore;
      if (args.length === 5) {
        tscore = Math.abs(jStat.tscore(args[0], args[1], args[2], args[3]));
        return (args[4] === 1) ?
          (jStat.studentt.cdf(-tscore, args[3]-1)) :
          (jStat.studentt.cdf(-tscore, args[3]-1)*2);
      }
      if (isNumber(args[1])) {
        tscore = Math.abs(args[0]);
        return (args[2] == 1) ?
          (jStat.studentt.cdf(-tscore, args[1]-1)) :
          (jStat.studentt.cdf(-tscore, args[1]-1) * 2);
      }
      tscore = Math.abs(jStat.tscore(args[0], args[1]));
      return (args[2] == 1) ?
        (jStat.studentt.cdf(-tscore, args[1].length-1)) :
        (jStat.studentt.cdf(-tscore, args[1].length-1) * 2);
    }
  });

  jStat.extend(jStat.fn, {
    tscore: function tscore(value) {
      return (value - this.mean()) / (this.stdev(true) / Math.sqrt(this.cols()));
    },

    ttest: function ttest(value, sides) {
      return (sides === 1) ?
        (1 - jStat.studentt.cdf(Math.abs(this.tscore(value)), this.cols()-1)) :
        (jStat.studentt.cdf(-Math.abs(this.tscore(value)), this.cols()-1)*2);
    }
  });

  // F Statistics
  jStat.extend({
    // Paramter list is as follows:
    // (array1, array2, array3, ...)
    // or it is an array of arrays
    // array of arrays conversion
    anovafscore: function anovafscore() {
      var args = slice.call(arguments),
      expVar, sample, sampMean, sampSampMean, tmpargs, unexpVar, i, j;
      if (args.length === 1) {
        tmpargs = new Array(args[0].length);
        for (i = 0; i < args[0].length; i++) {
          tmpargs[i] = args[0][i];
        }
        args = tmpargs;
      }
      // Builds sample array
      sample = new Array();
      for (i = 0; i < args.length; i++) {
        sample = sample.concat(args[i]);
      }
      sampMean = jStat.mean(sample);
      // Computes the explained variance
      expVar = 0;
      for (i = 0; i < args.length; i++) {
        expVar = expVar + args[i].length * Math.pow(jStat.mean(args[i]) - sampMean, 2);
      }
      expVar /= (args.length - 1);
      // Computes unexplained variance
      unexpVar = 0;
      for (i = 0; i < args.length; i++) {
        sampSampMean = jStat.mean(args[i]);
        for (j = 0; j < args[i].length; j++) {
          unexpVar += Math.pow(args[i][j] - sampSampMean, 2);
        }
      }
      unexpVar /= (sample.length - args.length);
      return expVar / unexpVar;
    },

    // 2 different paramter setups
    // (array1, array2, array3, ...)
    // (anovafscore, df1, df2)
    anovaftest: function anovaftest() {
      var args = slice.call(arguments),
      df1, df2, n, i;
      if (isNumber(args[0])) {
        return 1 - jStat.centralF.cdf(args[0], args[1], args[2]);
      }
      var anovafscore = jStat.anovafscore(args);
      df1 = args.length - 1;
      n = 0;
      for (i = 0; i < args.length; i++) {
        n = n + args[i].length;
      }
      df2 = n - df1 - 1;
      return 1 - jStat.centralF.cdf(anovafscore, df1, df2);
    },

    ftest: function ftest(fscore, df1, df2) {
      return 1 - jStat.centralF.cdf(fscore, df1, df2);
    }
  });

  jStat.extend(jStat.fn, {
    anovafscore: function anovafscore() {
      return jStat.anovafscore(this.toArray());
    },

    anovaftes: function anovaftes() {
      var n = 0;
      var i;
      for (i = 0; i < this.length; i++) {
        n = n + this[i].length;
      }
      return jStat.ftest(this.anovafscore(), this.length - 1, n - this.length);
    }
  });

  // Tukey's range test
  jStat.extend({
    // 2 parameter lists
    // (mean1, mean2, n1, n2, sd)
    // (array1, array2, sd)
    qscore: function qscore() {
      var args = slice.call(arguments);
      var mean1, mean2, n1, n2, sd;
      if (isNumber(args[0])) {
          mean1 = args[0];
          mean2 = args[1];
          n1 = args[2];
          n2 = args[3];
          sd = args[4];
      } else {
          mean1 = jStat.mean(args[0]);
          mean2 = jStat.mean(args[1]);
          n1 = args[0].length;
          n2 = args[1].length;
          sd = args[2];
      }
      return Math.abs(mean1 - mean2) / (sd * Math.sqrt((1 / n1 + 1 / n2) / 2));
    },

    // 3 different parameter lists:
    // (qscore, n, k)
    // (mean1, mean2, n1, n2, sd, n, k)
    // (array1, array2, sd, n, k)
    qtest: function qtest() {
      var args = slice.call(arguments);

      var qscore;
      if (args.length === 3) {
        qscore = args[0];
        args = args.slice(1);
      } else if (args.length === 7) {
        qscore = jStat.qscore(args[0], args[1], args[2], args[3], args[4]);
        args = args.slice(5);
      } else {
        qscore = jStat.qscore(args[0], args[1], args[2]);
        args = args.slice(3);
      }

      var n = args[0];
      var k = args[1];

      return 1 - jStat.tukey.cdf(qscore, k, n - k);
    },

    tukeyhsd: function tukeyhsd(arrays) {
      var sd = jStat.pooledstdev(arrays);
      var means = arrays.map(function (arr) {return jStat.mean(arr);});
      var n = arrays.reduce(function (n, arr) {return n + arr.length;}, 0);

      var results = [];
      for (var i = 0; i < arrays.length; ++i) {
          for (var j = i + 1; j < arrays.length; ++j) {
              var p = jStat.qtest(means[i], means[j], arrays[i].length, arrays[j].length, sd, n, arrays.length);
              results.push([[i, j], p]);
          }
      }

      return results;
    }
  });

  // Error Bounds
  jStat.extend({
    // 2 different parameter setups
    // (value, alpha, sd, n)
    // (value, alpha, array)
    normalci: function normalci() {
      var args = slice.call(arguments),
      ans = new Array(2),
      change;
      if (args.length === 4) {
        change = Math.abs(jStat.normal.inv(args[1] / 2, 0, 1) *
                          args[2] / Math.sqrt(args[3]));
      } else {
        change = Math.abs(jStat.normal.inv(args[1] / 2, 0, 1) *
                          jStat.stdev(args[2]) / Math.sqrt(args[2].length));
      }
      ans[0] = args[0] - change;
      ans[1] = args[0] + change;
      return ans;
    },

    // 2 different parameter setups
    // (value, alpha, sd, n)
    // (value, alpha, array)
    tci: function tci() {
      var args = slice.call(arguments),
      ans = new Array(2),
      change;
      if (args.length === 4) {
        change = Math.abs(jStat.studentt.inv(args[1] / 2, args[3] - 1) *
                          args[2] / Math.sqrt(args[3]));
      } else {
        change = Math.abs(jStat.studentt.inv(args[1] / 2, args[2].length - 1) *
                          jStat.stdev(args[2], true) / Math.sqrt(args[2].length));
      }
      ans[0] = args[0] - change;
      ans[1] = args[0] + change;
      return ans;
    },

    significant: function significant(pvalue, alpha) {
      return pvalue < alpha;
    }
  });

  jStat.extend(jStat.fn, {
    normalci: function normalci(value, alpha) {
      return jStat.normalci(value, alpha, this.toArray());
    },

    tci: function tci(value, alpha) {
      return jStat.tci(value, alpha, this.toArray());
    }
  });

  // internal method for calculating the z-score for a difference of proportions test
  function differenceOfProportions(p1, n1, p2, n2) {
    if (p1 > 1 || p2 > 1 || p1 <= 0 || p2 <= 0) {
      throw new Error("Proportions should be greater than 0 and less than 1")
    }
    var pooled = (p1 * n1 + p2 * n2) / (n1 + n2);
    var se = Math.sqrt(pooled * (1 - pooled) * ((1/n1) + (1/n2)));
    return (p1 - p2) / se;
  }

  // Difference of Proportions
  jStat.extend(jStat.fn, {
    oneSidedDifferenceOfProportions: function oneSidedDifferenceOfProportions(p1, n1, p2, n2) {
      var z = differenceOfProportions(p1, n1, p2, n2);
      return jStat.ztest(z, 1);
    },

    twoSidedDifferenceOfProportions: function twoSidedDifferenceOfProportions(p1, n1, p2, n2) {
      var z = differenceOfProportions(p1, n1, p2, n2);
      return jStat.ztest(z, 2);
    }
  });

  }(jStat, Math));
  jStat.models = (function(){
    function sub_regress(exog) {
      var var_count = exog[0].length;
      var modelList = jStat.arange(var_count).map(function(endog_index) {
        var exog_index =
            jStat.arange(var_count).filter(function(i){return i!==endog_index});
        return ols(jStat.col(exog, endog_index).map(function(x){ return x[0] }),
                   jStat.col(exog, exog_index))
      });
      return modelList;
    }

    // do OLS model regress
    // exog have include const columns ,it will not generate it .In fact, exog is
    // "design matrix" look at
    //https://en.wikipedia.org/wiki/Design_matrix
    function ols(endog, exog) {
      var nobs = endog.length;
      var df_model = exog[0].length - 1;
      var df_resid = nobs-df_model - 1;
      var coef = jStat.lstsq(exog, endog);
      var predict =
          jStat.multiply(exog, coef.map(function(x) { return [x] }))
              .map(function(p) { return p[0] });
      var resid = jStat.subtract(endog, predict);
      var ybar = jStat.mean(endog);
      // constant cause problem
      // var SST = jStat.sum(endog.map(function(y) {
      //   return Math.pow(y-ybar,2);
      // }));
      var SSE = jStat.sum(predict.map(function(f) {
        return Math.pow(f - ybar, 2);
      }));
      var SSR = jStat.sum(endog.map(function(y, i) {
        return Math.pow(y - predict[i], 2);
      }));
      var SST = SSE + SSR;
      var R2 = (SSE / SST);
      return {
          exog:exog,
          endog:endog,
          nobs:nobs,
          df_model:df_model,
          df_resid:df_resid,
          coef:coef,
          predict:predict,
          resid:resid,
          ybar:ybar,
          SST:SST,
          SSE:SSE,
          SSR:SSR,
          R2:R2
      };
    }

    // H0: b_I=0
    // H1: b_I!=0
    function t_test(model) {
      var subModelList = sub_regress(model.exog);
      //var sigmaHat=jStat.stdev(model.resid);
      var sigmaHat = Math.sqrt(model.SSR / (model.df_resid));
      var seBetaHat = subModelList.map(function(mod) {
        var SST = mod.SST;
        var R2 = mod.R2;
        return sigmaHat / Math.sqrt(SST * (1 - R2));
      });
      var tStatistic = model.coef.map(function(coef, i) {
        return (coef - 0) / seBetaHat[i];
      });
      var pValue = tStatistic.map(function(t) {
        var leftppf = jStat.studentt.cdf(t, model.df_resid);
        return (leftppf > 0.5 ? 1 - leftppf : leftppf) * 2;
      });
      var c = jStat.studentt.inv(0.975, model.df_resid);
      var interval95 = model.coef.map(function(coef, i) {
        var d = c * seBetaHat[i];
        return [coef - d, coef + d];
      });
      return {
          se: seBetaHat,
          t: tStatistic,
          p: pValue,
          sigmaHat: sigmaHat,
          interval95: interval95
      };
    }

    function F_test(model) {
      var F_statistic =
          (model.R2 / model.df_model) / ((1 - model.R2) / model.df_resid);
      var fcdf = function(x, n1, n2) {
        return jStat.beta.cdf(x / (n2 / n1 + x), n1 / 2, n2 / 2)
      };
      var pvalue = 1 - fcdf(F_statistic, model.df_model, model.df_resid);
      return { F_statistic: F_statistic, pvalue: pvalue };
    }

    function ols_wrap(endog, exog) {
      var model = ols(endog,exog);
      var ttest = t_test(model);
      var ftest = F_test(model);
      // Provide the Wherry / Ezekiel / McNemar / Cohen Adjusted R^2
      // Which matches the 'adjusted R^2' provided by R's lm package
      var adjust_R2 =
          1 - (1 - model.R2) * ((model.nobs - 1) / (model.df_resid));
      model.t = ttest;
      model.f = ftest;
      model.adjust_R2 = adjust_R2;
      return model;
    }

    return { ols: ols_wrap };
  })();
  //To regress, simply build X matrix
  //(append column of 1's) using
  //buildxmatrix and build the Y
  //matrix using buildymatrix
  //(simply the transpose)
  //and run regress.



  //Regressions

  jStat.extend({
    buildxmatrix: function buildxmatrix(){
      //Parameters will be passed in as such
      //(array1,array2,array3,...)
      //as (x1,x2,x3,...)
      //needs to be (1,x1,x2,x3,...)
      var matrixRows = new Array(arguments.length);
      for(var i=0;i<arguments.length;i++){
        var array = [1];
        matrixRows[i]= array.concat(arguments[i]);
      }
      return jStat(matrixRows);

    },

    builddxmatrix: function builddxmatrix() {
      //Paramters will be passed in as such
      //([array1,array2,...]
      var matrixRows = new Array(arguments[0].length);
      for(var i=0;i<arguments[0].length;i++){
        var array = [1];
        matrixRows[i]= array.concat(arguments[0][i]);
      }
      return jStat(matrixRows);

    },

    buildjxmatrix: function buildjxmatrix(jMat) {
      //Builds from jStat Matrix
      var pass = new Array(jMat.length);
      for(var i=0;i<jMat.length;i++){
        pass[i] = jMat[i];
      }
      return jStat.builddxmatrix(pass);

    },

    buildymatrix: function buildymatrix(array){
      return jStat(array).transpose();
    },

    buildjymatrix: function buildjymatrix(jMat){
      return jMat.transpose();
    },

    matrixmult: function matrixmult(A,B){
      var i, j, k, result, sum;
      if (A.cols() == B.rows()) {
        if(B.rows()>1){
          result = [];
          for (i = 0; i < A.rows(); i++) {
            result[i] = [];
            for (j = 0; j < B.cols(); j++) {
              sum = 0;
              for (k = 0; k < A.cols(); k++) {
                sum += A.toArray()[i][k] * B.toArray()[k][j];
              }
              result[i][j] = sum;
            }
          }
          return jStat(result);
        }
        result = [];
        for (i = 0; i < A.rows(); i++) {
          result[i] = [];
          for (j = 0; j < B.cols(); j++) {
            sum = 0;
            for (k = 0; k < A.cols(); k++) {
              sum += A.toArray()[i][k] * B.toArray()[j];
            }
            result[i][j] = sum;
          }
        }
        return jStat(result);
      }
    },

    //regress and regresst to be fixed

    regress: function regress(jMatX,jMatY){
      //print("regressin!");
      //print(jMatX.toArray());
      var innerinv = jStat.xtranspxinv(jMatX);
      //print(innerinv);
      var xtransp = jMatX.transpose();
      var next = jStat.matrixmult(jStat(innerinv),xtransp);
      return jStat.matrixmult(next,jMatY);

    },

    regresst: function regresst(jMatX,jMatY,sides){
      var beta = jStat.regress(jMatX,jMatY);

      var compile = {};
      compile.anova = {};
      var jMatYBar = jStat.jMatYBar(jMatX, beta);
      compile.yBar = jMatYBar;
      var yAverage = jMatY.mean();
      compile.anova.residuals = jStat.residuals(jMatY, jMatYBar);

      compile.anova.ssr = jStat.ssr(jMatYBar, yAverage);
      compile.anova.msr = compile.anova.ssr / (jMatX[0].length - 1);

      compile.anova.sse = jStat.sse(jMatY, jMatYBar);
      compile.anova.mse =
          compile.anova.sse / (jMatY.length - (jMatX[0].length - 1) - 1);

      compile.anova.sst = jStat.sst(jMatY, yAverage);
      compile.anova.mst = compile.anova.sst / (jMatY.length - 1);

      compile.anova.r2 = 1 - (compile.anova.sse / compile.anova.sst);
      if (compile.anova.r2 < 0) compile.anova.r2 = 0;

      compile.anova.fratio = compile.anova.msr / compile.anova.mse;
      compile.anova.pvalue =
          jStat.anovaftest(compile.anova.fratio,
                           jMatX[0].length - 1,
                           jMatY.length - (jMatX[0].length - 1) - 1);

      compile.anova.rmse = Math.sqrt(compile.anova.mse);

      compile.anova.r2adj = 1 - (compile.anova.mse / compile.anova.mst);
      if (compile.anova.r2adj < 0) compile.anova.r2adj = 0;

      compile.stats = new Array(jMatX[0].length);
      var covar = jStat.xtranspxinv(jMatX);
      var sds, ts, ps;

      for(var i=0; i<beta.length;i++){
        sds=Math.sqrt(compile.anova.mse * Math.abs(covar[i][i]));
        ts= Math.abs(beta[i] / sds);
        ps= jStat.ttest(ts, jMatY.length - jMatX[0].length - 1, sides);

        compile.stats[i]=[beta[i], sds, ts, ps];
      }

      compile.regress = beta;
      return compile;
    },

    xtranspx: function xtranspx(jMatX){
      return jStat.matrixmult(jMatX.transpose(),jMatX);
    },


    xtranspxinv: function xtranspxinv(jMatX){
      var inner = jStat.matrixmult(jMatX.transpose(),jMatX);
      var innerinv = jStat.inv(inner);
      return innerinv;
    },

    jMatYBar: function jMatYBar(jMatX, beta) {
      var yBar = jStat.matrixmult(jMatX, beta);
      return new jStat(yBar);
    },

    residuals: function residuals(jMatY, jMatYBar) {
      return jStat.matrixsubtract(jMatY, jMatYBar);
    },

    ssr: function ssr(jMatYBar, yAverage) {
      var ssr = 0;
      for(var i = 0; i < jMatYBar.length; i++) {
        ssr += Math.pow(jMatYBar[i] - yAverage, 2);
      }
      return ssr;
    },

    sse: function sse(jMatY, jMatYBar) {
      var sse = 0;
      for(var i = 0; i < jMatY.length; i++) {
        sse += Math.pow(jMatY[i] - jMatYBar[i], 2);
      }
      return sse;
    },

    sst: function sst(jMatY, yAverage) {
      var sst = 0;
      for(var i = 0; i < jMatY.length; i++) {
        sst += Math.pow(jMatY[i] - yAverage, 2);
      }
      return sst;
    },

    matrixsubtract: function matrixsubtract(A,B){
      var ans = new Array(A.length);
      for(var i=0;i<A.length;i++){
        ans[i] = new Array(A[i].length);
        for(var j=0;j<A[i].length;j++){
          ans[i][j]=A[i][j]-B[i][j];
        }
      }
      return jStat(ans);
    }
  });
    // Make it compatible with previous version.
    jStat.jStat = jStat;

    return jStat;
  });
  });

  var defaultOperator = '=';
  var validSymbols = ['>', '>=', '<', '<=', '=', '<>'];
  var TOKEN_TYPE_OPERATOR = 'operator';
  var TOKEN_TYPE_LITERAL = 'literal';
  var SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];

  var TOKEN_TYPE_OPERATOR_1 = TOKEN_TYPE_OPERATOR;
  var TOKEN_TYPE_LITERAL_1 = TOKEN_TYPE_LITERAL;

  /**
   * Create token which describe passed symbol/value.
   *
   * @param {String} value Value/Symbol to describe.
   * @param {String} type Type of the token 'operator' or 'literal'.
   * @return {Object}
   */
  function createToken(value, type) {
    if (SUPPORTED_TOKENS.indexOf(type) === -1) {
      throw new Error('Unsupported token type: ' + type);
    }

    return {
      value: value,
      type: type,
    };
  }

  /**
   * Tries to cast numeric values to their type passed as a string.
   *
   * @param {*} value
   * @return {*}
   */
  function castValueToCorrectType(value) {
    if (typeof value !== 'string') {
      return value;
    }

    if (/^\d+(\.\d+)?$/.test(value)) {
      value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);
    }

    return value;
  }

  /**
   * Generate stream of tokens from passed expression.
   *
   * @param {String} expression
   * @return {String[]}
   */
  function tokenizeExpression(expression) {
    var expressionLength = expression.length;
    var tokens = [];
    var cursorIndex = 0;
    var processedValue = '';
    var processedSymbol = '';

    while (cursorIndex < expressionLength) {
      var char = expression.charAt(cursorIndex);

      switch (char) {
        case '>':
        case '<':
        case '=':
          processedSymbol = processedSymbol + char;

          if (processedValue.length > 0) {
            tokens.push(processedValue);
            processedValue = '';
          }
        break;
        default:
          if (processedSymbol.length > 0) {
            tokens.push(processedSymbol);
            processedSymbol = '';
          }

          processedValue = processedValue + char;
        break;
      }
      cursorIndex++;
    }

    if (processedValue.length > 0) {
      tokens.push(processedValue);
    }
    if (processedSymbol.length > 0) {
      tokens.push(processedSymbol);
    }

    return tokens;
  }
  /**
   * Analyze and convert tokens to an object which describes their meaning.
   *
   * @param {String[]} tokens
   * @return {Object[]}
   */
  function analyzeTokens(tokens) {
    var literalValue = '';
    var analyzedTokens = [];

    for (var i = 0; i < tokens.length; i++) {
      var token = tokens[i];

      if (i === 0 && validSymbols.indexOf(token) >= 0) {
        analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));
      } else {
        literalValue += token;
      }
    }

    if (literalValue.length > 0) {
      analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));
    }

    if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {
      analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));
    }

    return analyzedTokens;
  }
  /**
   * Compute/Evaluate an expression passed as an array of tokens.
   *
   * @param {Object[]} tokens
   * @return {Boolean}
   */
  function computeExpression(tokens) {
    var values = [];
    var operator;

    for (var i = 0; i < tokens.length; i++) {
      var token = tokens[i];

      switch (token.type) {
        case TOKEN_TYPE_OPERATOR:
          operator = token.value;
        break;
        case TOKEN_TYPE_LITERAL:
          values.push(token.value);
        break;
      }
    }

    return evaluate(values, operator);
  }
  /**
   * Evaluate values based on passed math operator.
   *
   * @param {*} values
   * @param {String} operator
   * @return {Boolean}
   */
  function evaluate(values, operator) {
    var result = false;

    switch (operator) {
      case '>':
        result = values[0] > values[1];
        break;
      case '>=':
        result = values[0] >= values[1];
        break;
      case '<':
        result = values[0] < values[1];
        break;
      case '<=':
        result = values[0] <= values[1];
        break;
      case '=':
        result = values[0] == values[1];
        break;
      case '<>':
        result = values[0] != values[1];
        break;
    }

    return result;
  }

  var parse = function(expression) {
    return analyzeTokens(tokenizeExpression(expression));
  };
  var createToken_1 = createToken;
  var compute = computeExpression;

  var criteriaEval = {
  	TOKEN_TYPE_OPERATOR: TOKEN_TYPE_OPERATOR_1,
  	TOKEN_TYPE_LITERAL: TOKEN_TYPE_LITERAL_1,
  	parse: parse,
  	createToken: createToken_1,
  	compute: compute
  };

  var UNIQUE = function () {
    var result = [];
    for (var i = 0; i < arguments.length; ++i) {
      var hasElement = false;
      var element    = arguments[i];

      // Check if we've already seen this element.
      for (var j = 0; j < result.length; ++j) {
        hasElement = result[j] === element;
        if (hasElement) { break; }
      }

      // If we did not find it, add it to the result.
      if (!hasElement) {
        result.push(element);
      }
    }
    return result;
  };

  var FLATTEN = common.flatten;

  var ARGS2ARRAY = function () {
    return Array.prototype.slice.call(arguments, 0);
  };

  var REFERENCE = function (context, reference) {
    if (!arguments.length) {
      return error$1.error;
    }
    try {
      var path = reference.split('.');
      var result = context;
      for (var i = 0; i < path.length; ++i) {
        var step = path[i];
        if (step[step.length - 1] === ']') {
          var opening = step.indexOf('[');
          var index = step.substring(opening + 1, step.length - 1);
          result = result[step.substring(0, opening)][index];
        } else {
          result = result[step];
        }
      }
      return result;
    } catch (error) {}
  };

  var JOIN = function (array, separator) {
    return array.join(separator);
  };

  var NUMBERS = function () {
    var possibleNumbers = common.flatten(arguments);
    return possibleNumbers.filter(function (el) {
      return typeof el === 'number';
    });
  };

  var miscellaneous = {
  	UNIQUE: UNIQUE,
  	FLATTEN: FLATTEN,
  	ARGS2ARRAY: ARGS2ARRAY,
  	REFERENCE: REFERENCE,
  	JOIN: JOIN,
  	NUMBERS: NUMBERS
  };

  var statistical = createCommonjsModule(function (module, exports) {
  var SQRT2PI = 2.5066282746310002;

  exports.AVEDEV = function() {
    var flatArguments = common.flatten(arguments);
    var flatArgumentsDefined = flatArguments.filter(common.isDefined);
    if (flatArgumentsDefined.length === 0) {
      return error$1.num;
    }
    var range = common.parseNumberArray(flatArgumentsDefined);
    if (range instanceof Error) {
      return range;
    }
    return jstat.sum(jstat(range).subtract(jstat.mean(range)).abs()[0]) / range.length;
  };

  exports.AVERAGE = function() {
    var flatArguments = common.flatten(arguments);
    var flatArgumentsDefined = flatArguments.filter(common.isDefined);
    if (flatArgumentsDefined.length === 0) {
      return error$1.div0;
    }
    var someError = common.anyError.apply(undefined, flatArgumentsDefined);
    if (someError) {
      return someError;
    }
    var range = common.numbers(flatArgumentsDefined);
    var n = range.length;
    var sum = 0;
    var count = 0;
    var result;

    for (var i = 0; i < n; i++) {
      sum += range[i];
      count += 1;
    }
    result = sum / count;

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.AVERAGEA = function() {
    var flatArguments = common.flatten(arguments);
    var flatArgumentsDefined = flatArguments.filter(common.isDefined);
    if (flatArgumentsDefined.length === 0) {
      return error$1.div0;
    }
    var someError = common.anyError.apply(undefined, flatArgumentsDefined);
    if (someError) {
      return someError;
    }
    var range = flatArgumentsDefined;
    var n = range.length;
    var sum = 0;
    var count = 0;
    var result;
    for (var i = 0; i < n; i++) {
      var el = range[i];
      if (typeof el === 'number') {
        sum += el;
      }
      if (el === true) {
        sum++;
      }
      if (el !== null) {
        count++;
      }
    }
    result = sum / count;

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.AVERAGEIF = function(range, criteria, average_range) {
    if (arguments.length <= 1) {
      return error$1.na;
    }
    average_range = average_range || range;
    var flatAverageRange = common.flatten(average_range);
    var flatAverageRangeDefined = flatAverageRange.filter(common.isDefined);
    average_range = common.parseNumberArray(flatAverageRangeDefined);

    range = common.flatten(range);

    if (average_range instanceof Error) {
      return average_range;
    }
    var average_count = 0;
    var result = 0;
    var isWildcard = criteria === void 0 || criteria === '*';
    var tokenizedCriteria = isWildcard ? null : criteriaEval.parse(criteria + '');

    for (var i = 0; i < range.length; i++) {
      var value = range[i];

      if (isWildcard) {
        result += average_range[i];
        average_count++;
      } else {
        var tokens = [criteriaEval.createToken(value, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

        if (criteriaEval.compute(tokens)) {
          result += average_range[i];
          average_count++;
        }
      }
    }

    return result / average_count;
  };

  exports.AVERAGEIFS = function() {
    // Does not work with multi dimensional ranges yet!
    // http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx
    var args = common.argsToArray(arguments);
    var criteriaLength = (args.length - 1) / 2;
    var range = common.flatten(args[0]);
    var count = 0;
    var result = 0;

    for (var i = 0; i < range.length; i++) {
      var isMeetCondition = false;

      for (var j = 0; j < criteriaLength; j++) {
        var value = args[2 * j + 1][i];
        var criteria = args[2 * j + 2];
        var isWildcard = criteria === void 0 || criteria === '*';
        var computedResult = false;

        if (isWildcard) {
          computedResult = true;
        } else {
          var tokenizedCriteria = criteriaEval.parse(criteria + '');
          var tokens = [criteriaEval.createToken(value, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

          computedResult = criteriaEval.compute(tokens);
        }

        // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition
        if (!computedResult) {
          isMeetCondition = false;
          break;
        }

        isMeetCondition = true;
      }

      if (isMeetCondition) {
        result += range[i];
        count++;
      }
    }

    var average = result / count;

    if (isNaN(average)) {
      return 0;
    } else {
      return average;
    }
  };

  exports.BETA = {};

  exports.BETA.DIST = function(x, alpha, beta, cumulative, A, B) {
    if (arguments.length < 4) {
      return error$1.value;
    }

    A = (A === undefined) ? 0 : A;
    B = (B === undefined) ? 1 : B;

    x = common.parseNumber(x);
    alpha = common.parseNumber(alpha);
    beta = common.parseNumber(beta);
    A = common.parseNumber(A);
    B = common.parseNumber(B);
    if (common.anyIsError(x, alpha, beta, A, B)) {
      return error$1.value;
    }

    x = (x - A) / (B - A);
    return (cumulative) ? jstat.beta.cdf(x, alpha, beta) : jstat.beta.pdf(x, alpha, beta);
  };

  exports.BETA.INV = function(probability, alpha, beta, A, B) {
    A = (A === undefined) ? 0 : A;
    B = (B === undefined) ? 1 : B;

    probability = common.parseNumber(probability);
    alpha = common.parseNumber(alpha);
    beta = common.parseNumber(beta);
    A = common.parseNumber(A);
    B = common.parseNumber(B);
    if (common.anyIsError(probability, alpha, beta, A, B)) {
      return error$1.value;
    }

    return jstat.beta.inv(probability, alpha, beta) * (B - A) + A;
  };

  exports.BINOM = {};

  exports.BINOM.DIST = function(successes, trials, probability, cumulative) {
    successes = common.parseNumber(successes);
    trials = common.parseNumber(trials);
    probability = common.parseNumber(probability);
    cumulative = common.parseNumber(cumulative);
    if (common.anyIsError(successes, trials, probability, cumulative)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.binomial.cdf(successes, trials, probability) : jstat.binomial.pdf(successes, trials, probability);
  };

  exports.BINOM.DIST.RANGE = function(trials, probability, successes, successes2) {
    successes2 = (successes2 === undefined) ? successes : successes2;

    trials = common.parseNumber(trials);
    probability = common.parseNumber(probability);
    successes = common.parseNumber(successes);
    successes2 = common.parseNumber(successes2);
    if (common.anyIsError(trials, probability, successes, successes2)) {
      return error$1.value;
    }

    var result = 0;
    for (var i = successes; i <= successes2; i++) {
      result += mathTrig.COMBIN(trials, i) * Math.pow(probability, i) * Math.pow(1 - probability, trials - i);
    }
    return result;
  };

  exports.BINOM.INV = function(trials, probability, alpha) {
    trials = common.parseNumber(trials);
    probability = common.parseNumber(probability);
    alpha = common.parseNumber(alpha);
    if (common.anyIsError(trials, probability, alpha)) {
      return error$1.value;
    }

    var x = 0;
    while (x <= trials) {
      if (jstat.binomial.cdf(x, trials, probability) >= alpha) {
        return x;
      }
      x++;
    }
  };

  exports.CHISQ = {};

  exports.CHISQ.DIST = function(x, k, cumulative) {
    x = common.parseNumber(x);
    k = common.parseNumber(k);
    if (common.anyIsError(x, k)) {
      return error$1.value;
    }

    return (cumulative) ? jstat.chisquare.cdf(x, k) : jstat.chisquare.pdf(x, k);
  };

  exports.CHISQ.DIST.RT = function(x, k) {
    if (!x | !k) {
      return error$1.na;
    }

    if (x < 1 || k > Math.pow(10, 10)) {
      return error$1.num;
    }

    if ((typeof x !== 'number') || (typeof k !== 'number')) {
      return error$1.value;
    }

    return 1 -  jstat.chisquare.cdf(x, k);
  };

  exports.CHISQ.INV = function(probability, k) {
    probability = common.parseNumber(probability);
    k = common.parseNumber(k);
    if (common.anyIsError(probability, k)) {
      return error$1.value;
    }
    return jstat.chisquare.inv(probability, k);
  };

  exports.CHISQ.INV.RT = function(p, k) {
    if (!p | !k) {
      return error$1.na;
    }

    if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {
      return error$1.num;
    }

    if ((typeof p !== 'number') || (typeof k !== 'number')) {
      return error$1.value;
    }

    return jstat.chisquare.inv(1.0 - p, k);
  };

  exports.CHISQ.TEST = function(observed, expected) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {
      return error$1.value;
    }

    if (observed.length !== expected.length) {
      return error$1.value;
    }

    if (observed[0] && expected[0] &&
      observed[0].length !== expected[0].length) {
      return error$1.value;
    }

    var row = observed.length;
    var tmp, i, j;

    // Convert single-dimension array into two-dimension array
    for (i = 0; i < row; i ++) {
      if (!(observed[i] instanceof Array)) {
        tmp = observed[i];
        observed[i] = [];
        observed[i].push(tmp);
      }
      if (!(expected[i] instanceof Array)) {
        tmp = expected[i];
        expected[i] = [];
        expected[i].push(tmp);
      }
    }

    var col = observed[0].length;
    var dof = (col === 1) ? row-1 : (row-1)*(col-1);
    var xsqr = 0;
    var Pi =Math.PI;

    for (i = 0; i < row; i ++) {
      for (j = 0; j < col; j ++) {
        xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];
      }
    }

    // Get independency by X square and its degree of freedom
    function ChiSq(xsqr, dof) {
      var p = Math.exp(-0.5 * xsqr);
      if((dof%2) === 1) {
        p = p * Math.sqrt(2 * xsqr/Pi);
      }
      var k = dof;
      while(k >= 2) {
        p = p * xsqr/k;
        k = k - 2;
      }
      var t = p;
      var a = dof;
      while (t > 0.0000000001*p) {
        a = a + 2;
        t = t * xsqr/a;
        p = p + t;
      }
      return 1-p;
    }

    return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;
  };

  exports.COLUMN = function(matrix, index) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (index < 0) {
      return error$1.num;
    }

    if (!(matrix instanceof Array) || (typeof index !== 'number')) {
      return error$1.value;
    }

    if (matrix.length === 0) {
      return undefined;
    }

    return jstat.col(matrix, index);
  };

  exports.COLUMNS = function(matrix) {
    if (arguments.length !== 1) {
      return error$1.na;
    }

    if (!(matrix instanceof Array)) {
      return error$1.value;
    }

    if (matrix.length === 0) {
      return 0;
    }

    return jstat.cols(matrix);
  };

  exports.CONFIDENCE = {};

  exports.CONFIDENCE.NORM = function(alpha, sd, n) {
    alpha = common.parseNumber(alpha);
    sd = common.parseNumber(sd);
    n = common.parseNumber(n);
    if (common.anyIsError(alpha, sd, n)) {
      return error$1.value;
    }
    return jstat.normalci(1, alpha, sd, n)[1] - 1;
  };

  exports.CONFIDENCE.T = function(alpha, sd, n) {
    alpha = common.parseNumber(alpha);
    sd = common.parseNumber(sd);
    n = common.parseNumber(n);
    if (common.anyIsError(alpha, sd, n)) {
      return error$1.value;
    }
    return jstat.tci(1, alpha, sd, n)[1] - 1;
  };

  exports.CORREL = function(array1, array2) {
    array1 = common.parseNumberArray(common.flatten(array1));
    array2 = common.parseNumberArray(common.flatten(array2));
    if (common.anyIsError(array1, array2)) {
      return error$1.value;
    }
    return jstat.corrcoeff(array1, array2);
  };

  exports.COUNT = function() {
    var flatArguments = common.flatten(arguments);
    return common.numbers(flatArguments).length;
  };

  exports.COUNTA = function() {
    var flatArguments = common.flatten(arguments);
    return flatArguments.length - exports.COUNTBLANK(flatArguments);
  };

  exports.COUNTIN = function (range, value) {
    var result = 0;

    range = common.flatten(range);

    for (var i = 0; i < range.length; i++) {
      if (range[i] === value) {
        result++;
      }
    }
    return result;
  };


  exports.COUNTBLANK = function() {
    var range = common.flatten(arguments);
    var blanks = 0;
    var element;
    for (var i = 0; i < range.length; i++) {
      element = range[i];
      if (element === undefined || element === null || element === '') {
        blanks++;
      }
    }
    return blanks;
  };

  exports.COUNTIF = function(range, criteria) {
    range = common.flatten(range);

    var isWildcard = criteria === void 0 || criteria === '*';

    if (isWildcard) {
      return range.length;
    }

    var matches = 0;
    var tokenizedCriteria = criteriaEval.parse(criteria + '');

    for (var i = 0; i < range.length; i++) {
      var value = range[i];
      var tokens = [criteriaEval.createToken(value, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

      if (criteriaEval.compute(tokens)) {
        matches++;
      }
    }

    return matches;
  };

  exports.COUNTIFS = function() {
    var args = common.argsToArray(arguments);
    var results = new Array(common.flatten(args[0]).length);

    for (var i = 0; i < results.length; i++) {
      results[i] = true;
    }
    for (i = 0; i < args.length; i += 2) {
      var range = common.flatten(args[i]);
      var criteria = args[i + 1];
      var isWildcard = criteria === void 0 || criteria === '*';

      if (!isWildcard) {
        var tokenizedCriteria = criteriaEval.parse(criteria + '');

        for (var j = 0; j < range.length; j++) {
          var value = range[j];
          var tokens = [criteriaEval.createToken(value, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

          results[j] = results[j] && criteriaEval.compute(tokens);
        }
      }
    }
    var result = 0;
    for (i = 0; i < results.length; i++) {
      if (results[i]) {
        result++;
      }
    }

    return result;
  };

  exports.COUNTUNIQUE = function () {
    return miscellaneous.UNIQUE.apply(null, common.flatten(arguments)).length;
  };

  exports.COVARIANCE = {};

  exports.COVARIANCE.P = function(array1, array2) {
    array1 = common.parseNumberArray(common.flatten(array1));
    array2 = common.parseNumberArray(common.flatten(array2));
    if (common.anyIsError(array1, array2)) {
      return error$1.value;
    }
    var mean1 = jstat.mean(array1);
    var mean2 = jstat.mean(array2);
    var result = 0;
    var n = array1.length;
    for (var i = 0; i < n; i++) {
      result += (array1[i] - mean1) * (array2[i] - mean2);
    }
    return result / n;
  };

  exports.COVARIANCE.S = function(array1, array2) {
    array1 = common.parseNumberArray(common.flatten(array1));
    array2 = common.parseNumberArray(common.flatten(array2));
    if (common.anyIsError(array1, array2)) {
      return error$1.value;
    }
    return jstat.covariance(array1, array2);
  };

  exports.DEVSQ = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var mean = jstat.mean(range);
    var result = 0;
    for (var i = 0; i < range.length; i++) {
      result += Math.pow((range[i] - mean), 2);
    }
    return result;
  };

  exports.EXPON = {};

  exports.EXPON.DIST = function(x, lambda, cumulative) {
    x = common.parseNumber(x);
    lambda = common.parseNumber(lambda);
    if (common.anyIsError(x, lambda)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.exponential.cdf(x, lambda) : jstat.exponential.pdf(x, lambda);
  };

  exports.F = {};

  exports.F.DIST = function(x, d1, d2, cumulative) {
    x = common.parseNumber(x);
    d1 = common.parseNumber(d1);
    d2 = common.parseNumber(d2);
    if (common.anyIsError(x, d1, d2)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.centralF.cdf(x, d1, d2) : jstat.centralF.pdf(x, d1, d2);
  };

  exports.F.DIST.RT = function(x, d1, d2) {
    if (arguments.length !== 3) {
      return error$1.na;
    }

    if (x < 0 || d1 < 1 || d2 < 1) {
      return error$1.num;
    }

    if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {
      return error$1.value;
    }

    return 1 - jstat.centralF.cdf(x, d1, d2);
  };

  exports.F.INV = function(probability, d1, d2) {
    probability = common.parseNumber(probability);
    d1 = common.parseNumber(d1);
    d2 = common.parseNumber(d2);
    if (common.anyIsError(probability, d1, d2)) {
      return error$1.value;
    }
    if (probability <= 0.0 || probability > 1.0) {
      return error$1.num;
    }

    return jstat.centralF.inv(probability, d1, d2);
  };

  exports.F.INV.RT = function(p, d1, d2) {
    if (arguments.length !== 3) {
      return error$1.na;
    }

    if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {
      return error$1.num;
    }

    if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {
      return error$1.value;
    }

    return jstat.centralF.inv(1.0 - p, d1, d2);
  };

  exports.F.TEST = function(array1, array2) {
    if (!array1 || !array2) {
      return error$1.na;
    }

    if (!(array1 instanceof Array) || !(array2 instanceof Array)) {
      return error$1.na;
    }

    if (array1.length < 2 || array2.length < 2) {
      return error$1.div0;
    }

    var sumOfSquares = function(values, x1) {
      var sum = 0;
      for (var i = 0; i < values.length; i++) {
        sum +=Math.pow((values[i] - x1), 2);
      }
      return sum;
    };

    var x1 = mathTrig.SUM(array1) / array1.length;
    var x2 = mathTrig.SUM(array2) / array2.length;
    var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);
    var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);

    return sum1 / sum2;
  };

  exports.FISHER = function(x) {
    x = common.parseNumber(x);
    if (x instanceof Error) {
      return x;
    }
    return Math.log((1 + x) / (1 - x)) / 2;
  };

  exports.FISHERINV = function(y) {
    y = common.parseNumber(y);
    if (y instanceof Error) {
      return y;
    }
    var e2y = Math.exp(2 * y);
    return (e2y - 1) / (e2y + 1);
  };

  exports.FORECAST = function(x, data_y, data_x) {
    x = common.parseNumber(x);
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(x, data_y, data_x)) {
      return error$1.value;
    }
    var xmean = jstat.mean(data_x);
    var ymean = jstat.mean(data_y);
    var n = data_x.length;
    var num = 0;
    var den = 0;
    for (var i = 0; i < n; i++) {
      num += (data_x[i] - xmean) * (data_y[i] - ymean);
      den += Math.pow(data_x[i] - xmean, 2);
    }
    var b = num / den;
    var a = ymean - b * xmean;
    return a + b * x;
  };

  exports.FREQUENCY = function(data, bins) {
    data = common.parseNumberArray(common.flatten(data));
    bins = common.parseNumberArray(common.flatten(bins));
    if (common.anyIsError(data, bins)) {
      return error$1.value;
    }
    var n = data.length;
    var b = bins.length;
    var r = [];
    for (var i = 0; i <= b; i++) {
      r[i] = 0;
      for (var j = 0; j < n; j++) {
        if (i === 0) {
          if (data[j] <= bins[0]) {
            r[0] += 1;
          }
        } else if (i < b) {
          if (data[j] > bins[i - 1] && data[j] <= bins[i]) {
            r[i] += 1;
          }
        } else if (i === b) {
          if (data[j] > bins[b - 1]) {
            r[b] += 1;
          }
        }
      }
    }
    return r;
  };


  exports.GAMMA = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    if (number === 0) {
      return error$1.num;
    }

    if (parseInt(number, 10) === number && number < 0) {
      return error$1.num;
    }

    return jstat.gammafn(number);
  };

  exports.GAMMA.DIST = function(value, alpha, beta, cumulative) {
    if (arguments.length !== 4) {
      return error$1.na;
    }

    if (value < 0 || alpha <= 0 || beta <= 0) {
      return error$1.value;
    }

    if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {
      return error$1.value;
    }

    return cumulative ? jstat.gamma.cdf(value, alpha, beta, true) : jstat.gamma.pdf(value, alpha, beta, false);
  };

  exports.GAMMA.INV = function(probability, alpha, beta) {
    if (arguments.length !== 3) {
      return error$1.na;
    }

    if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {
      return error$1.num;
    }

    if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {
      return error$1.value;
    }

    return jstat.gamma.inv(probability, alpha, beta);
  };

  exports.GAMMALN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return jstat.gammaln(number);
  };

  exports.GAMMALN.PRECISE = function(x) {
    if (arguments.length !== 1) {
      return error$1.na;
    }

    if (x <= 0) {
      return error$1.num;
    }

    if (typeof x !== 'number') {
      return error$1.value;
    }

    return jstat.gammaln(x);
  };

  exports.GAUSS = function(z) {
    z = common.parseNumber(z);
    if (z instanceof Error) {
      return z;
    }
    return jstat.normal.cdf(z, 0, 1) - 0.5;
  };

  exports.GEOMEAN = function() {
    var args = common.parseNumberArray(common.flatten(arguments));
    if (args instanceof Error) {
      return args;
    }
    return jstat.geomean(args);
  };

  exports.GROWTH = function(known_y, known_x, new_x, use_const) {
    // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)

    known_y = common.parseNumberArray(known_y);
    if (known_y instanceof Error) {
      return known_y;
    }

    // Default values for optional parameters:
    var i;
    if (known_x === undefined) {
      known_x = [];
      for (i = 1; i <= known_y.length; i++) {
        known_x.push(i);
      }
    }
    if (new_x === undefined) {
      new_x = [];
      for (i = 1; i <= known_y.length; i++) {
        new_x.push(i);
      }
    }

    known_x = common.parseNumberArray(known_x);
    new_x = common.parseNumberArray(new_x);
    if (common.anyIsError(known_x, new_x)) {
      return error$1.value;
    }


    if (use_const === undefined) {
      use_const = true;
    }

    // Calculate sums over the data:
    var n = known_y.length;
    var avg_x = 0;
    var avg_y = 0;
    var avg_xy = 0;
    var avg_xx = 0;
    for (i = 0; i < n; i++) {
      var x = known_x[i];
      var y = Math.log(known_y[i]);
      avg_x += x;
      avg_y += y;
      avg_xy += x * y;
      avg_xx += x * x;
    }
    avg_x /= n;
    avg_y /= n;
    avg_xy /= n;
    avg_xx /= n;

    // Compute linear regression coefficients:
    var beta;
    var alpha;
    if (use_const) {
      beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);
      alpha = avg_y - beta * avg_x;
    } else {
      beta = avg_xy / avg_xx;
      alpha = 0;
    }

    // Compute and return result array:
    var new_y = [];
    for (i = 0; i < new_x.length; i++) {
      new_y.push(Math.exp(alpha + beta * new_x[i]));
    }
    return new_y;
  };

  exports.HARMEAN = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var n = range.length;
    var den = 0;
    for (var i = 0; i < n; i++) {
      den += 1 / range[i];
    }
    return n / den;
  };

  exports.HYPGEOM = {};

  exports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    M = common.parseNumber(M);
    N = common.parseNumber(N);
    if (common.anyIsError(x, n, M, N)) {
      return error$1.value;
    }

    function pdf(x, n, M, N) {
      return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);
    }

    function cdf(x, n, M, N) {
      var result = 0;
      for (var i = 0; i <= x; i++) {
        result += pdf(i, n, M, N);
      }
      return result;
    }

    return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);
  };

  exports.INTERCEPT = function(known_y, known_x) {
    known_y = common.parseNumberArray(known_y);
    known_x = common.parseNumberArray(known_x);
    if (common.anyIsError(known_y, known_x)) {
      return error$1.value;
    }
    if (known_y.length !== known_x.length) {
      return error$1.na;
    }
    return exports.FORECAST(0, known_y, known_x);
  };

  exports.KURT = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var mean = jstat.mean(range);
    var n = range.length;
    var sigma = 0;
    for (var i = 0; i < n; i++) {
      sigma += Math.pow(range[i] - mean, 4);
    }
    sigma = sigma / Math.pow(jstat.stdev(range, true), 4);
    return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));
  };

  exports.LARGE = function(range, k) {
    range = common.parseNumberArray(common.flatten(range));
    k = common.parseNumber(k);
    if (common.anyIsError(range, k)) {
      return range;
    }

    if(k < 0 || range.length < k){
      return error$1.value;
    }

    return range.sort(function(a, b) {
      return b - a;
    })[k - 1];
  };

  exports.LINEST = function(data_y, data_x) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(data_y, data_x)) {
      return error$1.value;
    }
    var ymean = jstat.mean(data_y);
    var xmean = jstat.mean(data_x);
    var n = data_x.length;
    var num = 0;
    var den = 0;
    for (var i = 0; i < n; i++) {
      num += (data_x[i] - xmean) * (data_y[i] - ymean);
      den += Math.pow(data_x[i] - xmean, 2);
    }
    var m = num / den;
    var b = ymean - m * xmean;
    return [m, b];
  };

  // According to Microsoft:
  // http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx
  // LOGEST returns are based on the following linear model:
  // ln y = x1 ln m1 + ... + xn ln mn + ln b
  exports.LOGEST = function(data_y, data_x) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(data_y, data_x)) {
      return error$1.value;
    }
    for (var i = 0; i < data_y.length; i ++) {
      data_y[i] = Math.log(data_y[i]);
    }

    var result = exports.LINEST(data_y, data_x);
    result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;
    result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;
    return result;
  };

  exports.LOGNORM = {};

  exports.LOGNORM.DIST = function(x, mean, sd, cumulative) {
    x = common.parseNumber(x);
    mean = common.parseNumber(mean);
    sd = common.parseNumber(sd);
    if (common.anyIsError(x, mean, sd)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.lognormal.cdf(x, mean, sd) : jstat.lognormal.pdf(x, mean, sd);
  };

  exports.LOGNORM.INV = function(probability, mean, sd) {
    probability = common.parseNumber(probability);
    mean = common.parseNumber(mean);
    sd = common.parseNumber(sd);
    if (common.anyIsError(probability, mean, sd)) {
      return error$1.value;
    }
    return jstat.lognormal.inv(probability, mean, sd);
  };

  exports.MAX = function() {
    var flatArguments = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, flatArguments);
    if (someError) {
      return someError;
    }
    var range = common.numbers(flatArguments);
    return (range.length === 0) ? 0 : Math.max.apply(Math, range);
  };

  exports.MAXA = function() {
    var flatArguments = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, flatArguments);
    if (someError) {
      return someError;
    }
    var range = common.arrayValuesToNumbers(flatArguments);
    range = range.map(function (value) { return (value === undefined || value === null) ? 0 : value; });
    return (range.length === 0) ? 0 : Math.max.apply(Math, range);
  };

  exports.MEDIAN = function() {
    var flatArguments = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, flatArguments);
    if (someError) {
      return someError;
    }
    var range = common.arrayValuesToNumbers(flatArguments);
    var result = jstat.median(range);

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.MIN = function() {
    var flatArguments = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, flatArguments);
    if (someError) {
      return someError;
    }
    var range = common.numbers(flatArguments);
    return (range.length === 0) ? 0 : Math.min.apply(Math, range);
  };

  exports.MINA = function() {
    var flatArguments = common.flatten(arguments);
    var someError = common.anyError.apply(undefined, flatArguments);
    if (someError) {
      return someError;
    }
    var range = common.arrayValuesToNumbers(flatArguments);
    range = range.map(function (value) { return (value === undefined || value === null) ? 0 : value; });
    return (range.length === 0) ? 0 : Math.min.apply(Math, range);
  };

  exports.MODE = {};

  exports.MODE.MULT = function() {
    // Credits: Ronan
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var n = range.length;
    var count = {};
    var maxItems = [];
    var max = 0;
    var currentItem;

    for (var i = 0; i < n; i++) {
      currentItem = range[i];
      count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;
      if (count[currentItem] > max) {
        max = count[currentItem];
        maxItems = [];
      }
      if (count[currentItem] === max) {
        maxItems[maxItems.length] = currentItem;
      }
    }
    return maxItems;
  };

  exports.MODE.SNGL = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    return exports.MODE.MULT(range).sort(function(a, b) {
      return a - b;
    })[0];
  };

  exports.NEGBINOM = {};

  exports.NEGBINOM.DIST = function(k, r, p, cumulative) {
    k = common.parseNumber(k);
    r = common.parseNumber(r);
    p = common.parseNumber(p);
    if (common.anyIsError(k, r, p)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.negbin.cdf(k, r, p) : jstat.negbin.pdf(k, r, p);
  };

  exports.NORM = {};

  exports.NORM.DIST = function(x, mean, sd, cumulative) {
    x = common.parseNumber(x);
    mean = common.parseNumber(mean);
    sd = common.parseNumber(sd);
    if (common.anyIsError(x, mean, sd)) {
      return error$1.value;
    }
    if (sd <= 0) {
      return error$1.num;
    }

    // Return normal distribution computed by jStat [http://jstat.org]
    return (cumulative) ? jstat.normal.cdf(x, mean, sd) : jstat.normal.pdf(x, mean, sd);
  };

  exports.NORM.INV = function(probability, mean, sd) {
    probability = common.parseNumber(probability);
    mean = common.parseNumber(mean);
    sd = common.parseNumber(sd);
    if (common.anyIsError(probability, mean, sd)) {
      return error$1.value;
    }
    return jstat.normal.inv(probability, mean, sd);
  };

  exports.NORM.S = {};

  exports.NORM.S.DIST = function(z, cumulative) {
    z = common.parseNumber(z);
    if (z instanceof Error) {
      return error$1.value;
    }
    return (cumulative) ? jstat.normal.cdf(z, 0, 1) : jstat.normal.pdf(z, 0, 1);
  };

  exports.NORM.S.INV = function(probability) {
    probability = common.parseNumber(probability);
    if (probability instanceof Error) {
      return error$1.value;
    }
    return jstat.normal.inv(probability, 0, 1);
  };

  exports.PEARSON = function(data_x, data_y) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(data_y, data_x)) {
      return error$1.value;
    }
    var xmean = jstat.mean(data_x);
    var ymean = jstat.mean(data_y);
    var n = data_x.length;
    var num = 0;
    var den1 = 0;
    var den2 = 0;
    for (var i = 0; i < n; i++) {
      num += (data_x[i] - xmean) * (data_y[i] - ymean);
      den1 += Math.pow(data_x[i] - xmean, 2);
      den2 += Math.pow(data_y[i] - ymean, 2);
    }
    return num / Math.sqrt(den1 * den2);
  };

  exports.PERCENTILE = {};

  exports.PERCENTILE.EXC = function(array, k) {
    array = common.parseNumberArray(common.flatten(array));
    k = common.parseNumber(k);
    if (common.anyIsError(array, k)) {
      return error$1.value;
    }
    array = array.sort(function(a, b) {
      {
        return a - b;
      }
    });
    var n = array.length;
    if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {
      return error$1.num;
    }
    var l = k * (n + 1) - 1;
    var fl = Math.floor(l);
    return common.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));
  };

  exports.PERCENTILE.INC = function(array, k) {
    array = common.parseNumberArray(common.flatten(array));
    k = common.parseNumber(k);
    if (common.anyIsError(array, k)) {
      return error$1.value;
    }
    array = array.sort(function(a, b) {
      return a - b;
    });
    var n = array.length;
    var l = k * (n - 1);
    var fl = Math.floor(l);
    return common.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));
  };

  exports.PERCENTRANK = {};

  exports.PERCENTRANK.EXC = function(array, x, significance) {
    significance = (significance === undefined) ? 3 : significance;
    array = common.parseNumberArray(common.flatten(array));
    x = common.parseNumber(x);
    significance = common.parseNumber(significance);
    if (common.anyIsError(array, x, significance)) {
      return error$1.value;
    }
    array = array.sort(function(a, b) {
      return a - b;
    });
    var uniques = miscellaneous.UNIQUE.apply(null, array);
    var n = array.length;
    var m = uniques.length;
    var power = Math.pow(10, significance);
    var result = 0;
    var match = false;
    var i = 0;
    while (!match && i < m) {
      if (x === uniques[i]) {
        result = (array.indexOf(uniques[i]) + 1) / (n + 1);
        match = true;
      } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {
        result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);
        match = true;
      }
      i++;
    }
    return Math.floor(result * power) / power;
  };

  exports.PERCENTRANK.INC = function(array, x, significance) {
    significance = (significance === undefined) ? 3 : significance;
    array = common.parseNumberArray(common.flatten(array));
    x = common.parseNumber(x);
    significance = common.parseNumber(significance);
    if (common.anyIsError(array, x, significance)) {
      return error$1.value;
    }
    array = array.sort(function(a, b) {
      return a - b;
    });
    var uniques = miscellaneous.UNIQUE.apply(null, array);
    var n = array.length;
    var m = uniques.length;
    var power = Math.pow(10, significance);
    var result = 0;
    var match = false;
    var i = 0;
    while (!match && i < m) {
      if (x === uniques[i]) {
        result = array.indexOf(uniques[i]) / (n - 1);
        match = true;
      } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {
        result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);
        match = true;
      }
      i++;
    }
    return Math.floor(result * power) / power;
  };

  exports.PERMUT = function(number, number_chosen) {
    number = common.parseNumber(number);
    number_chosen = common.parseNumber(number_chosen);
    if (common.anyIsError(number, number_chosen)) {
      return error$1.value;
    }
    return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);
  };

  exports.PERMUTATIONA = function(number, number_chosen) {
    number = common.parseNumber(number);
    number_chosen = common.parseNumber(number_chosen);
    if (common.anyIsError(number, number_chosen)) {
      return error$1.value;
    }
    return Math.pow(number, number_chosen);
  };

  exports.PHI = function(x) {
    x = common.parseNumber(x);
    if (x instanceof Error) {
      return error$1.value;
    }
    return Math.exp(-0.5 * x * x) / SQRT2PI;
  };

  exports.POISSON = {};

  exports.POISSON.DIST = function(x, mean, cumulative) {
    x = common.parseNumber(x);
    mean = common.parseNumber(mean);
    if (common.anyIsError(x, mean)) {
      return error$1.value;
    }
    return (cumulative) ? jstat.poisson.cdf(x, mean) : jstat.poisson.pdf(x, mean);
  };

  exports.PROB = function(range, probability, lower, upper) {
    if (lower === undefined) {
      return 0;
    }
    upper = (upper === undefined) ? lower : upper;

    range = common.parseNumberArray(common.flatten(range));
    probability = common.parseNumberArray(common.flatten(probability));
    lower = common.parseNumber(lower);
    upper = common.parseNumber(upper);
    if (common.anyIsError(range, probability, lower, upper)) {
      return error$1.value;
    }

    if (lower === upper) {
      return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;
    }

    var sorted = range.sort(function(a, b) {
      return a - b;
    });
    var n = sorted.length;
    var result = 0;
    for (var i = 0; i < n; i++) {
      if (sorted[i] >= lower && sorted[i] <= upper) {
        result += probability[range.indexOf(sorted[i])];
      }
    }
    return result;
  };

  exports.QUARTILE = {};

  exports.QUARTILE.EXC = function(range, quart) {
    range = common.parseNumberArray(common.flatten(range));
    quart = common.parseNumber(quart);
    if (common.anyIsError(range, quart)) {
      return error$1.value;
    }
    switch (quart) {
      case 1:
        return exports.PERCENTILE.EXC(range, 0.25);
      case 2:
        return exports.PERCENTILE.EXC(range, 0.5);
      case 3:
        return exports.PERCENTILE.EXC(range, 0.75);
      default:
        return error$1.num;
    }
  };

  exports.QUARTILE.INC = function(range, quart) {
    range = common.parseNumberArray(common.flatten(range));
    quart = common.parseNumber(quart);
    if (common.anyIsError(range, quart)) {
      return error$1.value;
    }
    switch (quart) {
      case 1:
        return exports.PERCENTILE.INC(range, 0.25);
      case 2:
        return exports.PERCENTILE.INC(range, 0.5);
      case 3:
        return exports.PERCENTILE.INC(range, 0.75);
      default:
        return error$1.num;
    }
  };

  exports.RANK = {};

  exports.RANK.AVG = function(number, range, order) {
    number = common.parseNumber(number);
    range = common.parseNumberArray(common.flatten(range));
    if (common.anyIsError(number, range)) {
      return error$1.value;
    }
    range = common.flatten(range);
    order = order || false;
    var sort = (order) ? function(a, b) {
      return a - b;
    } : function(a, b) {
      return b - a;
    };
    range = range.sort(sort);

    var length = range.length;
    var count = 0;
    for (var i = 0; i < length; i++) {
      if (range[i] === number) {
        count++;
      }
    }

    return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;
  };

  exports.RANK.EQ = function(number, range, order) {
    number = common.parseNumber(number);
    range = common.parseNumberArray(common.flatten(range));
    if (common.anyIsError(number, range)) {
      return error$1.value;
    }
    order = order || false;
    var sort = (order) ? function(a, b) {
      return a - b;
    } : function(a, b) {
      return b - a;
    };
    range = range.sort(sort);
    return range.indexOf(number) + 1;
  };

  exports.ROW = function(matrix, index) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (index < 0) {
      return error$1.num;
    }

    if (!(matrix instanceof Array) || (typeof index !== 'number')) {
      return error$1.value;
    }

    if (matrix.length === 0) {
      return undefined;
    }

    return jstat.row(matrix, index);
  };

  exports.ROWS = function(matrix) {
    if (arguments.length !== 1) {
      return error$1.na;
    }

    if (!(matrix instanceof Array)) {
      return error$1.value;
    }

    if (matrix.length === 0) {
      return 0;
    }

    return jstat.rows(matrix);
  };

  exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that
    data_x = common.parseNumberArray(common.flatten(data_x));
    data_y = common.parseNumberArray(common.flatten(data_y));
    if (common.anyIsError(data_x, data_y)) {
      return error$1.value;
    }
    return Math.pow(exports.PEARSON(data_x, data_y), 2);
  };

  exports.SKEW = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var mean = jstat.mean(range);
    var n = range.length;
    var sigma = 0;
    for (var i = 0; i < n; i++) {
      sigma += Math.pow(range[i] - mean, 3);
    }
    return n * sigma / ((n - 1) * (n - 2) * Math.pow(jstat.stdev(range, true), 3));
  };

  exports.SKEW.P = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var mean = jstat.mean(range);
    var n = range.length;
    var m2 = 0;
    var m3 = 0;
    for (var i = 0; i < n; i++) {
      m3 += Math.pow(range[i] - mean, 3);
      m2 += Math.pow(range[i] - mean, 2);
    }
    m3 = m3 / n;
    m2 = m2 / n;
    return m3 / Math.pow(m2, 3 / 2);
  };

  exports.SLOPE = function(data_y, data_x) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(data_y, data_x)) {
      return error$1.value;
    }
    var xmean = jstat.mean(data_x);
    var ymean = jstat.mean(data_y);
    var n = data_x.length;
    var num = 0;
    var den = 0;
    for (var i = 0; i < n; i++) {
      num += (data_x[i] - xmean) * (data_y[i] - ymean);
      den += Math.pow(data_x[i] - xmean, 2);
    }
    return num / den;
  };

  exports.SMALL = function(range, k) {
    range = common.parseNumberArray(common.flatten(range));
    k = common.parseNumber(k);
    if (common.anyIsError(range, k)) {
      return range;
    }
    return range.sort(function(a, b) {
      return a - b;
    })[k - 1];
  };

  exports.STANDARDIZE = function(x, mean, sd) {
    x = common.parseNumber(x);
    mean = common.parseNumber(mean);
    sd = common.parseNumber(sd);
    if (common.anyIsError(x, mean, sd)) {
      return error$1.value;
    }
    return (x - mean) / sd;
  };

  exports.STDEV = {};

  exports.STDEV.P = function() {
    var v = exports.VAR.P.apply(this, arguments);
    var result = Math.sqrt(v);

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.STDEV.S = function() {
    var v = exports.VAR.S.apply(this, arguments);
    var result = Math.sqrt(v);

    return result;
  };

  exports.STDEVA = function() {
    var v = exports.VARA.apply(this, arguments);
    var result = Math.sqrt(v);

    return result;
  };

  exports.STDEVPA = function() {
    var v = exports.VARPA.apply(this, arguments);
    var result = Math.sqrt(v);

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };


  exports.STEYX = function(data_y, data_x) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    if (common.anyIsError(data_y, data_x)) {
      return error$1.value;
    }
    var xmean = jstat.mean(data_x);
    var ymean = jstat.mean(data_y);
    var n = data_x.length;
    var lft = 0;
    var num = 0;
    var den = 0;
    for (var i = 0; i < n; i++) {
      lft += Math.pow(data_y[i] - ymean, 2);
      num += (data_x[i] - xmean) * (data_y[i] - ymean);
      den += Math.pow(data_x[i] - xmean, 2);
    }
    return Math.sqrt((lft - num * num / den) / (n - 2));
  };

  exports.TRANSPOSE = function(matrix) {
    if (!matrix) {
      return error$1.na;
    }
    return jstat.transpose(matrix);
  };

  exports.T = text.T;

  exports.T.DIST = function (x, df, tails) {
    if (tails !== 1 && tails !== 2) {
      return error$1.num;
    }

    return (tails === 1) ? exports.T.DIST.RT(x, df) : exports.T.DIST['2T'](x, df);
  };

  exports.T.DIST['2T'] = function(x, df) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (x < 0 || df < 1) {
      return error$1.num;
    }

    if ((typeof x !== 'number') || (typeof df !== 'number')) {
      return error$1.value;
    }

    return (1 - jstat.studentt.cdf(x , df)) * 2;
  };

  exports.T.DIST.RT = function(x, df) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (x < 0 || df < 1) {
      return error$1.num;
    }

    if ((typeof x !== 'number') || (typeof df !== 'number')) {
      return error$1.value;
    }

    return 1 - jstat.studentt.cdf(x , df);
  };

  exports.T.INV = function(probability, df) {
    probability = common.parseNumber(probability);
    df = common.parseNumber(df);
    if (common.anyIsError(probability, df)) {
      return error$1.value;
    }
    return jstat.studentt.inv(probability, df);
  };

  exports.T.INV['2T'] = function(probability, df) {
    probability = common.parseNumber(probability);
    df = common.parseNumber(df);
    if (probability <= 0 || probability > 1 || df < 1) {
      return error$1.num;
    }
    if (common.anyIsError(probability, df)) {
      return error$1.value;
    }
    return Math.abs(jstat.studentt.inv(probability/2, df));
  };

  // The algorithm can be found here:
  // http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html
  exports.T.TEST = function(data_x, data_y) {
    data_x = common.parseNumberArray(common.flatten(data_x));
    data_y = common.parseNumberArray(common.flatten(data_y));
    if (common.anyIsError(data_x, data_y)) {
      return error$1.value;
    }

    var mean_x = jstat.mean(data_x);
    var mean_y = jstat.mean(data_y);
    var s_x = 0;
    var s_y = 0;
    var i;

    for (i = 0; i < data_x.length; i++) {
      s_x += Math.pow(data_x[i] - mean_x, 2);
    }
    for (i = 0; i < data_y.length; i++) {
      s_y += Math.pow(data_y[i] - mean_y, 2);
    }

    s_x = s_x / (data_x.length-1);
    s_y = s_y / (data_y.length-1);

    var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);

    return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);
  };

  exports.TREND = function(data_y, data_x, new_data_x) {
    data_y = common.parseNumberArray(common.flatten(data_y));
    data_x = common.parseNumberArray(common.flatten(data_x));
    new_data_x = common.parseNumberArray(common.flatten(new_data_x));
    if (common.anyIsError(data_y, data_x, new_data_x)) {
      return error$1.value;
    }
    var linest = exports.LINEST(data_y, data_x);
    var m = linest[0];
    var b = linest[1];
    var result = [];

    new_data_x.forEach(function(x) {
      result.push(m * x + b);
    });

    return result;
  };

  exports.TRIMMEAN = function(range, percent) {
    range = common.parseNumberArray(common.flatten(range));
    percent = common.parseNumber(percent);
    if (common.anyIsError(range, percent)) {
      return error$1.value;
    }
    var trim = mathTrig.FLOOR(range.length * percent, 2) / 2;
    return jstat.mean(common.initial(common.rest(range.sort(function(a, b) {
      return a - b;
    }), trim), trim));
  };

  exports.VAR = {};

  exports.VAR.P = function() {
    var range = common.numbers(common.flatten(arguments));
    var n = range.length;
    var sigma = 0;
    var mean = exports.AVERAGE(range);
    var result;
    for (var i = 0; i < n; i++) {
      sigma += Math.pow(range[i] - mean, 2);
    }
    result = sigma / n;

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.VAR.S = function() {
    var range = common.numbers(common.flatten(arguments));
    var n = range.length;
    var sigma = 0;
    var mean = exports.AVERAGE(range);
    for (var i = 0; i < n; i++) {
      sigma += Math.pow(range[i] - mean, 2);
    }
    return sigma / (n - 1);
  };

  exports.VARA = function() {
    var range = common.flatten(arguments);
    var n = range.length;
    var sigma = 0;
    var count = 0;
    var mean = exports.AVERAGEA(range);
    for (var i = 0; i < n; i++) {
      var el = range[i];
      if (typeof el === 'number') {
        sigma += Math.pow(el - mean, 2);
      } else if (el === true) {
        sigma += Math.pow(1 - mean, 2);
      } else {
        sigma += Math.pow(0 - mean, 2);
      }

      if (el !== null) {
        count++;
      }
    }
    return sigma / (count - 1);
  };

  exports.VARPA = function() {
    var range = common.flatten(arguments);
    var n = range.length;
    var sigma = 0;
    var count = 0;
    var mean = exports.AVERAGEA(range);
    var result;
    for (var i = 0; i < n; i++) {
      var el = range[i];
      if (typeof el === 'number') {
        sigma += Math.pow(el - mean, 2);
      } else if (el === true) {
        sigma += Math.pow(1 - mean, 2);
      } else {
        sigma += Math.pow(0 - mean, 2);
      }

      if (el !== null) {
        count++;
      }
    }
    result = sigma / count;

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.WEIBULL = {};

  exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {
    x = common.parseNumber(x);
    alpha = common.parseNumber(alpha);
    beta = common.parseNumber(beta);
    if (common.anyIsError(x, alpha, beta)) {
      return error$1.value;
    }
    return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);
  };

  exports.Z = {};

  exports.Z.TEST = function(range, x, sd) {
    range = common.parseNumberArray(common.flatten(range));
    x = common.parseNumber(x);
    if (common.anyIsError(range, x)) {
      return error$1.value;
    }

    sd = sd || exports.STDEV.S(range);
    var n = range.length;
    return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);
  };
  });

  var information = createCommonjsModule(function (module, exports) {
  // TODO
  exports.CELL = function() {
    throw new Error('CELL is not implemented');
  };

  exports.ERROR = {};
  exports.ERROR.TYPE = function(error_val) {
    switch (error_val) {
      case error$1.nil: return 1;
      case error$1.div0: return 2;
      case error$1.value: return 3;
      case error$1.ref: return 4;
      case error$1.name: return 5;
      case error$1.num: return 6;
      case error$1.na: return 7;
      case error$1.data: return 8;
    }
    return error$1.na;
  };

  // TODO
  exports.INFO = function() {
    throw new Error('INFO is not implemented');
  };

  exports.ISBLANK = function(value) {
    return value === null;
  };

  exports.ISBINARY = function (number) {
    return (/^[01]{1,10}$/).test(number);
  };

  exports.ISERR = function(value) {
    return ([error$1.value, error$1.ref, error$1.div0, error$1.num, error$1.name, error$1.nil]).indexOf(value) >= 0 ||
      (typeof value === 'number' && (isNaN(value) || !isFinite(value)));
  };

  exports.ISERROR = function(value) {
    return exports.ISERR(value) || value === error$1.na;
  };

  exports.ISEVEN = function(number) {
    return (Math.floor(Math.abs(number)) & 1) ? false : true;
  };

  // TODO
  exports.ISFORMULA = function() {
    throw new Error('ISFORMULA is not implemented');
  };

  exports.ISLOGICAL = function(value) {
    return value === true || value === false;
  };

  exports.ISNA = function(value) {
    return value === error$1.na;
  };

  exports.ISNONTEXT = function(value) {
    return typeof(value) !== 'string';
  };

  exports.ISNUMBER = function(value) {
    return typeof(value) === 'number' && !isNaN(value) && isFinite(value);
  };

  exports.ISODD = function(number) {
    return (Math.floor(Math.abs(number)) & 1) ? true : false;
  };

  // TODO
  exports.ISREF = function() {
    throw new Error('ISREF is not implemented');
  };

  exports.ISTEXT = function(value) {
    return typeof(value) === 'string';
  };

  exports.N = function(value) {
    if (this.ISNUMBER(value)) {
      return value;
    }
    if (value instanceof Date) {
      return value.getTime();
    }
    if (value === true) {
      return 1;
    }
    if (value === false) {
      return 0;
    }
    if (this.ISERROR(value)) {
      return value;
    }
    return 0;
  };

  exports.NA = function() {
    return error$1.na;
  };


  // TODO
  exports.SHEET = function() {
    throw new Error('SHEET is not implemented');
  };

  // TODO
  exports.SHEETS = function() {
    throw new Error('SHEETS is not implemented');
  };

  exports.TYPE = function(value) {
    if (this.ISNUMBER(value)) {
      return 1;
    }
    if (this.ISTEXT(value)) {
      return 2;
    }
    if (this.ISLOGICAL(value)) {
      return 4;
    }
    if (this.ISERROR(value)) {
      return 16;
    }
    if (Array.isArray(value)) {
      return 64;
    }
  };
  });

  var mathTrig = createCommonjsModule(function (module, exports) {
  exports.ABS = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.abs(number);

    return result;
  };

  exports.ACOS = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.acos(number);

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.ACOSH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.log(number + Math.sqrt(number * number - 1));

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.ACOT = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.atan(1 / number);

    return result;
  };

  exports.ACOTH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = 0.5 * Math.log((number + 1) / (number - 1));

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  //TODO: use options
  exports.AGGREGATE = function(function_num, options, ref1, ref2) {
    function_num = common.parseNumber(function_num);
    options = common.parseNumber(function_num);
    if (common.anyIsError(function_num, options)) {
      return error$1.value;
    }
    switch (function_num) {
      case 1:
        return statistical.AVERAGE(ref1);
      case 2:
        return statistical.COUNT(ref1);
      case 3:
        return statistical.COUNTA(ref1);
      case 4:
        return statistical.MAX(ref1);
      case 5:
        return statistical.MIN(ref1);
      case 6:
        return exports.PRODUCT(ref1);
      case 7:
        return statistical.STDEV.S(ref1);
      case 8:
        return statistical.STDEV.P(ref1);
      case 9:
        return exports.SUM(ref1);
      case 10:
        return statistical.VAR.S(ref1);
      case 11:
        return statistical.VAR.P(ref1);
      case 12:
        return statistical.MEDIAN(ref1);
      case 13:
        return statistical.MODE.SNGL(ref1);
      case 14:
        return statistical.LARGE(ref1, ref2);
      case 15:
        return statistical.SMALL(ref1, ref2);
      case 16:
        return statistical.PERCENTILE.INC(ref1, ref2);
      case 17:
        return statistical.QUARTILE.INC(ref1, ref2);
      case 18:
        return statistical.PERCENTILE.EXC(ref1, ref2);
      case 19:
        return statistical.QUARTILE.EXC(ref1, ref2);
    }
  };

  exports.ARABIC = function(text) {
    if (text === undefined || text === null) {
      return 0;
    }
    if (text instanceof Error) {
      return text;
    }
    // Credits: Rafa? Kukawski
    if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {
      return error$1.value;
    }
    var r = 0;
    text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {
      r += {
        M: 1000,
        CM: 900,
        D: 500,
        CD: 400,
        C: 100,
        XC: 90,
        L: 50,
        XL: 40,
        X: 10,
        IX: 9,
        V: 5,
        IV: 4,
        I: 1
      }[i];
    });
    return r;
  };

  exports.ASIN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.asin(number);

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.ASINH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.log(number + Math.sqrt(number * number + 1));
  };

  exports.ATAN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.atan(number);
  };

  exports.ATAN2 = function(number_x, number_y) {
    number_x = common.parseNumber(number_x);
    number_y = common.parseNumber(number_y);
    var anyError = common.anyError(number_x, number_y);
    if (anyError) {
      return anyError;
    }
    return Math.atan2(number_x, number_y);
  };

  exports.ATANH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var result = Math.log((1 + number) / (1 - number)) / 2;

    if (isNaN(result)) {
      result = error$1.num;
    }

    return result;
  };

  exports.BASE = function(number, radix, min_length) {
    number = common.parseNumber(number);
    radix = common.parseNumber(radix);
    min_length = common.parseNumber(min_length);
    var anyError = common.anyError(number, radix, min_length);
    if (anyError) {
      return anyError;
    }
    if (radix === 0) {
      return error$1.num;
    }
    var result = number.toString(radix);
    return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;
  };

  exports.CEILING = function(number, significance, mode) {
    number = common.parseNumber(number);
    significance = common.parseNumber(significance);
    mode = common.parseNumber(mode);
    var anyError = common.anyError(number, significance, mode);
    if (anyError) {
      return anyError;
    }
    if (significance === 0) {
      return 0;
    }
    significance = Math.abs(significance);
    var precision = -Math.floor(Math.log(significance) / Math.log(10));
    if (number >= 0) {
      return exports.ROUND(Math.ceil(number / significance) * significance, precision);
    } else {
      if (mode === 0) {
        return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);
      } else {
        return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);
      }
    }
  };

  exports.CEILING.MATH = exports.CEILING;

  exports.CEILING.PRECISE = exports.CEILING;

  exports.COMBIN = function(number, number_chosen) {
    number = common.parseNumber(number);
    number_chosen = common.parseNumber(number_chosen);
    var anyError = common.anyError(number, number_chosen);
    if (anyError) {
      return anyError;
    }
    if (number < number_chosen) {
      return error$1.num;
    }
    return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));
  };

  exports.COMBINA = function(number, number_chosen) {
    number = common.parseNumber(number);
    number_chosen = common.parseNumber(number_chosen);
    var anyError = common.anyError(number, number_chosen);
    if (anyError) {
      return anyError;
    }
    if (number < number_chosen) {
      return error$1.num;
    }
    return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);
  };

  exports.COS = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.cos(number);
  };

  exports.COSH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return (Math.exp(number) + Math.exp(-number)) / 2;
  };

  exports.COT = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.div0;
    }
    return 1 / Math.tan(number);
  };

  exports.COTH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.div0;
    }
    var e2 = Math.exp(2 * number);
    return (e2 + 1) / (e2 - 1);
  };

  exports.CSC = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.div0;
    }
    return 1 / Math.sin(number);
  };

  exports.CSCH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.div0;
    }
    return 2 / (Math.exp(number) - Math.exp(-number));
  };

  exports.DECIMAL = function(number, radix) {
    if (arguments.length < 1) {
      return error$1.value;
    }

    number = common.parseNumber(number);
    radix = common.parseNumber(radix);
    var anyError = common.anyError(number, radix);
    if (anyError) {
      return anyError;
    }
    if (radix === 0) {
      return error$1.num;
    }

    return parseInt(number, radix);
  };

  exports.DEGREES = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return number * 180 / Math.PI;
  };

  exports.EVEN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return exports.CEILING(number, -2, -1);
  };

  exports.EXP = function(number) {
    if (arguments.length < 1) {
      return error$1.na;
    }
    if (arguments.length > 1) {
      return error$1.error;
    }

    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    number = Math.exp(number);

    return number;
  };

  var MEMOIZED_FACT = [];
  exports.FACT = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var n = Math.floor(number);
    if (n === 0 || n === 1) {
      return 1;
    } else if (MEMOIZED_FACT[n] > 0) {
      return MEMOIZED_FACT[n];
    } else {
      MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;
      return MEMOIZED_FACT[n];
    }
  };

  exports.FACTDOUBLE = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var n = Math.floor(number);
    if (n <= 0) {
      return 1;
    } else {
      return n * exports.FACTDOUBLE(n - 2);
    }
  };

  exports.FLOOR = function(number, significance) {
    number = common.parseNumber(number);
    significance = common.parseNumber(significance);
    var anyError = common.anyError(number, significance);
    if (anyError) {
      return anyError;
    }
    if (significance === 0) {
      return 0;
    }

    if (!(number >= 0 && significance > 0) && !(number <= 0 && significance < 0)) {
      return error$1.num;
    }

    significance = Math.abs(significance);
    var precision = -Math.floor(Math.log(significance) / Math.log(10));
    if (number >= 0) {
      return exports.ROUND(Math.floor(number / significance) * significance, precision);
    } else {
      return -exports.ROUND(Math.ceil(Math.abs(number) / significance), precision);
    }
  };

  //TODO: Verify
  exports.FLOOR.MATH = function(number, significance, mode) {
    if (significance instanceof Error) {
      return significance;
    }
    significance = (significance === undefined) ? 0 : significance;

    number = common.parseNumber(number);
    significance = common.parseNumber(significance);
    mode = common.parseNumber(mode);
    var anyError = common.anyError(number, significance, mode);
    if (anyError) {
      return anyError;
    }
    if (significance === 0) {
      return 0;
    }

    significance = significance ? Math.abs(significance) : 1;
    var precision = -Math.floor(Math.log(significance) / Math.log(10));
    if (number >= 0) {
      return exports.ROUND(Math.floor(number / significance) * significance, precision);
    } else if (mode === 0 || mode === undefined) {
      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);
    }
    return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);
  };

  // Deprecated
  exports.FLOOR.PRECISE = exports.FLOOR.MATH;

  // adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript
  exports.GCD = function() {
    var range = common.parseNumberArray(common.flatten(arguments));
    if (range instanceof Error) {
      return range;
    }
    var n = range.length;
    var r0 = range[0];
    var x = r0 < 0 ? -r0 : r0;
    for (var i = 1; i < n; i++) {
      var ri = range[i];
      var y = ri < 0 ? -ri : ri;
      while (x && y) {
        if (x > y) {
          x %= y;
        } else {
          y %= x;
        }
      }
      x += y;
    }
    return x;
  };


  exports.INT = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.floor(number);
  };

  //TODO: verify
  exports.ISO = {
    CEILING: exports.CEILING
  };

  exports.LCM = function() {
    // Credits: Jonas Raoni Soares Silva
    var o = common.parseNumberArray(common.flatten(arguments));
    if (o instanceof Error) {
      return o;
    }
    for (var i, j, n, d, r = 1;
         (n = o.pop()) !== undefined;) {
      if (n === 0) {
        return 0;
      }
      while (n > 1) {
        if (n % 2) {
          for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {
            //empty
          }
          d = (i <= j) ? i : n;
        } else {
          d = 2;
        }
        for (n /= d, r *= d, i = o.length; i;
             (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {
          //empty
        }
      }
    }
    return r;
  };

  exports.LN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.num;
    }
    return Math.log(number);
  };

  exports.LN10 = function() {
    return Math.log(10);
  };

  exports.LN2 = function() {
    return Math.log(2);
  };

  exports.LOG10E = function() {
    return Math.LOG10E;
  };

  exports.LOG2E = function() {
    return Math.LOG2E;
  };

  exports.LOG = function(number, base) {
    number = common.parseNumber(number);
    base = common.parseNumber(base);
    var anyError = common.anyError(number, base);
    if (anyError) {
      return anyError;
    }
    if (number === 0 || base === 0) {
      return error$1.num;
    }
    return Math.log(number) / Math.log(base);
  };

  exports.LOG10 = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number === 0) {
      return error$1.num;
    }
    return Math.log(number) / Math.log(10);
  };

  exports.MOD = function(dividend, divisor) {
    dividend = common.parseNumber(dividend);
    divisor = common.parseNumber(divisor);
    var anyError = common.anyError(dividend, divisor);
    if (anyError) {
      return anyError;
    }
    if (divisor === 0) {
      return error$1.div0;
    }
    var modulus = Math.abs(dividend % divisor);
    modulus = dividend < 0 ? divisor - modulus : modulus;
    return (divisor > 0) ? modulus : -modulus;
  };

  exports.MROUND = function(number, multiple) {
    number = common.parseNumber(number);
    multiple = common.parseNumber(multiple);
    var anyError = common.anyError(number, multiple);
    if (anyError) {
      return anyError;
    }
    if (number * multiple === 0) {
      return 0;
    }
    if (number * multiple < 0) {
      return error$1.num;
    }

    return Math.round(number / multiple) * multiple;
  };

  exports.MULTINOMIAL = function() {
    var args = common.parseNumberArray(common.flatten(arguments));
    if (args instanceof Error) {
      return args;
    }
    var sum = 0;
    var divisor = 1;
    for (var i = 0; i < args.length; i++) {
      sum += args[i];
      divisor *= exports.FACT(args[i]);
    }
    return exports.FACT(sum) / divisor;
  };

  exports.ODD = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var temp = Math.ceil(Math.abs(number));
    temp = (temp & 1) ? temp : temp + 1;
    return (number >= 0) ? temp : -temp;
  };

  exports.PI = function() {
    return Math.PI;
  };

  exports.E = function() {
    return Math.E;
  };

  exports.POWER = function(number, power) {
    number = common.parseNumber(number);
    power = common.parseNumber(power);
    var anyError = common.anyError(number, power);
    if (anyError) {
      return anyError;
    }
    if (number === 0 && power === 0) {
      return error$1.num;
    }
    var result = Math.pow(number, power);
    if (isNaN(result)) {
      return error$1.num;
    }

    return result;
  };

  exports.PRODUCT = function() {
    var flatArguments = common.flatten(arguments);
    var flatArgumentsDefined = flatArguments.filter(function (arg) { return arg !== undefined && arg !== null; });
    if (flatArgumentsDefined.length === 0) {
      return 0;
    }
    var args = common.parseNumberArray(flatArgumentsDefined);
    if (args instanceof Error) {
      return args;
    }
    var result = 1;
    for (var i = 0; i < args.length; i++) {
      result *= args[i];
    }
    return result;
  };

  exports.QUOTIENT = function(numerator, denominator) {
    numerator = common.parseNumber(numerator);
    denominator = common.parseNumber(denominator);
    var anyError = common.anyError(numerator, denominator);
    if (anyError) {
      return anyError;
    }
    return parseInt(numerator / denominator, 10);
  };

  exports.RADIANS = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return number * Math.PI / 180;
  };

  exports.RAND = function() {
    return Math.random();
  };

  exports.RANDBETWEEN = function(bottom, top) {
    bottom = common.parseNumber(bottom);
    top = common.parseNumber(top);
    var anyError = common.anyError(bottom, top);
    if (anyError) {
      return anyError;
    }
    // Creative Commons Attribution 3.0 License
    // Copyright (c) 2012 eqcode
    return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;
  };

  // TODO
  exports.ROMAN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    // The MIT License
    // Copyright (c) 2008 Steven Levithan
    var digits = String(number).split('');
    var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];
    var roman = '';
    var i = 3;
    while (i--) {
      roman = (key[+digits.pop() + (i * 10)] || '') + roman;
    }
    return new Array(+digits.join('') + 1).join('M') + roman;
  };

  exports.ROUND = function(number, digits) {
    number = common.parseNumber(number);
    digits = common.parseNumber(digits);
    var anyError = common.anyError(number, digits);
    if (anyError) {
      return anyError;
    }
    return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);
  };

  exports.ROUNDDOWN = function(number, digits) {
    number = common.parseNumber(number);
    digits = common.parseNumber(digits);
    var anyError = common.anyError(number, digits);
    if (anyError) {
      return anyError;
    }
    var sign = (number > 0) ? 1 : -1;
    return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);
  };

  exports.ROUNDUP = function(number, digits) {
    number = common.parseNumber(number);
    digits = common.parseNumber(digits);
    var anyError = common.anyError(number, digits);
    if (anyError) {
      return anyError;
    }
    var sign = (number > 0) ? 1 : -1;
    return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);
  };

  exports.SEC = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return 1 / Math.cos(number);
  };

  exports.SECH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return 2 / (Math.exp(number) + Math.exp(-number));
  };

  exports.SERIESSUM = function(x, n, m, coefficients) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    m = common.parseNumber(m);
    coefficients = common.parseNumberArray(coefficients);
    if (common.anyIsError(x, n, m, coefficients)) {
      return error$1.value;
    }
    var result = coefficients[0] * Math.pow(x, n);
    for (var i = 1; i < coefficients.length; i++) {
      result += coefficients[i] * Math.pow(x, n + i * m);
    }
    return result;
  };

  exports.SIGN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number < 0) {
      return -1;
    } else if (number === 0) {
      return 0;
    } else {
      return 1;
    }
  };

  exports.SIN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.sin(number);
  };

  exports.SINH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return (Math.exp(number) - Math.exp(-number)) / 2;
  };

  exports.SQRT = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    if (number < 0) {
      return error$1.num;
    }
    return Math.sqrt(number);
  };

  exports.SQRTPI = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.sqrt(number * Math.PI);
  };

  exports.SQRT1_2 = function() {
    return 1 / Math.sqrt(2);
  };

  exports.SQRT2 = function() {
    return Math.sqrt(2);
  };

  exports.SUBTOTAL = function(function_code, ref1) {
    function_code = common.parseNumber(function_code);
    if (function_code instanceof Error) {
      return function_code;
    }
    switch (function_code) {
      case 1:
        return statistical.AVERAGE(ref1);
      case 2:
        return statistical.COUNT(ref1);
      case 3:
        return statistical.COUNTA(ref1);
      case 4:
        return statistical.MAX(ref1);
      case 5:
        return statistical.MIN(ref1);
      case 6:
        return exports.PRODUCT(ref1);
      case 7:
        return statistical.STDEV.S(ref1);
      case 8:
        return statistical.STDEV.P(ref1);
      case 9:
        return exports.SUM(ref1);
      case 10:
        return statistical.VAR.S(ref1);
      case 11:
        return statistical.VAR.P(ref1);
      // no hidden values for us
      case 101:
        return statistical.AVERAGE(ref1);
      case 102:
        return statistical.COUNT(ref1);
      case 103:
        return statistical.COUNTA(ref1);
      case 104:
        return statistical.MAX(ref1);
      case 105:
        return statistical.MIN(ref1);
      case 106:
        return exports.PRODUCT(ref1);
      case 107:
        return statistical.STDEV.S(ref1);
      case 108:
        return statistical.STDEV.P(ref1);
      case 109:
        return exports.SUM(ref1);
      case 110:
        return statistical.VAR.S(ref1);
      case 111:
        return statistical.VAR.P(ref1);

    }
  };

  exports.ADD = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    num1 = common.parseNumber(num1);
    num2 = common.parseNumber(num2);
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 + num2;
  };

  exports.MINUS = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    num1 = common.parseNumber(num1);
    num2 = common.parseNumber(num2);
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 - num2;
  };

  exports.DIVIDE = function (dividend, divisor) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    dividend = common.parseNumber(dividend);
    divisor = common.parseNumber(divisor);
    var anyError = common.anyError(dividend, divisor);
    if (anyError) {
      return anyError;
    }

    if (divisor === 0) {
      return error$1.div0;
    }

    return dividend / divisor;
  };

  exports.MULTIPLY = function (factor1, factor2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    factor1 = common.parseNumber(factor1);
    factor2 = common.parseNumber(factor2);
    var anyError = common.anyError(factor1, factor2);
    if (anyError) {
      return anyError;
    }

    return factor1 * factor2;
  };

  exports.GT = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }
    if (num1 instanceof Error) {
      return num1;
    }
    if (num2 instanceof Error) {
      return num2;
    }

    if (common.anyIsString(num1, num2)) {
      num1 = common.parseString(num1);
      num2 = common.parseString(num2);
    } else {
      num1 = common.parseNumber(num1);
      num2 = common.parseNumber(num2);
    }
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 > num2;
  };

  exports.GTE = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (common.anyIsString(num1, num2)) {
      num1 = common.parseString(num1);
      num2 = common.parseString(num2);
    } else {
      num1 = common.parseNumber(num1);
      num2 = common.parseNumber(num2);
    }
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 >= num2;
  };

  exports.LT = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (common.anyIsString(num1, num2)) {
      num1 = common.parseString(num1);
      num2 = common.parseString(num2);
    } else {
      num1 = common.parseNumber(num1);
      num2 = common.parseNumber(num2);
    }
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 < num2;
  };


  exports.LTE = function (num1, num2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    if (common.anyIsString(num1, num2)) {
      num1 = common.parseString(num1);
      num2 = common.parseString(num2);
    } else {
      num1 = common.parseNumber(num1);
      num2 = common.parseNumber(num2);
    }
    var anyError = common.anyError(num1, num2);
    if (anyError) {
      return anyError;
    }

    return num1 <= num2;
  };

  exports.EQ = function (value1, value2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }
    if (value1 instanceof Error) {
      return value1;
    }
    if (value2 instanceof Error) {
      return value2;
    }
    if (value1 === null) {
      value1 = undefined;
    }
    if (value2 === null) {
      value2 = undefined;
    }

    return value1 === value2;
  };

  exports.NE = function (value1, value2) {
    if (arguments.length !== 2) {
      return error$1.na;
    }
    if (value1 instanceof Error) {
      return value1;
    }
    if (value2 instanceof Error) {
      return value2;
    }
    if (value1 === null) {
      value1 = undefined;
    }
    if (value2 === null) {
      value2 = undefined;
    }

    return value1 !== value2;
  };

  exports.POW = function (base, exponent) {
    if (arguments.length !== 2) {
      return error$1.na;
    }

    return exports.POWER(base, exponent);
  };

  exports.SUM = function() {
    var result = 0;

    common.arrayEach(common.argsToArray(arguments), function(value) {
      if (result instanceof Error) {
        return false;
      } else if (value instanceof Error) {
        result = value;
      } else if (typeof value === 'number') {
        result += value;

      } else if (typeof value === 'string') {
        var parsed = parseFloat(value);

        !isNaN(parsed) && (result += parsed);

      } else if (Array.isArray(value)) {
        var inner_result = exports.SUM.apply(null, value);
        if (inner_result instanceof Error) {
          result = inner_result;
        } else {
          result += inner_result;
        }
      }
    });

    return result;
  };

  exports.SUMIF = function (range, criteria, sumRange) {
    range = common.flatten(range);
    if (sumRange) {
      sumRange = common.flatten(sumRange);
    } else {
      sumRange = range;
    }
    if (range instanceof Error) {
      return range;
    }
    if (criteria === undefined || criteria === null || criteria instanceof Error) {
      return 0;
    }
    var result = 0;
    var isWildcard = criteria === '*';
    var tokenizedCriteria = isWildcard ? null : criteriaEval.parse(criteria + '');
    for (var i = 0; i < range.length; i++) {
      var value = range[i];
      var sumValue = sumRange[i];

      if (isWildcard) {
        result += value;
      } else {
        var tokens = [criteriaEval.createToken(value, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

        result += criteriaEval.compute(tokens) ? sumValue : 0;
      }
    }

    return result;
  };

  exports.SUMIFS = function() {
    var args = common.argsToArray(arguments);
    var range = common.parseNumberArray(common.flatten(args.shift()));

    if (range instanceof Error) {
      return range;
    }

    var criterias = args;
    var criteriaLength = criterias.length / 2;

    for (var i = 0; i < criteriaLength; i++) {
      criterias[i * 2] = common.flatten(criterias[i * 2]);
    }

    var result = 0;

    for (var i = 0; i < range.length; i++) {
      var isMeetCondition = false;

      for (var j = 0; j < criteriaLength; j++) {
        var valueToTest = criterias[j * 2][i];
        var criteria = criterias[j * 2 + 1];
        var isWildcard = criteria === void 0 || criteria === '*';
        var computedResult = false;

        if (isWildcard) {
          computedResult = true;
        } else {
          var tokenizedCriteria = criteriaEval.parse(criteria + '');
          var tokens = [criteriaEval.createToken(valueToTest, criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

          computedResult = criteriaEval.compute(tokens);
        }

        // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition
        if (!computedResult) {
          isMeetCondition = false;
          break;
        }

        isMeetCondition = true;
      }

      if (isMeetCondition) {
        result += range[i];
      }
    }

    return result;
  };

  exports.SUMPRODUCT = function() {
    if (!arguments || arguments.length === 0) {
      return error$1.value;
    }
    var arrays = arguments.length + 1;
    var result = 0;
    var product;
    var k;
    var _i;
    var _ij;
    for (var i = 0; i < arguments[0].length; i++) {
      if (!(arguments[0][i] instanceof Array)) {
        product = 1;
        for (k = 1; k < arrays; k++) {
          var _i_arg = arguments[k - 1][i];
          if (_i_arg instanceof Error) {
            return _i_arg;
          }
          _i = common.parseNumber(_i_arg);
          if (_i instanceof Error) {
            return _i;
          }
          product *= _i;
        }
        result += product;
      } else {
        for (var j = 0; j < arguments[0][i].length; j++) {
          product = 1;
          for (k = 1; k < arrays; k++) {
            var _ij_arg = arguments[k - 1][i][j];
            if (_ij_arg instanceof Error) {
              return _ij_arg;
            }
            _ij = common.parseNumber(_ij_arg);
            if (_ij instanceof Error) {
              return _ij;
            }
            product *= _ij;
          }
          result += product;
        }
      }
    }
    return result;
  };

  exports.SUMSQ = function() {
    var numbers = common.parseNumberArray(common.flatten(arguments));
    if (numbers instanceof Error) {
      return numbers;
    }
    var result = 0;
    var length = numbers.length;
    for (var i = 0; i < length; i++) {
      result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;
    }
    return result;
  };

  exports.SUMX2MY2 = function(array_x, array_y) {
    array_x = common.parseNumberArray(common.flatten(array_x));
    array_y = common.parseNumberArray(common.flatten(array_y));
    if (common.anyIsError(array_x, array_y)) {
      return error$1.value;
    }
    var result = 0;
    for (var i = 0; i < array_x.length; i++) {
      result += array_x[i] * array_x[i] - array_y[i] * array_y[i];
    }
    return result;
  };

  exports.SUMX2PY2 = function(array_x, array_y) {
    array_x = common.parseNumberArray(common.flatten(array_x));
    array_y = common.parseNumberArray(common.flatten(array_y));
    if (common.anyIsError(array_x, array_y)) {
      return error$1.value;
    }
    var result = 0;
    array_x = common.parseNumberArray(common.flatten(array_x));
    array_y = common.parseNumberArray(common.flatten(array_y));
    for (var i = 0; i < array_x.length; i++) {
      result += array_x[i] * array_x[i] + array_y[i] * array_y[i];
    }
    return result;
  };

  exports.SUMXMY2 = function(array_x, array_y) {
    array_x = common.parseNumberArray(common.flatten(array_x));
    array_y = common.parseNumberArray(common.flatten(array_y));
    if (common.anyIsError(array_x, array_y)) {
      return error$1.value;
    }
    var result = 0;
    array_x = common.flatten(array_x);
    array_y = common.flatten(array_y);
    for (var i = 0; i < array_x.length; i++) {
      result += Math.pow(array_x[i] - array_y[i], 2);
    }
    return result;
  };

  exports.TAN = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    return Math.tan(number);
  };

  exports.TANH = function(number) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }
    var e2 = Math.exp(2 * number);
    return (e2 - 1) / (e2 + 1);
  };

  exports.TRUNC = function(number, digits) {
    number = common.parseNumber(number);
    digits = common.parseNumber(digits);
    var anyError = common.anyError(number, digits);
    if (anyError) {
      return anyError;
    }
    var sign = (number > 0) ? 1 : -1;
    return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);
  };
  });

  var bessel = createCommonjsModule(function (module, exports) {
  /* bessel.js (C) 2013-present SheetJS -- http://sheetjs.com */
  /* vim: set ts=2: */
  /*exported BESSEL */
  var BESSEL;
  (function (factory) {
    /*jshint ignore:start */
    if(typeof DO_NOT_EXPORT_BESSEL === 'undefined') {
      {
        factory(exports);
      }
    } else {
      factory(BESSEL = {});
    }
    /*jshint ignore:end */
  }(function(BESSEL) {
  BESSEL.version = '1.0.2';
  var M = Math;

  function _horner(arr, v) { for(var i = 0, z = 0; i < arr.length; ++i) z = v * z + arr[i]; return z; }
  function _bessel_iter(x, n, f0, f1, sign) {
    if(n === 0) return f0;
    if(n === 1) return f1;
    var tdx = 2 / x, f2 = f1;
    for(var o = 1; o < n; ++o) {
      f2 = f1 * o * tdx + sign * f0;
      f0 = f1; f1 = f2;
    }
    return f2;
  }
  function _bessel_wrap(bessel0, bessel1, name, nonzero, sign) {
    return function bessel(x,n) {
      if(nonzero) {
        if(x === 0) return (nonzero == 1 ? -Infinity : Infinity);
        else if(x < 0) return NaN;
      }
      if(n === 0) return bessel0(x);
      if(n === 1) return bessel1(x);
      if(n < 0) return NaN;
      n|=0;
      var b0 = bessel0(x), b1 = bessel1(x);
      return _bessel_iter(x, n, b0, b1, sign);
    };
  }
  var besselj = (function() {
    var W = 0.636619772; // 2 / Math.PI

    var b0_a1a = [57568490574.0, -13362590354.0, 651619640.7, -11214424.18, 77392.33017, -184.9052456].reverse();
    var b0_a2a = [57568490411.0, 1029532985.0, 9494680.718, 59272.64853, 267.8532712, 1.0].reverse();
    var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();
    var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934935152e-7].reverse();

    function bessel0(x) {
      var a=0, a1=0, a2=0, y = x * x;
      if(x < 8) {
        a1 = _horner(b0_a1a, y);
        a2 = _horner(b0_a2a, y);
        a = a1 / a2;
      } else {
        var xx = x - 0.785398164;
        y = 64 / y;
        a1 = _horner(b0_a1b, y);
        a2 = _horner(b0_a2b, y);
        a = M.sqrt(W/x)*(M.cos(xx)*a1-M.sin(xx)*a2*8/x);
      }
      return a;
    }

    var b1_a1a = [72362614232.0, -7895059235.0, 242396853.1, -2972611.439, 15704.48260, -30.16036606].reverse();
    var b1_a2a = [144725228442.0, 2300535178.0, 18583304.74, 99447.43394, 376.9991397, 1.0].reverse();
    var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();
    var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();

    function bessel1(x) {
      var a=0, a1=0, a2=0, y = x*x, xx = M.abs(x) - 2.356194491;
      if(Math.abs(x)< 8) {
        a1 = x*_horner(b1_a1a, y);
        a2 = _horner(b1_a2a, y);
        a = a1 / a2;
      } else {
        y = 64 / y;
        a1=_horner(b1_a1b, y);
        a2=_horner(b1_a2b, y);
        a=M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));
        if(x < 0) a = -a;
      }
      return a;
    }

    return function besselj(x, n) {
      n = Math.round(n);
      if(!isFinite(x)) return isNaN(x) ? x : 0;
      if(n < 0) return ((n%2)?-1:1)*besselj(x, -n);
      if(x < 0) return ((n%2)?-1:1)*besselj(-x, n);
      if(n === 0) return bessel0(x);
      if(n === 1) return bessel1(x);
      if(x === 0) return 0;

      var ret=0.0;
      if(x > n) {
        ret = _bessel_iter(x, n, bessel0(x), bessel1(x),-1);
      } else {
        var m=2*M.floor((n+M.floor(M.sqrt(40*n)))/2);
        var jsum=false;
        var bjp=0.0, sum=0.0;
        var bj=1.0, bjm = 0.0;
        var tox = 2 / x;
        for (var j=m;j>0;j--) {
          bjm=j*tox*bj-bjp;
          bjp=bj;
          bj=bjm;
          if (M.abs(bj) > 1E10) {
            bj *= 1E-10;
            bjp *= 1E-10;
            ret *= 1E-10;
            sum *= 1E-10;
          }
          if (jsum) sum += bj;
          jsum=!jsum;
          if (j == n) ret=bjp;
        }
        sum=2.0*sum-bj;
        ret /= sum;
      }
      return ret;
    };
  })();
  var bessely = (function() {
    var W = 0.636619772;

    var b0_a1a = [-2957821389.0, 7062834065.0, -512359803.6, 10879881.29, -86327.92757, 228.4622733].reverse();
    var b0_a2a = [40076544269.0, 745249964.8, 7189466.438, 47447.26470, 226.1030244, 1.0].reverse();
    var b0_a1b = [1.0, -0.1098628627e-2, 0.2734510407e-4, -0.2073370639e-5, 0.2093887211e-6].reverse();
    var b0_a2b = [-0.1562499995e-1, 0.1430488765e-3, -0.6911147651e-5, 0.7621095161e-6, -0.934945152e-7].reverse();

    function bessel0(x) {
      var a=0, a1=0, a2=0, y = x * x, xx = x - 0.785398164;
      if(x < 8) {
        a1 = _horner(b0_a1a, y);
        a2 = _horner(b0_a2a, y);
        a = a1/a2 + W * besselj(x,0) * M.log(x);
      } else {
        y = 64 / y;
        a1 = _horner(b0_a1b, y);
        a2 = _horner(b0_a2b, y);
        a = M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);
      }
      return a;
    }

    var b1_a1a = [-0.4900604943e13, 0.1275274390e13, -0.5153438139e11, 0.7349264551e9, -0.4237922726e7, 0.8511937935e4].reverse();
    var b1_a2a = [0.2499580570e14, 0.4244419664e12, 0.3733650367e10, 0.2245904002e8, 0.1020426050e6, 0.3549632885e3, 1].reverse();
    var b1_a1b = [1.0, 0.183105e-2, -0.3516396496e-4, 0.2457520174e-5, -0.240337019e-6].reverse();
    var b1_a2b = [0.04687499995, -0.2002690873e-3, 0.8449199096e-5, -0.88228987e-6, 0.105787412e-6].reverse();

    function bessel1(x) {
      var a=0, a1=0, a2=0, y = x*x, xx = x - 2.356194491;
      if(x < 8) {
        a1 = x*_horner(b1_a1a, y);
        a2 = _horner(b1_a2a, y);
        a = a1/a2 + W * (besselj(x,1) * M.log(x) - 1 / x);
      } else {
        y = 64 / y;
        a1=_horner(b1_a1b, y);
        a2=_horner(b1_a2b, y);
        a=M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);
      }
      return a;
    }

    return _bessel_wrap(bessel0, bessel1, 'BESSELY', 1, -1);
  })();
  var besseli = (function() {
    var b0_a = [1.0, 3.5156229, 3.0899424, 1.2067492, 0.2659732, 0.360768e-1, 0.45813e-2].reverse();
    var b0_b = [0.39894228, 0.1328592e-1, 0.225319e-2, -0.157565e-2, 0.916281e-2, -0.2057706e-1, 0.2635537e-1, -0.1647633e-1, 0.392377e-2].reverse();

    function bessel0(x) {
      if(x <= 3.75) return _horner(b0_a, x*x/(3.75*3.75));
      return M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b0_b, 3.75/M.abs(x));
    }

    var b1_a = [0.5, 0.87890594, 0.51498869, 0.15084934, 0.2658733e-1, 0.301532e-2, 0.32411e-3].reverse();
    var b1_b = [0.39894228, -0.3988024e-1, -0.362018e-2, 0.163801e-2, -0.1031555e-1, 0.2282967e-1, -0.2895312e-1, 0.1787654e-1, -0.420059e-2].reverse();

    function bessel1(x) {
      if(x < 3.75) return x * _horner(b1_a, x*x/(3.75*3.75));
      return (x < 0 ? -1 : 1) * M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b1_b, 3.75/M.abs(x));
    }

    return function besseli(x, n) {
      n = Math.round(n);
      if(n === 0) return bessel0(x);
      if(n === 1) return bessel1(x);
      if(n < 0) return NaN;
      if(M.abs(x) === 0) return 0;
      if(x == Infinity) return Infinity;

      var ret = 0.0, j, tox = 2 / M.abs(x), bip = 0.0, bi=1.0, bim=0.0;
      var m=2*M.round((n+M.round(M.sqrt(40*n)))/2);
      for (j=m;j>0;j--) {
        bim=j*tox*bi + bip;
        bip=bi; bi=bim;
        if (M.abs(bi) > 1E10) {
          bi *= 1E-10;
          bip *= 1E-10;
          ret *= 1E-10;
        }
        if(j == n) ret = bip;
      }
      ret *= besseli(x, 0) / bi;
      return x < 0 && (n%2) ? -ret : ret;
    };

  })();

  var besselk = (function() {
    var b0_a = [-0.57721566, 0.42278420, 0.23069756, 0.3488590e-1, 0.262698e-2, 0.10750e-3, 0.74e-5].reverse();
    var b0_b = [1.25331414, -0.7832358e-1, 0.2189568e-1, -0.1062446e-1, 0.587872e-2, -0.251540e-2, 0.53208e-3].reverse();

    function bessel0(x) {
      if(x <= 2) return -M.log(x/2) * besseli(x,0) + _horner(b0_a, x*x/4);
      return M.exp(-x) / M.sqrt(x) * _horner(b0_b, 2/x);
    }

    var b1_a = [1.0, 0.15443144, -0.67278579, -0.18156897, -0.1919402e-1, -0.110404e-2, -0.4686e-4].reverse();
    var b1_b = [1.25331414, 0.23498619, -0.3655620e-1, 0.1504268e-1, -0.780353e-2, 0.325614e-2, -0.68245e-3].reverse();

    function bessel1(x) {
      if(x <= 2) return M.log(x/2) * besseli(x,1) + (1/x) * _horner(b1_a, x*x/4);
      return M.exp(-x)/M.sqrt(x)*_horner(b1_b, 2/x);
    }

    return _bessel_wrap(bessel0, bessel1, 'BESSELK', 2, 1);
  })();
  BESSEL.besselj = besselj;
  BESSEL.bessely = bessely;
  BESSEL.besseli = besseli;
  BESSEL.besselk = besselk;
  }));
  });

  var engineering = createCommonjsModule(function (module, exports) {
  function isValidBinaryNumber(number) {
    return (/^[01]{1,10}$/).test(number);
  }

  exports.BESSELI = function(x, n) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    if (common.anyIsError(x, n)) {
      return error$1.value;
    }

    return bessel.besseli(x, n);
  };

  exports.BESSELJ = function(x, n) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    if (common.anyIsError(x, n)) {
      return error$1.value;
    }

    return bessel.besselj(x, n);
  };

  exports.BESSELK = function(x, n) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    if (common.anyIsError(x, n)) {
      return error$1.value;
    }

    return bessel.besselk(x, n);
  };

  exports.BESSELY = function(x, n) {
    x = common.parseNumber(x);
    n = common.parseNumber(n);
    if (common.anyIsError(x, n)) {
      return error$1.value;
    }

    return bessel.bessely(x, n);
  };

  exports.BIN2DEC = function(number) {
    // Return error if number is not binary or contains more than 10 characters (10 digits)
    if (!isValidBinaryNumber(number)) {
      return error$1.num;
    }

    // Convert binary number to decimal
    var result = parseInt(number, 2);

    // Handle negative numbers
    var stringified = number.toString();
    if (stringified.length === 10 && stringified.substring(0, 1) === '1') {
      return parseInt(stringified.substring(1), 2) - 512;
    } else {
      return result;
    }
  };


  exports.BIN2HEX = function(number, places) {
    // Return error if number is not binary or contains more than 10 characters (10 digits)
    if (!isValidBinaryNumber(number)) {
      return error$1.num;
    }

    // Ignore places and return a 10-character hexadecimal number if number is negative
    var stringified = number.toString();
    if (stringified.length === 10 && stringified.substring(0, 1) === '1') {
      return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);
    }

    // Convert binary number to hexadecimal
    var result = parseInt(number, 2).toString(16);

    // Return hexadecimal number using the minimum number of characters necessary if places is undefined
    if (places === undefined) {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.BIN2OCT = function(number, places) {
    // Return error if number is not binary or contains more than 10 characters (10 digits)
    if (!isValidBinaryNumber(number)) {
      return error$1.num;
    }

    // Ignore places and return a 10-character octal number if number is negative
    var stringified = number.toString();
    if (stringified.length === 10 && stringified.substring(0, 1) === '1') {
      return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);
    }

    // Convert binary number to octal
    var result = parseInt(number, 2).toString(8);

    // Return octal number using the minimum number of characters necessary if places is undefined
    if (places === undefined) {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.BITAND = function(number1, number2) {
    // Return error if either number is a non-numeric value
    number1 = common.parseNumber(number1);
    number2 = common.parseNumber(number2);
    if (common.anyIsError(number1, number2)) {
      return error$1.value;
    }

    // Return error if either number is less than 0
    if (number1 < 0 || number2 < 0) {
      return error$1.num;
    }

    // Return error if either number is a non-integer
    if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {
      return error$1.num;
    }

    // Return error if either number is greater than (2^48)-1
    if (number1 > 281474976710655 || number2 > 281474976710655) {
      return error$1.num;
    }

    // Return bitwise AND of two numbers
    return number1 & number2;
  };

  exports.BITLSHIFT = function(number, shift) {
    number = common.parseNumber(number);
    shift = common.parseNumber(shift);
    if (common.anyIsError(number, shift)) {
      return error$1.value;
    }

    // Return error if number is less than 0
    if (number < 0) {
      return error$1.num;
    }

    // Return error if number is a non-integer
    if (Math.floor(number) !== number) {
      return error$1.num;
    }

    // Return error if number is greater than (2^48)-1
    if (number > 281474976710655) {
      return error$1.num;
    }

    // Return error if the absolute value of shift is greater than 53
    if (Math.abs(shift) > 53) {
      return error$1.num;
    }

    // Return number shifted by shift bits to the left or to the right if shift is negative
    return (shift >= 0) ? number << shift : number >> -shift;
  };

  exports.BITOR = function(number1, number2) {
    number1 = common.parseNumber(number1);
    number2 = common.parseNumber(number2);
    if (common.anyIsError(number1, number2)) {
      return error$1.value;
    }

    // Return error if either number is less than 0
    if (number1 < 0 || number2 < 0) {
      return error$1.num;
    }

    // Return error if either number is a non-integer
    if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {
      return error$1.num;
    }

    // Return error if either number is greater than (2^48)-1
    if (number1 > 281474976710655 || number2 > 281474976710655) {
      return error$1.num;
    }

    // Return bitwise OR of two numbers
    return number1 | number2;
  };

  exports.BITRSHIFT = function(number, shift) {
    number = common.parseNumber(number);
    shift = common.parseNumber(shift);
    if (common.anyIsError(number, shift)) {
      return error$1.value;
    }

    // Return error if number is less than 0
    if (number < 0) {
      return error$1.num;
    }

    // Return error if number is a non-integer
    if (Math.floor(number) !== number) {
      return error$1.num;
    }

    // Return error if number is greater than (2^48)-1
    if (number > 281474976710655) {
      return error$1.num;
    }

    // Return error if the absolute value of shift is greater than 53
    if (Math.abs(shift) > 53) {
      return error$1.num;
    }

    // Return number shifted by shift bits to the right or to the left if shift is negative
    return (shift >= 0) ? number >> shift : number << -shift;
  };

  exports.BITXOR = function(number1, number2) {
    number1 = common.parseNumber(number1);
    number2 = common.parseNumber(number2);
    if (common.anyIsError(number1, number2)) {
      return error$1.value;
    }

    // Return error if either number is less than 0
    if (number1 < 0 || number2 < 0) {
      return error$1.num;
    }

    // Return error if either number is a non-integer
    if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {
      return error$1.num;
    }

    // Return error if either number is greater than (2^48)-1
    if (number1 > 281474976710655 || number2 > 281474976710655) {
      return error$1.num;
    }

    // Return bitwise XOR of two numbers
    return number1 ^ number2;
  };

  exports.COMPLEX = function(real, imaginary, suffix) {
    real = common.parseNumber(real);
    imaginary = common.parseNumber(imaginary);
    if (common.anyIsError(real, imaginary)) {
      return real;
    }

    // Set suffix
    suffix = (suffix === undefined) ? 'i' : suffix;

    // Return error if suffix is neither "i" nor "j"
    if (suffix !== 'i' && suffix !== 'j') {
      return error$1.value;
    }

    // Return complex number
    if (real === 0 && imaginary === 0) {
      return 0;
    } else if (real === 0) {
      return (imaginary === 1) ? suffix : imaginary.toString() + suffix;
    } else if (imaginary === 0) {
      return real.toString();
    } else {
      var sign = (imaginary > 0) ? '+' : '';
      return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);
    }
  };

  exports.CONVERT = function(number, from_unit, to_unit) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    // List of units supported by CONVERT and units defined by the International System of Units
    // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]
    var units = [
      ["a.u. of action", "?", null, "action", false, false, 1.05457168181818e-34],
      ["a.u. of charge", "e", null, "electric_charge", false, false, 1.60217653141414e-19],
      ["a.u. of energy", "Eh", null, "energy", false, false, 4.35974417757576e-18],
      ["a.u. of length", "a?", null, "length", false, false, 5.29177210818182e-11],
      ["a.u. of mass", "m?", null, "mass", false, false, 9.10938261616162e-31],
      ["a.u. of time", "?/Eh", null, "time", false, false, 2.41888432650516e-17],
      ["admiralty knot", "admkn", null, "speed", false, true, 0.514773333],
      ["ampere", "A", null, "electric_current", true, false, 1],
      ["ampere per meter", "A/m", null, "magnetic_field_intensity", true, false, 1],
      ["ngstrm", "", ["ang"], "length", false, true, 1e-10],
      ["are", "ar", null, "area", false, true, 100],
      ["astronomical unit", "ua", null, "length", false, false, 1.49597870691667e-11],
      ["bar", "bar", null, "pressure", false, false, 100000],
      ["barn", "b", null, "area", false, false, 1e-28],
      ["becquerel", "Bq", null, "radioactivity", true, false, 1],
      ["bit", "bit", ["b"], "information", false, true, 1],
      ["btu", "BTU", ["btu"], "energy", false, true, 1055.05585262],
      ["byte", "byte", null, "information", false, true, 8],
      ["candela", "cd", null, "luminous_intensity", true, false, 1],
      ["candela per square metre", "cd/m?", null, "luminance", true, false, 1],
      ["coulomb", "C", null, "electric_charge", true, false, 1],
      ["cubic ngstrm", "ang3", ["ang^3"], "volume", false, true, 1e-30],
      ["cubic foot", "ft3", ["ft^3"], "volume", false, true, 0.028316846592],
      ["cubic inch", "in3", ["in^3"], "volume", false, true, 0.000016387064],
      ["cubic light-year", "ly3", ["ly^3"], "volume", false, true, 8.46786664623715e-47],
      ["cubic metre", "m?", null, "volume", true, true, 1],
      ["cubic mile", "mi3", ["mi^3"], "volume", false, true, 4168181825.44058],
      ["cubic nautical mile", "Nmi3", ["Nmi^3"], "volume", false, true, 6352182208],
      ["cubic Pica", "Pica3", ["Picapt3", "Pica^3", "Picapt^3"], "volume", false, true, 7.58660370370369e-8],
      ["cubic yard", "yd3", ["yd^3"], "volume", false, true, 0.764554857984],
      ["cup", "cup", null, "volume", false, true, 0.0002365882365],
      ["dalton", "Da", ["u"], "mass", false, false, 1.66053886282828e-27],
      ["day", "d", ["day"], "time", false, true, 86400],
      ["degree", "", null, "angle", false, false, 0.0174532925199433],
      ["degrees Rankine", "Rank", null, "temperature", false, true, 0.555555555555556],
      ["dyne", "dyn", ["dy"], "force", false, true, 0.00001],
      ["electronvolt", "eV", ["ev"], "energy", false, true, 1.60217656514141],
      ["ell", "ell", null, "length", false, true, 1.143],
      ["erg", "erg", ["e"], "energy", false, true, 1e-7],
      ["farad", "F", null, "electric_capacitance", true, false, 1],
      ["fluid ounce", "oz", null, "volume", false, true, 0.0000295735295625],
      ["foot", "ft", null, "length", false, true, 0.3048],
      ["foot-pound", "flb", null, "energy", false, true, 1.3558179483314],
      ["gal", "Gal", null, "acceleration", false, false, 0.01],
      ["gallon", "gal", null, "volume", false, true, 0.003785411784],
      ["gauss", "G", ["ga"], "magnetic_flux_density", false, true, 1],
      ["grain", "grain", null, "mass", false, true, 0.0000647989],
      ["gram", "g", null, "mass", false, true, 0.001],
      ["gray", "Gy", null, "absorbed_dose", true, false, 1],
      ["gross registered ton", "GRT", ["regton"], "volume", false, true, 2.8316846592],
      ["hectare", "ha", null, "area", false, true, 10000],
      ["henry", "H", null, "inductance", true, false, 1],
      ["hertz", "Hz", null, "frequency", true, false, 1],
      ["horsepower", "HP", ["h"], "power", false, true, 745.69987158227],
      ["horsepower-hour", "HPh", ["hh", "hph"], "energy", false, true, 2684519.538],
      ["hour", "h", ["hr"], "time", false, true, 3600],
      ["imperial gallon (U.K.)", "uk_gal", null, "volume", false, true, 0.00454609],
      ["imperial hundredweight", "lcwt", ["uk_cwt", "hweight"], "mass", false, true, 50.802345],
      ["imperial quart (U.K)", "uk_qt", null, "volume", false, true, 0.0011365225],
      ["imperial ton", "brton", ["uk_ton", "LTON"], "mass", false, true, 1016.046909],
      ["inch", "in", null, "length", false, true, 0.0254],
      ["international acre", "uk_acre", null, "area", false, true, 4046.8564224],
      ["IT calorie", "cal", null, "energy", false, true, 4.1868],
      ["joule", "J", null, "energy", true, true, 1],
      ["katal", "kat", null, "catalytic_activity", true, false, 1],
      ["kelvin", "K", ["kel"], "temperature", true, true, 1],
      ["kilogram", "kg", null, "mass", true, true, 1],
      ["knot", "kn", null, "speed", false, true, 0.514444444444444],
      ["light-year", "ly", null, "length", false, true, 9460730472580800],
      ["litre", "L", ["l", "lt"], "volume", false, true, 0.001],
      ["lumen", "lm", null, "luminous_flux", true, false, 1],
      ["lux", "lx", null, "illuminance", true, false, 1],
      ["maxwell", "Mx", null, "magnetic_flux", false, false, 1e-18],
      ["measurement ton", "MTON", null, "volume", false, true, 1.13267386368],
      ["meter per hour", "m/h", ["m/hr"], "speed", false, true, 0.00027777777777778],
      ["meter per second", "m/s", ["m/sec"], "speed", true, true, 1],
      ["meter per second squared", "m?s??", null, "acceleration", true, false, 1],
      ["parsec", "pc", ["parsec"], "length", false, true, 30856775814671900],
      ["meter squared per second", "m?/s", null, "kinematic_viscosity", true, false, 1],
      ["metre", "m", null, "length", true, true, 1],
      ["miles per hour", "mph", null, "speed", false, true, 0.44704],
      ["millimetre of mercury", "mmHg", null, "pressure", false, false, 133.322],
      ["minute", "?", null, "angle", false, false, 0.000290888208665722],
      ["minute", "min", ["mn"], "time", false, true, 60],
      ["modern teaspoon", "tspm", null, "volume", false, true, 0.000005],
      ["mole", "mol", null, "amount_of_substance", true, false, 1],
      ["morgen", "Morgen", null, "area", false, true, 2500],
      ["n.u. of action", "?", null, "action", false, false, 1.05457168181818e-34],
      ["n.u. of mass", "m?", null, "mass", false, false, 9.10938261616162e-31],
      ["n.u. of speed", "c?", null, "speed", false, false, 299792458],
      ["n.u. of time", "?/(me?c??)", null, "time", false, false, 1.28808866778687e-21],
      ["nautical mile", "M", ["Nmi"], "length", false, true, 1852],
      ["newton", "N", null, "force", true, true, 1],
      ["rsted", "Oe ", null, "magnetic_field_intensity", false, false, 79.5774715459477],
      ["ohm", "", null, "electric_resistance", true, false, 1],
      ["ounce mass", "ozm", null, "mass", false, true, 0.028349523125],
      ["pascal", "Pa", null, "pressure", true, false, 1],
      ["pascal second", "Pa?s", null, "dynamic_viscosity", true, false, 1],
      ["pferdestrke", "PS", null, "power", false, true, 735.49875],
      ["phot", "ph", null, "illuminance", false, false, 0.0001],
      ["pica (1/6 inch)", "pica", null, "length", false, true, 0.00035277777777778],
      ["pica (1/72 inch)", "Pica", ["Picapt"], "length", false, true, 0.00423333333333333],
      ["poise", "P", null, "dynamic_viscosity", false, false, 0.1],
      ["pond", "pond", null, "force", false, true, 0.00980665],
      ["pound force", "lbf", null, "force", false, true, 4.4482216152605],
      ["pound mass", "lbm", null, "mass", false, true, 0.45359237],
      ["quart", "qt", null, "volume", false, true, 0.000946352946],
      ["radian", "rad", null, "angle", true, false, 1],
      ["second", "?", null, "angle", false, false, 0.00000484813681109536],
      ["second", "s", ["sec"], "time", true, true, 1],
      ["short hundredweight", "cwt", ["shweight"], "mass", false, true, 45.359237],
      ["siemens", "S", null, "electrical_conductance", true, false, 1],
      ["sievert", "Sv", null, "equivalent_dose", true, false, 1],
      ["slug", "sg", null, "mass", false, true, 14.59390294],
      ["square ngstrm", "ang2", ["ang^2"], "area", false, true, 1e-20],
      ["square foot", "ft2", ["ft^2"], "area", false, true, 0.09290304],
      ["square inch", "in2", ["in^2"], "area", false, true, 0.00064516],
      ["square light-year", "ly2", ["ly^2"], "area", false, true, 8.95054210748189e+31],
      ["square meter", "m?", null, "area", true, true, 1],
      ["square mile", "mi2", ["mi^2"], "area", false, true, 2589988.110336],
      ["square nautical mile", "Nmi2", ["Nmi^2"], "area", false, true, 3429904],
      ["square Pica", "Pica2", ["Picapt2", "Pica^2", "Picapt^2"], "area", false, true, 0.00001792111111111],
      ["square yard", "yd2", ["yd^2"], "area", false, true, 0.83612736],
      ["statute mile", "mi", null, "length", false, true, 1609.344],
      ["steradian", "sr", null, "solid_angle", true, false, 1],
      ["stilb", "sb", null, "luminance", false, false, 0.0001],
      ["stokes", "St", null, "kinematic_viscosity", false, false, 0.0001],
      ["stone", "stone", null, "mass", false, true, 6.35029318],
      ["tablespoon", "tbs", null, "volume", false, true, 0.0000147868],
      ["teaspoon", "tsp", null, "volume", false, true, 0.00000492892],
      ["tesla", "T", null, "magnetic_flux_density", true, true, 1],
      ["thermodynamic calorie", "c", null, "energy", false, true, 4.184],
      ["ton", "ton", null, "mass", false, true, 907.18474],
      ["tonne", "t", null, "mass", false, false, 1000],
      ["U.K. pint", "uk_pt", null, "volume", false, true, 0.00056826125],
      ["U.S. bushel", "bushel", null, "volume", false, true, 0.03523907],
      ["U.S. oil barrel", "barrel", null, "volume", false, true, 0.158987295],
      ["U.S. pint", "pt", ["us_pt"], "volume", false, true, 0.000473176473],
      ["U.S. survey mile", "survey_mi", null, "length", false, true, 1609.347219],
      ["U.S. survey/statute acre", "us_acre", null, "area", false, true, 4046.87261],
      ["volt", "V", null, "voltage", true, false, 1],
      ["watt", "W", null, "power", true, true, 1],
      ["watt-hour", "Wh", ["wh"], "energy", false, true, 3600],
      ["weber", "Wb", null, "magnetic_flux", true, false, 1],
      ["yard", "yd", null, "length", false, true, 0.9144],
      ["year", "yr", null, "time", false, true, 31557600]
    ];

    // Binary prefixes
    // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]
    var binary_prefixes = {
      Yi: ["yobi", 80, 1208925819614629174706176, "Yi", "yotta"],
      Zi: ["zebi", 70, 1180591620717411303424, "Zi", "zetta"],
      Ei: ["exbi", 60, 1152921504606846976, "Ei", "exa"],
      Pi: ["pebi", 50, 1125899906842624, "Pi", "peta"],
      Ti: ["tebi", 40, 1099511627776, "Ti", "tera"],
      Gi: ["gibi", 30, 1073741824, "Gi", "giga"],
      Mi: ["mebi", 20, 1048576, "Mi", "mega"],
      ki: ["kibi", 10, 1024, "ki", "kilo"]
    };

    // Unit prefixes
    // [Name, Multiplier, Abbreviation]
    var unit_prefixes = {
      Y: ["yotta", 1e+24, "Y"],
      Z: ["zetta", 1e+21, "Z"],
      E: ["exa", 1e+18, "E"],
      P: ["peta", 1e+15, "P"],
      T: ["tera", 1e+12, "T"],
      G: ["giga", 1e+09, "G"],
      M: ["mega", 1e+06, "M"],
      k: ["kilo", 1e+03, "k"],
      h: ["hecto", 1e+02, "h"],
      e: ["dekao", 1e+01, "e"],
      d: ["deci", 1e-01, "d"],
      c: ["centi", 1e-02, "c"],
      m: ["milli", 1e-03, "m"],
      u: ["micro", 1e-06, "u"],
      n: ["nano", 1e-09, "n"],
      p: ["pico", 1e-12, "p"],
      f: ["femto", 1e-15, "f"],
      a: ["atto", 1e-18, "a"],
      z: ["zepto", 1e-21, "z"],
      y: ["yocto", 1e-24, "y"]
    };

    // Initialize units and multipliers
    var from = null;
    var to = null;
    var base_from_unit = from_unit;
    var base_to_unit = to_unit;
    var from_multiplier = 1;
    var to_multiplier = 1;
    var alt;

    // Lookup from and to units
    for (var i = 0; i < units.length; i++) {
      alt = (units[i][2] === null) ? [] : units[i][2];
      if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {
        from = units[i];
      }
      if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {
        to = units[i];
      }
    }

    // Lookup from prefix
    if (from === null) {
      var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];
      var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];

      // Handle dekao unit prefix (only unit prefix with two characters)
      if (from_unit.substring(0, 2) === 'da') {
        from_unit_prefix = ["dekao", 1e+01, "da"];
      }

      // Handle binary prefixes first (so that 'Yi' is processed before 'Y')
      if (from_binary_prefix) {
        from_multiplier = from_binary_prefix[2];
        base_from_unit = from_unit.substring(2);
      } else if (from_unit_prefix) {
        from_multiplier = from_unit_prefix[1];
        base_from_unit = from_unit.substring(from_unit_prefix[2].length);
      }

      // Lookup from unit
      for (var j = 0; j < units.length; j++) {
        alt = (units[j][2] === null) ? [] : units[j][2];
        if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {
          from = units[j];
        }
      }
    }

    // Lookup to prefix
    if (to === null) {
      var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];
      var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];

      // Handle dekao unit prefix (only unit prefix with two characters)
      if (to_unit.substring(0, 2) === 'da') {
        to_unit_prefix = ["dekao", 1e+01, "da"];
      }

      // Handle binary prefixes first (so that 'Yi' is processed before 'Y')
      if (to_binary_prefix) {
        to_multiplier = to_binary_prefix[2];
        base_to_unit = to_unit.substring(2);
      } else if (to_unit_prefix) {
        to_multiplier = to_unit_prefix[1];
        base_to_unit = to_unit.substring(to_unit_prefix[2].length);
      }

      // Lookup to unit
      for (var k = 0; k < units.length; k++) {
        alt = (units[k][2] === null) ? [] : units[k][2];
        if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {
          to = units[k];
        }
      }
    }

    // Return error if a unit does not exist
    if (from === null || to === null) {
      return error$1.na;
    }

    // Return error if units represent different quantities
    if (from[3] !== to[3]) {
      return error$1.na;
    }

    // Return converted number
    return number * from[6] * from_multiplier / (to[6] * to_multiplier);
  };

  exports.DEC2BIN = function(number, places) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    // Return error if number is not decimal, is lower than -512, or is greater than 511
    if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {
      return error$1.num;
    }

    // Ignore places and return a 10-character binary number if number is negative
    if (number < 0) {
      return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);
    }

    // Convert decimal number to binary
    var result = parseInt(number, 10).toString(2);

    // Return binary number using the minimum number of characters necessary if places is undefined
    if (typeof places === 'undefined') {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.DEC2HEX = function(number, places) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887
    if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {
      return error$1.num;
    }

    // Ignore places and return a 10-character hexadecimal number if number is negative
    if (number < 0) {
      return (1099511627776 + number).toString(16);
    }

    // Convert decimal number to hexadecimal
    var result = parseInt(number, 10).toString(16);

    // Return hexadecimal number using the minimum number of characters necessary if places is undefined
    if (typeof places === 'undefined') {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.DEC2OCT = function(number, places) {
    number = common.parseNumber(number);
    if (number instanceof Error) {
      return number;
    }

    // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887
    if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {
      return error$1.num;
    }

    // Ignore places and return a 10-character octal number if number is negative
    if (number < 0) {
      return (1073741824 + number).toString(8);
    }

    // Convert decimal number to octal
    var result = parseInt(number, 10).toString(8);

    // Return octal number using the minimum number of characters necessary if places is undefined
    if (typeof places === 'undefined') {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.DELTA = function(number1, number2) {
    // Set number2 to zero if undefined
    number2 = (number2 === undefined) ? 0 : number2;
    number1 = common.parseNumber(number1);
    number2 = common.parseNumber(number2);
    if (common.anyIsError(number1, number2)) {
      return error$1.value;
    }

    // Return delta
    return (number1 === number2) ? 1 : 0;
  };

  // TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound
  exports.ERF = function(lower_bound, upper_bound) {
    // Set number2 to zero if undefined
    upper_bound = (upper_bound === undefined) ? 0 : upper_bound;

    lower_bound = common.parseNumber(lower_bound);
    upper_bound = common.parseNumber(upper_bound);
    if (common.anyIsError(lower_bound, upper_bound)) {
      return error$1.value;
    }

    return jstat.erf(lower_bound);
  };

  // TODO
  exports.ERF.PRECISE = function() {
    throw new Error('ERF.PRECISE is not implemented');
  };

  exports.ERFC = function(x) {
    // Return error if x is not a number
    if (isNaN(x)) {
      return error$1.value;
    }

    return jstat.erfc(x);
  };

  // TODO
  exports.ERFC.PRECISE = function() {
    throw new Error('ERFC.PRECISE is not implemented');
  };

  exports.GESTEP = function(number, step) {
    step = step || 0;
    number = common.parseNumber(number);
    if (common.anyIsError(step, number)) {
      return number;
    }

    // Return delta
    return (number >= step) ? 1 : 0;
  };

  exports.HEX2BIN = function(number, places) {
    // Return error if number is not hexadecimal or contains more than ten characters (10 digits)
    if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Check if number is negative
    var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;

    // Convert hexadecimal number to decimal
    var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);

    // Return error if number is lower than -512 or greater than 511
    if (decimal < -512 || decimal > 511) {
      return error$1.num;
    }

    // Ignore places and return a 10-character binary number if number is negative
    if (negative) {
      return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);
    }

    // Convert decimal number to binary
    var result = decimal.toString(2);

    // Return binary number using the minimum number of characters necessary if places is undefined
    if (places === undefined) {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.HEX2DEC = function(number) {
    // Return error if number is not hexadecimal or contains more than ten characters (10 digits)
    if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Convert hexadecimal number to decimal
    var decimal = parseInt(number, 16);

    // Return decimal number
    return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;
  };

  exports.HEX2OCT = function(number, places) {
    // Return error if number is not hexadecimal or contains more than ten characters (10 digits)
    if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Convert hexadecimal number to decimal
    var decimal = parseInt(number, 16);

    // Return error if number is positive and greater than 0x1fffffff (536870911)
    if (decimal > 536870911 && decimal < 1098974756864) {
      return error$1.num;
    }

    // Ignore places and return a 10-character octal number if number is negative
    if (decimal >= 1098974756864) {
      return (decimal - 1098437885952).toString(8);
    }

    // Convert decimal number to octal
    var result = decimal.toString(8);

    // Return octal number using the minimum number of characters necessary if places is undefined
    if (places === undefined) {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.IMABS = function(inumber) {
    // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    // Return error if either coefficient is not a number
    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return absolute value of complex number
    return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));
  };

  exports.IMAGINARY = function(inumber) {
    if (inumber === undefined || inumber === true || inumber === false) {
      return error$1.value;
    }

    // Return 0 if inumber is equal to 0
    if (inumber === 0 || inumber === '0') {
      return 0;
    }

    // Handle special cases
    if (['i', 'j'].indexOf(inumber) >= 0) {
      return 1;
    }

    // Force string type
    inumber = inumber + '';

    // Normalize imaginary coefficient
    inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');

    // Lookup sign
    var plus = inumber.indexOf('+');
    var minus = inumber.indexOf('-');
    if (plus === 0) {
      plus = inumber.indexOf('+', 1);
    }

    if (minus === 0) {
      minus = inumber.indexOf('-', 1);
    }

    // Lookup imaginary unit
    var last = inumber.substring(inumber.length - 1, inumber.length);
    var unit = (last === 'i' || last === 'j');

    if (plus >= 0 || minus >= 0) {
      // Return error if imaginary unit is neither i nor j
      if (!unit) {
        return error$1.num;
      }

      // Return imaginary coefficient of complex number
      if (plus >= 0) {
        return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?
          error$1.num :
          Number(inumber.substring(plus + 1, inumber.length - 1));
      } else {
        return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?
          error$1.num :
          -Number(inumber.substring(minus + 1, inumber.length - 1));
      }
    } else {
      if (unit) {
        return (isNaN(inumber.substring(0, inumber.length - 1))) ? error$1.num : inumber.substring(0, inumber.length - 1);
      } else {
        return (isNaN(inumber)) ? error$1.num : 0;
      }
    }
  };

  exports.IMARGUMENT = function(inumber) {
    // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    // Return error if either coefficient is not a number
    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return error if inumber is equal to zero
    if (x === 0 && y === 0) {
      return error$1.div0;
    }

    // Return PI/2 if x is equal to zero and y is positive
    if (x === 0 && y > 0) {
      return Math.PI / 2;
    }

    // Return -PI/2 if x is equal to zero and y is negative
    if (x === 0 && y < 0) {
      return -Math.PI / 2;
    }

    // Return zero if x is negative and y is equal to zero
    if (y === 0 && x > 0) {
      return 0;
    }

    // Return zero if x is negative and y is equal to zero
    if (y === 0 && x < 0) {
      return -Math.PI;
    }

    // Return argument of complex number
    if (x > 0) {
      return Math.atan(y / x);
    } else if (x < 0 && y >= 0) {
      return Math.atan(y / x) + Math.PI;
    } else {
      return Math.atan(y / x) - Math.PI;
    }
  };

  exports.IMCONJUGATE = function(inumber) {
    // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return conjugate of complex number
    return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;
  };

  exports.IMCOS = function(inumber) {
    // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return cosine of complex number
    return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);
  };

  exports.IMCOSH = function(inumber) {
    // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return hyperbolic cosine of complex number
    return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);
  };

  exports.IMCOT = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return cotangent of complex number
    return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));
  };

  exports.IMDIV = function(inumber1, inumber2) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var a = exports.IMREAL(inumber1);
    var b = exports.IMAGINARY(inumber1);
    var c = exports.IMREAL(inumber2);
    var d = exports.IMAGINARY(inumber2);

    if (common.anyIsError(a, b, c, d)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit1 = inumber1.substring(inumber1.length - 1);
    var unit2 = inumber2.substring(inumber2.length - 1);
    var unit = 'i';
    if (unit1 === 'j') {
      unit = 'j';
    } else if (unit2 === 'j') {
      unit = 'j';
    }

    // Return error if inumber2 is null
    if (c === 0 && d === 0) {
      return error$1.num;
    }

    // Return exponential of complex number
    var den = c * c + d * d;
    return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);
  };

  exports.IMEXP = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return exponential of complex number
    var e = Math.exp(x);
    return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);
  };

  exports.IMLN = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return exponential of complex number
    return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);
  };

  exports.IMLOG10 = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return exponential of complex number
    return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);
  };

  exports.IMLOG2 = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return exponential of complex number
    return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);
  };

  exports.IMPOWER = function(inumber, number) {
    number = common.parseNumber(number);
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);
    if (common.anyIsError(number, x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Calculate power of modulus
    var p = Math.pow(exports.IMABS(inumber), number);

    // Calculate argument
    var t = exports.IMARGUMENT(inumber);

    // Return exponential of complex number
    return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);
  };

  exports.IMPRODUCT = function() {
    // Initialize result
    var result = arguments[0];

    if (!arguments.length) {
      return error$1.value;
    }

    // Loop on all numbers
    for (var i = 1; i < arguments.length; i++) {
      // Lookup coefficients of two complex numbers
      var a = exports.IMREAL(result);
      var b = exports.IMAGINARY(result);
      var c = exports.IMREAL(arguments[i]);
      var d = exports.IMAGINARY(arguments[i]);

      if (common.anyIsError(a, b, c, d)) {
        return error$1.value;
      }

      // Complute product of two complex numbers
      result = exports.COMPLEX(a * c - b * d, a * d + b * c);
    }

    // Return product of complex numbers
    return result;
  };

  exports.IMREAL = function(inumber) {
    if (inumber === undefined || inumber === true || inumber === false) {
      return error$1.value;
    }

    // Return 0 if inumber is equal to 0
    if (inumber === 0 || inumber === '0') {
      return 0;
    }

    // Handle special cases
    if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {
      return 0;
    }

    // Force String type
    inumber = inumber + '';

    // Lookup sign
    var plus = inumber.indexOf('+');
    var minus = inumber.indexOf('-');
    if (plus === 0) {
      plus = inumber.indexOf('+', 1);
    }
    if (minus === 0) {
      minus = inumber.indexOf('-', 1);
    }

    // Lookup imaginary unit
    var last = inumber.substring(inumber.length - 1, inumber.length);
    var unit = (last === 'i' || last === 'j');

    if (plus >= 0 || minus >= 0) {
      // Return error if imaginary unit is neither i nor j
      if (!unit) {
        return error$1.num;
      }

      // Return real coefficient of complex number
      if (plus >= 0) {
        return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?
          error$1.num :
          Number(inumber.substring(0, plus));
      } else {
        return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?
          error$1.num :
          Number(inumber.substring(0, minus));
      }
    } else {
      if (unit) {
        return (isNaN(inumber.substring(0, inumber.length - 1))) ? error$1.num : 0;
      } else {
        return (isNaN(inumber)) ? error$1.num : inumber;
      }
    }
  };

  exports.IMSEC = function(inumber) {
    // Return error if inumber is a logical value
    if (inumber === true || inumber === false) {
      return error$1.value;
    }

    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return secant of complex number
    return exports.IMDIV('1', exports.IMCOS(inumber));
  };

  exports.IMSECH = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return hyperbolic secant of complex number
    return exports.IMDIV('1', exports.IMCOSH(inumber));
  };

  exports.IMSIN = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return sine of complex number
    return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);
  };

  exports.IMSINH = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Return hyperbolic sine of complex number
    return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);
  };

  exports.IMSQRT = function(inumber) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit = inumber.substring(inumber.length - 1);
    unit = (unit === 'i' || unit === 'j') ? unit : 'i';

    // Calculate power of modulus
    var s = Math.sqrt(exports.IMABS(inumber));

    // Calculate argument
    var t = exports.IMARGUMENT(inumber);

    // Return exponential of complex number
    return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);
  };

  exports.IMCSC = function (inumber) {
    // Return error if inumber is a logical value
    if (inumber === true || inumber === false) {
      return error$1.value;
    }

    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    // Return error if either coefficient is not a number
    if (common.anyIsError(x, y)) {
      return error$1.num;
    }

    // Return cosecant of complex number
    return exports.IMDIV('1', exports.IMSIN(inumber));
  };

  exports.IMCSCH = function (inumber) {
    // Return error if inumber is a logical value
    if (inumber === true || inumber === false) {
      return error$1.value;
    }

    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    // Return error if either coefficient is not a number
    if (common.anyIsError(x, y)) {
      return error$1.num;
    }

    // Return hyperbolic cosecant of complex number
    return exports.IMDIV('1', exports.IMSINH(inumber));
  };

  exports.IMSUB = function(inumber1, inumber2) {
    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var a = this.IMREAL(inumber1);
    var b = this.IMAGINARY(inumber1);
    var c = this.IMREAL(inumber2);
    var d = this.IMAGINARY(inumber2);

    if (common.anyIsError(a, b, c, d)) {
      return error$1.value;
    }

    // Lookup imaginary unit
    var unit1 = inumber1.substring(inumber1.length - 1);
    var unit2 = inumber2.substring(inumber2.length - 1);
    var unit = 'i';
    if (unit1 === 'j') {
      unit = 'j';
    } else if (unit2 === 'j') {
      unit = 'j';
    }

    // Return _ of two complex numbers
    return this.COMPLEX(a - c, b - d, unit);
  };

  exports.IMSUM = function() {
    if (!arguments.length) {
      return error$1.value;
    }
    var args = common.flatten(arguments);

    // Initialize result
    var result = args[0];

    // Loop on all numbers
    for (var i = 1; i < args.length; i++) {
      // Lookup coefficients of two complex numbers
      var a = this.IMREAL(result);
      var b = this.IMAGINARY(result);
      var c = this.IMREAL(args[i]);
      var d = this.IMAGINARY(args[i]);

      if (common.anyIsError(a, b, c, d)) {
        return error$1.value;
      }

      // Complute product of two complex numbers
      result = this.COMPLEX(a + c, b + d);
    }

    // Return sum of complex numbers
    return result;
  };

  exports.IMTAN = function(inumber) {
    // Return error if inumber is a logical value
    if (inumber === true || inumber === false) {
      return error$1.value;
    }

    // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]
    var x = exports.IMREAL(inumber);
    var y = exports.IMAGINARY(inumber);

    if (common.anyIsError(x, y)) {
      return error$1.value;
    }

    // Return tangent of complex number
    return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));
  };

  exports.OCT2BIN = function(number, places) {
    // Return error if number is not hexadecimal or contains more than ten characters (10 digits)
    if (!/^[0-7]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Check if number is negative
    var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;

    // Convert octal number to decimal
    var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);

    // Return error if number is lower than -512 or greater than 511
    if (decimal < -512 || decimal > 511) {
      return error$1.num;
    }

    // Ignore places and return a 10-character binary number if number is negative
    if (negative) {
      return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);
    }

    // Convert decimal number to binary
    var result = decimal.toString(2);

    // Return binary number using the minimum number of characters necessary if places is undefined
    if (typeof places === 'undefined') {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };

  exports.OCT2DEC = function(number) {
    // Return error if number is not octal or contains more than ten characters (10 digits)
    if (!/^[0-7]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Convert octal number to decimal
    var decimal = parseInt(number, 8);

    // Return decimal number
    return (decimal >= 536870912) ? decimal - 1073741824 : decimal;
  };

  exports.OCT2HEX = function(number, places) {
    // Return error if number is not octal or contains more than ten characters (10 digits)
    if (!/^[0-7]{1,10}$/.test(number)) {
      return error$1.num;
    }

    // Convert octal number to decimal
    var decimal = parseInt(number, 8);

    // Ignore places and return a 10-character octal number if number is negative
    if (decimal >= 536870912) {
      return 'ff' + (decimal + 3221225472).toString(16);
    }

    // Convert decimal number to hexadecimal
    var result = decimal.toString(16);

    // Return hexadecimal number using the minimum number of characters necessary if places is undefined
    if (places === undefined) {
      return result;
    } else {
      // Return error if places is nonnumeric
      if (isNaN(places)) {
        return error$1.value;
      }

      // Return error if places is negative
      if (places < 0) {
        return error$1.num;
      }

      // Truncate places in case it is not an integer
      places = Math.floor(places);

      // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)
      return (places >= result.length) ? text.REPT('0', places - result.length) + result : error$1.num;
    }
  };
  });

  var dateTime = createCommonjsModule(function (module, exports) {
  var d1900 = new Date(Date.UTC(1900, 0, 1));
  var WEEK_STARTS = [
    undefined,
    0,
    1,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    1,
    2,
    3,
    4,
    5,
    6,
    0
  ];
  var WEEK_TYPES = [
    [],
    [1, 2, 3, 4, 5, 6, 7],
    [7, 1, 2, 3, 4, 5, 6],
    [6, 0, 1, 2, 3, 4, 5],
    [],
    [],
    [],
    [],
    [],
    [],
    [],
    [7, 1, 2, 3, 4, 5, 6],
    [6, 7, 1, 2, 3, 4, 5],
    [5, 6, 7, 1, 2, 3, 4],
    [4, 5, 6, 7, 1, 2, 3],
    [3, 4, 5, 6, 7, 1, 2],
    [2, 3, 4, 5, 6, 7, 1],
    [1, 2, 3, 4, 5, 6, 7]
  ];
  var WEEKEND_TYPES = [
    [],
    [6, 0],
    [0, 1],
    [1, 2],
    [2, 3],
    [3, 4],
    [4, 5],
    [5, 6],
    undefined,
    undefined,
    undefined, [0, 0],
    [1, 1],
    [2, 2],
    [3, 3],
    [4, 4],
    [5, 5],
    [6, 6]
  ];

  exports.DATE = function (year, month, day) {
    var result;

    year = common.parseNumber(year);
    month = common.parseNumber(month);
    day = common.parseNumber(day);

    if (common.anyIsError(year, month, day)) {
      result = error$1.value;

    } else {
      result = new Date(year, month - 1, day);
      if (result.getFullYear() < 0) {
        result = error$1.num;
      }
    }

    return result;
  };

  exports.DATEDIF = function (start_date, end_date, unit) {
    unit = unit.toUpperCase();
    start_date = common.parseDate(start_date);
    end_date = common.parseDate(end_date);

    var start_date_year = start_date.getFullYear();
    var start_date_month = start_date.getMonth();
    var start_date_day = start_date.getDate();
    var end_date_year = end_date.getFullYear();
    var end_date_month = end_date.getMonth();
    var end_date_day = end_date.getDate();

    var result;
    switch (unit) {
      case 'Y':
        result = Math.floor(exports.YEARFRAC(start_date, end_date));
        break;
      case 'D':
        result = exports.DAYS(end_date, start_date);
        break;
      case 'M':
        result = end_date_month - start_date_month + 12 * (end_date_year - start_date_year);
        if (end_date_day < start_date_day) {
          result--;
        }
        break;
      case 'MD':
        if (start_date_day <= end_date_day) {
          result = end_date_day - start_date_day;
        } else {
          if (end_date_month === 0) {
            start_date.setFullYear(end_date_year - 1);
            start_date.setMonth(12);
          } else {
            start_date.setFullYear(end_date_year);
            start_date.setMonth(end_date_month - 1);
          }
          result = exports.DAYS(end_date, start_date);
        }
        break;
      case 'YM':
        result = end_date_month - start_date_month + 12 * (end_date_year - start_date_year);
        if (end_date_day < start_date_day) {
          result--;
        }
        result = result % 12;
        break;
      case 'YD':
        if (end_date_month > start_date_month || (end_date_month === start_date_month && end_date_day < start_date_day)) {
          start_date.setFullYear(end_date_year);
        } else {
          start_date.setFullYear(end_date_year - 1);
        }

        result = exports.DAYS(end_date, start_date);
        break;
    }

    return result;
  };

  exports.DATEVALUE = function (date_text) {
    if (typeof date_text !== 'string') {
      return error$1.value;
    }

    var date = Date.parse(date_text);

    if (isNaN(date)) {
      return error$1.value;
    }

    return new Date(date_text);
  };

  exports.DAY = function (serial_number) {
    var date = common.parseDate(serial_number);
    if (date instanceof Error) {
      return date;
    }

    return date.getDate();
  };

  function startOfDay(date) {
    var newDate = new Date(date);
    newDate.setHours(0, 0, 0, 0);
    return newDate;
  }

  exports.DAYS = function (end_date, start_date) {
    end_date = common.parseDate(end_date);
    start_date = common.parseDate(start_date);

    if (end_date instanceof Error) {
      return end_date;
    }
    if (start_date instanceof Error) {
      return start_date;
    }

    return serial(startOfDay(end_date)) - serial(startOfDay(start_date));
  };

  exports.DAYS360 = function (start_date, end_date, method) {
    method = common.parseBool(method || 'false');
    start_date = common.parseDate(start_date);
    end_date = common.parseDate(end_date);

    if (start_date instanceof Error) {
      return start_date;
    }
    if (end_date instanceof Error) {
      return end_date;
    }
    if (method instanceof Error) {
      return method;
    }
    var sm = start_date.getMonth();
    var em = end_date.getMonth();
    var sd, ed;

    if (method) {
      sd = start_date.getDate() === 31 ? 30 : start_date.getDate();
      ed = end_date.getDate() === 31 ? 30 : end_date.getDate();
    } else {
      var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();
      var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();
      sd = start_date.getDate() === smd ? 30 : start_date.getDate();
      if (end_date.getDate() === emd) {
        if (sd < 30) {
          em++;
          ed = 1;
        } else {
          ed = 30;
        }
      } else {
        ed = end_date.getDate();
      }
    }

    return 360 * (end_date.getFullYear() - start_date.getFullYear()) +
      30 * (em - sm) + (ed - sd);
  };

  exports.EDATE = function (start_date, months) {
    start_date = common.parseDate(start_date);

    if (start_date instanceof Error) {
      return start_date;
    }
    if (isNaN(months)) {
      return error$1.value;
    }
    months = parseInt(months, 10);
    start_date.setMonth(start_date.getMonth() + months);

    return start_date;
  };

  exports.EOMONTH = function (start_date, months) {
    start_date = common.parseDate(start_date);

    if (start_date instanceof Error) {
      return start_date;
    }
    if (isNaN(months)) {
      return error$1.value;
    }
    months = parseInt(months, 10);

    return new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0);
  };

  exports.HOUR = function (serial_number) {
    serial_number = common.parseDate(serial_number);

    if (serial_number instanceof Error) {
      return serial_number;
    }

    return serial_number.getHours();
  };

  exports.INTERVAL = function (second) {
    if (typeof second !== 'number' && typeof second !== 'string') {
      return error$1.value;
    } else {
      second = parseInt(second, 10);
    }

    var year = Math.floor(second / 946080000);
    second = second % 946080000;
    var month = Math.floor(second / 2592000);
    second = second % 2592000;
    var day = Math.floor(second / 86400);
    second = second % 86400;

    var hour = Math.floor(second / 3600);
    second = second % 3600;
    var min = Math.floor(second / 60);
    second = second % 60;
    var sec = second;

    year = (year > 0) ? year + 'Y' : '';
    month = (month > 0) ? month + 'M' : '';
    day = (day > 0) ? day + 'D' : '';
    hour = (hour > 0) ? hour + 'H' : '';
    min = (min > 0) ? min + 'M' : '';
    sec = (sec > 0) ? sec + 'S' : '';

    return 'P' + year + month + day + 'T' + hour + min + sec;
  };

  exports.ISOWEEKNUM = function (date) {
    date = common.parseDate(date);

    if (date instanceof Error) {
      return date;
    }

    date = startOfDay(date);
    date.setDate(date.getDate() + 4 - (date.getDay() || 7));
    var yearStart = new Date(date.getFullYear(), 0, 1);

    return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);
  };

  exports.MINUTE = function (serial_number) {
    serial_number = common.parseDate(serial_number);

    if (serial_number instanceof Error) {
      return serial_number;
    }

    return serial_number.getMinutes();
  };

  exports.MONTH = function (serial_number) {
    serial_number = common.parseDate(serial_number);

    if (serial_number instanceof Error) {
      return serial_number;
    }

    return serial_number.getMonth() + 1;
  };

  exports.NETWORKDAYS = function (start_date, end_date, holidays) {
    return this.NETWORKDAYS.INTL(start_date, end_date, 1, holidays);
  };

  exports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {
    start_date = common.parseDate(start_date);

    if (start_date instanceof Error) {
      return start_date;
    }
    end_date = common.parseDate(end_date);

    if (end_date instanceof Error) {
      return end_date;
    }

    var isMask = false;
    var maskDays = [];
    var maskIndex = [1, 2, 3, 4, 5, 6, 0];
    var maskRegex = new RegExp('^[0|1]{7}$');

    if (weekend === undefined) {
      weekend = WEEKEND_TYPES[1];
    } else if (typeof weekend === 'string' && maskRegex.test(weekend)) {
      isMask = true;
      weekend = weekend.split('');
      for (i = 0; i < weekend.length; i++) {
        if (weekend[i] === '1') {
          maskDays.push(maskIndex[i]);
        }
      }
    } else {
      weekend = WEEKEND_TYPES[weekend];
    }
    if (!(weekend instanceof Array)) {
      return error$1.value;
    }
    if (holidays === undefined) {
      holidays = [];
    } else if (!(holidays instanceof Array)) {
      holidays = [holidays];
    }

    for (var i = 0; i < holidays.length; i++) {
      var h = common.parseDate(holidays[i]);
      if (h instanceof Error) {
        return h;
      }
      holidays[i] = h;
    }
    var days = Math.round((end_date - start_date) / (1000 * 60 * 60 * 24)) + 1;
    var total = days;
    var day = start_date;
    for (i = 0; i < days; i++) {
      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();
      var dec = isMask ? maskDays.includes(d) : (d === weekend[0] || d === weekend[1]);
      for (var j = 0; j < holidays.length; j++) {
        var holiday = holidays[j];
        if (holiday.getDate() === day.getDate() &&
          holiday.getMonth() === day.getMonth() &&
          holiday.getFullYear() === day.getFullYear()) {
          dec = true;
          break;
        }
      }
      if (dec) {
        total--;
      }
      day.setDate(day.getDate() + 1);
    }

    return total;
  };

  exports.NOW = function () {
    return new Date();
  };

  exports.SECOND = function (serial_number) {
    serial_number = common.parseDate(serial_number);
    if (serial_number instanceof Error) {
      return serial_number;
    }

    return serial_number.getSeconds();
  };

  exports.TIME = function (hour, minute, second) {
    hour = common.parseNumber(hour);
    minute = common.parseNumber(minute);
    second = common.parseNumber(second);
    if (common.anyIsError(hour, minute, second)) {
      return error$1.value;
    }
    if (hour < 0 || minute < 0 || second < 0) {
      return error$1.num;
    }

    return (3600 * hour + 60 * minute + second) / 86400;
  };

  exports.TIMEVALUE = function (time_text) {
    time_text = common.parseDate(time_text);

    if (time_text instanceof Error) {
      return time_text;
    }

    return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;
  };

  exports.TODAY = function () {
    return startOfDay(new Date());
  };

  exports.WEEKDAY = function (serial_number, return_type) {
    serial_number = common.parseDate(serial_number);
    if (serial_number instanceof Error) {
      return serial_number;
    }
    if (return_type === undefined) {
      return_type = 1;
    }
    var day = serial_number.getDay();

    return WEEK_TYPES[return_type][day];
  };

  exports.WEEKNUM = function (serial_number, return_type) {
    serial_number = common.parseDate(serial_number);
    if (serial_number instanceof Error) {
      return serial_number;
    }
    if (return_type === undefined) {
      return_type = 1;
    }
    if (return_type === 21) {
      return this.ISOWEEKNUM(serial_number);
    }
    var week_start = WEEK_STARTS[return_type];
    var jan = new Date(serial_number.getFullYear(), 0, 1);
    var inc = jan.getDay() < week_start ? 1 : 0;
    jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;

    return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;
  };

  exports.WORKDAY = function (start_date, days, holidays) {
    return this.WORKDAY.INTL(start_date, days, 1, holidays);
  };

  exports.WORKDAY.INTL = function (start_date, days, weekend, holidays) {
    start_date = common.parseDate(start_date);
    if (start_date instanceof Error) {
      return start_date;
    }
    days = common.parseNumber(days);
    if (days instanceof Error) {
      return days;
    }
    if (days < 0) {
      return error$1.num;
    }
    if (weekend === undefined) {
      weekend = WEEKEND_TYPES[1];
    } else {
      weekend = WEEKEND_TYPES[weekend];
    }
    if (!(weekend instanceof Array)) {
      return error$1.value;
    }
    if (holidays === undefined) {
      holidays = [];
    } else if (!(holidays instanceof Array)) {
      holidays = [holidays];
    }
    for (var i = 0; i < holidays.length; i++) {
      var h = common.parseDate(holidays[i]);
      if (h instanceof Error) {
        return h;
      }
      holidays[i] = h;
    }
    var d = 0;
    while (d < days) {
      start_date.setDate(start_date.getDate() + 1);
      var day = start_date.getDay();
      if (day === weekend[0] || day === weekend[1]) {
        continue;
      }
      for (var j = 0; j < holidays.length; j++) {
        var holiday = holidays[j];
        if (holiday.getDate() === start_date.getDate() &&
          holiday.getMonth() === start_date.getMonth() &&
          holiday.getFullYear() === start_date.getFullYear()) {
          d--;
          break;
        }
      }
      d++;
    }

    return start_date;
  };

  exports.YEAR = function (serial_number) {
    serial_number = common.parseDate(serial_number);

    if (serial_number instanceof Error) {
      return serial_number;
    }

    return serial_number.getFullYear();
  };

  function isLeapYear(year) {
    return new Date(year, 1, 29).getMonth() === 1;
  }

  // TODO : Use DAYS ?
  function daysBetween(start_date, end_date) {
    return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);
  }

  exports.YEARFRAC = function (start_date, end_date, basis) {
    start_date = common.parseDate(start_date);
    if (start_date instanceof Error) {
      return start_date;
    }
    end_date = common.parseDate(end_date);
    if (end_date instanceof Error) {
      return end_date;
    }

    basis = basis || 0;
    var sd = start_date.getDate();
    var sm = start_date.getMonth() + 1;
    var sy = start_date.getFullYear();
    var ed = end_date.getDate();
    var em = end_date.getMonth() + 1;
    var ey = end_date.getFullYear();

    switch (basis) {
      case 0:
        // US (NASD) 30/360
        if (sd === 31 && ed === 31) {
          sd = 30;
          ed = 30;
        } else if (sd === 31) {
          sd = 30;
        } else if (sd === 30 && ed === 31) {
          ed = 30;
        }
        return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;
      case 1:
        // Actual/actual
        var feb29Between = function (date1, date2) {
          var year1 = date1.getFullYear();
          var mar1year1 = new Date(year1, 2, 1);
          if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {
            return true;
          }
          var year2 = date2.getFullYear();
          var mar1year2 = new Date(year2, 2, 1);
          return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);
        };
        var ylength = 365;
        if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {
          if ((sy === ey && isLeapYear(sy)) ||
            feb29Between(start_date, end_date) ||
            (em === 1 && ed === 29)) {
            ylength = 366;
          }
          return daysBetween(start_date, end_date) / ylength;
        }
        var years = (ey - sy) + 1;
        var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;
        var average = days / years;
        return daysBetween(start_date, end_date) / average;
      case 2:
        // Actual/360
        return daysBetween(start_date, end_date) / 360;
      case 3:
        // Actual/365
        return daysBetween(start_date, end_date) / 365;
      case 4:
        // European 30/360
        return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;
    }
  };

  function serial(date) {
    var addOn = (date > -2203891200000) ? 2 : 1;

    return Math.ceil((date - d1900) / 86400000) + addOn;
  }
  });

  var compatibility = createCommonjsModule(function (module, exports) {
  function set(fn, root) {
    if (root) {
      for (var i in root) {
        fn[i] = root[i];
      }
    }

    return fn;
  }

  exports.BETADIST = statistical.BETA.DIST;
  exports.BETAINV = statistical.BETA.INV;
  exports.BINOMDIST = statistical.BINOM.DIST;
  exports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);
  exports.CEILINGMATH = mathTrig.CEILING.MATH;
  exports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;
  exports.CHIDIST = statistical.CHISQ.DIST;
  exports.CHIDISTRT = statistical.CHISQ.DIST.RT;
  exports.CHIINV = statistical.CHISQ.INV;
  exports.CHIINVRT = statistical.CHISQ.INV.RT;
  exports.CHITEST = statistical.CHISQ.TEST;
  exports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);
  exports.COVAR = statistical.COVARIANCE.P;
  exports.COVARIANCEP = statistical.COVARIANCE.P;
  exports.COVARIANCES = statistical.COVARIANCE.S;
  exports.CRITBINOM = statistical.BINOM.INV;
  exports.EXPONDIST = statistical.EXPON.DIST;
  exports.ERFCPRECISE = engineering.ERFC.PRECISE;
  exports.ERFPRECISE = engineering.ERF.PRECISE;
  exports.FDIST = statistical.F.DIST;
  exports.FDISTRT = statistical.F.DIST.RT;
  exports.FINVRT = statistical.F.INV.RT;
  exports.FINV = statistical.F.INV;
  exports.FLOOR = set(mathTrig.FLOOR.MATH, mathTrig.FLOOR);
  exports.FLOORMATH = mathTrig.FLOOR.MATH;
  exports.FLOORPRECISE = mathTrig.FLOOR.PRECISE;
  exports.FTEST = statistical.F.TEST;
  exports.GAMMADIST = statistical.GAMMA.DIST;
  exports.GAMMAINV = statistical.GAMMA.INV;
  exports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;
  exports.HYPGEOMDIST = statistical.HYPGEOM.DIST;
  exports.LOGINV = statistical.LOGNORM.INV;
  exports.LOGNORMINV = statistical.LOGNORM.INV;
  exports.LOGNORMDIST = statistical.LOGNORM.DIST;
  exports.MODE = set(statistical.MODE.SNGL, statistical.MODE);
  exports.MODEMULT = statistical.MODE.MULT;
  exports.MODESNGL = statistical.MODE.SNGL;
  exports.NEGBINOMDIST = statistical.NEGBINOM.DIST;
  exports.NETWORKDAYSINTL = dateTime.NETWORKDAYS.INTL;
  exports.NORMDIST = statistical.NORM.DIST;
  exports.NORMINV = statistical.NORM.INV;
  exports.NORMSDIST = statistical.NORM.S.DIST;
  exports.NORMSINV = statistical.NORM.S.INV;
  exports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);
  exports.PERCENTILEEXC = statistical.PERCENTILE.EXC;
  exports.PERCENTILEINC = statistical.PERCENTILE.INC;
  exports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);
  exports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;
  exports.PERCENTRANKINC = statistical.PERCENTRANK.INC;
  exports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);
  exports.POISSONDIST = statistical.POISSON.DIST;
  exports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);
  exports.QUARTILEEXC = statistical.QUARTILE.EXC;
  exports.QUARTILEINC = statistical.QUARTILE.INC;
  exports.RANK = set(statistical.RANK.EQ, statistical.RANK);
  exports.RANKAVG = statistical.RANK.AVG;
  exports.RANKEQ = statistical.RANK.EQ;
  exports.SKEWP = statistical.SKEW.P;
  exports.STDEV = set(statistical.STDEV.S, statistical.STDEV);
  exports.STDEVP = statistical.STDEV.P;
  exports.STDEVS = statistical.STDEV.S;
  exports.TDIST = statistical.T.DIST;
  exports.TDISTRT = statistical.T.DIST.RT;
  exports.TINV = statistical.T.INV;
  exports.TTEST = statistical.T.TEST;
  exports.VAR = set(statistical.VAR.S, statistical.VAR);
  exports.VARP = statistical.VAR.P;
  exports.VARS = statistical.VAR.S;
  exports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);
  exports.WEIBULLDIST = statistical.WEIBULL.DIST;
  exports.WORKDAYINTL = dateTime.WORKDAY.INTL;
  exports.ZTEST = statistical.Z.TEST;
  });

  var database = createCommonjsModule(function (module, exports) {
  function compact(array) {
    var result = [];

    common.arrayEach(array, function(value) {
      if (value) {
        result.push(value);
      }
    });

    return result;
  }

  exports.FINDFIELD = function(database, title) {
    var index = null;

    common.arrayEach(database, function(value, i) {
      if (value[0] === title) {
        index = i;
        return false;
      }
    });

    // Return error if the input field title is incorrect
    if (index == null) {
      return error$1.value;
    }

    return index;
  };

  function findResultIndex(database, criterias) {
    var matches = {};
    for (var i = 1; i < database[0].length; ++i) {
      matches[i] = true;
    }
    var maxCriteriaLength = criterias[0].length;
    for (i = 1; i < criterias.length; ++i) {
      if (criterias[i].length > maxCriteriaLength) {
        maxCriteriaLength = criterias[i].length;
      }
    }

    for (var k = 1; k < database.length; ++k) {
      for (var l = 1; l < database[k].length; ++l) {
        var currentCriteriaResult = false;
        var hasMatchingCriteria   = false;
        for (var j = 0; j < criterias.length; ++j) {
          var criteria = criterias[j];
          if (criteria.length < maxCriteriaLength) {
            continue;
          }

          var criteriaField = criteria[0];
          if (database[k][0] !== criteriaField) {
            continue;
          }
          hasMatchingCriteria = true;
          for (var p = 1; p < criteria.length; ++p) {
            if (!currentCriteriaResult) {
              var isWildcard = criteria[p] === void 0 || criteria[p] === '*';

              if (isWildcard) {
                currentCriteriaResult = true;
              } else {
                var tokenizedCriteria = criteriaEval.parse(criteria[p] + '');
                var tokens = [criteriaEval.createToken(database[k][l], criteriaEval.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);

                currentCriteriaResult = criteriaEval.compute(tokens);
              }
            }
          }
        }
        if (hasMatchingCriteria) {
          matches[l] = matches[l] && currentCriteriaResult;
        }
      }
    }

    var result = [];
    for (var n = 0; n < database[0].length; ++n) {
      if (matches[n]) {
        result.push(n - 1);
      }
    }

    return result;
  }

  // Database functions
  exports.DAVERAGE = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }
    var sum = 0;

    common.arrayEach(resultIndexes, function(value) {
      sum += targetFields[value];
    });

    return resultIndexes.length === 0 ? error$1.div0 : sum / resultIndexes.length;
  };

  exports.DCOUNT = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });

    return statistical.COUNT(targetValues);
  };

  exports.DCOUNTA = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }

    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });

    return statistical.COUNTA(targetValues);
  };

  exports.DGET = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }

    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    // Return error if no record meets the criteria
    if (resultIndexes.length === 0) {
      return error$1.value;
    }
    // Returns the #NUM! error value because more than one record meets the
    // criteria
    if (resultIndexes.length > 1) {
      return error$1.num;
    }

    return targetFields[resultIndexes[0]];
  };

  exports.DMAX = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var maxValue = targetFields[resultIndexes[0]];

    common.arrayEach(resultIndexes, function(value) {
      if (maxValue < targetFields[value]) {
        maxValue = targetFields[value];
      }
    });

    return maxValue;
  };

  exports.DMIN = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }

    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var minValue = targetFields[resultIndexes[0]];

    common.arrayEach(resultIndexes, function(value) {
      if (minValue > targetFields[value]) {
        minValue = targetFields[value];
      }
    });

    return minValue;
  };

  exports.DPRODUCT = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }

    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });
    targetValues = compact(targetValues);

    var result = 1;

    common.arrayEach(targetValues, function(value) {
      result *= value;
    });

    return result;
  };

  exports.DSTDEV = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }
    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });
    targetValues = compact(targetValues);

    return statistical.STDEV.S(targetValues);
  };

  exports.DSTDEVP = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });
    targetValues = compact(targetValues);

    return statistical.STDEV.P(targetValues);
  };

  exports.DSUM = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }

    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });

    return mathTrig.SUM(targetValues);
  };

  exports.DVAR = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }
    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });

    return statistical.VAR.S(targetValues);
  };

  exports.DVARP = function(database, field, criteria) {
    // Return error if field is not a number and not a string
    if (isNaN(field) && (typeof field !== "string")) {
      return error$1.value;
    }
    var resultIndexes = findResultIndex(database, criteria);
    var targetFields = [];

    if (typeof field === "string") {
      var index = exports.FINDFIELD(database, field);
      targetFields = common.rest(database[index]);
    } else {
      targetFields = common.rest(database[field]);
    }
    var targetValues = [];

    common.arrayEach(resultIndexes, function(value) {
      targetValues.push(targetFields[value]);
    });

    return statistical.VAR.P(targetValues);
  };
  });

  var AND = function() {
    var args = common.flatten(arguments);
    var result = error$1.value;
    for (var i = 0; i < args.length; i++) {
      if (args[i] instanceof Error) {
        return args[i];
      }
      if (args[i] === undefined || args[i] === null || typeof args[i] === "string") {
        continue;
      }
      if (result === error$1.value) {
        result = true;
      }
      if (!args[i]) {
        result = false;
      }
    }
    return result;
  };

  var CHOOSE = function() {
    if (arguments.length < 2) {
      return error$1.na;
    }

    var index = arguments[0];
    if (index < 1 || index > 254) {
      return error$1.value;
    }

    if (arguments.length < index + 1) {
      return error$1.value;
    }

    return arguments[index];
  };

  var FALSE = function() {
    return false;
  };

  var IF = function(test, then_value, otherwise_value) {
    if (test instanceof Error) {
      return test;
    }
    then_value = arguments.length >= 2 ? then_value : true;
    if (then_value === undefined || then_value === null) {
      then_value = 0;
    }
    otherwise_value = arguments.length === 3 ? otherwise_value : false;
    if (otherwise_value === undefined || otherwise_value === null) {
      otherwise_value = 0;
    }
    return test ? then_value : otherwise_value;
  };

  var IFS = function() {
    for (var i = 0; i < arguments.length / 2; i++) {
      if (arguments[i * 2]) {
        return arguments[i * 2 + 1];
      }
    }
    return error$1.na;
  };

  var IFERROR = function(value, valueIfError) {
    if (information.ISERROR(value)) {
      return valueIfError;
    }
    return value;
  };

  var IFNA = function(value, value_if_na) {
    return value === error$1.na ? value_if_na : value;
  };

  var NOT = function(logical) {
    if (typeof logical === "string") {
      return error$1.value;
    }
    if (logical instanceof Error) {
      return logical;
    }
    return !logical;
  };

  var OR = function() {
    var args = common.flatten(arguments);
    var result = error$1.value;
    for (var i = 0; i < args.length; i++) {
      if (args[i] instanceof Error) {
        return args[i];
      }
      if (args[i] === undefined || args[i] === null || typeof args[i] === "string") {
        continue;
      }
      if (result === error$1.value) {
        result = false;
      }
      if (args[i]) {
        result = true;
      }
    }
    return result;
  };

  var TRUE = function() {
    return true;
  };

  var XOR = function() {
    var args = common.flatten(arguments);
    var result = error$1.value;
    for (var i = 0; i < args.length; i++) {
      if (args[i] instanceof Error) {
        return args[i];
      }
      if (args[i] === undefined || args[i] === null || typeof args[i] === "string") {
        continue;
      }
      if (result === error$1.value) {
        result = 0;
      }
      if (args[i]) {
        result++;
      }
    }
    if (result === error$1.value) {
      return result;
    }
    return (Math.floor(Math.abs(result)) & 1) ? true : false;
  };

  var SWITCH = function () {
    var result;

    if (arguments.length > 0)  {
      var targetValue = arguments[0];
      var argc = arguments.length - 1;
      var switchCount = Math.floor(argc / 2);
      var switchSatisfied = false;
      var hasDefaultClause = argc % 2 !== 0;
      var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];

      if (switchCount) {
        for (var index = 0; index < switchCount; index++) {
          if (targetValue === arguments[index * 2 + 1]) {
            result = arguments[index * 2 + 2];
            switchSatisfied = true;
            break;
          }
        }
      }

      if (!switchSatisfied) {
        result = hasDefaultClause ? defaultClause : error$1.na;
      }
    } else {
      result = error$1.value;
    }

    return result;
  };

  var logical = {
  	AND: AND,
  	CHOOSE: CHOOSE,
  	FALSE: FALSE,
  	IF: IF,
  	IFS: IFS,
  	IFERROR: IFERROR,
  	IFNA: IFNA,
  	NOT: NOT,
  	OR: OR,
  	TRUE: TRUE,
  	XOR: XOR,
  	SWITCH: SWITCH
  };

  var financial = createCommonjsModule(function (module, exports) {
  function validDate(d) {
    return d && d.getTime && !isNaN(d.getTime());
  }

  function ensureDate(d) {
    return (d instanceof Date)?d:new Date(d);
  }

  exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {
    // Return error if either date is invalid
    issue      = ensureDate(issue);
    first      = ensureDate(first);
    settlement = ensureDate(settlement);
    if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {
      return error$1.value;
    }

    // Return error if either rate or par are lower than or equal to zero
    if (rate <= 0 || par <= 0) {
      return error$1.num;
    }

    // Return error if frequency is neither 1, 2, or 4
    if ([1, 2, 4].indexOf(frequency) === -1) {
      return error$1.num;
    }

    // Return error if basis is neither 0, 1, 2, 3, or 4
    if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {
      return error$1.num;
    }

    // Return error if settlement is before or equal to issue
    if (settlement <= issue) {
      return error$1.num;
    }

    // Set default values
    par   = par   || 0;
    basis = basis || 0;

    // Compute accrued interest
    return par * rate * dateTime.YEARFRAC(issue, settlement, basis);
  };

  // TODO
  exports.ACCRINTM = function() {
    throw new Error('ACCRINTM is not implemented');
  };

  // TODO
  exports.AMORDEGRC = function() {
    throw new Error('AMORDEGRC is not implemented');
  };

  // TODO
  exports.AMORLINC = function() {
    throw new Error('AMORLINC is not implemented');
  };

  // TODO
  exports.COUPDAYBS = function() {
    throw new Error('COUPDAYBS is not implemented');
  };

  // TODO
  exports.COUPDAYS = function() {
    throw new Error('COUPDAYS is not implemented');
  };

  // TODO
  exports.COUPDAYSNC = function() {
    throw new Error('COUPDAYSNC is not implemented');
  };

  // TODO
  exports.COUPNCD = function() {
    throw new Error('COUPNCD is not implemented');
  };

  // TODO
  exports.COUPNUM = function() {
    throw new Error('COUPNUM is not implemented');
  };

  // TODO
  exports.COUPPCD = function() {
    throw new Error('COUPPCD is not implemented');
  };

  exports.CUMIPMT = function(rate, periods, value, start, end, type) {
    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    value = common.parseNumber(value);
    if (common.anyIsError(rate, periods, value)) {
      return error$1.value;
    }

    if (rate <= 0 || periods <= 0 || value <= 0) {
      return error$1.num;
    }

    if (start < 1 || end < 1 || start > end) {
      return error$1.num;
    }

    if (type !== 0 && type !== 1) {
      return error$1.num;
    }

    var payment = exports.PMT(rate, periods, value, 0, type);
    var interest = 0;

    if (start === 1) {
      if (type === 0) {
        interest = -value;
      }
      start++;
    }

    for (var i = start; i <= end; i++) {
      if (type === 1) {
        interest += exports.FV(rate, i - 2, payment, value, 1) - payment;
      } else {
        interest += exports.FV(rate, i - 1, payment, value, 0);
      }
    }
    interest *= rate;

    return interest;
  };

  exports.CUMPRINC = function(rate, periods, value, start, end, type) {
    // Credits: algorithm inspired by Apache OpenOffice
    // Credits: Hannes Stiebitzhofer for the translations of function and variable names

    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    value = common.parseNumber(value);
    if (common.anyIsError(rate, periods, value)) {
      return error$1.value;
    }

    // Return error if either rate, periods, or value are lower than or equal to zero
    if (rate <= 0 || periods <= 0 || value <= 0) {
      return error$1.num;
    }

    // Return error if start < 1, end < 1, or start > end
    if (start < 1 || end < 1 || start > end) {
      return error$1.num;
    }

    // Return error if type is neither 0 nor 1
    if (type !== 0 && type !== 1) {
      return error$1.num;
    }

    // Compute cumulative principal
    var payment = exports.PMT(rate, periods, value, 0, type);
    var principal = 0;
    if (start === 1) {
      if (type === 0) {
        principal = payment + value * rate;
      } else {
        principal = payment;
      }
      start++;
    }
    for (var i = start; i <= end; i++) {
      if (type > 0) {
        principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;
      } else {
        principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;
      }
    }

    // Return cumulative principal
    return principal;
  };

  exports.DB = function(cost, salvage, life, period, month) {
    // Initialize month
    month = (month === undefined) ? 12 : month;

    cost = common.parseNumber(cost);
    salvage = common.parseNumber(salvage);
    life = common.parseNumber(life);
    period = common.parseNumber(period);
    month = common.parseNumber(month);
    if (common.anyIsError(cost, salvage, life, period, month)) {
      return error$1.value;
    }

    // Return error if any of the parameters is negative
    if (cost < 0 || salvage < 0 || life < 0 || period < 0) {
      return error$1.num;
    }

    // Return error if month is not an integer between 1 and 12
    if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {
      return error$1.num;
    }

    // Return error if period is greater than life
    if (period > life) {
      return error$1.num;
    }

    // Return 0 (zero) if salvage is greater than or equal to cost
    if (salvage >= cost) {
      return 0;
    }

    // Rate is rounded to three decimals places
    var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);

    // Compute initial depreciation
    var initial = cost * rate * month / 12;

    // Compute total depreciation
    var total = initial;
    var current = 0;
    var ceiling = (period === life) ? life - 1 : period;
    for (var i = 2; i <= ceiling; i++) {
      current = (cost - total) * rate;
      total += current;
    }

    // Depreciation for the first and last periods are special cases
    if (period === 1) {
      // First period
      return initial;
    } else if (period === life) {
      // Last period
      return (cost - total) * rate;
    } else {
      return current;
    }
  };

  exports.DDB = function(cost, salvage, life, period, factor) {
    // Initialize factor
    factor = (factor === undefined) ? 2 : factor;

    cost = common.parseNumber(cost);
    salvage = common.parseNumber(salvage);
    life = common.parseNumber(life);
    period = common.parseNumber(period);
    factor = common.parseNumber(factor);
    if (common.anyIsError(cost, salvage, life, period, factor)) {
      return error$1.value;
    }

    // Return error if any of the parameters is negative or if factor is null
    if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {
      return error$1.num;
    }

    // Return error if period is greater than life
    if (period > life) {
      return error$1.num;
    }

    // Return 0 (zero) if salvage is greater than or equal to cost
    if (salvage >= cost) {
      return 0;
    }

    // Compute depreciation
    var total = 0;
    var current = 0;
    for (var i = 1; i <= period; i++) {
      current = Math.min((cost - total) * (factor / life), (cost - salvage - total));
      total += current;
    }

    // Return depreciation
    return current;
  };

  // TODO
  exports.DISC = function() {
    throw new Error('DISC is not implemented');
  };

  exports.DOLLARDE = function(dollar, fraction) {
    // Credits: algorithm inspired by Apache OpenOffice

    dollar = common.parseNumber(dollar);
    fraction = common.parseNumber(fraction);
    if (common.anyIsError(dollar, fraction)) {
      return error$1.value;
    }

    // Return error if fraction is negative
    if (fraction < 0) {
      return error$1.num;
    }

    // Return error if fraction is greater than or equal to 0 and less than 1
    if (fraction >= 0 && fraction < 1) {
      return error$1.div0;
    }

    // Truncate fraction if it is not an integer
    fraction = parseInt(fraction, 10);

    // Compute integer part
    var result = parseInt(dollar, 10);

    // Add decimal part
    result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;

    // Round result
    var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);
    result = Math.round(result * power) / power;

    // Return converted dollar price
    return result;
  };

  exports.DOLLARFR = function(dollar, fraction) {
    // Credits: algorithm inspired by Apache OpenOffice

    dollar = common.parseNumber(dollar);
    fraction = common.parseNumber(fraction);
    if (common.anyIsError(dollar, fraction)) {
      return error$1.value;
    }

    // Return error if fraction is negative
    if (fraction < 0) {
      return error$1.num;
    }

    // Return error if fraction is greater than or equal to 0 and less than 1
    if (fraction >= 0 && fraction < 1) {
      return error$1.div0;
    }

    // Truncate fraction if it is not an integer
    fraction = parseInt(fraction, 10);

    // Compute integer part
    var result = parseInt(dollar, 10);

    // Add decimal part
    result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;

    // Return converted dollar price
    return result;
  };

  // TODO
  exports.DURATION = function() {
    throw new Error('DURATION is not implemented');
  };

  exports.EFFECT = function(rate, periods) {
    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    if (common.anyIsError(rate, periods)) {
      return error$1.value;
    }

    // Return error if rate <=0 or periods < 1
    if (rate <= 0 || periods < 1) {
      return error$1.num;
    }

    // Truncate periods if it is not an integer
    periods = parseInt(periods, 10);

    // Return effective annual interest rate
    return Math.pow(1 + rate / periods, periods) - 1;
  };

  exports.FV = function(rate, periods, payment, value, type) {
    // Credits: algorithm inspired by Apache OpenOffice

    value = value || 0;
    type = type || 0;

    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    payment = common.parseNumber(payment);
    value = common.parseNumber(value);
    type = common.parseNumber(type);
    if (common.anyIsError(rate, periods, payment, value, type)) {
      return error$1.value;
    }

    // Return future value
    var result;
    if (rate === 0) {
      result = value + payment * periods;
    } else {
      var term = Math.pow(1 + rate, periods);
      if (type === 1) {
        result = value * term + payment * (1 + rate) * (term - 1) / rate;
      } else {
        result = value * term + payment * (term - 1) / rate;
      }
    }
    return -result;
  };

  exports.FVSCHEDULE = function(principal, schedule) {
    principal = common.parseNumber(principal);
    schedule = common.parseNumberArray(common.flatten(schedule));
    if (common.anyIsError(principal, schedule)) {
      return error$1.value;
    }

    var n = schedule.length;
    var future = principal;

    // Apply all interests in schedule
    for (var i = 0; i < n; i++) {
      // Apply scheduled interest
      future *= 1 + schedule[i];
    }

    // Return future value
    return future;
  };

  // TODO
  exports.INTRATE = function() {
    throw new Error('INTRATE is not implemented');
  };

  exports.IPMT = function(rate, period, periods, present, future, type) {
    // Credits: algorithm inspired by Apache OpenOffice

    future = future || 0;
    type = type || 0;

    rate = common.parseNumber(rate);
    period = common.parseNumber(period);
    periods = common.parseNumber(periods);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    type = common.parseNumber(type);
    if (common.anyIsError(rate, period, periods, present, future, type)) {
      return error$1.value;
    }

    // Compute payment
    var payment = exports.PMT(rate, periods, present, future, type);

    // Compute interest
    var interest;
    if (period === 1) {
      if (type === 1) {
        interest = 0;
      } else {
        interest = -present;
      }
    } else {
      if (type === 1) {
        interest = exports.FV(rate, period - 2, payment, present, 1) - payment;
      } else {
        interest = exports.FV(rate, period - 1, payment, present, 0);
      }
    }

    // Return interest
    return interest * rate;
  };

  exports.IRR = function(values, guess) {
    // Credits: algorithm inspired by Apache OpenOffice

    guess = guess || 0;

    values = common.parseNumberArray(common.flatten(values));
    guess = common.parseNumber(guess);
    if (common.anyIsError(values, guess)) {
      return error$1.value;
    }

    // Calculates the resulting amount
    var irrResult = function(values, dates, rate) {
      var r = rate + 1;
      var result = values[0];
      for (var i = 1; i < values.length; i++) {
        result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);
      }
      return result;
    };

    // Calculates the first derivation
    var irrResultDeriv = function(values, dates, rate) {
      var r = rate + 1;
      var result = 0;
      for (var i = 1; i < values.length; i++) {
        var frac = (dates[i] - dates[0]) / 365;
        result -= frac * values[i] / Math.pow(r, frac + 1);
      }
      return result;
    };

    // Initialize dates and check that values contains at least one positive value and one negative value
    var dates = [];
    var positive = false;
    var negative = false;
    for (var i = 0; i < values.length; i++) {
      dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;
      if (values[i] > 0) {
        positive = true;
      }
      if (values[i] < 0) {
        negative = true;
      }
    }

    // Return error if values does not contain at least one positive value and one negative value
    if (!positive || !negative) {
      return error$1.num;
    }

    // Initialize guess and resultRate
    guess = (guess === undefined) ? 0.1 : guess;
    var resultRate = guess;

    // Set maximum epsilon for end of iteration
    var epsMax = 1e-10;

    // Implement Newton's method
    var newRate, epsRate, resultValue;
    var contLoop = true;
    do {
      resultValue = irrResult(values, dates, resultRate);
      newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);
      epsRate = Math.abs(newRate - resultRate);
      resultRate = newRate;
      contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);
    } while (contLoop);

    // Return internal rate of return
    return resultRate;
  };

  exports.ISPMT = function(rate, period, periods, value) {
    rate = common.parseNumber(rate);
    period = common.parseNumber(period);
    periods = common.parseNumber(periods);
    value = common.parseNumber(value);
    if (common.anyIsError(rate, period, periods, value)) {
      return error$1.value;
    }

    // Return interest
    return value * rate * (period / periods - 1);
  };

  // TODO
  exports.MDURATION = function() {
    throw new Error('MDURATION is not implemented');
  };

  exports.MIRR = function(values, finance_rate, reinvest_rate) {
    values = common.parseNumberArray(common.flatten(values));
    finance_rate = common.parseNumber(finance_rate);
    reinvest_rate = common.parseNumber(reinvest_rate);
    if (common.anyIsError(values, finance_rate, reinvest_rate)) {
      return error$1.value;
    }

    // Initialize number of values
    var n = values.length;

    // Lookup payments (negative values) and incomes (positive values)
    var payments = [];
    var incomes = [];
    for (var i = 0; i < n; i++) {
      if (values[i] < 0) {
        payments.push(values[i]);
      } else {
        incomes.push(values[i]);
      }
    }

    // Return modified internal rate of return
    var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);
    var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);
    return Math.pow(num / den, 1 / (n - 1)) - 1;
  };

  exports.NOMINAL = function(rate, periods) {
    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    if (common.anyIsError(rate, periods)) {
      return error$1.value;
    }

    // Return error if rate <=0 or periods < 1
    if (rate <= 0 || periods < 1) {
      return error$1.num;
    }

    // Truncate periods if it is not an integer
    periods = parseInt(periods, 10);

    // Return nominal annual interest rate
    return (Math.pow(rate + 1, 1 / periods) - 1) * periods;
  };

  exports.NPER = function(rate, payment, present, future, type) {
    type = (type === undefined) ? 0 : type;
    future = (future === undefined) ? 0 : future;

    rate = common.parseNumber(rate);
    payment = common.parseNumber(payment);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    type = common.parseNumber(type);

    if (common.anyIsError(rate, payment, present, future, type)) {
      return error$1.value;
    }

    if (rate === 0) {
      return (-(present + future) / payment);
    } else {
      var num = payment * (1 + rate * type) - future * rate;
      var den = (present * rate + payment * (1 + rate * type));
      return Math.log(num / den) / Math.log(1 + rate);
    }
  };

  exports.NPV = function() {
    var args = common.parseNumberArray(common.flatten(arguments));
    if (args instanceof Error) {
      return args;
    }

    // Lookup rate
    var rate = args[0];

    // Initialize net present value
    var value = 0;

    // Loop on all values
    for (var j = 1; j < args.length; j++) {
      value += args[j] / Math.pow(1 + rate, j);
    }

    // Return net present value
    return value;
  };

  // TODO
  exports.ODDFPRICE = function() {
    throw new Error('ODDFPRICE is not implemented');
  };

  // TODO
  exports.ODDFYIELD = function() {
    throw new Error('ODDFYIELD is not implemented');
  };

  // TODO
  exports.ODDLPRICE = function() {
    throw new Error('ODDLPRICE is not implemented');
  };

  // TODO
  exports.ODDLYIELD = function() {
    throw new Error('ODDLYIELD is not implemented');
  };

  exports.PDURATION = function(rate, present, future) {
    rate = common.parseNumber(rate);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    if (common.anyIsError(rate, present, future)) {
      return error$1.value;
    }

    // Return error if rate <=0
    if (rate <= 0) {
      return error$1.num;
    }

    // Return number of periods
    return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);
  };

  exports.PMT = function(rate, periods, present, future, type) {
    // Credits: algorithm inspired by Apache OpenOffice

    future = future || 0;
    type = type || 0;

    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    type = common.parseNumber(type);
    if (common.anyIsError(rate, periods, present, future, type)) {
      return error$1.value;
    }

    // Return payment
    var result;
    if (rate === 0) {
      result = (present + future) / periods;
    } else {
      var term = Math.pow(1 + rate, periods);
      if (type === 1) {
        result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);
      } else {
        result = future * rate / (term - 1) + present * rate / (1 - 1 / term);
      }
    }
    return -result;
  };

  exports.PPMT = function(rate, period, periods, present, future, type) {
    future = future || 0;
    type = type || 0;

    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    type = common.parseNumber(type);
    if (common.anyIsError(rate, periods, present, future, type)) {
      return error$1.value;
    }

    return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);
  };

  // TODO
  exports.PRICE = function() {
    throw new Error('PRICE is not implemented');
  };

  // TODO
  exports.PRICEDISC = function() {
    throw new Error('PRICEDISC is not implemented');
  };

  // TODO
  exports.PRICEMAT = function() {
    throw new Error('PRICEMAT is not implemented');
  };

  exports.PV = function(rate, periods, payment, future, type) {
    future = future || 0;
    type = type || 0;

    rate = common.parseNumber(rate);
    periods = common.parseNumber(periods);
    payment = common.parseNumber(payment);
    future = common.parseNumber(future);
    type = common.parseNumber(type);
    if (common.anyIsError(rate, periods, payment, future, type)) {
      return error$1.value;
    }

    // Return present value
    if (rate === 0) {
      return -payment * periods - future;
    } else {
      return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);
    }
  };

  exports.RATE = function(periods, payment, present, future, type, guess) {
    guess = (guess === undefined) ? 0.01 : guess;
    future = (future === undefined) ? 0 : future;
    type = (type === undefined) ? 0 : type;

    periods = common.parseNumber(periods);
    payment = common.parseNumber(payment);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    type = common.parseNumber(type);
    guess = common.parseNumber(guess);
    if (common.anyIsError(periods, payment, present, future, type, guess)) {
      return error$1.value;
    }

    var epsMax = 1e-10;
    var iterMax = 20;
    var rate = guess;

    type = type ? 1 : 0;
    for (var i = 0; i < iterMax; i++) {
      if (rate <= -1) {
        return error$1.num;
      }
      var y, f;
      if (Math.abs(rate) < epsMax) {
        y = present * (1 + periods * rate) + payment * (1 + rate * type) * periods + future;
      } else {
        f = Math.pow(1 + rate, periods);
        y = present * f + payment * (1 / rate + type) * (f - 1) + future;
      }
      if (Math.abs(y) < epsMax) {
        return rate;
      }
      var dy;
      if (Math.abs(rate) < epsMax) {
        dy = present * periods + payment * type * periods;
      } else {
        f = Math.pow(1 + rate, periods);
        var df = periods * Math.pow(1 + rate, periods - 1);
        dy = present * df + payment * (1 / rate + type) * df + payment * (-1 / (rate * rate)) * (f - 1);
      }
      rate -= y / dy;
    }

    return rate;
  };

  // TODO
  exports.RECEIVED = function() {
    throw new Error('RECEIVED is not implemented');
  };

  exports.RRI = function(periods, present, future) {
    periods = common.parseNumber(periods);
    present = common.parseNumber(present);
    future = common.parseNumber(future);
    if (common.anyIsError(periods, present, future)) {
      return error$1.value;
    }

    // Return error if periods or present is equal to 0 (zero)
    if (periods === 0 || present === 0) {
      return error$1.num;
    }

    // Return equivalent interest rate
    return Math.pow(future / present, 1 / periods) - 1;
  };

  exports.SLN = function(cost, salvage, life) {
    cost = common.parseNumber(cost);
    salvage = common.parseNumber(salvage);
    life = common.parseNumber(life);
    if (common.anyIsError(cost, salvage, life)) {
      return error$1.value;
    }

    // Return error if life equal to 0 (zero)
    if (life === 0) {
      return error$1.num;
    }

    // Return straight-line depreciation
    return (cost - salvage) / life;
  };

  exports.SYD = function(cost, salvage, life, period) {
    // Return error if any of the parameters is not a number
    cost = common.parseNumber(cost);
    salvage = common.parseNumber(salvage);
    life = common.parseNumber(life);
    period = common.parseNumber(period);
    if (common.anyIsError(cost, salvage, life, period)) {
      return error$1.value;
    }

    // Return error if life equal to 0 (zero)
    if (life === 0) {
      return error$1.num;
    }

    // Return error if period is lower than 1 or greater than life
    if (period < 1 || period > life) {
      return error$1.num;
    }

    // Truncate period if it is not an integer
    period = parseInt(period, 10);

    // Return straight-line depreciation
    return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));
  };

  exports.TBILLEQ = function(settlement, maturity, discount) {
    settlement = common.parseDate(settlement);
    maturity = common.parseDate(maturity);
    discount = common.parseNumber(discount);
    if (common.anyIsError(settlement, maturity, discount)) {
      return error$1.value;
    }

    // Return error if discount is lower than or equal to zero
    if (discount <= 0) {
      return error$1.num;
    }

    // Return error if settlement is greater than maturity
    if (settlement > maturity) {
      return error$1.num;
    }

    // Return error if maturity is more than one year after settlement
    if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {
      return error$1.num;
    }

    // Return bond-equivalent yield
    return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));
  };

  exports.TBILLPRICE = function(settlement, maturity, discount) {
    settlement = common.parseDate(settlement);
    maturity = common.parseDate(maturity);
    discount = common.parseNumber(discount);
    if (common.anyIsError(settlement, maturity, discount)) {
      return error$1.value;
    }

    // Return error if discount is lower than or equal to zero
    if (discount <= 0) {
      return error$1.num;
    }

    // Return error if settlement is greater than maturity
    if (settlement > maturity) {
      return error$1.num;
    }

    // Return error if maturity is more than one year after settlement
    if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {
      return error$1.num;
    }

    // Return bond-equivalent yield
    return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);
  };

  exports.TBILLYIELD = function(settlement, maturity, price) {
    settlement = common.parseDate(settlement);
    maturity = common.parseDate(maturity);
    price = common.parseNumber(price);
    if (common.anyIsError(settlement, maturity, price)) {
      return error$1.value;
    }

    // Return error if price is lower than or equal to zero
    if (price <= 0) {
      return error$1.num;
    }

    // Return error if settlement is greater than maturity
    if (settlement > maturity) {
      return error$1.num;
    }

    // Return error if maturity is more than one year after settlement
    if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {
      return error$1.num;
    }

    // Return bond-equivalent yield
    return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));
  };

  // TODO
  exports.VDB = function() {
    throw new Error('VDB is not implemented');
  };

  exports.XIRR = function(values, dates, guess) {
    // Credits: algorithm inspired by Apache OpenOffice

    values = common.parseNumberArray(common.flatten(values));
    dates = common.parseDateArray(common.flatten(dates));
    guess = common.parseNumber(guess);

    if (common.anyIsError(values, dates, guess)) {
      return error$1.value;
    }

    // Calculates the resulting amount
    var irrResult = function(values, dates, rate) {
      var r = rate + 1;
      var result = values[0];
      for (var i = 1; i < values.length; i++) {
        result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);
      }
      return result;
    };

    // Calculates the first derivation
    var irrResultDeriv = function(values, dates, rate) {
      var r = rate + 1;
      var result = 0;
      for (var i = 1; i < values.length; i++) {
        var frac = dateTime.DAYS(dates[i], dates[0]) / 365;
        result -= frac * values[i] / Math.pow(r, frac + 1);
      }
      return result;
    };

    // Check that values contains at least one positive value and one negative value
    var positive = false;
    var negative = false;
    for (var i = 0; i < values.length; i++) {
      if (values[i] > 0) {
        positive = true;
      }
      if (values[i] < 0) {
        negative = true;
      }
    }

    // Return error if values does not contain at least one positive value and one negative value
    if (!positive || !negative) {
      return error$1.num;
    }

    // Initialize guess and resultRate
    guess = guess || 0.1;
    var resultRate = guess;

    // Set maximum epsilon for end of iteration
    var epsMax = 1e-10;

    // Implement Newton's method
    var newRate, epsRate, resultValue;
    var contLoop = true;
    do {
      resultValue = irrResult(values, dates, resultRate);
      newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);
      epsRate = Math.abs(newRate - resultRate);
      resultRate = newRate;
      contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);
    } while (contLoop);

    // Return internal rate of return
    return resultRate;
  };

  exports.XNPV = function(rate, values, dates) {
    rate = common.parseNumber(rate);
    values = common.parseNumberArray(common.flatten(values));
    dates = common.parseDateArray(common.flatten(dates));
    if (common.anyIsError(rate, values, dates)) {
      return error$1.value;
    }

    var result = 0;
    for (var i = 0; i < values.length; i++) {
      result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);
    }
    return result;
  };

  // TODO
  exports.YIELD = function() {
    throw new Error('YIELD is not implemented');
  };

  // TODO
  exports.YIELDDISC = function() {
    throw new Error('YIELDDISC is not implemented');
  };

  // TODO
  exports.YIELDMAT = function() {
    throw new Error('YIELDMAT is not implemented');
  };
  });

  var lookupReference = createCommonjsModule(function (module, exports) {
  exports.MATCH = function (lookupValue, lookupArray, matchType) {
    if (!lookupValue && !lookupArray) {
      return error$1.na;
    }

    if (arguments.length === 2) {
      matchType = 1;
    }
    if (!(lookupArray instanceof Array)) {
      return error$1.na;
    }

    lookupArray = common.flatten(lookupArray);

    if (matchType !== -1 && matchType !== 0 && matchType !== 1) {
      return error$1.na;
    }
    var index;
    var indexValue;
    for (var idx = 0; idx < lookupArray.length; idx++) {
      if (matchType === 1) {
        if (lookupArray[idx] === lookupValue) {
          return idx + 1;
        } else if (lookupArray[idx] < lookupValue) {
          if (!indexValue) {
            index = idx + 1;
            indexValue = lookupArray[idx];
          } else if (lookupArray[idx] > indexValue) {
            index = idx + 1;
            indexValue = lookupArray[idx];
          }
        }
      } else if (matchType === 0) {
        if (typeof lookupValue === 'string') {
          lookupValue = lookupValue.replace(/\?/g, '.');
          if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {
            return idx + 1;
          }
        } else {
          if (lookupArray[idx] === lookupValue) {
            return idx + 1;
          }
        }
      } else if (matchType === -1) {
        if (lookupArray[idx] === lookupValue) {
          return idx + 1;
        } else if (lookupArray[idx] > lookupValue) {
          if (!indexValue) {
            index = idx + 1;
            indexValue = lookupArray[idx];
          } else if (lookupArray[idx] < indexValue) {
            index = idx + 1;
            indexValue = lookupArray[idx];
          }
        }
      }
    }

    return index ? index : error$1.na;
  };

  exports.VLOOKUP = function (needle, table, index, rangeLookup) {
    if (!table || !index) {
      return error$1.na;
    }

    rangeLookup = !(rangeLookup === 0 || rangeLookup === false);
    var result = error$1.na;
    var isNumberLookup = (typeof needle === "number");
    var exactMatchOnly = false;
    for (var i = 0; i < table.length; i++) {
      var row = table[i];

      if (row[0] === needle) {
        result = (index < (row.length + 1) ? row[index - 1] : error$1.ref);
        break;
      } else if (!exactMatchOnly && ((isNumberLookup && rangeLookup && row[0] <= needle) ||
        (rangeLookup && typeof row[0] === "string" && row[0].localeCompare(needle) < 0))) {
        result = (index < (row.length + 1) ? row[index - 1] : error$1.ref);
      }

      if (isNumberLookup && row[0] > needle) {
        exactMatchOnly = true;
      }
    }

    return result;
  };

  exports.HLOOKUP = function (needle, table, index, rangeLookup) {
    return exports.VLOOKUP(needle, common.transpose(table), index, rangeLookup);
  };

  exports.LOOKUP = function (searchCriterion, array, resultArray) {
    array = common.flatten(array);
    resultArray = common.flatten(resultArray);
    var isNumberLookup = (typeof searchCriterion === "number");
    var result = error$1.na;

    for (var i = 0; i < array.length; i++) {
      if (array[i] === searchCriterion) {
        return resultArray[i];
      } else if ((isNumberLookup && array[i] <= searchCriterion) ||
        (typeof array[i] === "string" && array[i].localeCompare(searchCriterion) < 0)) {
        result = resultArray[i];
      } else if ((isNumberLookup && array[i] > searchCriterion)) {
        return result;
      }
    }

    return result;
  };

  exports.INDEX = function (cellRange, rowNumber, columnNumber) {
    var someError = common.anyError(cellRange, rowNumber, columnNumber);
    if (someError) {
      return someError;
    }

    if (!Array.isArray(cellRange)) {
      return error$1.value;
    }

    var isOneDimensionRange = cellRange.length > 0 && !Array.isArray(cellRange[0]);

    if (isOneDimensionRange && !columnNumber) {
      columnNumber = rowNumber;
      rowNumber = 1;
    } else {
      columnNumber = columnNumber ? columnNumber : 1;
      rowNumber = rowNumber ? rowNumber : 1;
    }

    if (columnNumber < 0 || rowNumber < 0) {
      return error$1.value;
    }

    if (isOneDimensionRange && rowNumber === 1 && columnNumber <= cellRange.length) {
      return cellRange[columnNumber - 1];
    } else if (rowNumber <= cellRange.length && columnNumber <= cellRange[rowNumber - 1].length) {
      return cellRange[rowNumber - 1][columnNumber - 1];
    }

    return error$1.ref;
  };
  });

  var formulajs = createCommonjsModule(function (module, exports) {
  var categories = [
    compatibility,
    database,
    engineering,
    logical,
    mathTrig,
    text,
    dateTime,
    financial,
    information,
    lookupReference,
    statistical,
    miscellaneous
  ];

  for (var c in categories) {
    var category = categories[c];
    for (var f in category) {
      exports[f] = exports[f] || category[f];
    }
  }
  exports.utils = {
    errors: error$1
  };
  });

  var formulajs$1 = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.assign(/*#__PURE__*/Object.create(null), formulajs, {
    'default': formulajs
  }));

  var SUPPORTED_FORMULAS = Object.keys(formulajs$1);

  var SYMBOL$4 = SUPPORTED_FORMULAS;
  function func$4(symbol) {
    return function __formulaFunction() {
      symbol = symbol.toUpperCase();
      var symbolParts = symbol.split('.');
      var foundFormula = false;
      var result;

      if (symbolParts.length === 1) {
        if (formulajs$1[symbolParts[0]]) {
          foundFormula = true;
          result = formulajs$1[symbolParts[0]].apply(formulajs$1, arguments);
        }
      } else {
        var length = symbolParts.length;
        var index = 0;
        var nestedFormula = formulajs$1;

        while (index < length) {
          nestedFormula = nestedFormula[symbolParts[index]];
          index++;

          if (!nestedFormula) {
            nestedFormula = null;
            break;
          }
        }

        if (nestedFormula) {
          foundFormula = true;
          result = nestedFormula.apply(void 0, arguments);
        }
      }

      if (!foundFormula) {
        throw Error(ERROR_NAME);
      }

      return result;
    };
  }
  func$4.isFactory = true;
  func$4.SYMBOL = SYMBOL$4;

  var SYMBOL$5 = '>';
  function func$5(exp1, exp2) {
    return exp1 > exp2;
  }
  func$5.SYMBOL = SYMBOL$5;

  var SYMBOL$6 = '>=';
  function func$6(exp1, exp2) {
    return exp1 >= exp2;
  }
  func$6.SYMBOL = SYMBOL$6;

  var SYMBOL$7 = '<';
  function func$7(exp1, exp2) {
    return exp1 < exp2;
  }
  func$7.SYMBOL = SYMBOL$7;

  var SYMBOL$8 = '<=';
  function func$8(exp1, exp2) {
    return exp1 <= exp2;
  }
  func$8.SYMBOL = SYMBOL$8;

  var SYMBOL$9 = '-';
  function func$9(first) {
    for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      rest[_key - 1] = arguments[_key];
    }

    var result = rest.reduce(function (acc, value) {
      return acc - toNumber(value);
    }, toNumber(first));

    if (isNaN(result)) {
      throw Error(ERROR_VALUE);
    }

    return result;
  }
  func$9.SYMBOL = SYMBOL$9;

  var SYMBOL$a = '*';
  function func$a(first) {
    for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      rest[_key - 1] = arguments[_key];
    }

    var result = rest.reduce(function (acc, value) {
      return acc * toNumber(value);
    }, toNumber(first));

    if (isNaN(result)) {
      throw Error(ERROR_VALUE);
    }

    return result;
  }
  func$a.SYMBOL = SYMBOL$a;

  var SYMBOL$b = '<>';
  function func$b(exp1, exp2) {
    return exp1 !== exp2;
  }
  func$b.SYMBOL = SYMBOL$b;

  var SYMBOL$c = '^';
  function func$c(exp1, exp2) {
    var result = Math.pow(toNumber(exp1), toNumber(exp2));

    if (isNaN(result)) {
      throw Error(ERROR_VALUE);
    }

    return result;
  }
  func$c.SYMBOL = SYMBOL$c;

  function _toConsumableArray$1(arr) {
    return _arrayWithoutHoles$1(arr) || _iterableToArray$1(arr) || _unsupportedIterableToArray$1(arr) || _nonIterableSpread$1();
  }

  function _nonIterableSpread$1() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _unsupportedIterableToArray$1(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray$1(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$1(o, minLen);
  }

  function _iterableToArray$1(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
  }

  function _arrayWithoutHoles$1(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray$1(arr);
  }

  function _arrayLikeToArray$1(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) {
      arr2[i] = arr[i];
    }

    return arr2;
  }
  var availableOperators = Object.create(null);
  /**
   * Evaluate values by operator id.git
   *
   * @param {String} operator Operator id.
   * @param {Array} [params=[]] Arguments to evaluate.
   * @returns {*}
   */

  function evaluateByOperator(operator) {
    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    operator = operator.toUpperCase();

    if (!availableOperators[operator]) {
      throw Error(ERROR_NAME);
    }

    return availableOperators[operator].apply(availableOperators, _toConsumableArray$1(params));
  }
  /**
   * Register operator.
   *
   * @param {String|Array} symbol Symbol to register.
   * @param {Function} func Logic to register for this symbol.
   */

  function registerOperation(symbol, func) {
    if (!Array.isArray(symbol)) {
      symbol = [symbol.toUpperCase()];
    }

    symbol.forEach(function (s) {
      if (func.isFactory) {
        availableOperators[s] = func(s);
      } else {
        availableOperators[s] = func;
      }
    });
  }
  registerOperation(func.SYMBOL, func);
  registerOperation(func$1.SYMBOL, func$1);
  registerOperation(func$2.SYMBOL, func$2);
  registerOperation(func$3.SYMBOL, func$3);
  registerOperation(func$c.SYMBOL, func$c);
  registerOperation(func$4.SYMBOL, func$4);
  registerOperation(func$5.SYMBOL, func$5);
  registerOperation(func$6.SYMBOL, func$6);
  registerOperation(func$7.SYMBOL, func$7);
  registerOperation(func$8.SYMBOL, func$8);
  registerOperation(func$a.SYMBOL, func$a);
  registerOperation(func$b.SYMBOL, func$b);
  registerOperation(func$9.SYMBOL, func$9);

  /* parser generated by jison 0.4.18 */

  /*
    Returns a Parser object of the following structure:

    Parser: {
      yy: {}
    }

    Parser.prototype: {
      yy: {},
      trace: function(),
      symbols_: {associative list: name ==> number},
      terminals_: {associative list: number ==> name},
      productions_: [...],
      performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),
      table: [...],
      defaultActions: {...},
      parseError: function(str, hash),
      parse: function(input),

      lexer: {
          EOF: 1,
          parseError: function(str, hash),
          setInput: function(input),
          input: function(),
          unput: function(str),
          more: function(),
          less: function(n),
          pastInput: function(),
          upcomingInput: function(),
          showPosition: function(),
          test_match: function(regex_match_array, rule_index),
          next: function(),
          lex: function(),
          begin: function(condition),
          popState: function(),
          _currentRules: function(),
          topState: function(),
          pushState: function(condition),

          options: {
              ranges: boolean           (optional: true ==> token location info will include a .range[] member)
              flex: boolean             (optional: true ==> flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)
              backtrack_lexer: boolean  (optional: true ==> lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)
          },

          performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),
          rules: [...],
          conditions: {associative list: name ==> set},
      }
    }


    token location info (@$, _$, etc.): {
      first_line: n,
      last_line: n,
      first_column: n,
      last_column: n,
      range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)
    }


    the parseError function receives a 'hash' object with these members for lexer and parser errors: {
      text:        (matched text)
      token:       (the produced terminal token, if any)
      line:        (yylineno)
    }
    while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {
      loc:         (yylloc)
      expected:    (string describing the set of expected tokens)
      recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)
    }
  */
  var o = function o(k, v, _o, l) {
    for (_o = _o || {}, l = k.length; l--; _o[k[l]] = v) {
    }

    return _o;
  },
      $V0 = [1, 5],
      $V1 = [1, 8],
      $V2 = [1, 6],
      $V3 = [1, 7],
      $V4 = [1, 9],
      $V5 = [1, 14],
      $V6 = [1, 15],
      $V7 = [1, 16],
      $V8 = [1, 12],
      $V9 = [1, 13],
      $Va = [1, 17],
      $Vb = [1, 19],
      $Vc = [1, 20],
      $Vd = [1, 21],
      $Ve = [1, 22],
      $Vf = [1, 23],
      $Vg = [1, 24],
      $Vh = [1, 25],
      $Vi = [1, 26],
      $Vj = [1, 27],
      $Vk = [1, 28],
      $Vl = [5, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 29, 30],
      $Vm = [5, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 29, 30, 32],
      $Vn = [5, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 29, 30, 34],
      $Vo = [5, 10, 11, 13, 14, 15, 16, 17, 29, 30],
      $Vp = [5, 10, 13, 14, 15, 16, 29, 30],
      $Vq = [5, 10, 11, 13, 14, 15, 16, 17, 18, 19, 29, 30],
      $Vr = [13, 29, 30];

  var parser = {
    trace: function trace() {},
    yy: {},
    symbols_: {
      "error": 2,
      "expressions": 3,
      "expression": 4,
      "EOF": 5,
      "variableSequence": 6,
      "number": 7,
      "STRING": 8,
      "&": 9,
      "=": 10,
      "+": 11,
      "(": 12,
      ")": 13,
      "<": 14,
      ">": 15,
      "NOT": 16,
      "-": 17,
      "*": 18,
      "/": 19,
      "^": 20,
      "FUNCTION": 21,
      "expseq": 22,
      "cell": 23,
      "ABSOLUTE_CELL": 24,
      "RELATIVE_CELL": 25,
      "MIXED_CELL": 26,
      ":": 27,
      "ARRAY": 28,
      ";": 29,
      ",": 30,
      "VARIABLE": 31,
      "DECIMAL": 32,
      "NUMBER": 33,
      "%": 34,
      "ERROR": 35,
      "$accept": 0,
      "$end": 1
    },
    terminals_: {
      5: "EOF",
      8: "STRING",
      9: "&",
      10: "=",
      11: "+",
      12: "(",
      13: ")",
      14: "<",
      15: ">",
      16: "NOT",
      17: "-",
      18: "*",
      19: "/",
      20: "^",
      21: "FUNCTION",
      24: "ABSOLUTE_CELL",
      25: "RELATIVE_CELL",
      26: "MIXED_CELL",
      27: ":",
      28: "ARRAY",
      29: ";",
      30: ",",
      31: "VARIABLE",
      32: "DECIMAL",
      33: "NUMBER",
      34: "%",
      35: "ERROR"
    },
    productions_: [0, [3, 2], [4, 1], [4, 1], [4, 1], [4, 3], [4, 3], [4, 3], [4, 3], [4, 4], [4, 4], [4, 4], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 3], [4, 2], [4, 2], [4, 3], [4, 4], [4, 1], [4, 1], [4, 2], [23, 1], [23, 1], [23, 1], [23, 3], [23, 3], [23, 3], [23, 3], [23, 3], [23, 3], [23, 3], [23, 3], [23, 3], [22, 1], [22, 1], [22, 3], [22, 3], [6, 1], [6, 3], [7, 1], [7, 3], [7, 2], [2, 1]],
    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate
    /* action[1] */
    , $$
    /* vstack */
    , _$
    /* lstack */
    ) {
      /* this == yyval */
      var $0 = $$.length - 1;

      switch (yystate) {
        case 1:
          return $$[$0 - 1];

        case 2:
          this.$ = yy.callVariable($$[$0][0]);
          break;

        case 3:
          this.$ = yy.toNumber($$[$0]);
          break;

        case 4:
          this.$ = yy.trimEdges($$[$0]);
          break;

        case 5:
          this.$ = yy.evaluateByOperator('&', [$$[$0 - 2], $$[$0]]);
          break;

        case 6:
          this.$ = yy.evaluateByOperator('=', [$$[$0 - 2], $$[$0]]);
          break;

        case 7:
          this.$ = yy.evaluateByOperator('+', [$$[$0 - 2], $$[$0]]);
          break;

        case 8:
          this.$ = $$[$0 - 1];
          break;

        case 9:
          this.$ = yy.evaluateByOperator('<=', [$$[$0 - 3], $$[$0]]);
          break;

        case 10:
          this.$ = yy.evaluateByOperator('>=', [$$[$0 - 3], $$[$0]]);
          break;

        case 11:
          this.$ = yy.evaluateByOperator('<>', [$$[$0 - 3], $$[$0]]);
          break;

        case 12:
          this.$ = yy.evaluateByOperator('NOT', [$$[$0 - 2], $$[$0]]);
          break;

        case 13:
          this.$ = yy.evaluateByOperator('>', [$$[$0 - 2], $$[$0]]);
          break;

        case 14:
          this.$ = yy.evaluateByOperator('<', [$$[$0 - 2], $$[$0]]);
          break;

        case 15:
          this.$ = yy.evaluateByOperator('-', [$$[$0 - 2], $$[$0]]);
          break;

        case 16:
          this.$ = yy.evaluateByOperator('*', [$$[$0 - 2], $$[$0]]);
          break;

        case 17:
          this.$ = yy.evaluateByOperator('/', [$$[$0 - 2], $$[$0]]);
          break;

        case 18:
          this.$ = yy.evaluateByOperator('^', [$$[$0 - 2], $$[$0]]);
          break;

        case 19:
          var n1 = yy.invertNumber($$[$0]);
          this.$ = n1;

          if (isNaN(this.$)) {
            this.$ = 0;
          }

          break;

        case 20:
          var n1 = yy.toNumber($$[$0]);
          this.$ = n1;

          if (isNaN(this.$)) {
            this.$ = 0;
          }

          break;

        case 21:
          this.$ = yy.callFunction($$[$0 - 2]);
          break;

        case 22:
          this.$ = yy.callFunction($$[$0 - 3], $$[$0 - 1]);
          break;

        case 26:
        case 27:
        case 28:
          this.$ = yy.cellValue($$[$0]);
          break;

        case 29:
        case 30:
        case 31:
        case 32:
        case 33:
        case 34:
        case 35:
        case 36:
        case 37:
          this.$ = yy.rangeValue($$[$0 - 2], $$[$0]);
          break;

        case 38:
        case 42:
          this.$ = [$$[$0]];
          break;

        case 39:
          this.$ = yy.trimEdges(yytext).split(',');
          break;

        case 40:
        case 41:
          $$[$0 - 2].push($$[$0]);
          this.$ = $$[$0 - 2];
          break;

        case 43:
          this.$ = Array.isArray($$[$0 - 2]) ? $$[$0 - 2] : [$$[$0 - 2]];
          this.$.push($$[$0]);
          break;

        case 44:
          this.$ = $$[$0];
          break;

        case 45:
          this.$ = ($$[$0 - 2] + '.' + $$[$0]) * 1;
          break;

        case 46:
          this.$ = $$[$0 - 1] * 0.01;
          break;

        case 47:
          this.$ = yy.throwError($$[$0]);
          break;
      }
    },
    table: [{
      2: 11,
      3: 1,
      4: 2,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      1: [3]
    }, {
      5: [1, 18],
      9: $Vb,
      10: $Vc,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }, o($Vl, [2, 2], {
      32: [1, 29]
    }), o($Vl, [2, 3], {
      34: [1, 30]
    }), o($Vl, [2, 4]), {
      2: 11,
      4: 31,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 32,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 33,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      12: [1, 34]
    }, o($Vl, [2, 23]), o($Vl, [2, 24], {
      2: 35,
      35: $Va
    }), o($Vm, [2, 42]), o($Vn, [2, 44], {
      32: [1, 36]
    }), o($Vl, [2, 26], {
      27: [1, 37]
    }), o($Vl, [2, 27], {
      27: [1, 38]
    }), o($Vl, [2, 28], {
      27: [1, 39]
    }), o([5, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 29, 30, 35], [2, 47]), {
      1: [2, 1]
    }, {
      2: 11,
      4: 40,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 41,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 42,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 45,
      6: 3,
      7: 4,
      8: $V0,
      10: [1, 43],
      11: $V1,
      12: $V2,
      15: [1, 44],
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 47,
      6: 3,
      7: 4,
      8: $V0,
      10: [1, 46],
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 48,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 49,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 50,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 51,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 52,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      31: [1, 53]
    }, o($Vn, [2, 46]), {
      9: $Vb,
      10: $Vc,
      11: $Vd,
      13: [1, 54],
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }, o($Vo, [2, 19], {
      9: $Vb,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vo, [2, 20], {
      9: $Vb,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), {
      2: 11,
      4: 57,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      13: [1, 55],
      17: $V3,
      21: $V4,
      22: 56,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      28: [1, 58],
      31: $V8,
      33: $V9,
      35: $Va
    }, o($Vl, [2, 25]), {
      33: [1, 59]
    }, {
      24: [1, 60],
      25: [1, 61],
      26: [1, 62]
    }, {
      24: [1, 63],
      25: [1, 64],
      26: [1, 65]
    }, {
      24: [1, 66],
      25: [1, 67],
      26: [1, 68]
    }, o($Vl, [2, 5]), o([5, 10, 13, 29, 30], [2, 6], {
      9: $Vb,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vo, [2, 7], {
      9: $Vb,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), {
      2: 11,
      4: 69,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 70,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, o($Vp, [2, 14], {
      9: $Vb,
      11: $Vd,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), {
      2: 11,
      4: 71,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, o($Vp, [2, 13], {
      9: $Vb,
      11: $Vd,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o([5, 10, 13, 16, 29, 30], [2, 12], {
      9: $Vb,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vo, [2, 15], {
      9: $Vb,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vq, [2, 16], {
      9: $Vb,
      20: $Vk
    }), o($Vq, [2, 17], {
      9: $Vb,
      20: $Vk
    }), o([5, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 29, 30], [2, 18], {
      9: $Vb
    }), o($Vm, [2, 43]), o($Vl, [2, 8]), o($Vl, [2, 21]), {
      13: [1, 72],
      29: [1, 73],
      30: [1, 74]
    }, o($Vr, [2, 38], {
      9: $Vb,
      10: $Vc,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vr, [2, 39]), o($Vn, [2, 45]), o($Vl, [2, 29]), o($Vl, [2, 30]), o($Vl, [2, 31]), o($Vl, [2, 32]), o($Vl, [2, 33]), o($Vl, [2, 34]), o($Vl, [2, 35]), o($Vl, [2, 36]), o($Vl, [2, 37]), o($Vp, [2, 9], {
      9: $Vb,
      11: $Vd,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vp, [2, 11], {
      9: $Vb,
      11: $Vd,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vp, [2, 10], {
      9: $Vb,
      11: $Vd,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vl, [2, 22]), {
      2: 11,
      4: 75,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, {
      2: 11,
      4: 76,
      6: 3,
      7: 4,
      8: $V0,
      11: $V1,
      12: $V2,
      17: $V3,
      21: $V4,
      23: 10,
      24: $V5,
      25: $V6,
      26: $V7,
      31: $V8,
      33: $V9,
      35: $Va
    }, o($Vr, [2, 40], {
      9: $Vb,
      10: $Vc,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    }), o($Vr, [2, 41], {
      9: $Vb,
      10: $Vc,
      11: $Vd,
      14: $Ve,
      15: $Vf,
      16: $Vg,
      17: $Vh,
      18: $Vi,
      19: $Vj,
      20: $Vk
    })],
    defaultActions: {
      18: [2, 1]
    },
    parseError: function parseError(str, hash) {
      if (hash.recoverable) {
        this.trace(str);
      } else {
        var error = new Error(str);
        error.hash = hash;
        throw error;
      }
    },
    parse: function parse(input) {
      var self = this,
          stack = [0],
          // token stack
      vstack = [null],
          // semantic value stack
      lstack = [],
          // location stack
      table = this.table,
          yytext = '',
          yylineno = 0,
          yyleng = 0,
          recovering = 0,
          TERROR = 2,
          EOF = 1;
      var args = lstack.slice.call(arguments, 1); //this.reductionCount = this.shiftCount = 0;

      var lexer = Object.create(this.lexer);
      var sharedState = {
        yy: {}
      }; // copy state

      for (var k in this.yy) {
        if (Object.prototype.hasOwnProperty.call(this.yy, k)) {
          sharedState.yy[k] = this.yy[k];
        }
      }

      lexer.setInput(input, sharedState.yy);
      sharedState.yy.lexer = lexer;
      sharedState.yy.parser = this;

      if (typeof lexer.yylloc == 'undefined') {
        lexer.yylloc = {};
      }

      var yyloc = lexer.yylloc;
      lstack.push(yyloc);
      var ranges = lexer.options && lexer.options.ranges;

      if (typeof sharedState.yy.parseError === 'function') {
        this.parseError = sharedState.yy.parseError;
      } else {
        this.parseError = Object.getPrototypeOf(this).parseError;
      }

      function popStack(n) {
        stack.length = stack.length - 2 * n;
        vstack.length = vstack.length - n;
        lstack.length = lstack.length - n;
      }

      var lex = function lex() {
        var token;
        token = lexer.lex() || EOF; // if token isn't its numeric value, convert

        if (typeof token !== 'number') {
          token = self.symbols_[token] || token;
        }

        return token;
      };

      var symbol,
          preErrorSymbol,
          state,
          action,
          r,
          yyval = {},
          p,
          len,
          newState,
          expected;

      while (true) {
        // retreive state number from top of stack
        state = stack[stack.length - 1]; // use default actions if available

        if (this.defaultActions[state]) {
          action = this.defaultActions[state];
        } else {
          if (symbol === null || typeof symbol == 'undefined') {
            symbol = lex();
          } // read action for current state and first input


          action = table[state] && table[state][symbol];
        } // handle parse error


        if (typeof action === 'undefined' || !action.length || !action[0]) {
          // Return the rule stack depth where the nearest error rule can be found.
          // Return FALSE when no error recovery rule was found.
          var locateNearestErrorRecoveryRule = function locateNearestErrorRecoveryRule(state) {
            var stack_probe = stack.length - 1;
            var depth = 0; // try to recover from error

            for (;;) {
              // check for error recovery rule in this state
              if (TERROR.toString() in table[state]) {
                return depth;
              }

              if (state === 0 || stack_probe < 2) {
                return false; // No suitable error recovery rule available.
              }

              stack_probe -= 2; // popStack(1): [symbol, action]

              state = stack[stack_probe];
              ++depth;
            }
          };

          var error_rule_depth;
          var errStr = '';

          if (!recovering) {
            // first see if there's any chance at hitting an error recovery rule:
            error_rule_depth = locateNearestErrorRecoveryRule(state); // Report error

            expected = [];

            for (p in table[state]) {
              if (this.terminals_[p] && p > TERROR) {
                expected.push("'" + this.terminals_[p] + "'");
              }
            }

            if (lexer.showPosition) {
              errStr = 'Parse error on line ' + (yylineno + 1) + ":\n" + lexer.showPosition() + "\nExpecting " + expected.join(', ') + ", got '" + (this.terminals_[symbol] || symbol) + "'";
            } else {
              errStr = 'Parse error on line ' + (yylineno + 1) + ": Unexpected " + (symbol == EOF ? "end of input" : "'" + (this.terminals_[symbol] || symbol) + "'");
            }

            this.parseError(errStr, {
              text: lexer.match,
              token: this.terminals_[symbol] || symbol,
              line: lexer.yylineno,
              loc: yyloc,
              expected: expected,
              recoverable: error_rule_depth !== false
            });
          } else if (preErrorSymbol !== EOF) {
            error_rule_depth = locateNearestErrorRecoveryRule(state);
          } // just recovered from another error


          if (recovering == 3) {
            if (symbol === EOF || preErrorSymbol === EOF) {
              throw new Error(errStr || 'Parsing halted while starting to recover from another error.');
            } // discard current lookahead and grab another


            yyleng = lexer.yyleng;
            yytext = lexer.yytext;
            yylineno = lexer.yylineno;
            yyloc = lexer.yylloc;
            symbol = lex();
          } // try to recover from error


          if (error_rule_depth === false) {
            throw new Error(errStr || 'Parsing halted. No suitable error recovery rule available.');
          }

          popStack(error_rule_depth);
          preErrorSymbol = symbol == TERROR ? null : symbol; // save the lookahead token

          symbol = TERROR; // insert generic error symbol as new lookahead

          state = stack[stack.length - 1];
          action = table[state] && table[state][TERROR];
          recovering = 3; // allow 3 real symbols to be shifted before reporting a new error
        } // this shouldn't happen, unless resolve defaults are off


        if (action[0] instanceof Array && action.length > 1) {
          throw new Error('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol);
        }

        switch (action[0]) {
          case 1:
            // shift
            //this.shiftCount++;
            stack.push(symbol);
            vstack.push(lexer.yytext);
            lstack.push(lexer.yylloc);
            stack.push(action[1]); // push state

            symbol = null;

            if (!preErrorSymbol) {
              // normal execution/no error
              yyleng = lexer.yyleng;
              yytext = lexer.yytext;
              yylineno = lexer.yylineno;
              yyloc = lexer.yylloc;

              if (recovering > 0) {
                recovering--;
              }
            } else {
              // error just occurred, resume old lookahead f/ before error
              symbol = preErrorSymbol;
              preErrorSymbol = null;
            }

            break;

          case 2:
            // reduce
            //this.reductionCount++;
            len = this.productions_[action[1]][1]; // perform semantic action

            yyval.$ = vstack[vstack.length - len]; // default to $$ = $1
            // default location, uses first token for firsts, last for lasts

            yyval._$ = {
              first_line: lstack[lstack.length - (len || 1)].first_line,
              last_line: lstack[lstack.length - 1].last_line,
              first_column: lstack[lstack.length - (len || 1)].first_column,
              last_column: lstack[lstack.length - 1].last_column
            };

            if (ranges) {
              yyval._$.range = [lstack[lstack.length - (len || 1)].range[0], lstack[lstack.length - 1].range[1]];
            }

            r = this.performAction.apply(yyval, [yytext, yyleng, yylineno, sharedState.yy, action[1], vstack, lstack].concat(args));

            if (typeof r !== 'undefined') {
              return r;
            } // pop off stack


            if (len) {
              stack = stack.slice(0, -1 * len * 2);
              vstack = vstack.slice(0, -1 * len);
              lstack = lstack.slice(0, -1 * len);
            }

            stack.push(this.productions_[action[1]][0]); // push nonterminal (reduce)

            vstack.push(yyval.$);
            lstack.push(yyval._$); // goto new state = table[STATE][NONTERMINAL]

            newState = table[stack[stack.length - 2]][stack[stack.length - 1]];
            stack.push(newState);
            break;

          case 3:
            // accept
            return true;
        }
      }

      return true;
    }
  };
  /* generated by jison-lex 0.3.4 */

  var lexer = function () {
    var lexer = {
      EOF: 1,
      parseError: function parseError(str, hash) {
        if (this.yy.parser) {
          this.yy.parser.parseError(str, hash);
        } else {
          throw new Error(str);
        }
      },
      // resets the lexer, sets new input
      setInput: function setInput(input, yy) {
        this.yy = yy || this.yy || {};
        this._input = input;
        this._more = this._backtrack = this.done = false;
        this.yylineno = this.yyleng = 0;
        this.yytext = this.matched = this.match = '';
        this.conditionStack = ['INITIAL'];
        this.yylloc = {
          first_line: 1,
          first_column: 0,
          last_line: 1,
          last_column: 0
        };

        if (this.options.ranges) {
          this.yylloc.range = [0, 0];
        }

        this.offset = 0;
        return this;
      },
      // consumes and returns one char from the input
      input: function input() {
        var ch = this._input[0];
        this.yytext += ch;
        this.yyleng++;
        this.offset++;
        this.match += ch;
        this.matched += ch;
        var lines = ch.match(/(?:\r\n?|\n).*/g);

        if (lines) {
          this.yylineno++;
          this.yylloc.last_line++;
        } else {
          this.yylloc.last_column++;
        }

        if (this.options.ranges) {
          this.yylloc.range[1]++;
        }

        this._input = this._input.slice(1);
        return ch;
      },
      // unshifts one char (or a string) into the input
      unput: function unput(ch) {
        var len = ch.length;
        var lines = ch.split(/(?:\r\n?|\n)/g);
        this._input = ch + this._input;
        this.yytext = this.yytext.substr(0, this.yytext.length - len); //this.yyleng -= len;

        this.offset -= len;
        var oldLines = this.match.split(/(?:\r\n?|\n)/g);
        this.match = this.match.substr(0, this.match.length - 1);
        this.matched = this.matched.substr(0, this.matched.length - 1);

        if (lines.length - 1) {
          this.yylineno -= lines.length - 1;
        }

        var r = this.yylloc.range;
        this.yylloc = {
          first_line: this.yylloc.first_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.first_column,
          last_column: lines ? (lines.length === oldLines.length ? this.yylloc.first_column : 0) + oldLines[oldLines.length - lines.length].length - lines[0].length : this.yylloc.first_column - len
        };

        if (this.options.ranges) {
          this.yylloc.range = [r[0], r[0] + this.yyleng - len];
        }

        this.yyleng = this.yytext.length;
        return this;
      },
      // When called from action, caches matched text and appends it on next action
      more: function more() {
        this._more = true;
        return this;
      },
      // When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.
      reject: function reject() {
        if (this.options.backtrack_lexer) {
          this._backtrack = true;
        } else {
          return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n' + this.showPosition(), {
            text: "",
            token: null,
            line: this.yylineno
          });
        }

        return this;
      },
      // retain first n characters of the match
      less: function less(n) {
        this.unput(this.match.slice(n));
      },
      // displays already matched input, i.e. for error messages
      pastInput: function pastInput() {
        var past = this.matched.substr(0, this.matched.length - this.match.length);
        return (past.length > 20 ? '...' : '') + past.substr(-20).replace(/\n/g, "");
      },
      // displays upcoming input, i.e. for error messages
      upcomingInput: function upcomingInput() {
        var next = this.match;

        if (next.length < 20) {
          next += this._input.substr(0, 20 - next.length);
        }

        return (next.substr(0, 20) + (next.length > 20 ? '...' : '')).replace(/\n/g, "");
      },
      // displays the character position where the lexing error occurred, i.e. for error messages
      showPosition: function showPosition() {
        var pre = this.pastInput();
        var c = new Array(pre.length + 1).join("-");
        return pre + this.upcomingInput() + "\n" + c + "^";
      },
      // test the lexed token: return FALSE when not a match, otherwise return token
      test_match: function test_match(match, indexed_rule) {
        var token, lines, backup;

        if (this.options.backtrack_lexer) {
          // save context
          backup = {
            yylineno: this.yylineno,
            yylloc: {
              first_line: this.yylloc.first_line,
              last_line: this.last_line,
              first_column: this.yylloc.first_column,
              last_column: this.yylloc.last_column
            },
            yytext: this.yytext,
            match: this.match,
            matches: this.matches,
            matched: this.matched,
            yyleng: this.yyleng,
            offset: this.offset,
            _more: this._more,
            _input: this._input,
            yy: this.yy,
            conditionStack: this.conditionStack.slice(0),
            done: this.done
          };

          if (this.options.ranges) {
            backup.yylloc.range = this.yylloc.range.slice(0);
          }
        }

        lines = match[0].match(/(?:\r\n?|\n).*/g);

        if (lines) {
          this.yylineno += lines.length;
        }

        this.yylloc = {
          first_line: this.yylloc.last_line,
          last_line: this.yylineno + 1,
          first_column: this.yylloc.last_column,
          last_column: lines ? lines[lines.length - 1].length - lines[lines.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + match[0].length
        };
        this.yytext += match[0];
        this.match += match[0];
        this.matches = match;
        this.yyleng = this.yytext.length;

        if (this.options.ranges) {
          this.yylloc.range = [this.offset, this.offset += this.yyleng];
        }

        this._more = false;
        this._backtrack = false;
        this._input = this._input.slice(match[0].length);
        this.matched += match[0];
        token = this.performAction.call(this, this.yy, this, indexed_rule, this.conditionStack[this.conditionStack.length - 1]);

        if (this.done && this._input) {
          this.done = false;
        }

        if (token) {
          return token;
        } else if (this._backtrack) {
          // recover context
          for (var k in backup) {
            this[k] = backup[k];
          }

          return false; // rule action called reject() implying the next rule should be tested instead.
        }

        return false;
      },
      // return next match in input
      next: function next() {
        if (this.done) {
          return this.EOF;
        }

        if (!this._input) {
          this.done = true;
        }

        var token, match, tempMatch, index;

        if (!this._more) {
          this.yytext = '';
          this.match = '';
        }

        var rules = this._currentRules();

        for (var i = 0; i < rules.length; i++) {
          tempMatch = this._input.match(this.rules[rules[i]]);

          if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {
            match = tempMatch;
            index = i;

            if (this.options.backtrack_lexer) {
              token = this.test_match(tempMatch, rules[i]);

              if (token !== false) {
                return token;
              } else if (this._backtrack) {
                match = false;
                continue; // rule action called reject() implying a rule MISmatch.
              } else {
                // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
                return false;
              }
            } else if (!this.options.flex) {
              break;
            }
          }
        }

        if (match) {
          token = this.test_match(match, rules[index]);

          if (token !== false) {
            return token;
          } // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)


          return false;
        }

        if (this._input === "") {
          return this.EOF;
        } else {
          return this.parseError('Lexical error on line ' + (this.yylineno + 1) + '. Unrecognized text.\n' + this.showPosition(), {
            text: "",
            token: null,
            line: this.yylineno
          });
        }
      },
      // return next match that has a token
      lex: function lex() {
        var r = this.next();

        if (r) {
          return r;
        } else {
          return this.lex();
        }
      },
      // activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)
      begin: function begin(condition) {
        this.conditionStack.push(condition);
      },
      // pop the previously active lexer condition state off the condition stack
      popState: function popState() {
        var n = this.conditionStack.length - 1;

        if (n > 0) {
          return this.conditionStack.pop();
        } else {
          return this.conditionStack[0];
        }
      },
      // produce the lexer rule set which is active for the currently active lexer condition state
      _currentRules: function _currentRules() {
        if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {
          return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules;
        } else {
          return this.conditions["INITIAL"].rules;
        }
      },
      // return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available
      topState: function topState(n) {
        n = this.conditionStack.length - 1 - Math.abs(n || 0);

        if (n >= 0) {
          return this.conditionStack[n];
        } else {
          return "INITIAL";
        }
      },
      // alias for begin(condition)
      pushState: function pushState(condition) {
        this.begin(condition);
      },
      // return the number of states currently on the stack
      stateStackSize: function stateStackSize() {
        return this.conditionStack.length;
      },
      options: {},
      performAction: function anonymous(yy, yy_, $avoiding_name_collisions, YY_START) {

        switch ($avoiding_name_collisions) {
          case 0:
            /* skip whitespace */
            break;

          case 1:
            return 8;

          case 2:
            return 8;

          case 3:
            return 21;

          case 4:
            return 35;

          case 5:
            return 24;

          case 6:
            return 26;

          case 7:
            return 26;

          case 8:
            return 25;

          case 9:
            return 21;

          case 10:
            return 31;

          case 11:
            return 31;

          case 12:
            return 33;

          case 13:
            return 28;

          case 14:
            return 9;

          case 15:
            return ' ';

          case 16:
            return 32;

          case 17:
            return 27;

          case 18:
            return 29;

          case 19:
            return 30;

          case 20:
            return 18;

          case 21:
            return 19;

          case 22:
            return 17;

          case 23:
            return 11;

          case 24:
            return 20;

          case 25:
            return 12;

          case 26:
            return 13;

          case 27:
            return 15;

          case 28:
            return 14;

          case 29:
            return 16;

          case 30:
            return '"';

          case 31:
            return "'";

          case 32:
            return "!";

          case 33:
            return 10;

          case 34:
            return 34;

          case 35:
            return '#';

          case 36:
            return 5;
        }
      },
      rules: [/^(?:\s+)/, /^(?:"(\\["]|[^"])*")/, /^(?:'(\\[']|[^'])*')/, /^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/, /^(?:#[A-Z0-9\/]+(!|\?)?)/, /^(?:\$[A-Za-z]+\$[0-9]+)/, /^(?:\$[A-Za-z]+[0-9]+)/, /^(?:[A-Za-z]+\$[0-9]+)/, /^(?:[A-Za-z]+[0-9]+)/, /^(?:[A-Za-z\.]+(?=[(]))/, /^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/, /^(?:[A-Za-z_]+)/, /^(?:[0-9]+)/, /^(?:\[(.*)?\])/, /^(?:&)/, /^(?: )/, /^(?:[.])/, /^(?::)/, /^(?:;)/, /^(?:,)/, /^(?:\*)/, /^(?:\/)/, /^(?:-)/, /^(?:\+)/, /^(?:\^)/, /^(?:\()/, /^(?:\))/, /^(?:>)/, /^(?:<)/, /^(?:NOT\b)/, /^(?:")/, /^(?:')/, /^(?:!)/, /^(?:=)/, /^(?:%)/, /^(?:[#])/, /^(?:$)/],
      conditions: {
        "INITIAL": {
          "rules": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
          "inclusive": true
        }
      }
    };
    return lexer;
  }();

  parser.lexer = lexer;
  function Parser() {
    this.yy = {};
  }
  Parser.prototype = parser;
  parser.Parser = Parser;

  /* eslint-disable import/prefer-default-export */

  /**
   * Trim value by cutting character starting from the beginning and ending at the same time.
   *
   * @param {String} string String to trimming.
   * @param {Number} [margin=1] Number of character to cut.
   * @returns {String}
   */
  function trimEdges(string) {
    var margin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
    string = string.substring(margin, string.length - margin);
    return string;
  }

  function _slicedToArray$1(arr, i) {
    return _arrayWithHoles$1(arr) || _iterableToArrayLimit$1(arr, i) || _unsupportedIterableToArray$2(arr, i) || _nonIterableRest$1();
  }

  function _nonIterableRest$1() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _unsupportedIterableToArray$2(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray$2(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$2(o, minLen);
  }

  function _arrayLikeToArray$2(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) {
      arr2[i] = arr[i];
    }

    return arr2;
  }

  function _iterableToArrayLimit$1(arr, i) {
    var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

    if (_i == null) return;
    var _arr = [];
    var _n = true;
    var _d = false;

    var _s, _e;

    try {
      for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$1(arr) {
    if (Array.isArray(arr)) return arr;
  }
  /**
   * Convert row label to index.
   *
   * @param {String} label Row label (eq. '1', '5')
   * @returns {Number} Returns -1 if label is not recognized otherwise proper row index.
   */


  function rowLabelToIndex(label) {
    var result = parseInt(label, 10);

    if (isNaN(result)) {
      result = -1;
    } else {
      result = Math.max(result - 1, -1);
    }

    return result;
  }
  /**
   * Convert row index to label.
   *
   * @param {Number} row Row index.
   * @returns {String} Returns row label (eq. '1', '7').
   */

  function rowIndexToLabel(row) {
    var result = '';

    if (row >= 0) {
      result = "".concat(row + 1);
    }

    return result;
  }
  var COLUMN_LABEL_BASE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  var COLUMN_LABEL_BASE_LENGTH = COLUMN_LABEL_BASE.length;
  /**
   * Convert column label to index.
   *
   * @param {String} label Column label (eq. 'ABB', 'CNQ')
   * @returns {Number} Returns -1 if label is not recognized otherwise proper column index.
   */

  function columnLabelToIndex(label) {
    var result = 0;

    if (typeof label === 'string') {
      label = label.toUpperCase();

      for (var i = 0, j = label.length - 1; i < label.length; i += 1, j -= 1) {
        result += Math.pow(COLUMN_LABEL_BASE_LENGTH, j) * (COLUMN_LABEL_BASE.indexOf(label[i]) + 1);
      }
    }

    --result;
    return result;
  }
  /**
   * Convert column index to label.
   *
   * @param {Number} column Column index.
   * @returns {String} Returns column label (eq. 'ABB', 'CNQ').
   */

  function columnIndexToLabel(column) {
    var result = '';

    while (column >= 0) {
      result = String.fromCharCode(column % COLUMN_LABEL_BASE_LENGTH + 97) + result;
      column = Math.floor(column / COLUMN_LABEL_BASE_LENGTH) - 1;
    }

    return result.toUpperCase();
  }
  var LABEL_EXTRACT_REGEXP = /^([$])?([A-Za-z]+)([$])?([0-9]+)$/;
  /**
   * Extract cell coordinates.
   *
   * @param {String} label Cell coordinates (eq. 'A1', '$B6', '$N$98').
   * @returns {Array} Returns an array of objects.
   */

  function extractLabel(label) {
    if (typeof label !== 'string' || !LABEL_EXTRACT_REGEXP.test(label)) {
      return [];
    }

    var _label$toUpperCase$ma = label.toUpperCase().match(LABEL_EXTRACT_REGEXP),
        _label$toUpperCase$ma2 = _slicedToArray$1(_label$toUpperCase$ma, 5),
        columnAbs = _label$toUpperCase$ma2[1],
        column = _label$toUpperCase$ma2[2],
        rowAbs = _label$toUpperCase$ma2[3],
        row = _label$toUpperCase$ma2[4];

    return [{
      index: rowLabelToIndex(row),
      label: row,
      isAbsolute: rowAbs === '$'
    }, {
      index: columnLabelToIndex(column),
      label: column,
      isAbsolute: columnAbs === '$'
    }];
  }
  /**
   * Convert row and column indexes into cell label.
   *
   * @param {Object} row Object with `index` and `isAbsolute` properties.
   * @param {Object} column Object with `index` and `isAbsolute` properties.
   * @returns {String} Returns cell label.
   */

  function toLabel(row, column) {
    var rowLabel = (row.isAbsolute ? '$' : '') + rowIndexToLabel(row.index);
    var columnLabel = (column.isAbsolute ? '$' : '') + columnIndexToLabel(column.index);
    return columnLabel + rowLabel;
  }

  function _typeof(obj) {
    "@babel/helpers - typeof";

    return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) {
      return typeof obj;
    } : function (obj) {
      return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    }, _typeof(obj);
  }

  function _slicedToArray$2(arr, i) {
    return _arrayWithHoles$2(arr) || _iterableToArrayLimit$2(arr, i) || _unsupportedIterableToArray$3(arr, i) || _nonIterableRest$2();
  }

  function _nonIterableRest$2() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function _unsupportedIterableToArray$3(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray$3(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$3(o, minLen);
  }

  function _arrayLikeToArray$3(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) {
      arr2[i] = arr[i];
    }

    return arr2;
  }

  function _iterableToArrayLimit$2(arr, i) {
    var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

    if (_i == null) return;
    var _arr = [];
    var _n = true;
    var _d = false;

    var _s, _e;

    try {
      for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _arrayWithHoles$2(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _classCallCheck$1(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties$1(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass$1(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties$1(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties$1(Constructor, staticProps);
    Object.defineProperty(Constructor, "prototype", {
      writable: false
    });
    return Constructor;
  }

  function _inherits$1(subClass, superClass) {
    if (typeof superClass !== "function" && superClass !== null) {
      throw new TypeError("Super expression must either be null or a function");
    }

    subClass.prototype = Object.create(superClass && superClass.prototype, {
      constructor: {
        value: subClass,
        writable: true,
        configurable: true
      }
    });
    Object.defineProperty(subClass, "prototype", {
      writable: false
    });
    if (superClass) _setPrototypeOf$1(subClass, superClass);
  }

  function _setPrototypeOf$1(o, p) {
    _setPrototypeOf$1 = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
      o.__proto__ = p;
      return o;
    };

    return _setPrototypeOf$1(o, p);
  }

  function _createSuper$1(Derived) {
    var hasNativeReflectConstruct = _isNativeReflectConstruct$1();

    return function _createSuperInternal() {
      var Super = _getPrototypeOf$1(Derived),
          result;

      if (hasNativeReflectConstruct) {
        var NewTarget = _getPrototypeOf$1(this).constructor;

        result = Reflect.construct(Super, arguments, NewTarget);
      } else {
        result = Super.apply(this, arguments);
      }

      return _possibleConstructorReturn$1(this, result);
    };
  }

  function _possibleConstructorReturn$1(self, call) {
    if (call && (_typeof(call) === "object" || typeof call === "function")) {
      return call;
    } else if (call !== void 0) {
      throw new TypeError("Derived constructors may only return object or undefined");
    }

    return _assertThisInitialized$1(self);
  }

  function _assertThisInitialized$1(self) {
    if (self === void 0) {
      throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    }

    return self;
  }

  function _isNativeReflectConstruct$1() {
    if (typeof Reflect === "undefined" || !Reflect.construct) return false;
    if (Reflect.construct.sham) return false;
    if (typeof Proxy === "function") return true;

    try {
      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
      return true;
    } catch (e) {
      return false;
    }
  }

  function _getPrototypeOf$1(o) {
    _getPrototypeOf$1 = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
      return o.__proto__ || Object.getPrototypeOf(o);
    };
    return _getPrototypeOf$1(o);
  }
  /**
   * @class Parser
   */

  var Parser$1 = /*#__PURE__*/function (_Emitter) {
    _inherits$1(Parser$1, _Emitter);

    var _super = _createSuper$1(Parser$1);

    function Parser$1() {
      var _this;

      _classCallCheck$1(this, Parser$1);

      _this = _super.call(this);
      _this.parser = new Parser();
      _this.parser.yy = {
        toNumber: toNumber,
        trimEdges: trimEdges,
        invertNumber: invertNumber,
        throwError: function throwError(errorName) {
          return _this._throwError(errorName);
        },
        callVariable: function callVariable(variable) {
          return _this._callVariable(variable);
        },
        evaluateByOperator: evaluateByOperator,
        callFunction: function callFunction(name, params) {
          return _this._callFunction(name, params);
        },
        cellValue: function cellValue(value) {
          return _this._callCellValue(value);
        },
        rangeValue: function rangeValue(start, end) {
          return _this._callRangeValue(start, end);
        }
      };
      _this.variables = Object.create(null);
      _this.functions = Object.create(null);

      _this.setVariable('TRUE', true).setVariable('FALSE', false).setVariable('NULL', null);

      return _this;
    }
    /**
     * Parse formula expression.
     *
     * @param {String} expression to parse.
     * @return {*} Returns an object with tow properties `error` and `result`.
     */


    _createClass$1(Parser$1, [{
      key: "parse",
      value: function parse(expression) {
        var result = null;
        var error$1 = null;

        try {
          if (expression === '') {
            result = '';
          } else {
            result = this.parser.parse(expression);
          }
        } catch (ex) {
          var message = error(ex.message);

          if (message) {
            error$1 = message;
          } else {
            error$1 = error(ERROR);
          }
        }

        if (result instanceof Error) {
          error$1 = error(result.message) || error(ERROR);
          result = null;
        }

        return {
          error: error$1,
          result: result
        };
      }
      /**
       * Set predefined variable name which can be visible while parsing formula expression.
       *
       * @param {String} name Variable name.
       * @param {*} value Variable value.
       * @returns {Parser}
       */

    }, {
      key: "setVariable",
      value: function setVariable(name, value) {
        this.variables[name] = value;
        return this;
      }
      /**
       * Get variable name.
       *
       * @param {String} name Variable name.
       * @returns {*}
       */

    }, {
      key: "getVariable",
      value: function getVariable(name) {
        return this.variables[name];
      }
      /**
       * Retrieve variable value by its name.
       *
       * @param name Variable name.
       * @returns {*}
       * @private
       */

    }, {
      key: "_callVariable",
      value: function _callVariable(name) {
        var value = this.getVariable(name);
        this.emit('callVariable', name, function (newValue) {
          if (newValue !== void 0) {
            value = newValue;
          }
        });

        if (value === void 0) {
          throw Error(ERROR_NAME);
        }

        return value;
      }
      /**
       * Set custom function which can be visible while parsing formula expression.
       *
       * @param {String} name Custom function name.
       * @param {Function} fn Custom function.
       * @returns {Parser}
       */

    }, {
      key: "setFunction",
      value: function setFunction(name, fn) {
        this.functions[name] = fn;
        return this;
      }
      /**
       * Get custom function.
       *
       * @param {String} name Custom function name.
       * @returns {*}
       */

    }, {
      key: "getFunction",
      value: function getFunction(name) {
        return this.functions[name];
      }
      /**
       * Call function with provided params.
       *
       * @param name Function name.
       * @param params Function params.
       * @returns {*}
       * @private
       */

    }, {
      key: "_callFunction",
      value: function _callFunction(name) {
        var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
        var fn = this.getFunction(name);
        var value;

        if (fn) {
          value = fn(params);
        }

        this.emit('callFunction', name, params, function (newValue) {
          if (newValue !== void 0) {
            value = newValue;
          }
        });
        return value === void 0 ? evaluateByOperator(name, params) : value;
      }
      /**
       * Retrieve value by its label (`B3`, `B$3`, `B$3`, `$B$3`).
       *
       * @param {String} label Coordinates.
       * @returns {*}
       * @private
       */

    }, {
      key: "_callCellValue",
      value: function _callCellValue(label) {
        label = label.toUpperCase();

        var _extractLabel = extractLabel(label),
            _extractLabel2 = _slicedToArray$2(_extractLabel, 2),
            row = _extractLabel2[0],
            column = _extractLabel2[1];

        var value = void 0;
        this.emit('callCellValue', {
          label: label,
          row: row,
          column: column
        }, function (_value) {
          value = _value;
        });
        return value;
      }
      /**
       * Retrieve value by its label (`B3:A1`, `B$3:A1`, `B$3:$A1`, `$B$3:A$1`).
       *
       * @param {String} startLabel Coordinates of the first cell.
       * @param {String} endLabel Coordinates of the last cell.
       * @returns {Array} Returns an array of mixed values.
       * @private
       */

    }, {
      key: "_callRangeValue",
      value: function _callRangeValue(startLabel, endLabel) {
        startLabel = startLabel.toUpperCase();
        endLabel = endLabel.toUpperCase();

        var _extractLabel3 = extractLabel(startLabel),
            _extractLabel4 = _slicedToArray$2(_extractLabel3, 2),
            startRow = _extractLabel4[0],
            startColumn = _extractLabel4[1];

        var _extractLabel5 = extractLabel(endLabel),
            _extractLabel6 = _slicedToArray$2(_extractLabel5, 2),
            endRow = _extractLabel6[0],
            endColumn = _extractLabel6[1];

        var startCell = {};
        var endCell = {};

        if (startRow.index <= endRow.index) {
          startCell.row = startRow;
          endCell.row = endRow;
        } else {
          startCell.row = endRow;
          endCell.row = startRow;
        }

        if (startColumn.index <= endColumn.index) {
          startCell.column = startColumn;
          endCell.column = endColumn;
        } else {
          startCell.column = endColumn;
          endCell.column = startColumn;
        }

        startCell.label = toLabel(startCell.row, startCell.column);
        endCell.label = toLabel(endCell.row, endCell.column);
        var value = [];
        this.emit('callRangeValue', startCell, endCell, function () {
          var _value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

          value = _value;
        });
        return value;
      }
      /**
       * Try to throw error by its name.
       *
       * @param {String} errorName Error name.
       * @returns {String}
       * @private
       */

    }, {
      key: "_throwError",
      value: function _throwError(errorName) {
        if (isValidStrict(errorName)) {
          throw Error(errorName);
        }

        throw Error(ERROR);
      }
    }]);

    return Parser$1;
  }(tinyEmitter);

  const rnds8Pool = new Uint8Array(256); // # of random values to pre-allocate

  let poolPtr = rnds8Pool.length;
  function rng() {
    if (poolPtr > rnds8Pool.length - 16) {
      crypto__default['default'].randomFillSync(rnds8Pool);
      poolPtr = 0;
    }

    return rnds8Pool.slice(poolPtr, poolPtr += 16);
  }

  var REGEX = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

  function validate(uuid) {
    return typeof uuid === 'string' && REGEX.test(uuid);
  }

  /**
   * Convert array of 16 byte values to UUID string format of the form:
   * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
   */

  const byteToHex = [];

  for (let i = 0; i < 256; ++i) {
    byteToHex.push((i + 0x100).toString(16).substr(1));
  }

  function stringify(arr, offset = 0) {
    // Note: Be careful editing this code!  It's been tuned for performance
    // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
    const uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one
    // of the following:
    // - One or more input array values don't map to a hex octet (leading to
    // "undefined" in the uuid)
    // - Invalid input values for the RFC `version` or `variant` fields

    if (!validate(uuid)) {
      throw TypeError('Stringified UUID is invalid');
    }

    return uuid;
  }

  function v4(options, buf, offset) {
    options = options || {};
    const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`

    rnds[6] = rnds[6] & 0x0f | 0x40;
    rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

    if (buf) {
      offset = offset || 0;

      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = rnds[i];
      }

      return buf;
    }

    return stringify(rnds);
  }

  function ownKeys$1(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread2$1(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$1(Object(source),!0).forEach(function(key){_defineProperty$2(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$1(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _typeof$1(obj){"@babel/helpers - typeof";return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof$1(obj);}function _classCallCheck$2(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties$2(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass$2(Constructor,protoProps,staticProps){if(protoProps)_defineProperties$2(Constructor.prototype,protoProps);if(staticProps)_defineProperties$2(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _defineProperty$2(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else {obj[key]=value;}return obj;}function _slicedToArray$3(arr,i){return _arrayWithHoles$3(arr)||_iterableToArrayLimit$3(arr,i)||_unsupportedIterableToArray$4(arr,i)||_nonIterableRest$3();}function _toConsumableArray$2(arr){return _arrayWithoutHoles$2(arr)||_iterableToArray$2(arr)||_unsupportedIterableToArray$4(arr)||_nonIterableSpread$2();}function _arrayWithoutHoles$2(arr){if(Array.isArray(arr))return _arrayLikeToArray$4(arr);}function _arrayWithHoles$3(arr){if(Array.isArray(arr))return arr;}function _iterableToArray$2(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _iterableToArrayLimit$3(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _unsupportedIterableToArray$4(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray$4(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray$4(o,minLen);}function _arrayLikeToArray$4(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _nonIterableSpread$2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _nonIterableRest$3(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var en={functionlist:[{n:"SUMIF",t:0,d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",m:[2,3],p:[{name:"range",detail:"The range which is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"sum_range",detail:"The range to be summed, if different from `range`.",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the tangent of, in radians.",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse tangent.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"Returns the absolute value of a number.",a:"Absolute value of a number.",m:[1,1],p:[{name:"value",detail:"The number of which to return the absolute value.",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"Returns the factorial of the sum of values divided by the product of the values' factorials.",a:"Multinomial distribution function.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",m:[2,2],p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",m:[1,1],p:[{name:"value1",detail:"The first value or range in which to count the number of blanks.",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",m:[1,1],p:[{name:"value",detail:"The value to round down to the nearest integer.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",m:[1,1],p:[{name:"value",detail:"The value to be verified as even.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",m:[1,1],p:[{name:"value",detail:"The value to be verified as odd.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"Returns the least common multiple of one or more integers.",a:"Least common multiple of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least common multiple.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least common multiple.",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base e.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",m:[1,2],p:[{name:"value",detail:"The value for which to calculate the logarithm.",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"base",detail:"The base to use for calculation of the logarithm.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided to find the remainder.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",m:[2,2],p:[{name:"value",detail:"The number to round to the nearest integer multiple of another.",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest odd number.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",m:[1,255],p:[{name:"value1",detail:"The first number or range whose squares to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"Returns a conditional count across a range.",a:"A conditional count across a range.",m:[2,2],p:[{name:"range",detail:"The range that is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from degrees to radians.",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider for uniqueness.",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider for uniqueness.",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from radians to degrees.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",m:[1,1],p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest even number.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",m:[1,1],p:[{name:"exponent",detail:"The exponent to raise e to.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"Returns the factorial of a number.",a:"Factorial of a number.",m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'Returns the "double factorial" of a number.',a:'"double factorial" of a number.',m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"Returns the greatest common divisor of one or more integers.",a:"Greatest common divisor of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest common divisor.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest common divisor.",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",m:[2,2],p:[{name:"low",detail:"The low end of the random range.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"high",detail:"The high end of the random range.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",m:[4,4],p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The initial power to which to raise `x` in the power series.",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"The additive increment by which to increase `x`.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"The array or range containing the coefficients of the power series.",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",m:[1,1],p:[{name:"value",detail:"The value whose sign will be evaluated.",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the sine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",m:[1,1],p:[{name:"value",detail:"The number for which to calculate the positive square root.",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",m:[1,1],p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",m:[1,1],p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the cosine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",m:[1,2],p:[{name:"value",detail:"The value to be truncated.",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"Returns one number divided by another.",a:"One number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"Returns a number raised to a power.",a:"A number raised to a power.",m:[2,2],p:[{name:"base",detail:"The number to raise to the `exponent` power.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"exponent",detail:"The exponent to raise `base` to.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",m:[3,257],p:[{name:"sum_range",detail:"The range to sum.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criteria_range1",detail:"The range to check against criterion1.",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",m:[2,256],p:[{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"More numbers or ranges to calculate for the product.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",m:[5,5],p:[{name:"num_successes",detail:"The desired number of successes.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_draws",detail:"The number of permitted draws.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"successes_in_pop",detail:"The total number of successes in the population.",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The total size of the population",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;\n\nif FALSE(), it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:'Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.',a:"Kurtosis of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The rank from largest to smallest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",m:[3,3],p:[{name:"x",detail:"The value on the x-axis to forecast.",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating mode.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating mode.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the Weibull distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"shape",detail:"The shape parameter of the Weibull distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"scale",detail:"The scale parameter of the Weibull distribution function.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the cumulative distribution function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",m:[4,4],p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",m:[3,3],p:[{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"target_prob",detail:"The desired threshold probability.",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",m:[3,3],p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence.",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the population.",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The size of the population.",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the exponential distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"The lambda to specify the exponential distribution function.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",m:[2,3],p:[{name:"criteria_range",detail:"The range to check against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead.",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",m:[2,255],p:[{name:"average_range",detail:"The range to average.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned.",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",m:[1,1],p:[{name:"x",detail:"The input to the inverse standard normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",m:[2,2],p:[{name:"x",detail:"The input to the standard normal cumulative distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the normal distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",m:[4,4],p:[{name:"num_failures",detail:"The number of failures to model.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_successes",detail:"The number of successes to model.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the median value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function.",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",m:[4,4],p:[{name:"x",detail:"The input to the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"value",detail:"The test statistic to use in the Z-test.",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used.",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",m:[3,4],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`.",example:"2",require:"m",repeat:"n",type:"range"},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile value to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the Poisson distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the Poisson distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",m:[3,3],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",m:[4,4],p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test.",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test.",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"Specifies the number of distribution tails.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"Specifies the type of t-test.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",m:[4,4],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Logical value that determines the form of the function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",m:[3,3],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"Calculates the variance based on a sample.",a:"Variance.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",m:[3,3],p:[{name:"value",detail:"The value of the random variable to normalize.",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean of the distribution.",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the distribution.",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"n",detail:"The rank from smallest to largest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`.",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`.",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for in the row or column. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned.",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method.",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"Returns a cell reference as a string.",a:"Cell reference as a string.",m:[2,5],p:[{name:"row",detail:"The row number of the cell reference",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1).",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points.",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",m:[1,2],p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks.",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose row number will be returned.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose row count will be returned.",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose column count will be returned.",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",m:[3,5],p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns.",example:"A2",require:"m",repeat:"n",type:"range"},{name:"offset_rows",detail:"The number of rows to offset by.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"offset_columns",detail:"The number of columns to offset by.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"The height of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"The width of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The one-dimensional array to be searched.",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",m:[2,3],p:[{name:"reference",detail:"The array of cells to be offset into.",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row",detail:"The number of offset rows.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The number of offset columns.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",m:[2,254],p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data.",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended).",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table).",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve.",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",m:[2,255],p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value.",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"choice2",detail:"Additional values among which to choose.",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL.",example:'"http://www.luckysheet.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label.",example:'"luckysheet"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",m:[3,3],p:[{name:"hour",detail:"The hour component of the time.",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"minute",detail:"The minute component of the time.",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"second",detail:"The second component of the time.",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",m:[1,1],p:[{name:"time_string",detail:"The string that holds the time representation.",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the second component",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the minute component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the hour component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",m:[2,3],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",m:[1,1],p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",m:[1,2],p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",m:[1,2],p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the day.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"Returns the number of days between two dates.",a:"Number of days between two dates.",m:[2,2],p:[{name:"end_date",detail:"The end of the date range.",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"The start of the date range.",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"An indicator of what day count method to use.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",m:[3,3],p:[{name:"year",detail:"The year component of the date.",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The month component of the date.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"The day component of the date.",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",m:[1,1],p:[{name:"date_string",detail:"The string representing the date.",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",m:[3,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"unit",detail:'A string abbreviation for unit of time. For example, "M" for month. Accepted values are "Y","M","D","MD","YM","YD".',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",m:[2,3],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Returns the year specified by a given date.",a:"Year specified by a given date.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the year.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"Returns the current date as a date value.",a:"Current date as a date value.",m:[0,0],p:[]},{n:"MONTH",t:6,d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the month.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",m:[2,2],p:[{name:"nominal_rate",detail:"The nominal interest rate per year.",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"Formats a number into the currency specific to your spreadsheet locale.",a:"Formats a number as currency specific to your spreadsheet locale.",m:[1,2],p:[{name:"number",detail:"The value to be formatted.",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",m:[2,2],p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions.",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",m:[2,2],p:[{name:"decimal_price",detail:"The price quotation given as a decimal value.",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The number of months in the first year of depreciation.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The factor by which depreciation decreases.",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",m:[3,6],p:[{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_per_period",detail:"The amount per period to be paid.",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"rate_guess",detail:"An estimate for what the interest rate will be.",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",m:[4,4],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",m:[6,8],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_payment",detail:"The first date interest will be paid.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. \n\nIf the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. \n\nIf the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",m:[4,5],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity date of the security.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",m:[2,2],p:[{name:"principal",detail:"The amount of initial capital or value to compound against.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`.",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",m:[2,2],p:[{name:"effective_rate",detail:"The effective interest rate per year.",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",m:[2,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",m:[3,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"financing_rate",detail:"The interest rate paid on funds invested.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",m:[1,2],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",m:[2,255],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow1",detail:"The first future cash flow.",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"cashflow2",detail:"Additional future cash flows.",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",m:[3,3],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",m:[4,5],p:[{name:"buy_date",detail:"The date of purchase of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"sell_date",detail:"The date of sale of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"buy_price",detail:"The price at which the investment was purchased.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"sell_price",detail:"The price at which the investment was sold.",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the security at time of purchase.",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"The amount invested (irrespective of face value of each security).",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"The discount rate of the security invested in.",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount of each payment made.",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",m:[3,3],p:[{name:"cost",detail:"The initial cost of the asset.",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",m:[1,1],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",m:[1,1],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",m:[1,1],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",m:[2,3],p:[{name:"real_part",detail:"The real coefficient.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"imaginary_part",detail:"The imaginary coefficient.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used.",example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the conjugate for.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the absolute value of.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",m:[1,2],p:[{name:"number1",detail:"The first number to compare.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"The second number to compare.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",m:[1,255],p:[{name:"value1",detail:"The first complex number or range to add together.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",m:[2,2],p:[{name:"first_number",detail:"The complex number to subtract second_number from.",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"second_number",detail:"The complex number to subtract from first_number.",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"Returns one complex number divided by another.",a:"One complex number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The complex number to be divided.",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"divisor",detail:"The complex number to divide by.",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",m:[1,1],p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",m:[0,0],p:[]},{n:"FALSE",t:10,d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",m:[0,0],p:[]},{n:"AND",t:10,d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that represent logical values.",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",m:[2,2],p:[{name:"value",detail:"The value to return if `value` itself is not an error.",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"The value the function returns if `value` is an error.",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",m:[2,3],p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`.",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`.",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that evaluate to logical values.",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for inequality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for equality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",m:[2,2],p:[{name:"value1",detail:"The first addend.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The second addend.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",m:[2,2],p:[{name:"value1",detail:"The minuend, or number to be subtracted from.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",m:[2,2],p:[{name:"factor1",detail:"The first multiplicand.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"The second multiplicand.",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",m:[2,2],p:[{name:"value1",detail:"The value to which `value2` will be appended.",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to append to `value1`.",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",m:[1,1],p:[{name:"percentage",detail:"The value to interpret as a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"Appends strings to one another.",a:"Appends strings to one another.",m:[1,255],p:[{name:"string1",detail:"The initial string.",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"More strings to append in sequence.",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",m:[1,1],p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned.",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",m:[1,1],p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format.",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",m:[1,1],p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive.",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",m:[1,1],p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive.",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",m:[2,2],p:[{name:"text",detail:"The input text.",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned.",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",m:[2,2],p:[{name:"text",detail:"The text to be tested against the regular expression.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression to test the text against.",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",m:[3,3],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced.",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",m:[1,3],p:[{name:"number",detail:"The number to format.",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display in the result.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"new"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:'"new year"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",m:[2,255],p:[{name:"delimiter",detail:"The character or string to place between each concatenated value.",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`.",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array2",detail:"More values to be appended using `delimiter`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the left portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the right portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"Returns a segment of a string.",a:"A segment of a string.",m:[3,3],p:[{name:"string",detail:"The string to extract a segment from.",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"extract_length",detail:"The length of the segment to extract.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"Returns the length of a string.",a:"Length of a string.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to lowercase.",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to uppercase.",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",m:[2,2],p:[{name:"string1",detail:"The first string to compare",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"The second string to compare",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",m:[4,4],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"position",detail:"The position where the replacement will begin (starting from 1).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"length",detail:"The number of characters in the text to be replaced.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",m:[2,2],p:[{name:"text_to_repeat",detail:"The character or string to repeat.",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",m:[3,4],p:[{name:"text_to_search",detail:"The text within which to search and replace.",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"search_for",detail:"The string to search for within `text_to_search`.",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"replace_with",detail:"The string that will replace `search_for`.",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",m:[1,1],p:[{name:"text",detail:"The text whose non-printable characters are to be removed.",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",m:[2,2],p:[{name:"number",detail:"The number, date, or time to format.",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks.",example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",m:[1,1],p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed.",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",m:[1,1],p:[{name:"text",detail:"The string containing the value to be converted.",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",m:[1,1],p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase.",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",m:[3,3],p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`.",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`.",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`.",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",m:[1,1],p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped.",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",m:[2,2],p:[{name:"data",detail:"The array or range containing the values to be counted.",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"classes",detail:"The array or range containing the set of classes.",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",m:[2,2],p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range.",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range.",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",m:[1,255],p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range.",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range.",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",m:[1,1],p:[{name:"cell",detail:"The cell to be verified as containing a formula.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",m:[2,2],p:[{name:"info_type",detail:"The type of information requested (see article for available types)",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"The reference to the cell.",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:'Returns the "value not available" error, `#N/A`.',a:"The `#N/A` error.",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",m:[1,1],p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",m:[1,1],p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"Checks whether a value is an error.",a:"Whether a value is an error.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be compared with the error value `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",m:[1,1],p:[{name:"value",detail:"The value to be checked.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"Checks whether a value is a number.",a:"Whether a value is a number.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a cell reference.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"Checks whether a value is text.",a:"Whether a value is text.",m:[1,1],p:[{name:"value",detail:"The value to be verified as text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",m:[1,1],p:[{name:"value",detail:"The value whose type is to be determined.",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date.",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number.",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to text.",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",m:[1,2],p:[{name:"ID number",example:"A1",detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Deadline",example:'"2017-10-01"',detail:"The deadline or range of age calculation. The default is the current day.",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",m:[1,2],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Birthday format",example:"0",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",m:[1,2],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Word segmentation mode",example:"0",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode].",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"Returns whether a value is a date.",a:"Whether a value is a date.",m:[1,1],p:[{name:"value",example:'"1990-01-01"',detail:"The value to be verified as a date.",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",m:[1,8],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"},{name:"Maximum mark",example:"#fc5c5c",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Minimum mark",example:"#fc5c5c",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Mark size",example:"1.5",detail:"The maximum and minimum mark size settings, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Fill color",example:"#CCF3F4",detail:"Form an area chart, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Segmentation threshold",example:"1",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"Above threshold color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Below threshold color",example:"#fc5c5c",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Zero value bar color",example:"#999",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Rotation angle",example:"0",detail:"The rotation angle of the pie chart, the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"border",example:"0",detail:"Pie chart border size, default is none 0",require:"o",repeat:"n",type:"rangeall"},{name:"Border color",example:"#000",detail:"The border color of the pie chart, the default is #000",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Outlier ratio",example:"1.5",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times",require:"o",repeat:"n",type:"rangeall"},{name:"Target value",example:"10",detail:"The target value setting on the box plot, the default is false and does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Point size",example:"1.5",detail:"The radius of the target point and outlier is set, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",m:[2,3],p:[{name:"Target",example:"10",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"achieved",example:"8",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Contrast",example:"12",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",m:[1,1],p:[{name:"config",example:"PIESPLINES(A1:A20)",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc.",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",m:[1,4],p:[{name:"range",detail:"The data to be sorted.",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order.",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_column2",detail:"Additional columns.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",m:[2,3],p:[{name:"range",detail:"The data to be filtered.",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false.",example:"1",require:"m",repeat:"n",type:"range"},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted.",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",m:[1,3],p:[{name:"range",detail:"The data to filter by unique entries.",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE().",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",m:[0,2],p:[{name:"rows",detail:"The number of rows to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",m:[1,4],p:[{name:"rows",detail:"The number of rows in the function's resulting grid.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",m:[1,1],p:[{name:"expression",example:'"A1+5*2^2"',detail:"Formula or expression",require:"m",repeat:"n",type:"rangeall"}]},{n:"REMOTE",t:"5",d:"Calls a function on a remote server",a:"Calls a function on a remote back end server/API.",m:[1,1],p:[{name:"remote_expression",example:"SUM(A1:A10000000)",detail:"Formula",require:"m",repeat:"n",type:"string"}]}],toolbar:{undo:"Undo",redo:"Redo","clear-format":"Clear Format","format-painter":"Format-Painter",paintFormat:"Paint format","currency-format":"Format as currency","percentage-format":"Format as percent","number-decrease":"Decrease decimal places","number-increase":"Increase decimal places",moreFormats:"More formats","border-all":"Border All","merge-all":"Merge All Cell",font:"Font","font-size":"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)","strike-through":"Strikethrough (Alt+Shift+5)",underline:"Underline","font-color":"Font color","align-left":"Left aligned","align-center":"Horizontal Center","align-right":"Right aligned","align-top":"Top aligned","align-mid":"Vertical Center","align-bottom":"Bottom aligned",chooseColor:"choose color",resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",background:"Fill color",border:"Border",borderStyle:"Border style","merge-cell":"Merge cells",chooseMergeType:"Choose merge type",horizontalAlign:"Horizontal align",verticalAlign:"Vertical align",alignment:"Alignment",textWrap:"Text wrap",textWrapMode:"Text wrap mode",textRotate:"Text rotate",textRotateMode:"Text rotate mode",freeze:"Freeze",sort:"Sort",filter:"Filter",findAndReplace:"Find and replace","formula-sum":"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataVerification:"Data verification",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print"},alternatingColors:{applyRange:"Apply to range",selectRange:"Select a data range",header:"Header",footer:"Footer",errorInfo:"Cannot perform this operation on multiple selection areas, please select a single area and try again",textTitle:"Format style",custom:"CUSTOM",close:"close",selectionTextColor:"Click to select text color",selectionCellColor:"Click to select cell color",removeColor:"Remove alternating colors",colorShow:"color",currentColor:"Current",tipSelectRange:"Please select the range of alternating colors",errorNoRange:"No range is selected",errorExistColors:"Alternating colors already exist and cannot be edited"},button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},paint:{start:"Paint format start",end:"ESC",tipSelectRange:"Please select the range to be copied",tipNotMulti:"Cannot perform this operation on multiple selection ranges"},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"WorkBook rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"},currencyDetail:{RMB:"RMB",USdollar:"US dollar",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"},defaultFmt:[{text:"Automatic",value:"General",example:""},{text:"Plain text",value:"@",example:""},{text:"",value:"split",example:""},{text:"Number",value:"##0.00",example:"1000.12"},{text:"Percent",value:"#0.00%",example:"12.21%"},{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"Accounting",value:"(0.00)",example:"(1200.09)"},{text:"Currency",value:"0.00",example:"1200.09"},{text:"",value:"split",example:""},{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"Time 24H",value:"hh:mm",example:"15:00"},{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"Date time 24 H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"Custom formats",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],fontFamily:{MicrosoftYaHei:"YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana"],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3},border:{borderTop:"Top border",borderBottom:"Bottom border",borderLeft:"Left border",borderRight:"Right border",borderNone:"No border",borderAll:"All borders",borderOutside:"Outside border",borderInside:"Inside border",borderHorizontal:"Horizontal borders",borderVertical:"Vertical borders",borderColor:"borderColor",borderSize:"borderSize"},merge:{mergeAll:"Merge all",mergeV:"Merge Vertically",mergeH:"Merge Horizontally",mergeCancel:"Unmerge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},align:{left:"left",center:"center",right:"right",top:"Top",middle:"Middle",bottom:"Bottom"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},rotation:{none:"None",angleup:"Tilt Up",angledown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},freezen:{default:"Freeze",freezenRow:"First Row",freezenColumn:"First Column",freezenRC:"Both",freezenRowRange:"Freeze to current row",freezenColumnRange:"Freeze to current column",freezenRCRange:"Freeze to current cell",freezenCancel:"Cancel freezing",noSeletionError:"No Range to be selected",rangeRCOverErrorTitle:"Freeze reminder",rangeRCOverError:"The frozen pane is beyond the visible range, which will lead to abnormal operation. Please reset the frozen area."},sort:{asc:"Ascending ",desc:"Descending ",custom:"Custom sort",hasTitle:"Data has a header row",sortBy:"Sort by",addOthers:"Add another sort column",close:"close",confirm:"sort",columnOperation:"Column",secondaryTitle:"then by",sortTitle:"Sort range",sortRangeTitle:"Sort range from",sortRangeTitleTo:"to",noRangeError:"Cannot perform this operation on multiple selection areas, please select a single range and try again",mergeError:"There are merged cells in the selection, this operation cannot be performed!"},filter:{filter:"create filter",sortByAsc:"Sort A-Z",sortByDesc:"Sort Z-A",filterByColor:"Filter by color",filterByCondition:"Filter by condition",filterByValues:"Filter by values",filiterInputNone:"None",filiterInputTip:"Enter filter value",filiterRangeStartTip:"Value for formula",filiterRangeEndTip:"Value for formula",filterValueByAllBtn:"Check all",filterValueByClearBtn:"Clear",filterValueByInverseBtn:"Inverse",filterValueByTip:"filter By Values",filterConform:"Confirm",filterCancel:"Cancel",clearFilter:"Clear filter",conditionNone:"None",conditionCellIsNull:"Is empty",conditionCellNotNull:"Is not empty",conditionCellTextContain:"Text contains",conditionCellTextNotContain:"Text does not contain",conditionCellTextStart:"Text starts with",conditionCellTextEnd:"Text ends with",conditionCellTextEqual:"Text is exactly",conditionCellDateEqual:"Date is",conditionCellDateBefore:"Date is before",conditionCellDateAfter:"Date is after",conditionCellGreater:"Greater than",conditionCellGreaterEqual:"Greater than or equal to",conditionCellLess:"Less than",conditionCellLessEqual:"Less than or equal to",conditionCellEqual:"Is equal to",conditionCellNotEqual:"Is not equal to",conditionCellBetween:"Is between",conditionCellNotBetween:"Is not between",filiterMoreDataTip:"Big amount of data! please wait",filiterMonthText:"Month",filiterYearText:"Year",filiterByColorTip:"Filter by cell color",filiterByTextColorTip:"Filter by font color",filterContainerOneColorTip:"This column contains only one color",filterDateFormatTip:"Date format",valueBlank:"(Null)",mergeError:"There are merged cells in the filter selection, this operation cannot be performed!"},rightclick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Above",bottom:"Below",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},comment:{insert:"Insert",edit:"Edit",delete:"Delete",showOne:"Show/Hide",showAll:"Show/Hide All"},screenshot:{screenshotTipNoSelection:"Please select the scope of the screenshot",screenshotTipTitle:"Warning",screenshotTipHasMerge:"This operation cannot be performed on merged cells",screenshotTipHasMulti:"This operation cannot be performed on multiple selection regions",screenshotTipSuccess:"Successful",screenshotImageName:"Screenshot",downLoadClose:"Close",downLoadCopy:"Copy to clipboard",downLoadBtn:"Download",browserNotTip:"not supported by IE browser!",rightclickTip:'Please right-click "copy" on the picture',successTip:'Successfully (if pasting fails, please right-click on the image to "copy image")'},splitText:{splitDelimiters:"Delimiters",splitOther:"Other",splitContinueSymbol:"Consecutive separators are treated as a single",splitDataPreview:"Preview",splitTextTitle:"Split text",splitConfirmToExe:"There is already data here, do you want to replace it?",tipNoMulti:"Cannot perform this operation on multiple selection areas, please select a single area and try again",tipNoMultiColumn:"Only one column of data can be converted at a time. The selected area can have multiple rows but not multiple columns. Please try again after selecting a single column range"},imageText:{imageSetting:"Image setting",close:"Close",conventional:"Conventional",moveCell1:"Move and resize cells",moveCell2:"Move and do not resize the cell",moveCell3:"Do not move and resize the cell",fixedPos:"Fixed position",border:"Border",width:"Width",radius:"Radius",style:"Style",solid:"Solid",dashed:"Dashed",dotted:"Dotted",double:"Double",color:"Color"},punctuation:{tab:"Tab",semicolon:"semicolon",comma:"comma",space:"space"},findAndReplace:{find:"Find",replace:"Replace",goto:"Go to",location:"Location",formula:"Formula",date:"Date",number:"Number",string:"String",error:"Error",condition:"Condition",rowSpan:"Row span",columnSpan:"Column span",locationExample:"Location",lessTwoRowTip:"Please select at least two rows",lessTwoColumnTip:"Please select at least two columns",findTextbox:"Find Content",replaceTextbox:"Replace Content",regexTextbox:"Regular Expression",wholeTextbox:"Whole word",distinguishTextbox:"Case sensitive",allReplaceBtn:"Replace All",replaceBtn:"Replace",allFindBtn:"Find All",findBtn:"Find next",noFindTip:"The content was not found",modeTip:"This operation is not available in this mode",searchTargetSheet:"Sheet",searchTargetCell:"Cell",searchTargetValue:"Value",searchInputTip:"Please enter the search content",noReplceTip:"There is nothing to replace",noMatchTip:"No match found",successTip:"${xlength} items found",locationConstant:"Constant",locationFormula:"Formula",locationDate:"Date",locationDigital:"Number",locationString:"String",locationBool:"Logical",locationError:"Error",locationNull:"Null",locationCondition:"Conditional format",locationRowSpan:"Row span",locationColumnSpan:"Column span",locationTiplessTwoRow:"Please select at least two rows",locationTiplessTwoColumn:"Please select at least two columns",locationTipNotFindCell:"Cell not found"},sheetconfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNamecannotIsEmptyError:"Sheet name cannot be empty"},conditionformat:{conditionformat_greaterThan:"Conditionformat-GreaterThan",conditionformat_greaterThan_title:"Format cells greater than",conditionformat_lessThan:"Conditionformat-LessThan",conditionformat_lessThan_title:"Format cells smaller than",conditionformat_betweenness:"Conditionformat-Betweenness",conditionformat_betweenness_title:"Format cells with values between",conditionformat_equal:"Conditionformat-Equal",conditionformat_equal_title:"Format cells equal to",conditionformat_textContains:"Conditionformat-TextContains",conditionformat_textContains_title:"Format cells containing the following text",conditionformat_occurrenceDate:"Conditionformat-OccurrenceDate",conditionformat_occurrenceDate_title:"Format cells containing the following dates",conditionformat_duplicateValue:"Conditionformat-DuplicateValue",conditionformat_duplicateValue_title:"Format cells containing the following types of values",conditionformat_top10:"Conditionformat-Top10",conditionformat_top10_percent:"Conditionformat-Top10%",conditionformat_top10_title:"Format the cells with the highest value",conditionformat_last10:"Conditionformat-Last10",conditionformat_last10_percent:"Conditionformat-Last10%",conditionformat_last10_title:"Format the cells with the smallest value",conditionformat_AboveAverage:"Conditionformat-AboveAverage",conditionformat_AboveAverage_title:"Format cells above average",conditionformat_SubAverage:"Conditionformat-SubAverage",conditionformat_SubAverage_title:"Format cells below average",rule:"Rule",newRule:"New rule",editRule:"Edit rule",deleteRule:"Delete rule",deleteCellRule:"Delete cell rule",deleteSheetRule:"Delete sheet rule",manageRules:"Management rules",showRules:"Show its formatting rules",highlightCellRules:"Highlight cell rules",itemSelectionRules:"Item selection rules",conditionformatManageRules:"Conditional Formatting Rule Manager",format:"Format",setFormat:"Set format",setAs:"Set as",setAsByArea:"For the selected area, set to",applyRange:"Apply range",selectRange:"Select application range",selectRange_percent:"Percentage of selected range",selectRange_average:"Average value of selected range",selectRange_value:"Value in the selected range",pleaseSelectRange:"Please select application range",selectDataRange:"Select data range",selectCell:"select cell",pleaseSelectCell:"Please select cell",pleaseSelectADate:"Please select a date",pleaseEnterInteger:"Please enter an integer between 1 and 1000",onlySingleCell:"Only a single cell can be referenced",conditionValueCanOnly:"The condition value can only be a number or a single cell",ruleTypeItem1:"Format all cells based on their respective values",ruleTypeItem2:"Only format cells that contain",ruleTypeItem2_title:"Only for cells that meet the following conditions",ruleTypeItem3:"Format only the top or bottom numbers",ruleTypeItem3_title:"Is the value in the following ranking",ruleTypeItem4:"Format only values above or below the average",ruleTypeItem4_title:"Is a value that satisfies the following conditions",ruleTypeItem5:"Format only unique or repeated values",ruleTypeItem6:"Use formulas to determine which cells to format",formula:"Formula",textColor:"Text color",cellColor:"Cell color",confirm:"Confirm",confirmColor:"Confirm color",cancel:"Cancel",close:"Close",clearColorSelect:"Clear color select",sheet:"Sheet",currentSheet:"Current Sheet",dataBar:"data bar",dataBarColor:"data bar color",gradientDataBar_1:"Blue-white gradient data bar",gradientDataBar_2:"Green-white gradient data bar",gradientDataBar_3:"Red-white gradient data bar",gradientDataBar_4:"Orange-white gradient stripes",gradientDataBar_5:"Light blue-white gradient stripes",gradientDataBar_6:"Purple-white gradient data bar",solidColorDataBar_1:"Blue data bar",solidColorDataBar_2:"Green data bar",solidColorDataBar_3:"Red data bar",solidColorDataBar_4:"Orange data bar",solidColorDataBar_5:"Light blue data bar",solidColorDataBar_6:"Purple data bar",colorGradation:"color gradation",colorGradation_1:"Green-yellow-red color gradation",colorGradation_2:"Red-yellow-green color gradation",colorGradation_3:"Green-white-red color gradation",colorGradation_4:"Red-white-green color gradation",colorGradation_5:"Blue-white-red color gradation",colorGradation_6:"Red-white-blue color gradation",colorGradation_7:"White-red color gradation",colorGradation_8:"Red-white color gradation",colorGradation_9:"Green-white color gradation",colorGradation_10:"White-green color gradation",colorGradation_11:"Green-yellow color gradation",colorGradation_12:"Yellow-green color gradation",icons:"icons",pleaseSelectIcon:"Please click to select a group of icons:",cellValue:"Cell value",specificText:"Specific text",occurrence:"Date",greaterThan:"Greater than",lessThan:"Less than",between:"Between",equal:"Equal",in:"In",between2:"",contain:"Contain",textContains:"Text contains",duplicateValue:"Duplicate value",uniqueValue:"Unique value",top:"Top",top10:"Top 10",top10_percent:"Top 10%",last:"Last",last10:"Last 10",last10_percent:"Last 10%",oneself:"",above:"Above",aboveAverage:"Above average",below:"Below",belowAverage:"Below average",all:"All",yesterday:"YTD",today:"Today",tomorrow:"Tomorrow",lastWeek:"Last week",thisWeek:"This week",lastMonth:"Last month",thisMonth:"This month",lastYear:"Last year",thisYear:"This year",last7days:"Last 7 days",last30days:"Last 30 days",next7days:"Next 7 days",next30days:"Next 30 days",next60days:"Next 60 days",chooseRuleType:"Choose rule type",editRuleDescription:"Edit rule description",newFormatRule:"New format rule",editFormatRule:"Edit format rule",formatStyle:"Style",fillType:"Fill",color:"Color",twocolor:"Two-color",tricolor:"Tricolor",multicolor:"Multi color",grayColor:"Gray color",gradient:"Gradient",solid:"Solid",maxValue:"Max value",medianValue:"Median value",minValue:"Min value",direction:"Direction",threeWayArrow:"Three-way arrow",fourWayArrow:"Four-way arrow",fiveWayArrow:"Five-way arrow",threeTriangles:"Three triangles",shape:"Shape",threeColorTrafficLight:"Three-color traffic light",fourColorTrafficLight:"Four-color traffic light",threeSigns:"Three signs",greenRedBlackGradient:"Green-red-black gradient",rimless:"Rimless",bordered:"Bordered",mark:"Mark",threeSymbols:"Three symbols",tricolorFlag:"Tricolor flag",circled:"Circled",noCircle:"No circle",grade:"Grade",grade4:"4 Grade",grade5:"5 Grade",threeStars:"3 Stars",fiveQuadrantDiagram:"Five-quadrant diagram",fiveBoxes:"5 Boxes"},insertLink:{linkText:"Text",linkType:"Link type",external:"External link",internal:"Internal link",linkAddress:"Link address",linkSheet:"Worksheet",linkCell:"Cell reference",linkTooltip:"Tooltip",placeholder1:"Please enter the web link address",placeholder2:"Please enter the cell to be quoted, example A1",placeholder3:"Please enter the prompt content",tooltipInfo1:"Please enter a valid link",tooltipInfo2:"Please enter the correct cell reference"},dataVerification:{cellRange:"Cell range",selectCellRange:"Click to select a cell range",selectCellRange2:"Please select a range of cells",verificationCondition:"Verification condition",allowMultiSelect:"Allow multiple selection",dropdown:"drop-down list",checkbox:"Checkbox",number:"Number",number_integer:"Number-integer",number_decimal:"Number-decimal",text_content:"Text-content",text_length:"Text-length",date:"Date",validity:"Effectiveness",placeholder1:"Please enter the options, separated by commas, such as 1,2,3,4,5",placeholder2:"Please enter content",placeholder3:"Numeric value, such as 10",placeholder4:"Please enter the specified text",placeholder5:"Please enter the prompt displayed when the cell is selected",selected:"Selected",notSelected:"Not selected",between:"Between",notBetween:"Not between",equal:"Equal",notEqualTo:"Not equal to",moreThanThe:"More than the",lessThan:"Less than",greaterOrEqualTo:"Greater or equal to",lessThanOrEqualTo:"Less than or equal to",include:"Include",exclude:"Exclude",earlierThan:"Earlier than",noEarlierThan:"No earlier than",laterThan:"Later than",noLaterThan:"No later than",identificationNumber:"Identification number",phoneNumber:"Phone number",remote:"Automatic remote acquisition option",prohibitInput:"Prohibit input when input data is invalid",hintShow:"Show prompt when the cell is selected",deleteVerification:"Delete verification",tooltipInfo1:"The drop-down list option cannot be empty",tooltipInfo2:"Checkbox content cannot be empty",tooltipInfo3:"The value entered is not a numeric type",tooltipInfo4:"The value 2 cannot be less than the value 1",tooltipInfo5:"The text content cannot be empty",tooltipInfo6:"The value entered is not a date type",tooltipInfo7:"Date 2 cannot be less than date 1",textlengthInteger:"Text length must be an integer greater than or equal to 0"},formula:{sum:"Sum",average:"Average",count:"Count",max:"Max",min:"Min",ifGenerate:"If formula generator",find:"Learn more",tipNotBelongToIf:"This cell function does not belong to the if formula!",tipSelectCell:"Please select the cell to insert the function",ifGenCompareValueTitle:"Comparison value",ifGenSelectCellTitle:"Click to select cell",ifGenRangeTitle:"Range",ifGenRangeTo:"to",ifGenRangeEvaluate:"Range evaluate",ifGenSelectRangeTitle:"Click to select range",ifGenCutWay:"Partition way",ifGenCutSame:"Same Partition value",ifGenCutNpiece:"Partition by N",ifGenCutCustom:"Custom",ifGenCutConfirm:"Confirm",ifGenTipSelectCell:"Select cells",ifGenTipSelectCellPlace:"Please select cells",ifGenTipSelectRange:"Select range",ifGenTipSelectRangePlace:"Please select range",ifGenTipNotNullValue:"The comparison value cannot be empty!",ifGenTipLableTitile:"Label",ifGenTipRangeNotforNull:"The range cannot be empty!",ifGenTipCutValueNotforNull:"The partition value cannot be empty!",ifGenTipNotGenCondition:"No conditions are available for generation!"},formulaMore:{valueTitle:"Value",tipSelectDataRange:"Select data range",tipDataRangeTile:"Data range",findFunctionTitle:"Search function",tipInputFunctionName:"Function name or brief description of function",Array:"Array",Database:"Database",Date:"Date",Engineering:"Engineering",Filter:"Filter",Financial:"Financial",luckysheet:"Luckysheet",other:"Other",Logical:"Logical",Lookup:"Lookup",Math:"Math",Operator:"Operator",Parser:"Parser",Statistical:"Statistical",Text:"Text",dataMining:"Data Mining",selectFunctionTitle:"Select a function",calculationResult:"Result",tipSuccessText:"Success",tipParamErrorText:"Parameter type error",helpClose:"Close",helpCollapse:"Collapse",helpExample:"Example",helpAbstract:"Abstract",execfunctionError:"Error in the formula",execfunctionSelfError:"The formula cannot refer to its own cell",execfunctionSelfErrorResult:"The formula cannot refer to its own cell, which will lead to inaccurate calculation results",allowRepeatText:"Repeatable",allowOptionText:"Optional",selectCategory:"Or select a category"},drag:{noMerge:"Cannot perform this operation on merged cells",affectPivot:"This change cannot be made to the selected cell because it will affect the pivot table!",noMulti:"Cannot perform this operation on multiple selection areas, please select a single area",noPaste:"Unable to paste this content here, please select a cell in the paste area and try to paste again",noPartMerge:"Cannot perform this operation on partially merged cells",inputCorrect:"Please enter the correct value",notLessOne:"The number of rows and columns cannot be less than 1",offsetColumnLessZero:"The offset column cannot be negative!",pasteMustKeybordAlert:": Ctrl + C , Ctrl + V , Ctrl + X ",pasteMustKeybordAlertHTMLTitle:"",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;"},pivotTable:{title:"Pivot Table",closePannel:"Close",editRange:"Range",tipPivotFieldSelected:"Select the fields",tipClearSelectedField:"Clear all fields",btnClearSelectedField:"Clear",btnFilter:"Filter",titleRow:"Row",titleColumn:"Column",titleValue:"Value",tipShowColumn:"Statistics fields are displayed as columns",tipShowRow:"Statistics fields are displayed as rows",titleSelectionDataRange:"Select range",titleDataRange:"Data range",valueSum:"SUM",valueStatisticsSUM:"Sum",valueStatisticsCOUNT:"Count",valueStatisticsCOUNTA:"Count A",valueStatisticsCOUNTUNIQUE:"Count Unique",valueStatisticsAVERAGE:"Average",valueStatisticsMAX:"Max",valueStatisticsMIN:"Min",valueStatisticsMEDIAN:"Median",valueStatisticsPRODUCT:"Product",valueStatisticsSTDEV:"Stdev",valueStatisticsSTDEVP:"Stdevp",valueStatisticslet:"Var",valueStatisticsVARP:"VarP",errorNotAllowEdit:"This operation is prohibited in non-editing mode!",errorNotAllowMulti:"Cannot perform this operation on multiple selection areas, please select a single range and try again",errorSelectRange:"Please select the range of the new pivot table",errorIsDamage:"The source data of this pivot table is corrupted!",errorNotAllowPivotData:"Cannot select pivot table as source data!",errorSelectionRange:"Selection failed, wrong input range!",errorIncreaseRange:"Please expand the selected range!",titleAddColumn:"Add column to pivot table",titleMoveColumn:"Move the column to the white box below",titleClearColumnFilter:"Clear the filter for this column",titleFilterColumn:"Filter",titleSort:"Sort",titleNoSort:"No sort",titleSortAsc:"ASC",titleSortDesc:"DESC",titleSortBy:"Sort by",titleShowSum:"Show total",titleStasticTrue:"Yes",titleStasticFalse:"No"},dropCell:{copyCell:"Copy",sequence:"Sequence",onlyFormat:"Only format",noFormat:"Not format",day:"Day",workDay:"Work Day",month:"Month",year:"Year",chineseNumber:"Chinese numbers"},imageCtrl:{borderTile:"Image border color",borderCur:"Color"},protection:{protectiontTitle:"Protection",enterPassword:"Enter a password (optional)",enterHintTitle:"Prompt when editing is prohibited (optional)",enterHint:"The cell or chart you are trying to change is in a protected worksheet. If you want to change it, please unprotect the worksheet. You may need to enter a password",swichProtectionTip:"Protect the sheet and contents of locked cells",authorityTitle:"Allow users of this sheet to:",selectLockedCells:"Select locked cells",selectunLockedCells:"Select unlocked cells",formatCells:"Format cells",formatColumns:"Format columns",formatRows:"Format rows",insertColumns:"Insert columns",insertRows:"Insert rows",insertHyperlinks:"Insert hyperlinks",deleteColumns:"Delete columns",deleteRows:"Delete rows",sort:"Sort",filter:"Filter",usePivotTablereports:"Use Pivot Table reports",editObjects:"Edit objects",editScenarios:"Edit scenarios",allowRangeTitle:"Allow users of range to:",allowRangeAdd:"New...",allowRangeAddTitle:"Title",allowRangeAddSqrf:"Reference",selectCellRange:"Click to select a cell range",selectCellRangeHolder:"Cell range",allowRangeAddTitlePassword:"Password",allowRangeAddTitleHint:"Prompt",allowRangeAddTitleHintTitle:"Prompt when a password is set (optional)",allowRangeAddtitleDefault:"Input range name",rangeItemDblclick:"Double click to edit",rangeItemHasPassword:"Has password",rangeItemErrorTitleNull:"Title is null",rangeItemErrorRangeNull:"Reference is null",rangeItemErrorRange:"Reference is error",validationTitle:"Password validation",validationTips:"Need to enter a password to unlock the protection of the worksheet",validationInputHint:"Enter a password",checkPasswordNullalert:"Password is required!",checkPasswordWrongalert:"Incorrect password, please try again!",checkPasswordSucceedalert:"Unlock Succeed!",defaultRangeHintText:"The cell is being password protected.",defaultSheetHintText:"The cell or chart is in a protected worksheet. To make changes, please unprotect the worksheet. You may need to enter a password"},cellFormat:{cellFormatTitle:"Format cells",protection:"Protection",locked:"Locked",hidden:"Hidden",protectionTips:"To lock cells or hide formulas, protect the worksheet. On the toolbar, Click Protect Sheet Button",tipsPart:"Partial checked",tipsAll:"All checked",selectionIsNullAlert:"Selection is required!",sheetDataIsNullAlert:"error, Data is none!"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},edit:{typing:"typing"},websocket:{success:"WebSocket connection success",refresh:"An error occurred in the WebSocket connection, please refresh the page!",wait:"An error occurred in the WebSocket connection, please be patient!",close:"WebSocket connection closed",contact:"Server communication error occurred, please refresh the page and try again, if not, please contact the administrator!",support:"The current browser does not support WebSocket"}};var zh={functionlist:[{n:"SUMIF",t:0,d:"",a:"",m:[2,3],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n?*(~)~?~*\n\n=><",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"",a:"",m:[1,1],p:[{name:"value",detail:"",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"1",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11-11",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:" x  (0,0)  (`x`,`y`) ",a:" x  (0,0)  (`x`,`y`) ",m:[2,2],p:[{name:"x",detail:"xx",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"xy",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\nISEVENTRUEFALSE",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\nISODDTRUEFALSE",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:" e",a:" e",m:[1,1],p:[{name:"",detail:" e \n\n",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"10",a:"10",m:[1,1],p:[{name:"",detail:"10\n\n",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:", ",a:"",m:[2,2],p:[{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\n",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - 1",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"",a:"",m:[2,2],p:[{name:"n",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"",a:"",m:[2,256],p:[{name:"",detail:"\n\n1AVERAGE\n\n2COUNT\n\n3COUNTA\n\n4MAX\n\n5MIN\n\n6PRODUCT\n\n7STDEV\n\n8STDEVP\n\n9SUM\n\n10VAR\n\n11VARP\n\n210112102COUNT110VAR",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"2",detail:"[] - ",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n?*(~)~?~*\n\n=>>=<<=",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"0101",a:"0101",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"",a:"",m:[1,1],p:[{name:"z",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\n",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:" e (~2.718) ",a:" e (~2.718) ",m:[1,1],p:[{name:"",detail:"e",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"14 PI ",a:"14 PI ",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n0",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:" 0",a:" 0",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:" xnm  a a1xn + a2x(n+m) + ... + aix(n+(i-1)m) i  a ",a:" xnm  a",m:[4,4],p:[{name:"x",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"x",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"-110",a:"",m:[1,1],p:[{name:"",detail:"",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\nSQRT  #NUM! ",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:" PI ",a:" PI ",m:[1,1],p:[{name:"",detail:" PI \n\nSQRTPI  #NUM! ",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:" e",a:" e",m:[1,1],p:[{name:"",detail:" () \n\n",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[ - 0] - \n\n\n\nTRUNC0",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n0",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"\n\n",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"",a:"",m:[3,257],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2, 2...",detail:"[  ] - ",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"",a:"",m:[2,256],p:[{name:"1",detail:"1",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2, 2...",detail:"[  ] - ",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2 ... 30",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"  HYPGEOM.DIST ",a:"",m:[5,5],p:[{name:"Sample_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n cumulative  TRUE() HYPGEOM.DIST \n\n FALSE()",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:" Y  (x=0)  y ",a:" Y  (x=0)  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:" n n ",a:" n ",m:[2,2],p:[{name:"",detail:"",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"\n\nn4LARGE4",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"",a:"",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[ -  (FALSE()) ] - data",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"",a:"",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[ -  (FALSE()) ] - data",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"01",a:"01",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[ -  3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"01",a:"01",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[ -  3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:" x  y ",a:"",m:[3,3],p:[{name:"x",detail:"x",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"y",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"x",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"WEIBULL ",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"Weibull \n\nalpha  0",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:"Weibull \n\nbeta  0",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE() FALSE() ",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"",a:"",m:[3,3],p:[{name:"alpha",detail:"\n\n 100*(1 - alpha)% alpha  0.05 95%",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:" r",a:" r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:" Lambda ",a:" Lambda ",m:[3,3],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:" lambda ",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"",a:"",m:[2,3],p:[{name:"criteria_range",detail:" criterion ",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:' criteria_range \n\n""  1  "="  "=1"\n\n">1"\n\n">=1"\n\n"<1"\n\n"<=1"\n\n"<>1""<>"',example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[] -  criteria_range ",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"",a:"",m:[2,255],p:[{name:"average_range",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:" criterion1 ",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:" criteria_range1 ",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[] - ",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"",a:"",m:[2,2],p:[{name:"number",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n01",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:" K K  0  1  0  1",a:" K K  0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1  0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:" K K  0  1  0  1",a:" K K  0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1  0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"(Pearson) r",a:"(Pearson) r",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"  0 1",a:"  0 1",m:[1,1],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:" 0 1",a:" 0 1",m:[2,2],p:[{name:"z",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n TRUE()\n\n FALSE()",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n TRUE()\n\n FALSE()",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_f",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n TRUE()\n\n FALSE()",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:" x ",a:" x ",m:[3,3],p:[{name:"probability",detail:" 0  1  0  1",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:" x ",a:" x ",m:[4,4],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n TRUE()\n\n FALSE()",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:" z  P ",a:" z  P ",m:[2,3],p:[{name:"array",detail:" x ",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[] -  ",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"",a:"",m:[3,4],p:[{name:"x_range",detail:" x ",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:" x_range ",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:"[ - ] - \n\nPROB",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"\n\n125%\n\n250%\n\n375%",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"\n\n00%\n\n125%\n\n250%\n\n375%\n\n4100%",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\n TRUE() x x\n\n FALSE() x ",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"(Pearson) r ",a:"(Pearson) r ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:" t ",a:" t ",m:[3,3],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"\n\n cumulative  TRUE() HYPGEOM.DIST \n\n FALSE()",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:" t \n\n 0  1",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"\n\n\n\n 1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:" t \n\n 0 1",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"\n\n\n\n 1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-",a:"t-",m:[4,4],p:[{name:"array1",detail:" t ",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:" t ",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"\n\n 1\n\n 2",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:" t \n\n 1\n\n 2\n\n3",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:" x F  Fisher-Snedecor  Snedecor F ",a:" x",m:[4,4],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:" FALSE\n\n TRUE()F.DIST \n\n FALSE()F.DIST ",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"xF Fisher-SnedecorSnedecor F",a:"x",m:[3,3],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"0",a:"",m:[1,255],p:[{name:"value1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:" x  y ",a:" x  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:" k ",a:" k ",m:[2,2],p:[{name:"array",detail:" k ",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"",a:"",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"   ",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"",a:"",m:[3,4],p:[{name:"",detail:' 42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"VLOOKUP ",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:" 1\n\n 1  #VALUE! ",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[ TRUE() ] -  FALSE()\n\n FALSE FALSE #N/A\n\n TRUE  #N/A",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"",a:"",m:[3,4],p:[{name:"",detail:'42"Cats"I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"1\n\n1#VALUE!",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[ - TRUE()] - \n\nTRUE#N/A\n\nTRUE\n\nFALSE#N/A",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"",a:"",m:[2,3],p:[{name:"",detail:'42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:" | ",detail:" LOOKUP ",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"[  ] - ",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"",a:"",m:[2,5],p:[{name:"row_num",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"A1",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:"[ - 1] - \n\n1 $A$1\n\n2 A$1\n\n3 $A1\n\n4 A1",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[ - TRUE()] - A1(TRUE)R1C1(FALSE)",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[ - ] - ",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"",a:"",m:[1,2],p:[{name:"ref_text",detail:"",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[ - TRUE()] - A1(TRUE)R1C1(FALSE)",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"",a:"",m:[0,1],p:[{name:"reference",detail:"[ - ] - \n\n",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:" `A=1` ",a:" `A=1` ",m:[0,1],p:[{name:"reference",detail:"[ - ] - A1\n\n",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"",a:"",m:[3,5],p:[{name:"reference",detail:"",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:"\n\n",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"\n\n",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"",a:"",m:[2,3],p:[{name:"lookup_value",detail:" lookup_array ",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:"\n\n1MATCH#N/A!",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:"[ - 1] - \n\n1MATCH\n\n0\n\n-1MATCH",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"",a:"",m:[2,3],p:[{name:"array",detail:"",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:"",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"",a:"",m:[2,254],p:[{name:"data_field",detail:"\n\n",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[] - ",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[] -  1 ",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"",a:"",m:[2,255],p:[{name:"index_num",detail:"\n\n#VALUE!",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[] - ",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"",a:"",p:[{name:"",detail:"\n\nhttp://https://mailto:aim:ftp://gopher://telnet://news://\n\nhttp://",example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:'[ - ] - \n\n\n\n("")',example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"0 32767 \n\n 23  24",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"0 32767 \n\n 59 ",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"0 32767 \n\n 59 ",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"24",a:"24",m:[1,1],p:[{name:"time_text",detail:"",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"/",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"  0 59 ",a:"  0 59 ",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"",a:"",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[] - \n\nNDATEDATEVALUETO_DATE",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"",a:"",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"[ - 1] - \n0110000011\n1 =/2 =/7 =/11 =12 =17 =",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[  ] - \nNDATEDATEVALUETO_DATE",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:" ISO ",a:" ISO ",m:[1,1],p:[{name:"date",detail:"-",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[ -  1 ] - 1=2=",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[ -  1] -  (= 1) \n\n 1 1 7\n\n 2 1 7\n\n 3 0 6",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"",a:"",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"",a:"",m:[2,2],p:[{name:"end_date",detail:"",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"360",a:"360",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"[ - FALSE()] - \n\nFALSE -  (NASD) 303030\n\nTRUE - 3130",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"",a:"",m:[3,3],p:[{name:"year",detail:"\n\n 0 1899  1900 \n\n 1900  9999 \n\n 0  10000  #NUM!",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"\n\n month  12 month \n\n month  1month  1 ",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"\n\n day  day \n\n day  1 day  1 ",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"",a:"",m:[1,1],p:[{name:"date_text",detail:"",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"DATEDATE",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"DATEDATE",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:' "M" "Y""M""D""MD""YM"  "YD"\n\n"Y"\n\n"M"\n\n"D"\n\n"MD"\n\n"YM"\n\n"YD"',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date \n\n\n\n",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"[] - \n\nNDATEDATEVALUETO_DATE",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:" ",a:" ",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date \n\n\n\n\n\n",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"[ - 1] - \n0110000011\n1 =/2 =/7 =/11 =12 =17 =",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[  ] - \nNDATEDATEVALUETO_DATE",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:" Year  1900 - 9999 ",a:" Year  1900 - 9999 ",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:" start_date  end_date ",a:" start_date  end_date ",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"",a:"",m:[0,0],p:[]},{n:"MONTH",t:6,d:"  1 12",a:"  1 12",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"",a:"",m:[2,2],p:[{name:"nominal_rate",detail:"",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"",a:"",m:[1,2],p:[{name:"number",detail:"",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[ -  2] - \n\n",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"",a:"",m:[2,2],p:[{name:"fractional_dollar",detail:"",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"",a:"",m:[2,2],p:[{name:"decimal_dollar",detail:"",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"",a:"",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[ - 12] - ",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"",a:"",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[ - 2] - ",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"",a:"",m:[3,6],p:[{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0 \n\n1 ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[ - 0.1] - ",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"",a:"",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"\n\n",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"\n\n0 \n\n1 ",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"",a:"",m:[4,4],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[] - ",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0 \n\n1 ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"",a:"",m:[6,8],p:[{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[ - TRUE()] - \n\n TRUE\n\n FALSE",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"",a:"",m:[4,5],p:[{name:"issue",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[ -  0 ] - ",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ -  0 ] - \n\n0 \n\n1 ",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"",a:"",m:[2,2],p:[{name:"principal",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:"\n\nUNARY_PERCENT0.09UNARY_PERCENT(9)9",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"",a:"",m:[6,7],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"",a:"",m:[2,2],p:[{name:"effect_rate",detail:"",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"",a:"",m:[2,3],p:[{name:"values",detail:"\n\n",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"",a:"",m:[3,3],p:[{name:"values",detail:"\n\n",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:" ",a:" ",m:[1,2],p:[{name:"values",detail:"\n\n",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ -  0.1] - ",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"",a:"",m:[2,255],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[] - ",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"",a:"",m:[3,3],p:[{name:"rate",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:" dates ",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"",a:"",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"\n\n",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"\n\n0 \n\n1 ",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ -  0] - \n\n0 \n\n1 ",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:" 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ -  0] - \n\n0 \n\n1 ",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:" 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ -  0] - \n\n0 \n\n1 ",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:" 100 ",a:" 100 ",m:[6,7],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:" 100 ",a:" 100 ",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:" 100 ",a:" 100 ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:" 100 ",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0 \n\n1 ",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"",a:"",m:[3,3],p:[{name:"cost",detail:"",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:" 100 ",a:" 100 ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:" 100  Macauley ",a:" 100  Macauley ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\nfrequency = 1\n\nfrequency = 2\n\nfrequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[ - 0] - \n\n0(NASD) 30/360 - 30360\n\n1/ - \n\n2/360 - 360\n\n3/365 - 365\n\n430/360 - 030360",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'10\n\n\n\n01111111111000000000\n\nBIN2DEC(100)BIN2DEC("100")4',example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'10\n\n\n\n01111111111000000000\n\nBIN2HEX(11111)BIN2HEX("11111") 1F',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[  ] - \n\n0BIN2HEX("11111",8)0000001F\n\n11000000000',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'10\n\n\n\n01111111111000000000\n\nBIN2OCT(11111)BIN2OCT("11111")37',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[  ] - \n\n0BIN2OCT("11111")00000037\n\n11000000000',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n511-512\n\nDEC2BIN(199)DEC2BIN("199")11000111',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] - \n\n0\n\n",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n549755813887-549755814888\n\nDEC2HEX(100)DEC2HEX("100")64',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] - \n\n0\n\n",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n536870911-53687092\n\nDEC2OCT(199)DEC2OCT("199")307',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] - \n\n0\n\n",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'40\n\n\n\n1FFFFFFFFFE00\n\nHEX2BIN(199)HEX2BIN("199")110011001',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n0\n\n18000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'40\n\n\n\n7fffffffff8000000000\n\nHEX2DEC(199)HEX2DEC("199")409',example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'40\n\n\n\n1FFFFFFFFFE0000000\n\nHEX2OCT(199)HEX2OCT("199")631',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n0\n\n18000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'30\n\n\n\n7777777777000\n\nOCT2BIN(177)OCT2BIN("177")1111111',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n0\n\n14000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'30\n\nba\n\n37777777774000000000\n\nOCT2DEC(177)OCT2DEC("177")127',example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'30\n\nba\n\n37777777774000000000\n\nOCT2HEX(177)OCT2HEX("177")7F',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n0\n\n14000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,3],p:[{name:"real_num",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[ -  "i"] - ',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"  number1=number2 1 0",a:"  number1=number2 1 0",m:[1,2],p:[{name:"number1",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[ -  0] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] - 1 ",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:" inumber2",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:" inumber1 ",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] - ",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:"",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:" - NOT(TRUE()) FALSENOT(FALSE()) TRUE",a:" - NOT(TRUE()) FALSENOT(FALSE()) TRUE",m:[1,1],p:[{name:"logical",detail:" TRUE  FALSE ",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:" TRUE",a:" TRUE",m:[0,0],p:[]},{n:"FALSE",t:10,d:" FALSE",a:" FALSE",m:[0,0],p:[]},{n:"AND",t:10,d:" TRUE  TRUE FALSE FALSE",a:" TRUE  TRUE FALSE FALSE",m:[1,255],p:[{name:"logical1",detail:" TRUE  FALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[] -  TRUE  FALSE 255 ",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:" #N/A#VALUE!#REF!#DIV/0!#NUM!#NAME?  #NULL!",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:" TRUE  FALSE ",a:" TRUE  FALSE ",m:[2,3],p:[{name:"logical_test",detail:"TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"TRUE",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[ - ] - FALSE",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:" TRUE  TRUE FALSE FALSE",a:" TRUE  TRUE FALSE FALSE",m:[1,255],p:[{name:"logical1",detail:" TRUE  FALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - TRUEFALSE",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"TRUEFALSE<>",a:"TRUEFALSE<>",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"TRUEFALSE=",a:"TRUEFALSE=",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:" TRUE FALSE>",a:" TRUE FALSE>",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:" TRUE FALSE>=",a:" TRUE FALSE>=",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:" TRUE FALSE<",a:" TRUE FALSE<",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:" TRUE FALSE<=",a:" TRUE FALSE<=",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:" `+` ",a:" `+` ",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"-",a:"-",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"*",a:"*",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:" `/` ",a:" `/` ",m:[2,2],p:[{name:"value1",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"\n\n0",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:" `&` ",a:" `&` ",m:[2,2],p:[{name:"value1",detail:"value2 ",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"UNARY_PERCENT(100)1",a:"UNARY_PERCENT(100)1",m:[1,1],p:[{name:"number",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"",a:"",m:[1,255],p:[{name:"text1",detail:"",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2 ...",detail:"[] - ",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:" Unicode ",a:" Unicode ",m:[1,1],p:[{name:"text",detail:"Unicode",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:" Unicode ",a:" Unicode ",m:[1,1],p:[{name:"number",detail:" 1  255 ",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"",a:"",m:[1,1],p:[{name:"number",detail:"13999",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:" text ",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\nT\n\nT\n\nT\n\nT",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"",a:"",m:[1,3],p:[{name:"number",detail:"",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[ - 2] - \n\n",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[ - FALSE()] -  TRUE() FIXED ",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ - 1] - ",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ -  1] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"",a:"",m:[2,255],p:[{name:"separator",detail:"\n\nJOIN(,{1,2,3})",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[ - 1] -  LEFT ",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[ - 1] -  RIGHT ",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:" MID \n\nMID",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"(DBCS)",a:"(DBCS)",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text1",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"",a:"",m:[4,4],p:[{name:"old_text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:" 1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:"\n\n100100REPT100",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[  - 1 ] - ",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:" new_text  old_text",a:" new_text  old_text",m:[3,4],p:[{name:"text",detail:"",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:" old_text ",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[  ] -  new_text  old_text   instance_num old_text   old_text  new_text",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:" ASCII ",a:" ASCII ",m:[1,1],p:[{name:"text",detail:"",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:'\n\n0TEXT(12.3,"000.00")012.30TEXT(12.305,"00.00")12.31\n\n#0TEXT(12.3,"###.##")12.3',example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"",a:"",m:[3,3],p:[{name:"number",detail:" from_unit ",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:" y = mx + b  y \n\n known_y  known_x \n\n known_y known_x  known_y  known_x  known_y ",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,...}, known_y ] -  y = mx + b  x \n\n known_y known_x  known_y  known_x  known_y ",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ -  known_x ] -   TREND  y  x ",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE()] -  b  0\n\nTRUE()  b \n\nFALSE()  b  0m  y = mx",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"",a:"",m:[2,2],p:[{name:"data_array",detail:"",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:" data_array \n\nFREQUENCY",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:" y = b*m^x  y \n\n_y_x\n\n_y_x_y_x_y",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,...}, known_y ] -  y = b*m^x  x \n\n_y_x_y_x_y",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ -  known_x ] -  GROWTH  y  x ",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE()] - b  1\n\nTRUE()  b \n\nFALSE()  b  1m  y = m^x",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:" y = mx + b  y \n\n known_y  known_x \n\n known_y known_x  known_y  known_x  known_y ",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,...}, known_y ] -  y = mx + b  x \n\n known_y known_x  known_y  known_x  known_y ",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE()] -  b  0\n\nTRUE()  b \n\nFALSE()  b  0m  y = mx",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[ - FALSE()] - \n\nTRUEyLINEST\n\n\n\n011\n\n\n\nFF\n\nF\n\n\n\n",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:" y = mx + b  y \n\n known_y  known_x \n\n known_y known_x  known_y  known_x  known_y ",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,...}, known_y ] -  y = mx + b  x \n\n known_y known_x  known_y  known_x  known_y ",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE()] -  b  0\n\nTRUE()  b \n\nFALSE()  b  0m  y = mx",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[ - FALSE()] - \n\nTRUE b LOGEST \n\n\n\n 0  1 1 \n\n\n\nF  F \n\n -  F \n\n\n\n",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:" array1  array2 ",a:" array1  array2 ",m:[2,2],p:[{name:"array1",detail:"\n\narray1  array2 ",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"\n\narray2  array1 ",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"",a:"",m:[1,255],p:[{name:"array1",detail:"",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[] - ",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"",a:"",m:[1,1],p:[{name:"cell",detail:"\n\n cell  ISFORMULA  TRUE cell  TRUE FALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"",a:"",m:[2,2],p:[{name:"info_type",detail:"",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:" #N/A",a:" #N/A",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"error_val",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n TRUE FALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:" #N/A ",a:" #N/A ",m:[1,1],p:[{name:"value",detail:"#N/A\n\n#N/A#DIV/0!#NAME?#NULL!#NUM!#VALUE!#REF!ISERRTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n#DIV/0!#N/A#NAME?#NULL!#NUM!#VALUE!#REF!ISERRORTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:" TRUE  FALSE",a:" TRUE  FALSE",m:[1,1],p:[{name:"value",detail:"TRUEFALSE\n\n*TRUEFALSETRUEFALSEISLOGICALTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:" #N/A",a:" #N/A",m:[1,1],p:[{name:"value",detail:"#N/A\n\n*#N/A#N/AISNATRUEFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*ISNONTEXTFALSETRUE\n\nISNONTEXTTRUE\n\nISNONTEXTFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*ISNUMBERTRUEFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*ISREFTRUEFALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\nISTEXTTRUEFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n  1;\n\n  2;\n\n  4;\n\n  16;\n\n  64;",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n\n\n\n\nTRUE1\n\nFALSE0\n\n\n\n0",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\nTO_DATE30\n\n30\nTO_DATE",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"/",a:"/",m:[1,1],p:[{name:"value",detail:"\n\nTO_PURE_NUMBER\n\nTO_PERCENT",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\nTO_TEXT\n\nTO_TEXT",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n TO_DOLLARS ",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\nTO_PERCENT1 = 100%\n\nTO_PERCENT",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:" database \n\nfield  database  1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:"A1",detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:'"2017-10-01"',detail:"",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:",0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"...1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"",a:"",m:[1,2],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"tf-idf",a:"tf-idf",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"TextRank",a:"TextRank",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"",a:"",m:[1,1],p:[{name:"",example:'"1990-01-01"',detail:"1990/01/01, 199011",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"sparklines",a:"",m:[1,8],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#CCF3F4",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"0000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#999",detail:"0#999",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20-5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"0false1.5",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"10",detail:"false",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"sparklines",a:"",m:[2,3],p:[{name:"",example:"10",detail:"A1 100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"8",detail:"A1 100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"12",detail:"A1 1009",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:",sparklines",a:"sparklines",m:[1,1],p:[{name:"",example:"PIESPLINES(A1:A20)",detail:"sparklinesA1:A20 ",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"",a:"",m:[1,4],p:[{name:"array",detail:"",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[] - row1/col1",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[] - 1-1",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - FALSE()TRUE()",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"/",a:"/",m:[2,3],p:[{name:"array",detail:"",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[] - (filter)",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"",a:"",m:[1,3],p:[{name:"array",detail:"",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] -  = FALSE()  = TRUE()",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[] -  = TRUE() = FALSE() ",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:" 0  1 ",a:" 0  1 ",m:[0,2],p:[{name:"rows",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"",a:"",m:[1,4],p:[{name:"rows",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"",a:"",m:[1,1],p:[{name:"",example:'"A1+5*2^2"',detail:"",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"",redo:"","clear-format":"","format-painter":"","currency-format":"","percentage-format":"","number-decrease":"","number-increase":"",moreFormats:"","border-all":"","merge-all":"",font:"","font-size":"",bold:" (Ctrl+B)",italic:" (Ctrl+I)","strike-through":" (Alt+Shift+5)",underline:"","font-color":"","align-left":"","align-center":"","align-right":"","align-top":"","align-mid":"","align-bottom":"",chooseColor:"",resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",background:"",border:"",borderStyle:"","merge-cell":"",chooseMergeType:"",horizontalAlign:"",verticalAlign:"",alignment:"",textWrap:"",textWrapMode:"",textRotate:"",textRotateMode:"",freeze:"",sort:"",filter:"",findAndReplace:"","formula-sum":"",autoSum:"",moreFunction:"",conditionalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataVerification:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:""},alternatingColors:{applyRange:"",selectRange:"",header:"",footer:"",errorInfo:"",textTitle:"",custom:"",close:"",selectionTextColor:"",selectionCellColor:"",removeColor:"",colorShow:"",currentColor:"",tipSelectRange:"",errorNoRange:"",errorExistColors:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},paint:{start:"",end:"ESC",tipSelectRange:"",tipNotMulti:""},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"},currencyDetail:{RMB:"",USdollar:"",EUR:"",GBP:"",HK:"",JPY:"",AlbanianLek:"",AlgerianDinar:"",Afghani:"",ArgentinePeso:"",UnitedArabEmiratesDirham:"",ArubanFlorin:"",OmaniRial:"",Azerbaijanimanat:"",EgyptianPound:"",EthiopianBirr:"",AngolaKwanza:"",AustralianDollar:"",Patacas:"",BarbadosDollar:"",PapuaNewGuineaKina:"",BahamianDollar:"",PakistanRupee:"",ParaguayanGuarani:"",BahrainiDinar:"",PanamanianBalboa:"",Brazilianreal:"",Belarusianruble:"",BermudianDollar:"",BulgarianLev:"",IcelandKrona:"",BosniaHerzegovinaConvertibleMark:"",PolishZloty:"",Boliviano:"",BelizeDollar:"",BotswanaPula:"",NotDannuzhamu:"",BurundiFranc:"",NorthKoreanWon:"",DanishKrone:"",EastCaribbeanDollar:"",DominicaPeso:"",RussianRuble:"",EritreanNakfa:"",CFAfranc:"",PhilippinePeso:"",FijiDollar:"",CapeVerdeEscudo:"",FalklandIslandsPound:"",GambianDalasi:"",Congolesefranc:"",ColombianPeso:"",CostaRicanColon:"",CubanPeso:"",Cubanconvertiblepeso:"",GuyanaDollar:"",KazakhstanTenge:"",Haitiangourde:"",won:"",NetherlandsAntillesGuilder:"",Honduraslempiras:"",DjiboutiFranc:"",KyrgyzstanSom:"",GuineaFranc:"",CanadianDollar:"",GhanaianCedi:"",Cambodianriel:"",CzechKoruna:"",ZimbabweDollar:"",QatariRiyal:"",CaymanIslandsDollar:"",Comorianfranc:"",KuwaitiDinar:"",CroatianKuna:"",KenyanShilling:"",LesothoLoti:"",LaoKip:"",LebanesePound:"",Lithuanianlitas:"",LibyanDinar:"",LiberianDollar:"",RwandaFranc:"",RomanianLeu:"",MalagasyAriary:"",MaldivianRufiyaa:"",MalawiKwacha:"",MalaysianRinggit:"",MacedoniawearingDinar:"",MauritiusRupee:"",MauritanianOuguiya:"",MongolianTugrik:"",BangladeshiTaka:"",PeruvianNuevoSol:"",MyanmarKyat:"",MoldovanLeu:"",MoroccanDirham:"",MozambiqueMetical:"",MexicanPeso:"",NamibianDollar:"",SouthAfricanRand:"",SouthSudanesePound:"",NicaraguaCordoba:"",NepaleseRupee:"",NigerianNaira:"",NorwegianKrone:"",GeorgianLari:"",RMBOffshore:"",SwedishKrona:"",SwissFranc:"",SerbianDinar:"",SierraLeone:"",SeychellesRupee:"",SaudiRiyal:"",SaoTomeDobra:"",SaintHelenapound:"",SriLankaRupee:"",SwazilandLilangeni:"",SudanesePound:"",Surinamesedollar:"",SolomonIslandsDollar:"",SomaliShilling:"",TajikistanSomoni:"",PacificFranc:"",ThaiBaht:"",TanzanianShilling:"",TonganPaanga:"",TrinidadandTobagoDollar:"",TunisianDinar:"",TurkishLira:"",VanuatuVatu:"",GuatemalanQuetzal:"",CommissionBolivar:"",BruneiDollar:"",UgandanShilling:"",UkrainianHryvnia:"",UruguayanPeso:"",Uzbekistansom:"",WesternSamoaTala:"",SingaporeDollar:"",NT:"",NewZealandDollar:"",HungarianForint:"",SyrianPound:"",JamaicanDollar:"",ArmenianDram:"",YemeniRial:"",IraqiDinar:"",IranianRial:"",NewIsraeliShekel:"",IndianRupee:"",IndonesianRupiah:"",JordanianDinar:"",VND:"",ZambianKwacha:"",GibraltarPound:"",ChileanPeso:"",CFAFrancBEAC:""},defaultFmt:[{text:"",value:"General",example:""},{text:"",value:"@",example:""},{text:"",value:"split",example:""},{text:"",value:"##0.00",example:"1000.12"},{text:"",value:"#0.00%",example:"12.21%"},{text:"",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"",value:"(0.00)",example:"(1200.09)"},{text:"",value:"w",example:"120002500"},{text:"",value:"0.00",example:"1200.09"},{text:"2",value:"w0.00",example:"22500.55"},{text:"",value:"split",example:""},{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"24H",value:"hh:mm",example:"15:00"},{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"193085",value:'yyyy""M""d""'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"85",value:'M""d""'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"01:30",value:"/ hh:mm"},{name:"1:30",value:"/ h:mm"},{name:"1:30:30",value:"/ h:mm:ss"},{name:"08-05 01:30",value:"MM-dd / hh:mm"}],fontFamily:{MicrosoftYaHei:"Microsoft YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3,:4,"microsoft yahei":4,:5,simsun:5,:6,simhei:6,:7,kaiti:7,:8,fangsong:8,:9,nsimsun:9,:10,stxinwei:10,:11,stxingkai:11,:12,stliti:12},border:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{mergeAll:"",mergeV:"",mergeH:"",mergeCancel:"",overlappingError:"",partiallyError:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},textWrap:{overflow:"",wrap:"",clip:""},rotation:{none:"",angleup:"",angledown:"",vertical:"",rotationUp:"90",rotationDown:"90"},freezen:{default:"",freezenRow:"",freezenColumn:"A",freezenRC:"A",freezenRowRange:"",freezenColumnRange:"",freezenRCRange:"",freezenCancel:"",noSeletionError:"",rangeRCOverErrorTitle:"",rangeRCOverError:""},sort:{asc:"",desc:"",custom:"",hasTitle:"",sortBy:"",addOthers:"",close:"",confirm:"",columnOperation:"",secondaryTitle:"",sortTitle:"",sortRangeTitle:"",sortRangeTitleTo:"",noRangeError:"",mergeError:""},filter:{filter:"",clearFilter:"",sortByAsc:"A-Z",sortByDesc:"Z-A",filterByColor:"",filterByCondition:"",filterByValues:"",filiterInputNone:"",filiterInputTip:"",filiterRangeStartTip:"",filiterRangeEndTip:"",filterValueByAllBtn:"",filterValueByClearBtn:"",filterValueByInverseBtn:"",filterValueByTip:"",filterConform:" ",filterCancel:" ",conditionNone:"",conditionCellIsNull:"",conditionCellNotNull:"",conditionCellTextContain:"",conditionCellTextNotContain:"",conditionCellTextStart:"",conditionCellTextEnd:"",conditionCellTextEqual:"",conditionCellDateEqual:"",conditionCellDateBefore:"",conditionCellDateAfter:"",conditionCellGreater:"",conditionCellGreaterEqual:"",conditionCellLess:"",conditionCellLessEqual:"",conditionCellEqual:"",conditionCellNotEqual:"",conditionCellBetween:"",conditionCellNotBetween:"",filiterMoreDataTip:"",filiterMonthText:"",filiterYearText:"",filiterByColorTip:"",filiterByTextColorTip:"",filterContainerOneColorTip:"",filterDateFormatTip:"",valueBlank:"()",mergeError:""},rightclick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},comment:{insert:"",edit:"",delete:"",showOne:"/",showAll:"/"},screenshot:{screenshotTipNoSelection:"",screenshotTipTitle:"",screenshotTipHasMerge:"",screenshotTipHasMulti:"",screenshotTipSuccess:"",screenshotImageName:"",downLoadClose:"",downLoadCopy:"",downLoadBtn:"",browserNotTip:"IE",rightclickTip:"''",successTip:"''"},splitText:{splitDelimiters:"",splitOther:"",splitContinueSymbol:"",splitDataPreview:"",splitTextTitle:"",splitConfirmToExe:"",tipNoMulti:"",tipNoMultiColumn:""},imageText:{imageSetting:"",close:"",conventional:"",moveCell1:"",moveCell2:"",moveCell3:"",fixedPos:"",border:"",width:"",radius:"",style:"",solid:"",dashed:"",dotted:"",double:"",color:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},findAndReplace:{find:"",replace:"",goto:"",location:"",formula:"",date:"",number:"",string:"",error:"",condition:"",rowSpan:"",columnSpan:"",locationExample:"",lessTwoRowTip:"",lessTwoColumnTip:"",findTextbox:"",replaceTextbox:"",regexTextbox:"",wholeTextbox:"",distinguishTextbox:"",allReplaceBtn:"",replaceBtn:"",allFindBtn:"",findBtn:"",noFindTip:"",modeTip:"",searchTargetSheet:"",searchTargetCell:"",searchTargetValue:"",searchInputTip:"",noReplceTip:"",noMatchTip:"",successTip:"${xlength}",locationConstant:"",locationFormula:"",locationDate:"",locationDigital:"",locationString:"",locationBool:"",locationError:"",locationNull:"",locationCondition:"",locationRowSpan:"",locationColumnSpan:"",locationTiplessTwoRow:"",locationTiplessTwoColumn:"",locationTipNotFindCell:""},sheetconfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:"31' :\r\n[ ] : \\ ? * /",sheetNamecannotIsEmptyError:"!"},conditionformat:{conditionformat_greaterThan:"",conditionformat_greaterThan_title:"",conditionformat_lessThan:"",conditionformat_lessThan_title:"",conditionformat_betweenness:"",conditionformat_betweenness_title:"",conditionformat_equal:"",conditionformat_equal_title:"",conditionformat_textContains:"",conditionformat_textContains_title:"",conditionformat_occurrenceDate:"",conditionformat_occurrenceDate_title:"",conditionformat_duplicateValue:"",conditionformat_duplicateValue_title:"",conditionformat_top10:" 10 ",conditionformat_top10_percent:" 10%",conditionformat_top10_title:"",conditionformat_last10:" 10 ",conditionformat_last10_percent:" 10%",conditionformat_last10_title:"",conditionformat_AboveAverage:"",conditionformat_AboveAverage_title:"",conditionformat_SubAverage:"",conditionformat_SubAverage_title:"",rule:"",newRule:"",editRule:"",deleteRule:"",deleteCellRule:"",deleteSheetRule:"",manageRules:"",showRules:"",highlightCellRules:"",itemSelectionRules:"",conditionformatManageRules:"",format:"",setFormat:"",setAs:"",setAsByArea:"",applyRange:"",selectRange:"",selectRange_percent:"",selectRange_average:"",selectRange_value:"",pleaseSelectRange:"",selectDataRange:"",selectCell:"",pleaseSelectCell:"",pleaseSelectADate:"",pleaseEnterInteger:" 1  1000 ",onlySingleCell:"",conditionValueCanOnly:"",ruleTypeItem1:"",ruleTypeItem2:"",ruleTypeItem2_title:"",ruleTypeItem3:"",ruleTypeItem3_title:"",ruleTypeItem4:"",ruleTypeItem4_title:"",ruleTypeItem5:"",ruleTypeItem6:"",formula:"",textColor:"",cellColor:"",confirm:"",confirmColor:"",cancel:"",close:"",clearColorSelect:"",sheet:"",currentSheet:"",dataBar:"",dataBarColor:"",gradientDataBar_1:"-",gradientDataBar_2:"-",gradientDataBar_3:"-",gradientDataBar_4:"-",gradientDataBar_5:"-",gradientDataBar_6:"-",solidColorDataBar_1:"",solidColorDataBar_2:"",solidColorDataBar_3:"",solidColorDataBar_4:"",solidColorDataBar_5:"",solidColorDataBar_6:"",colorGradation:"",colorGradation_1:"--",colorGradation_2:"--",colorGradation_3:"--",colorGradation_4:"--",colorGradation_5:"--",colorGradation_6:"--",colorGradation_7:"-",colorGradation_8:"-",colorGradation_9:"-",colorGradation_10:"-",colorGradation_11:"-",colorGradation_12:"-",icons:"",pleaseSelectIcon:"",cellValue:"",specificText:"",occurrence:"",greaterThan:"",lessThan:"",between:"",equal:"",in:"",to:"",between2:"",contain:"",textContains:"",duplicateValue:"",uniqueValue:"",top:"",top10:" 10 ",top10_percent:" 10%",last:"",last10:" 10 ",last10_percent:" 10%",oneself:"",above:"",aboveAverage:"",below:"",belowAverage:"",all:"",yesterday:"",today:"",tomorrow:"",lastWeek:"",thisWeek:"",lastMonth:"",thisMonth:"",lastYear:"",thisYear:"",last7days:"7",last30days:"30",next7days:"7",next30days:"30",next60days:"60",chooseRuleType:"",editRuleDescription:"",newFormatRule:"",editFormatRule:"",formatStyle:"",fillType:"",color:"",twocolor:"",tricolor:"",multicolor:"",grayColor:"",gradient:"",solid:"",maxValue:"",medianValue:"",minValue:"",direction:"",threeWayArrow:"",fourWayArrow:"",fiveWayArrow:"",threeTriangles:"3",shape:"",threeColorTrafficLight:"",fourColorTrafficLight:"",threeSigns:"",greenRedBlackGradient:"--",rimless:"",bordered:"",mark:"",threeSymbols:"",tricolorFlag:"",circled:"",noCircle:"",grade:"",grade4:"",grade5:"",threeStars:"3",fiveQuadrantDiagram:"",fiveBoxes:"5"},insertLink:{linkText:"",linkType:"",external:"",internal:"",linkAddress:"",linkSheet:"",linkCell:"",linkTooltip:"",placeholder1:"",placeholder2:"A1",placeholder3:"",tooltipInfo1:"",tooltipInfo2:""},dataVerification:{cellRange:"",selectCellRange:"",selectCellRange2:"",verificationCondition:"",allowMultiSelect:"",dropdown:"",checkbox:"",number:"",number_integer:"-",number_decimal:"-",text_content:"-",text_length:"-",date:"",validity:"",placeholder1:"1,2,3,4,5",placeholder2:"",placeholder3:"10",placeholder4:"",placeholder5:"",selected:"",notSelected:"",between:"",notBetween:"",equal:"",notEqualTo:"",moreThanThe:"",lessThan:"",greaterOrEqualTo:"",lessThanOrEqualTo:"",include:"",exclude:"",earlierThan:"",noEarlierThan:"",laterThan:"",noLaterThan:"",identificationNumber:"",phoneNumber:"",remote:"",prohibitInput:"",hintShow:"",deleteVerification:"",tooltipInfo1:"",tooltipInfo2:"",tooltipInfo3:"",tooltipInfo4:"21",tooltipInfo5:"",tooltipInfo6:"",tooltipInfo7:"21",textlengthInteger:"0"},formula:{sum:"",average:"",count:"",max:"",min:"",ifGenerate:"if",find:"",tipNotBelongToIf:"if",tipSelectCell:"",ifGenCompareValueTitle:"",ifGenSelectCellTitle:"",ifGenRangeTitle:"",ifGenRangeTo:"",ifGenRangeEvaluate:"",ifGenSelectRangeTitle:"",ifGenCutWay:"",ifGenCutSame:"",ifGenCutNpiece:"N",ifGenCutCustom:"",ifGenCutConfirm:"",ifGenTipSelectCell:"",ifGenTipSelectCellPlace:"",ifGenTipSelectRange:"",ifGenTipSelectRangePlace:"",ifGenTipNotNullValue:"",ifGenTipLableTitile:"",ifGenTipRangeNotforNull:"",ifGenTipCutValueNotforNull:"",ifGenTipNotGenCondition:""},formulaMore:{valueTitle:"",tipSelectDataRange:"",tipDataRangeTile:"",findFunctionTitle:"",tipInputFunctionName:"",Array:"",Database:"",Date:"",Engineering:"",Filter:"",Financial:"",luckysheet:"Luckysheet",other:"",Logical:"",Lookup:"",Math:"",Operator:"",Parser:"",Statistical:"",Text:"",dataMining:"",selectFunctionTitle:"",calculationResult:"",tipSuccessText:"",tipParamErrorText:"",helpClose:"",helpCollapse:"",helpExample:"",helpAbstract:"",execfunctionError:'", "',execfunctionSelfError:"",execfunctionSelfErrorResult:"",allowRepeatText:"",allowOptionText:"",selectCategory:""},drag:{noMerge:"",affectPivot:"",noMulti:",",noPaste:"",noPartMerge:"",inputCorrect:"",notLessOne:"1",offsetColumnLessZero:"",pasteMustKeybordAlert:"Copy and paste in the Sheet: Ctrl + C to copy, Ctrl + V to paste, Ctrl + X to cut",pasteMustKeybordAlertHTMLTitle:"Copy and paste in the Sheet",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;to copy<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;to paste<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;to cut"},pivotTable:{title:"",closePannel:"",editRange:"",tipPivotFieldSelected:"",tipClearSelectedField:"",btnClearSelectedField:"",btnFilter:"",titleRow:"",titleColumn:"",titleValue:"",tipShowColumn:"",tipShowRow:"",titleSelectionDataRange:"",titleDataRange:"",valueSum:"",valueStatisticsSUM:"",valueStatisticsCOUNT:"",valueStatisticsCOUNTA:"",valueStatisticsCOUNTUNIQUE:"",valueStatisticsAVERAGE:"",valueStatisticsMAX:"",valueStatisticsMIN:"",valueStatisticsMEDIAN:"",valueStatisticsPRODUCT:"",valueStatisticsSTDEV:"",valueStatisticsSTDEVP:"",valueStatisticslet:"",valueStatisticsVARP:"",errorNotAllowEdit:"",errorNotAllowMulti:"",errorSelectRange:"",errorIsDamage:"",errorNotAllowPivotData:"",errorSelectionRange:", ",errorIncreaseRange:"!",titleAddColumn:"",titleMoveColumn:"",titleClearColumnFilter:"",titleFilterColumn:"",titleSort:"",titleNoSort:"",titleSortAsc:"",titleSortDesc:"",titleSortBy:"",titleShowSum:"",titleStasticTrue:"",titleStasticFalse:""},dropCell:{copyCell:"",sequence:"",onlyFormat:"",noFormat:"",day:"",workDay:"",month:"",year:"",chineseNumber:""},imageCtrl:{borderTile:"",borderCur:""},protection:{protectiontTitle:"",enterPassword:"",enterHint:"",swichProtectionTip:"",authorityTitle:":",selectLockedCells:"",selectunLockedCells:"",formatCells:"",formatColumns:"",formatRows:"",insertColumns:"",insertRows:"",insertHyperlinks:"",deleteColumns:"",deleteRows:"",sort:"",filter:"",usePivotTablereports:"",editObjects:"",editScenarios:"",allowRangeTitle:"",allowRangeAdd:"...",allowRangeAddTitle:"",allowRangeAddSqrf:"",selectCellRange:"",selectCellRangeHolder:"",allowRangeAddTitlePassword:"",allowRangeAddTitleHint:"",allowRangeAddTitleHintTitle:"()",allowRangeAddtitleDefault:"",rangeItemDblclick:"",rangeItemHasPassword:"",rangeItemErrorTitleNull:"",rangeItemErrorRangeNull:"",rangeItemErrorRange:"",validationTitle:"",validationTips:"",validationInputHint:"",checkPasswordNullalert:"",checkPasswordWrongalert:"",checkPasswordSucceedalert:"!",defaultRangeHintText:"",defaultSheetHintText:""},cellFormat:{cellFormatTitle:"",protection:"",locked:"",hidden:"",protectionTips:"()",tipsPart:"",tipsAll:"",selectionIsNullAlert:"",sheetDataIsNullAlert:""},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},edit:{typing:""},websocket:{success:"WebSocket",refresh:"WebSocket, ",wait:"WebSocket, ",close:"WebSocket",contact:"",support:"WebSocket"}};var es={functionlist:[{n:"SUMIF",t:0,d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",m:[2,3],p:[{name:"range",detail:"The range which is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"sum_range",detail:"The range to be summed, if different from `range`.",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the tangent of, in radians.",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse tangent.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"Returns the absolute value of a number.",a:"Absolute value of a number.",m:[1,1],p:[{name:"value",detail:"The number of which to return the absolute value.",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"Returns the factorial of the sum of values divided by the product of the values' factorials.",a:"Multinomial distribution function.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",m:[2,2],p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",m:[1,1],p:[{name:"value1",detail:"The first value or range in which to count the number of blanks.",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",m:[1,1],p:[{name:"value",detail:"The value to round down to the nearest integer.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",m:[1,1],p:[{name:"value",detail:"The value to be verified as even.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",m:[1,1],p:[{name:"value",detail:"The value to be verified as odd.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"Returns the least common multiple of one or more integers.",a:"Least common multiple of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least common multiple.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least common multiple.",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base e.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",m:[1,2],p:[{name:"value",detail:"The value for which to calculate the logarithm.",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"base",detail:"The base to use for calculation of the logarithm.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided to find the remainder.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",m:[2,2],p:[{name:"value",detail:"The number to round to the nearest integer multiple of another.",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest odd number.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",m:[1,255],p:[{name:"value1",detail:"The first number or range whose squares to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"Returns a conditional count across a range.",a:"A conditional count across a range.",m:[2,2],p:[{name:"range",detail:"The range that is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from degrees to radians.",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider for uniqueness.",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider for uniqueness.",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from radians to degrees.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",m:[1,1],p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest even number.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",m:[1,1],p:[{name:"exponent",detail:"The exponent to raise e to.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"Returns the factorial of a number.",a:"Factorial of a number.",m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'Returns the "double factorial" of a number.',a:'"double factorial" of a number.',m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"Returns the greatest common divisor of one or more integers.",a:"Greatest common divisor of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest common divisor.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest common divisor.",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",m:[2,2],p:[{name:"low",detail:"The low end of the random range.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"high",detail:"The high end of the random range.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",m:[4,4],p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The initial power to which to raise `x` in the power series.",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"The additive increment by which to increase `x`.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"The array or range containing the coefficients of the power series.",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",m:[1,1],p:[{name:"value",detail:"The value whose sign will be evaluated.",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the sine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",m:[1,1],p:[{name:"value",detail:"The number for which to calculate the positive square root.",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",m:[1,1],p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",m:[1,1],p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the cosine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",m:[1,2],p:[{name:"value",detail:"The value to be truncated.",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"Returns one number divided by another.",a:"One number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"Returns a number raised to a power.",a:"A number raised to a power.",m:[2,2],p:[{name:"base",detail:"The number to raise to the `exponent` power.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"exponent",detail:"The exponent to raise `base` to.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",m:[3,257],p:[{name:"sum_range",detail:"The range to sum.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criteria_range1",detail:"The range to check against criterion1.",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",m:[2,256],p:[{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"More numbers or ranges to calculate for the product.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",m:[5,5],p:[{name:"num_successes",detail:"The desired number of successes.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_draws",detail:"The number of permitted draws.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"successes_in_pop",detail:"The total number of successes in the population.",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The total size of the population",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;\n\nif FALSE(), it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:'Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.',a:"Kurtosis of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The rank from largest to smallest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",m:[3,3],p:[{name:"x",detail:"The value on the x-axis to forecast.",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating mode.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating mode.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the Weibull distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"shape",detail:"The shape parameter of the Weibull distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"scale",detail:"The scale parameter of the Weibull distribution function.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the cumulative distribution function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",m:[4,4],p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",m:[3,3],p:[{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"target_prob",detail:"The desired threshold probability.",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",m:[3,3],p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence.",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the population.",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The size of the population.",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the exponential distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"The lambda to specify the exponential distribution function.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",m:[2,3],p:[{name:"criteria_range",detail:"The range to check against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead.",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",m:[2,255],p:[{name:"average_range",detail:"The range to average.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned.",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",m:[1,1],p:[{name:"x",detail:"The input to the inverse standard normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",m:[2,2],p:[{name:"x",detail:"The input to the standard normal cumulative distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the normal distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",m:[4,4],p:[{name:"num_failures",detail:"The number of failures to model.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_successes",detail:"The number of successes to model.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the median value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function.",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",m:[4,4],p:[{name:"x",detail:"The input to the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"value",detail:"The test statistic to use in the Z-test.",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used.",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",m:[3,4],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`.",example:"2",require:"m",repeat:"n",type:"range"},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile value to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the Poisson distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the Poisson distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",m:[3,3],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",m:[4,4],p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test.",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test.",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"Specifies the number of distribution tails.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"Specifies the type of t-test.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",m:[4,4],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Logical value that determines the form of the function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",m:[3,3],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"Calculates the variance based on a sample.",a:"Variance.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",m:[3,3],p:[{name:"value",detail:"The value of the random variable to normalize.",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean of the distribution.",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the distribution.",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"n",detail:"The rank from smallest to largest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`.",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`.",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for in the row or column. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned.",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method.",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"Returns a cell reference as a string.",a:"Cell reference as a string.",m:[2,5],p:[{name:"row",detail:"The row number of the cell reference",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1).",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points.",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",m:[1,2],p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks.",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose row number will be returned.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose row count will be returned.",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose column count will be returned.",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",m:[3,5],p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns.",example:"A2",require:"m",repeat:"n",type:"range"},{name:"offset_rows",detail:"The number of rows to offset by.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"offset_columns",detail:"The number of columns to offset by.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"The height of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"The width of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The one-dimensional array to be searched.",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",m:[2,3],p:[{name:"reference",detail:"The array of cells to be offset into.",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row",detail:"The number of offset rows.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The number of offset columns.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",m:[2,254],p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data.",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended).",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table).",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve.",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",m:[2,255],p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value.",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"choice2",detail:"Additional values among which to choose.",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL.",example:'"http://www.luckysheet.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label.",example:'"luckysheet"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",m:[3,3],p:[{name:"hour",detail:"The hour component of the time.",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"minute",detail:"The minute component of the time.",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"second",detail:"The second component of the time.",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",m:[1,1],p:[{name:"time_string",detail:"The string that holds the time representation.",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the second component",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the minute component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the hour component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",m:[2,3],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",m:[1,1],p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",m:[1,2],p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",m:[1,2],p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the day.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"Returns the number of days between two dates.",a:"Number of days between two dates.",m:[2,2],p:[{name:"end_date",detail:"The end of the date range.",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"The start of the date range.",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"An indicator of what day count method to use.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",m:[3,3],p:[{name:"year",detail:"The year component of the date.",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The month component of the date.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"The day component of the date.",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",m:[1,1],p:[{name:"date_string",detail:"The string representing the date.",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",m:[3,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"unit",detail:'A string abbreviation for unit of time. For example, "M" for month. Accepted values are "Y","M","D","MD","YM","YD".',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",m:[2,3],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Returns the year specified by a given date.",a:"Year specified by a given date.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the year.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"Returns the current date as a date value.",a:"Current date as a date value.",m:[0,0],p:[]},{n:"MONTH",t:6,d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the month.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",m:[2,2],p:[{name:"nominal_rate",detail:"The nominal interest rate per year.",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"Formats a number into the currency specific to your spreadsheet locale.",a:"Formats a number as currency specific to your spreadsheet locale.",m:[1,2],p:[{name:"number",detail:"The value to be formatted.",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",m:[2,2],p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions.",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",m:[2,2],p:[{name:"decimal_price",detail:"The price quotation given as a decimal value.",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The number of months in the first year of depreciation.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The factor by which depreciation decreases.",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",m:[3,6],p:[{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_per_period",detail:"The amount per period to be paid.",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"rate_guess",detail:"An estimate for what the interest rate will be.",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",m:[4,4],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",m:[6,8],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_payment",detail:"The first date interest will be paid.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. \n\nIf the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. \n\nIf the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",m:[4,5],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity date of the security.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",m:[2,2],p:[{name:"principal",detail:"The amount of initial capital or value to compound against.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`.",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",m:[2,2],p:[{name:"effective_rate",detail:"The effective interest rate per year.",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",m:[2,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",m:[3,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"financing_rate",detail:"The interest rate paid on funds invested.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",m:[1,2],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",m:[2,255],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow1",detail:"The first future cash flow.",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"cashflow2",detail:"Additional future cash flows.",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",m:[3,3],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",m:[4,5],p:[{name:"buy_date",detail:"The date of purchase of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"sell_date",detail:"The date of sale of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"buy_price",detail:"The price at which the investment was purchased.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"sell_price",detail:"The price at which the investment was sold.",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the security at time of purchase.",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"The amount invested (irrespective of face value of each security).",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"The discount rate of the security invested in.",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount of each payment made.",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",m:[3,3],p:[{name:"cost",detail:"The initial cost of the asset.",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",m:[1,1],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",m:[1,1],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",m:[1,1],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",m:[2,3],p:[{name:"real_part",detail:"The real coefficient.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"imaginary_part",detail:"The imaginary coefficient.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used.",example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the conjugate for.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the absolute value of.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",m:[1,2],p:[{name:"number1",detail:"The first number to compare.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"The second number to compare.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",m:[1,255],p:[{name:"value1",detail:"The first complex number or range to add together.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",m:[2,2],p:[{name:"first_number",detail:"The complex number to subtract second_number from.",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"second_number",detail:"The complex number to subtract from first_number.",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"Returns one complex number divided by another.",a:"One complex number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The complex number to be divided.",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"divisor",detail:"The complex number to divide by.",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",m:[1,1],p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",m:[0,0],p:[]},{n:"FALSE",t:10,d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",m:[0,0],p:[]},{n:"AND",t:10,d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that represent logical values.",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",m:[2,2],p:[{name:"value",detail:"The value to return if `value` itself is not an error.",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"The value the function returns if `value` is an error.",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",m:[2,3],p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`.",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`.",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that evaluate to logical values.",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for inequality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for equality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",m:[2,2],p:[{name:"value1",detail:"The first addend.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The second addend.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",m:[2,2],p:[{name:"value1",detail:"The minuend, or number to be subtracted from.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",m:[2,2],p:[{name:"factor1",detail:"The first multiplicand.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"The second multiplicand.",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",m:[2,2],p:[{name:"value1",detail:"The value to which `value2` will be appended.",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to append to `value1`.",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",m:[1,1],p:[{name:"percentage",detail:"The value to interpret as a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"Appends strings to one another.",a:"Appends strings to one another.",m:[1,255],p:[{name:"string1",detail:"The initial string.",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"More strings to append in sequence.",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",m:[1,1],p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned.",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",m:[1,1],p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format.",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",m:[1,1],p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive.",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",m:[1,1],p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive.",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",m:[2,2],p:[{name:"text",detail:"The input text.",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned.",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",m:[2,2],p:[{name:"text",detail:"The text to be tested against the regular expression.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression to test the text against.",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",m:[3,3],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced.",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",m:[1,3],p:[{name:"number",detail:"The number to format.",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display in the result.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"new"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:'"new year"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",m:[2,255],p:[{name:"delimiter",detail:"The character or string to place between each concatenated value.",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`.",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array2",detail:"More values to be appended using `delimiter`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the left portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the right portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"Returns a segment of a string.",a:"A segment of a string.",m:[3,3],p:[{name:"string",detail:"The string to extract a segment from.",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"extract_length",detail:"The length of the segment to extract.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"Returns the length of a string.",a:"Length of a string.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to lowercase.",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to uppercase.",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",m:[2,2],p:[{name:"string1",detail:"The first string to compare",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"The second string to compare",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",m:[4,4],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"position",detail:"The position where the replacement will begin (starting from 1).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"length",detail:"The number of characters in the text to be replaced.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",m:[2,2],p:[{name:"text_to_repeat",detail:"The character or string to repeat.",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",m:[3,4],p:[{name:"text_to_search",detail:"The text within which to search and replace.",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"search_for",detail:"The string to search for within `text_to_search`.",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"replace_with",detail:"The string that will replace `search_for`.",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",m:[1,1],p:[{name:"text",detail:"The text whose non-printable characters are to be removed.",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",m:[2,2],p:[{name:"number",detail:"The number, date, or time to format.",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks.",example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",m:[1,1],p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed.",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",m:[1,1],p:[{name:"text",detail:"The string containing the value to be converted.",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",m:[1,1],p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase.",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",m:[3,3],p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`.",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`.",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`.",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",m:[1,1],p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped.",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",m:[2,2],p:[{name:"data",detail:"The array or range containing the values to be counted.",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"classes",detail:"The array or range containing the set of classes.",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",m:[2,2],p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range.",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range.",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",m:[1,255],p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range.",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range.",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",m:[1,1],p:[{name:"cell",detail:"The cell to be verified as containing a formula.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",m:[2,2],p:[{name:"info_type",detail:"The type of information requested (see article for available types)",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"The reference to the cell.",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:'Returns the "value not available" error, `#N/A`.',a:"The `#N/A` error.",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",m:[1,1],p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",m:[1,1],p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"Checks whether a value is an error.",a:"Whether a value is an error.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be compared with the error value `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",m:[1,1],p:[{name:"value",detail:"The value to be checked.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"Checks whether a value is a number.",a:"Whether a value is a number.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a cell reference.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"Checks whether a value is text.",a:"Whether a value is text.",m:[1,1],p:[{name:"value",detail:"The value to be verified as text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",m:[1,1],p:[{name:"value",detail:"The value whose type is to be determined.",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date.",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number.",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to text.",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",m:[1,2],p:[{name:"ID number",example:"A1",detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Deadline",example:'"2017-10-01"',detail:"The deadline or range of age calculation. The default is the current day.",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",m:[1,2],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Birthday format",example:"0",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",m:[1,2],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Word segmentation mode",example:"0",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode].",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"Returns whether a value is a date.",a:"Whether a value is a date.",m:[1,1],p:[{name:"value",example:'"1990-01-01"',detail:"The value to be verified as a date.",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",m:[1,8],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"},{name:"Maximum mark",example:"#fc5c5c",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Minimum mark",example:"#fc5c5c",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Mark size",example:"1.5",detail:"The maximum and minimum mark size settings, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Fill color",example:"#CCF3F4",detail:"Form an area chart, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Segmentation threshold",example:"1",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"Above threshold color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Below threshold color",example:"#fc5c5c",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Zero value bar color",example:"#999",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Rotation angle",example:"0",detail:"The rotation angle of the pie chart, the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"border",example:"0",detail:"Pie chart border size, default is none 0",require:"o",repeat:"n",type:"rangeall"},{name:"Border color",example:"#000",detail:"The border color of the pie chart, the default is #000",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Outlier ratio",example:"1.5",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times",require:"o",repeat:"n",type:"rangeall"},{name:"Target value",example:"10",detail:"The target value setting on the box plot, the default is false and does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Point size",example:"1.5",detail:"The radius of the target point and outlier is set, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",m:[2,3],p:[{name:"Target",example:"10",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"achieved",example:"8",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Contrast",example:"12",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",m:[1,1],p:[{name:"config",example:"PIESPLINES(A1:A20)",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc.",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",m:[1,4],p:[{name:"range",detail:"The data to be sorted.",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order.",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_column2",detail:"Additional columns.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",m:[2,3],p:[{name:"range",detail:"The data to be filtered.",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false.",example:"1",require:"m",repeat:"n",type:"range"},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted.",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",m:[1,3],p:[{name:"range",detail:"The data to filter by unique entries.",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE().",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",m:[0,2],p:[{name:"rows",detail:"The number of rows to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",m:[1,4],p:[{name:"rows",detail:"The number of rows in the function's resulting grid.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",m:[1,1],p:[{name:"expression",example:'"A1+5*2^2"',detail:"Formula or expression",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"Deshacer",redo:"Rehacer",paintFormat:"Clonar formato",currencyFormat:"Formato de moneda",percentageFormat:"Formato de porcentaje",numberDecrease:"Menos decimales",numberIncrease:"Ms decimales",moreFormats:"Ms formatos",font:"Fuente","font-size":"Tamao Fuente",bold:"Negrita (Ctrl+B)",italic:"Itlica (Ctrl+I)",strikethrough:"Tachar (Alt+Shift+5)",underline:"Guion bajo","font-color":"Color texto",chooseColor:"elegir color",resetColor:"Reinicializar",customColor:"PERSONALIZADO",alternatingColors:"Colores alternos",confirmColor:"Vale",cancelColor:"Cancelar",collapse:"Recoger",background:"Color de relleno",border:"Borde",borderStyle:"Estilo Borde","merge-cell":"Juntar celdas",chooseMergeType:"Elegir tipo de unin",horizontalAlign:"Alineacin Horizontal",verticalAlign:"Alineacin Vertical",alignment:"Alineacin",textWrap:"Ajuste de texto",textWrapMode:"Modo de ajuste de texto",textRotate:"Rotar texto",textRotateMode:"Modo de rotar texto",freeze:"Fijar fila superior",sort:"Ordenar",filter:"Filtrar",findAndReplace:"Buscar y reemplazar","formula-sum":"SUMA",autoSum:"SUMA automtica",moreFunction:"Ms funciones",conditionalFormat:"Formato condicional",comment:"Comentario",pivotTable:"Tabla Dinmica",chart:"Grfica",screenshot:"Captura de pantalla",splitColumn:"Separar texto",insertImage:"Insertar imagen",dataVerification:"Verificacin de datos",protection:"Proteger la hoja",clearText:"Limpiar color",noColorSelectedText:"Ningn color seleccionado",toolMore:"Ms",toolLess:"Menos",toolClose:"Cerrar",toolMoreTip:"Ms funcionalidades",moreOptions:"Ms opciones",cellFormat:"Configuracin formato de celda",print:"Imprimir"},alternatingColors:{applyRange:"Aplicar a rango",selectRange:"Seleccionar un rango de datos",header:"Cabecera",footer:"Pie",errorInfo:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una sola rea y vuelve a intentarlo",textTitle:"Estilo Formato",custom:"PERSONALIZADO",close:"cerrar",selectionTextColor:"Haz clic para seleccionar el color del texto",selectionCellColor:"Haz clic para seleccionar el color de la celda",removeColor:"Eliminar colores alternos",colorShow:"color",currentColor:"Actual",tipSelectRange:"Selecciona la gama de colores alternos",errorNoRange:"No hay ningn rango seleccionado",errorExistColors:"Los colores alternos ya existen y no se pueden editar"},button:{confirm:"Vale",cancel:"Cancelar",close:"Cerrar",update:"Actualizar",delete:"Eliminar",insert:"Insertar",prevPage:"Previous",nextPage:"Next",total:"total:"},paint:{start:"Inicio clonar formato",end:"ESC",tipSelectRange:"Selecciona el rango que quieres copiar",tipNotMulti:"No se puede realizar esta operacin en un rango de seleccin mltiple"},format:{moreCurrency:"Ms formatos de moneda",moreDateTime:"Ms formatos de fecha y hora",moreNumber:"Ms formatos de nmero",titleCurrency:"Formatos de moneda",decimalPlaces:"Decimales",titleDateTime:"Formatos de fecha y hora",titleNumber:"Formatos de nmeros"},info:{detailUpdate:"Nuevo abierto",detailSave:"Cache local restaurado",row:"",column:"",loading:"Cargando...",copy:"Copiar",return:"Salir",rename:"Renombrar",tips:"Renombrar Libro",noName:"Hoja sin ttulo",wait:"esperando actualizacin",add:"Aadir",addLast:"ms filas al final",backTop:"Volver arriba",pageInfo:"Total ${total}pgina ${totalPage}actual ${currentPage}",nextPage:"Siguiente",tipInputNumber:"Introduce el nmero",tipInputNumberLimit:"El rango de aumento est limitado a 1-100",tipRowHeightLimit:"La altura de la fila debe estar entre 0 ~ 545",tipColumnWidthLimit:"El ancho de la columna debe estar entre 0 ~ 2038",pageInfoFull:"Total ${total}pgina ${totalPage}Se muestran todos los datos"},currencyDetail:{RMB:"RMB",USdollar:"Dlar US",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"},defaultFmt:[{text:"Automtico",value:"General",example:""},{text:"Texto",value:"@",example:""},{text:"",value:"partir",example:""},{text:"Nmero",value:"##0.00",example:"1000.12"},{text:"Porcentaje",value:"#0.00%",example:"12.21%"},{text:"Cientfico",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"Contabilidad",value:"(0.00)",example:"(1200.09)"},{text:"Moneda",value:"0.00",example:"1200.09"},{text:"",value:"partir",example:""},{text:"Fecha",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"Hora",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"Hora 24H",value:"hh:mm",example:"15:00"},{text:"Fecha Hora",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"Fecha Hora 24 H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"partir",example:""},{text:"Formatos personalizados",value:"fmtOtherSelf",example:"ms"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],fontFamily:{MicrosoftYaHei:"YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana"],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3},border:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{mergeAll:"Unir todo",mergeV:"Verticalmente",mergeH:"Horizontalmente",mergeCancel:"Separar",overlappingError:"No se pueden fusionar reas superpuestas",partiallyError:"No se puede realizar esta operacin en celdas parcialmente unidas"},align:{left:"izquierda",center:"centro",right:"derecha",top:"Arriba",middle:"Centro",bottom:"Abajo"},textWrap:{overflow:"Desbordar",wrap:"Ajustar",clip:"Cortar"},rotation:{none:"Ninguno",angleup:"Ladear Arriba",angledown:"Ladear Abajo",vertical:"Apilar Verticalmente",rotationUp:"Rotar Arriba",rotationDown:"Rotar Abajo"},freezen:{default:"Fijar",freezenRow:"Primera Fila",freezenColumn:"Primera Columna",freezenRC:"Ambas",freezenRowRange:"Fijar rango filas",freezenColumnRange:"Fijar rango columnas",freezenRCRange:"Fijar ambos rangos",freezenCancel:"Cancelar",noSeletionError:"No hay rango para seleccionar",rangeRCOverErrorTitle:"Recordatorio de congelacin",rangeRCOverError:"El panel de congelacin excede el rango visible y puede causar que no funcione correctamente. Reinicie el rea de congelacin."},sort:{asc:"Ascendente ",desc:"Descendente ",custom:"Ordenacin personalizada",hasTitle:"Los datos tienen una fila de encabezado",sortBy:"Ordenar por",addOthers:"Aadir otra columna de ordenacin",close:"cerrar",confirm:"ordenar",columnOperation:"Columna",secondaryTitle:"y despus por",sortTitle:"Ordenar rango",sortRangeTitle:"Ordenar rango de",sortRangeTitleTo:"a",noRangeError:"No se puede realizar esta operacin en mltiples reas de seleccin, selecciona un solo rango e intenta nuevamente",mergeError:"Hay celdas combinadas en la seleccin, esta operacin no se puede realizar!"},filter:{filter:"crear filtro",sortByAsc:"Ordenar A-Z",sortByDesc:"Ordenar Z-A",filterByColor:"Filtrar por color",filterByCondition:"Filtrar por condicin",filterByValues:"Filtrar por valores",filiterInputNone:"Ninguno",filiterInputTip:"Introduce valor de filtro",filiterRangeStartTip:"Valor para frmula",filiterRangeEndTip:"Valor para frmula",filterValueByAllBtn:"Seleccionar todos",filterValueByClearBtn:"Limpiar",filterValueByInverseBtn:"Invertir",filterValueByTip:"filtrar por valores",filterConform:"Confirmar",filterCancel:"Cancelar",clearFilter:"Quitar filtro",conditionNone:"Ninguno",conditionCellIsNull:"Est vaco",conditionCellNotNull:"No est vaco",conditionCellTextContain:"El texto contiene",conditionCellTextNotContain:"El texto no contiene",conditionCellTextStart:"El texto empieza con",conditionCellTextEnd:"El texto termina con",conditionCellTextEqual:"El texto es exactamente",conditionCellDateEqual:"La fecha es",conditionCellDateBefore:"La fecha es anterior",conditionCellDateAfter:"La fecha es posterior",conditionCellGreater:"Mayor que",conditionCellGreaterEqual:"Mayor o igual que",conditionCellLess:"Menor que",conditionCellLessEqual:"Menor o igual que",conditionCellEqual:"Es igual a",conditionCellNotEqual:"No es igual a",conditionCellBetween:"Est entre",conditionCellNotBetween:"No est entre",filiterMoreDataTip:"Gran cantidad de datos! por favor espera",filiterMonthText:"Mes",filiterYearText:"Ao",filiterByColorTip:"Filtrar por color de celda",filiterByTextColorTip:"Filtrar por color de fuente",filterContainerOneColorTip:"Esta columna contiene solo un color",filterDateFormatTip:"Format fecha",valueBlank:"(Nulo)",mergeError:"Hay celdas combinadas en la seleccin del filtro, esta operacin no se puede realizar!"},rightclick:{copy:"Copiar",copyAs:"Copiar como",paste:"Pegar",insert:"Insertar",delete:"Eliminar",deleteCell:"Eliminar celda",deleteSelected:"Eliminar seleccionado ",hide:"Esconder",hideSelected:"Esconder seleccionado ",showHide:"Mostrar ocultos ",to:"Hacia",left:"Izquierda",right:"Derecha",top:"Arriba",bottom:"Abajo",moveLeft:"Mover izquierda",moveUp:"Mover arriba",add:"Aadir",row:"Fila",column:"Columna",width:"Ancho",height:"Alto",number:"Nmero",confirm:"Confirmar",orderAZ:"Ordenar A-Z",orderZA:"Ordenar Z-A",clearContent:"Limpiar contenido",matrix:"Operacin de Matriz",sortSelection:"Ordenar",filterSelection:"Filtrar",chartGeneration:"Crear grfico",firstLineTitle:"ttulo primera lnea",untitled:"sin ttulo",array1:"Matriz unidimensional",array2:"Matriz bidimensional",array3:"Matrices multidimensionales",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Desplazamiento Diagonal",offset:"Desplazamiento",boolean:"Booleana",flip:"Voltear",upAndDown:"Arriba y abajo",leftAndRight:"Izquierda y derecha",clockwise:"Sentido horario",counterclockwise:"Sentido anti-horario",transpose:"Transponer",matrixCalculation:"Clculo de matrices",plus:"Suma",minus:"Resta",multiply:"Multiplicacin",divided:"Divisin",power:"Exponenciacin",root:"Raz Cuadrada",log:"Logaritmo",delete0:"Eliminar valores nulos en ambos extremos",removeDuplicate:"Eliminar valores duplicados",byRow:"Por fila",byCol:"Por columna",generateNewMatrix:"Generar nueva matriz"},comment:{insert:"Insertar",edit:"Editar",delete:"Elimiar",showOne:"Mostrar/Ocular",showAll:"Mostrar/Ocular Todo"},screenshot:{screenshotTipNoSelection:"Selecciona el alcance de la captura de pantalla",screenshotTipTitle:"Advertencia!",screenshotTipHasMerge:"Esta operacin no se puede realizar en celdas combinadas",screenshotTipHasMulti:"Esta operacin no se puede realizar en varios rangos de seleccin",screenshotTipSuccess:"Exitoso",screenshotImageName:"Captura de pantalla",downLoadClose:"Cerrar",downLoadCopy:"Copiar al portapapeles",downLoadBtn:"Descargar",browserNotTip:"no es compatible con el navegador IE.",rightclickTip:'Haz clic con el botn derecho en la imagen y selecciona "copiar"',successTip:'Con xito (si falla el pegado, haz clic con el botn derecho en la imagen para "copiar imagen")'},splitText:{splitDelimiters:"Delimitadores",splitOther:"Otros",splitContinueSymbol:"Los separadores consecutivos se tratan como uno solo",splitDataPreview:"Previsualizar",splitTextTitle:"Partir texto",splitConfirmToExe:"Ya hay datos aqu, quieres reemplazarlos?",tipNoMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una nica rea y vuelve a intentarlo",tipNoMultiColumn:"Solo se puede convertir una columna de datos a la vez. El rea seleccionado puede tener varias filas, pero no varias columnas. Vuelve a intentarlo despus de seleccionar un solo rango de columnas"},imageText:{imageSetting:"Configuracin de imagen",close:"Cerrar",conventional:"Convencional",moveCell1:"Mover y cambiar el tamao de las celdas",moveCell2:"Mover y no cambiar el tamao de la celda",moveCell3:"No mover ni cambiar el tamao de la celda",fixedPos:"Posicin fija",border:"Borde",width:"Ancho",radius:"Radio",style:"Estilo",solid:"Slido",dashed:"Discontinua",dotted:"Punteado",double:"Doble",color:"Color"},punctuation:{tab:"Tabulacin",semicolon:"punto y coma",comma:"coma",space:"espacio"},findAndReplace:{find:"Encontrar",replace:"Reemplazar",goto:"Ir a",location:"Ubicacin",formula:"Frmula",date:"Fecha",number:"Nmero",string:"Texto",error:"Error",condition:"Condicin",rowSpan:"Intervalo de filas",columnSpan:"Intervalo de columnas",locationExample:"Ubicacin",lessTwoRowTip:"Selecciona al menos dos filas",lessTwoColumnTip:"Selecciona al menos dos columnas",findTextbox:"Encontrar Contenido",replaceTextbox:"Reemplazar Contenido",regexTextbox:"Expresin Regular",wholeTextbox:"Palabra entera",distinguishTextbox:"Distingue maysculas y minsculas",allReplaceBtn:"Reemplazar Todo",replaceBtn:"Reemplazar",allFindBtn:"Encontrar Todo",findBtn:"Encontrar siguiente",noFindTip:"No se encontr el contenido",modeTip:"Esta operacin no est disponible en este modo",searchTargetSheet:"Hoja",searchTargetCell:"Celda",searchTargetValue:"Valor",searchInputTip:"Introduce el contenido de la bsqueda",noReplceTip:"No hay nada que reemplazar",noMatchTip:"No se encontraron coincidencias",successTip:"${xlength} elementos encontrados",locationConstant:"Constante",locationFormula:"Frmula",locationDate:"Fecha",locationDigital:"Nmero",locationString:"Texto",locationBool:"Lgicos",locationError:"Error",locationNull:"Nulo",locationCondition:"Formato condicional",locationRowSpan:"Intervalo fila",locationColumnSpan:"Intervalo columna",locationTiplessTwoRow:"Selecciona al menos dos filas",locationTiplessTwoColumn:"Selecciona al menos dos columnas",locationTipNotFindCell:"Celda no encontrada"},sheetconfig:{delete:"Eliminar",copy:"Copiar",rename:"Renombrar",changeColor:"Cambiar color",hide:"Ocultar",unhide:"Mostrar",moveLeft:"Mover izquierda",moveRight:"Mover derecja",resetColor:"Reiniciar color",cancelText:"Cancelar",chooseText:"Confirmar color",tipNameRepeat:"El nombre de la pgina de la pestaa no se puede repetir! Revsalo",noMoreSheet:"El libro de trabajo contiene al menos una hoja de trabajo visual. Para eliminar la hoja de trabajo seleccionada, inserta una nueva hoja de trabajo o muestra una hoja de trabajo oculta",confirmDelete:"Ests seguro de eliminar",redoDelete:"Se puede deshacer con Ctrl+Z",noHide:"No se puede ocultar, al menos conserva una etiqueta de hoja",chartEditNoOpt:"Esta operacin no est permitida en el modo de edicin de grficos!",sheetNameSpecCharError:"El nombre no puede contener:[ ] :  ? * / ' \"",sheetNamecannotIsEmptyError:"El nombre de la hoja no puede estar vaco"},conditionformat:{conditionformat_greaterThan:"Conditionformat-GreaterThan",conditionformat_greaterThan_title:"Dar formato a celdas mayores que",conditionformat_lessThan:"Conditionformat-LessThan",conditionformat_lessThan_title:"Dar formato a celdas ms pequeas que",conditionformat_betweenness:"Conditionformat-Betweenness",conditionformat_betweenness_title:"Dar formato a celdas con valores entre",conditionformat_equal:"Conditionformat-Equal",conditionformat_equal_title:"Dar formato a celdas iguales a",conditionformat_textContains:"Conditionformat-TextContains",conditionformat_textContains_title:"Dar formato a las celdas que contienen el siguiente texto",conditionformat_occurrenceDate:"Conditionformat-OccurrenceDate",conditionformat_occurrenceDate_title:"Dar formato a celdas que contienen las siguientes fechas",conditionformat_duplicateValue:"Conditionformat-DuplicateValue",conditionformat_duplicateValue_title:"Dar formato a celdas que contienen los siguientes tipos de valores",conditionformat_top10:"Conditionformat-Top10",conditionformat_top10_percent:"Conditionformat-Top10%",conditionformat_top10_title:"Formatea las celdas con el valor ms alto",conditionformat_last10:"Conditionformat-Last10",conditionformat_last10_percent:"Conditionformat-Last10%",conditionformat_last10_title:"Formatea las celdas con el valor ms pequeo",conditionformat_AboveAverage:"Conditionformat-AboveAverage",conditionformat_AboveAverage_title:"Dar formato a celdas por encima del promedio",conditionformat_SubAverage:"Conditionformat-SubAverage",conditionformat_SubAverage_title:"Dar formato a celdas por debajo del promedio",rule:"Regla",newRule:"Nueva regla",editRule:"Editar regla",deleteRule:"Eliminar regla",deleteCellRule:"Eliminar regla de celda",deleteSheetRule:"Eliminar regla de hoja",manageRules:"Reglas administracin",showRules:"Muestra sus reglas de formato",highlightCellRules:"Resaltar reglas de celda",itemSelectionRules:"Reglas de seleccin de elementos",conditionformatManageRules:"Administrador de reglas de formato condicional",format:"Formatear",setFormat:"Establecer formato",setAs:"Establecer como",setAsByArea:"Para el rea seleccionada, establecer",applyRange:"Aplicar rango",selectRange:"Seleccionar rango de aplicacin",selectRange_percent:"Porcentaje del rango seleccionado",selectRange_average:"Valor promedio del rango seleccionado",selectRange_value:"Valor en el rango seleccionado",pleaseSelectRange:"Selecciona el rango de aplicacin",selectDataRange:"Seleccionar rango de datos",selectCell:"seleccionar celda",pleaseSelectCell:"Selecciona una celda",pleaseSelectADate:"Selecciona una fecha",pleaseEnterInteger:"Introduzca un nmero entero entre 1 y 1000",onlySingleCell:"Solo se puede hacer referencia a una sola celda",conditionValueCanOnly:"El valor de la condicin solo puede ser un nmero o una sola celda",ruleTypeItem1:"Aplicar formato a todas las celdas segn sus valores respectivos",ruleTypeItem2:"Solo formatear celdas que contengan",ruleTypeItem2_title:"Solo para celdas que cumplan las siguientes condiciones",ruleTypeItem3:"Aplicar formato solo a los nmeros superiores o inferiores",ruleTypeItem3_title:"Es el valor en la siguiente clasificacin",ruleTypeItem4:"Aplicar formato solo a los valores superiores o inferiores al promedio",ruleTypeItem4_title:"Es un valor que cumple las siguientes condiciones",ruleTypeItem5:"Aplicar formato solo a valores nicos o repetidos",ruleTypeItem6:"Use frmulas para determinar qu celdas formatear",formula:"frmula",textColor:"Color Texto",cellColor:"Color Celda",confirm:"Confirma",confirmColor:"Confirma color",cancel:"Cancela",close:"Cierra",clearColorSelect:"Limpiar seleccin de color",sheet:"Hoja",currentSheet:"Hoja actual",dataBar:"Barra de datos",dataBarColor:"Color barra de datos",gradientDataBar_1:"Barra de datos de degradado azul-blanco",gradientDataBar_2:"Barra de datos de degradado verde-blanco",gradientDataBar_3:"Barra de datos de degradado rojo-blanco",gradientDataBar_4:"Rayas de degradado de color naranja-blanco",gradientDataBar_5:"Rayas de degradado azul claro-blancas",gradientDataBar_6:"Barra de datos de degradado prpura-blanco",solidColorDataBar_1:"Barra de datos azul",solidColorDataBar_2:"Barra de datos verde",solidColorDataBar_3:"Barra de datos roja",solidColorDataBar_4:"Barra de datos naranja",solidColorDataBar_5:"Barra de datos azul claro",solidColorDataBar_6:"Barra de datos prpura",colorGradation:"Degradado de color",colorGradation_1:"Gradacin de color verde-amarillo-rojo",colorGradation_2:"Gradacin de color rojo-amarillo-verde",colorGradation_3:"Gradacin de color verde-blanco-rojo",colorGradation_4:"Gradacin de color rojo-blanco-verde",colorGradation_5:"Gradacin de color azul-blanco-rojo",colorGradation_6:"Gradacin de color rojo-blanco-azul",colorGradation_7:"Gradacin de color blanco-rojo",colorGradation_8:"Gradacin de color rojo-blanco",colorGradation_9:"Gradacin de color verde-blanco",colorGradation_10:"Gradacin de color blanco-verde",colorGradation_11:"Gradacin de color verde-amarillo",colorGradation_12:"Gradacin de color amarillo-verde",icons:"iconos",pleaseSelectIcon:"Haz clic para seleccionar un grupo de iconos:",cellValue:"Valor de celda",specificText:"Texto especfico",occurrence:"Fecha",greaterThan:"Mayor que",lessThan:"Menor que",between:"Entre",equal:"Igual",in:"En",between2:"",contain:"Contiene",textContains:"Texto contiene",duplicateValue:"Valor duplicado",uniqueValue:"Valor Unico",top:"Mejor",top10:"10 mejores",top10_percent:"10% mejores",last:"Ultimo",last10:"Ultimos 10",last10_percent:"Ultimos 10%",oneself:"",above:"Encima",aboveAverage:"Encima media",below:"Debajo",belowAverage:"Debajo media",all:"Todos",yesterday:"Ao a fecha",today:"Hoy",tomorrow:"Maana",lastWeek:"Ultima semana",thisWeek:"Esta semana",lastMonth:"Ultimo mes",thisMonth:"Este mes",lastYear:"Ultimo ao",thisYear:"Este ao",last7days:"Ultimos 7 das",last30days:"Ultimos 30 das",next7days:"Siguientes 7 das",next30days:"Siguientes 30 das",next60days:"Siguientes 60 das",chooseRuleType:"Elige el tipo de regla",editRuleDescription:"Editar descripcin de regla",newFormatRule:"Nueva regla de formato",editFormatRule:"Editar regla de formato",formatStyle:"Estilo",fillType:"Rellenar",color:"Color",twocolor:"Dos colores",tricolor:"Tricolor",multicolor:"Multi color",grayColor:"Color gris",gradient:"Gradiente",solid:"Slido",maxValue:"Valor mximo",medianValue:"Valor mediano",minValue:"Valor mnimo",direction:"Direccin",threeWayArrow:"Flecha de tres direcciones",fourWayArrow:"Flecha de cuatro direcciones",fiveWayArrow:"Flecha de cinco direcciones",threeTriangles:"Tres tringulos",shape:"Forma",threeColorTrafficLight:"Semforo de tres colores",fourColorTrafficLight:"Semforo de cuatro colores",threeSigns:"Tres signos",greenRedBlackGradient:"Gradiente verde-rojo-negro",rimless:"Sin aros",bordered:"Bordeado",mark:"Marcar",threeSymbols:"Tres smbolos",tricolorFlag:"Bandera tricolor",circled:"Rodeado",noCircle:"Sin crculo",grade:"Grado",grade4:"4 Grado",grade5:"5 Grado",threeStars:"3 Estrellas",fiveQuadrantDiagram:"Diagrama de cinco cuadrantes",fiveBoxes:"5 Cajas"},dataVerification:{cellRange:"Rango celdas",selectCellRange:"Haz clic para seleccionar un rango de celdas",selectCellRange2:"Selecciona un rango de celdas",verificationCondition:"Condicin de verificacin",allowMultiSelect:"Permitir seleccin mltiple",dropdown:"lista desplegable",checkbox:"Casilla de verificacin",number:"Nmero",number_integer:"Nmero entero",number_decimal:"Nmero decimal",text_content:"Contenido texto",text_length:"Longitud texto",date:"Fecha",validity:"Eficacia",placeholder1:"Introduce las opciones, separadas por comas, como 1,2,3,4,5",placeholder2:"Introduce contenido",placeholder3:"Valor numrico, como 10",placeholder4:"Introduce el texto especificado",placeholder5:"Introduce el mensaje que se muestra cuando se selecciona la celda",selected:"Seleccionado",notSelected:"No seleccionado",between:"Entre",notBetween:"No entre",equal:"Iqual",notEqualTo:"No iqual a",moreThanThe:"Ms que el",lessThan:"Menos que",greaterOrEqualTo:"Mayor o igual a",lessThanOrEqualTo:"Menor o igual a",include:"Incluir",exclude:"Excluir",earlierThan:"Antes de",noEarlierThan:"No antes de",laterThan:"Despus de",noLaterThan:"No despus de",identificationNumber:"Nmero de identificacin",phoneNumber:"Nmero de telfono",remote:"Opcin de adquisicin remota automtica",prohibitInput:"Prohibir la entrada cuando los datos de entrada no son vlidos",hintShow:"Mostrar mensaje cuando se selecciona la celda",deleteVerification:"Eliminar verificacin",tooltipInfo1:"La opcin de la lista desplegable no puede estar vaca",tooltipInfo2:"El contenido de la casilla de verificacin no puede estar vaco",tooltipInfo3:"El valor ingresado no es un tipo numrico",tooltipInfo4:"El segundo valor no puede ser menor que el primero",tooltipInfo5:"El contenido del texto no puede estar vaco",tooltipInfo6:"El valor ingresado no es una fecha",tooltipInfo7:"La segunda fecha no puede ser menor que la primera",textlengthInteger:"La longitud del texto debe ser un entero mayor o igual a 0"},formula:{sum:"Suma",average:"Media",count:"Contar",max:"Mx",min:"Mn",ifGenerate:"Generador de frmula SI",find:"Aprender ms",tipNotBelongToIf:"Esta funcin de celda no pertenece a la frmula SI!",tipSelectCell:"Selecciona la celda para insertar la funcin",ifGenCompareValueTitle:"Valor de comparacin",ifGenSelectCellTitle:"Haz click para seleccionar una celda",ifGenRangeTitle:"Rango",ifGenRangeTo:"a",ifGenRangeEvaluate:"Evaluar rango",ifGenSelectRangeTitle:"Haz click para seleccionar rango",ifGenCutWay:"Forma particionado",ifGenCutSame:"Mismo valor de particionado",ifGenCutNpiece:"Particionar por N",ifGenCutCustom:"Personalizado",ifGenCutConfirm:"Confirma",ifGenTipSelectCell:"Selecciona celdas",ifGenTipSelectCellPlace:"Por favor selecciona celdas",ifGenTipSelectRange:"Selecciona rango",ifGenTipSelectRangePlace:"Por favor selecciona rango",ifGenTipNotNullValue:"El valor de comparacin no puede ser vaco!",ifGenTipLableTitile:"Etiqueta",ifGenTipRangeNotforNull:"El rango no puede quedar vaco!",ifGenTipCutValueNotforNull:"El valor de particin no puede ser vaco!",ifGenTipNotGenCondition:"No hay condiciones disponibles para la generacin!"},formulaMore:{valueTitle:"Valor",tipSelectDataRange:"Selecciona rango de datos",tipDataRangeTile:"Rango de datos",findFunctionTitle:"Funcin de bsqueda",tipInputFunctionName:"Nombre o breve descripcin de la funcin",Array:"Vector",Database:"Base de datos",Date:"Fecha",Engineering:"Ingeniera",Filter:"Filtro",Financial:"Financiero",luckysheet:"Luckysheet",other:"Otro",Logical:"Lgica",Lookup:"Bsqueda",Math:"Matemtico",Operator:"Operadores",Parser:"Compilador",Statistical:"Estadstico",Text:"Texto",dataMining:"Minera de datos",selectFunctionTitle:"Selecciona una funcin",calculationResult:"Resultado",tipSuccessText:"Exito",tipParamErrorText:"Parmetro errneo",helpClose:"Cerrar",helpCollapse:"Recoger",helpExample:"Ejemplo",helpAbstract:"Resumen",execfunctionError:"Error en la frmula",execfunctionSelfError:"La frmula no puede hacer referencia a su propia celda",execfunctionSelfErrorResult:"La frmula no puede hacer referencia a su propia celda, lo que dar lugar a resultados de clculo inexactos",allowRepeatText:"Repetir",allowOptionText:"Opcin",selectCategory:"O selecciona una categora"},drag:{noMerge:"No se puede realizar esta operacin en celdas combinadas",afectarPivot:"Este cambio no se puede realizar en la celda seleccionada porque afectar a la tabla dinmica!",noMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una sola rea",noPaste:"No se puede pegar este contenido aqu, selecciona una celda en el rea de pegado e intenta pegar nuevamente",noPartMerge:"No se puede realizar esta operacin en celdas parcialmente fusionadas",inputCorrect:"Introduce el valor correcto",notLessOne:"El nmero de filas y columnas no puede ser inferior a 1",offsetColumnLessZero:"La columna de desplazamiento no puede ser negativa!",pasteMustKeybordAlert:": Ctrl + C , Ctrl + V , Ctrl + X ",pasteMustKeybordAlertHTMLTitle:"",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;"},pivotTable:{title:"Tabla Dinmica",closePannel:"Cerrar",editRange:"Rango",tipPivotFieldSelected:"Selecciona los campos",tipClearSelectedField:"Limpiar todos los campos",btnClearSelectedField:"Limpiar",btnFilter:"Filtrar",titleRow:"Fila",titleColumn:"Columna",titleValue:"Valor",tipShowColumn:"Los campos de estadsticas se muestran como columnas",tipShowRow:"Los campos de estadsticas se muestran como filas",titleSelectionDataRange:"Selecciona rango",titleDataRange:"Rango de datos",valueSum:"SUMA",valueStatisticsSUM:"Suma",valueStatisticsCOUNT:"Contar",valueStatisticsCOUNTA:"Contar A",valueStatisticsCOUNTUNIQUE:"Contar Distintos",valueStatisticsAVERAGE:"Media",valueStatisticsMAX:"Mx",valueStatisticsMIN:"Mn",valueStatisticsMEDIAN:"Mediana",valueStatisticsPRODUCT:"Producto",valueStatisticsSTDEV:"Desviacin Estndar",valueStatisticsSTDEVP:"Stdevp",valueStatisticslet:"Varianza",valueStatisticsVARP:"VarP",errorNotAllowEdit:"Esta operacin est prohibida en el modo sin edicin!",errorNotAllowMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona un solo rango y vuelve a intentarlo",errorSelectRange:"Seleccione el rango de la nueva tabla dinmica",errorIsDamage:"Los datos de origen de esta tabla dinmica estn daados!",errorNotAllowPivotData:"No se puede seleccionar la tabla dinmica como datos de origen!",errorSelectionRange:"La seleccin fall, rango de entrada incorrecto!",errorIncreaseRange:"Por favor, expande el rango seleccionado!",titleAddColumn:"Aadir columna a la tabla dinmica",titleMoveColumn:"Muever la columna a la celda en blanco de abajo",titleClearColumnFilter:"Quitar el filtro de esta columna",titleFilterColumn:"Filtro",titleSort:"Ordenar",titleNoSort:"No Ordenar",titleSortAsc:"ASC",titleSortDesc:"DESC",titleSortBy:"Ordenar por",titleShowSum:"Mostrar total",titleStasticTrue:"S",titleStasticFalse:"No"},dropCell:{copyCell:"Copiar",sequence:"Secuencia",onlyFormat:"Solo formato",noFormat:"Sin formato",day:"Da",workDay:"Da Laborable",month:"Mes",year:"Ao",chineseNumber:"Nmeros Chinos"},imageCtrl:{borderTile:"Color de borde de imagen",borderCur:"Color"},protection:{protectiontTitle:"Proteccin",enterPassword:"Introduce una contrasea (opcional)",enterHintTitle:"Preguntar cuando la edicin est prohibida (opcional)",enterHint:"La celda o el grfico que ests intentando cambiar se encuentra en una hoja de trabajo protegida. Si quieres cambiarlo, desprotege la hoja de trabajo. Es posible que tengas que ingresar una contrasea",swichProtectionTip:"Protege la hoja y el contenido de las celdas bloqueadas",authorityTitle:"Permitir a los usuarios de esta hoja:",selectLockedCells:"Selecciona celdas bloqueadas",selectunLockedCells:"Selecciona celdas desbloqueadas",formatCells:"Formatear celdas",formatColumns:"Formatear columnas",formatRows:"Formatear filas",insertColumns:"Insertar columnas",insertRows:"Insertar filas",insertHyperlinks:"Insertar enlaces",deleteColumns:"Eliminar columnas",deleteRows:"Eliminar filas",sort:"Ordenar",filter:"Filtrar",usePivotTablereports:"Usar informes de tabla dinmica",editObjects:"Editar objetos",editScenarios:"Editar escenarios",allowRangeTitle:"Permitir a los usuarios del rango:",allowRangeAdd:"Nuevo...",allowRangeAddTitle:"Ttulo",allowRangeAddSqrf:"Referencia",selectCellRange:"Haz clic para seleccionar un rango de celdas",selectCellRangeHolder:"Rango de celdas",allowRangeAddTitlePassword:"Contrasea",allowRangeAddTitleHint:"Pregunta",allowRangeAddTitleHintTitle:"Preguntar cuando hay una contrasea (opcional)",allowRangeAddtitleDefault:"Nombre del rango de entrada",rangeItemDblclick:"Haz doble clic para editar",rangeItemHasPassword:"Tiene contrasea",rangeItemErrorTitleNull:"El ttulo es nulo",rangeItemErrorRangeNull:"La referencia es nula",rangeItemErrorRange:"La reference tiene un error",validationTitle:"Validacin de contrasea",validationTips:"Hay que ingresar una contrasea para desbloquear la proteccin de la hoja de trabajo",validationInputHint:"Introduce una contrasea",checkPasswordNullalert:"Contrasea requerida!",checkPasswordWrongalert:"Contrasea incorrecta. Por favor, prueba de nuevo!",checkPasswordSucceedalert:"Desbloqueo conseguido!",defaultRangeHintText:"La celda est protegida con contrasea.",defaultSheetHintText:"La celda o el grfico estn en una hoja de trabajo protegida. Para realizar cambios, desprotege la hoja de trabajo. Es posible que tengas que ingresar una contrasea"},cellFormat:{cellFormatTitle:"Formatear celdas",protection:"Proteccin",locked:"Bloqueado",hidden:"Escondido",protectionTips:"Para bloquear celdas u ocultar frmulas, protege la hoja de trabajo. En la barra de herramientas, haz clic en el botn Proteger hoja",tipsPart:"Comprobado parcial",tipsAll:"Todo seleccionado",selectionIsNullAlert:"Se requiere una seleccin!",sheetDataIsNullAlert:"error, no hay datos!"},print:{normalBtn:"Normal",layoutBtn:"Disposicin de pgina",pageBtn:"Previsualizacin de saltos de pgina",menuItemPrint:"Imprimir (Ctrl+P)",menuItemAreas:"Imprimir reas",menuItemRows:"Imprimir ttulos de filas",menuItemColumns:"Imprimir ttulos de columnas"},edit:{typing:"mecanografa"},websocket:{success:"xito de la conexin de WebSocket",refresh:"Se produjo un error en la conexin de WebSocket, actualice la pgina!",wait:"Se produjo un error en la conexin de WebSocket, tenga paciencia!",close:"Conexin WebSocket cerrada",contact:"Ocurri un error de comunicacin con el servidor, actualice la pgina y vuelva a intentarlo; de lo contrario, comunquese con el administrador.",support:"El navegador actual no es compatible con WebSocket"}};var zh_tw={functionlist:[{n:"SUMIF",t:0,d:"",a:"",m:[2,3],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n,,*,~~~*\n\n,,,,:=><",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"",a:"",m:[1,1],p:[{name:"value",detail:"",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"-11,",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"1",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11-11",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"x0,0`x`,`y`",a:"x0,0`x`,`y`",m:[2,2],p:[{name:"x",detail:"xx",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"xy",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\n,ISEVENTRUE,FALSE",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\n,ISODDTRUE,FALSE",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"e",a:"e",m:[1,1],p:[{name:"",detail:"e\n\n",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"10",a:"10",m:[1,1],p:[{name:"",detail:"10\n\n",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:",",a:"",m:[2,2],p:[{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",\n\n,",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - 1",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:",",a:"",m:[2,2],p:[{name:"n",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:",",a:"",m:[2,256],p:[{name:"",detail:"\n\n1AVERAGE\n\n2COUNT\n\n3COUNTA\n\n4MAX\n\n5MIN\n\n6PRODUCT\n\n7STDEV\n\n8STDEVP\n\n9SUM\n\n10VAR\n\n11VARP\n\n210112,,102COUNT,110VAR",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"2",detail:"[] - ",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"-11,",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n,,*,~~~*\n\n,,,,:=>>=<<=,",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"0101",a:"0101",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"",a:"",m:[1,1],p:[{name:"z",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",\n\n,",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"e~2.718",a:"e~2.718",m:[1,1],p:[{name:"",detail:"e",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'""',a:'""',m:[1,1],p:[{name:"",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"14PI",a:"14PI",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n0",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n,",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n,",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"0",a:"0",m:[2,2],p:[{name:"",detail:",",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n,",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"xnma,a1xn + a2xn+m++ aixn+i-1m,ia",a:"xnma",m:[4,4],p:[{name:"x",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"x",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:",-110",a:"",m:[1,1],p:[{name:"",detail:"",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:",",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"\n\n,SQRT#NUM",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"PI",a:"PI",m:[1,1],p:[{name:"",detail:"PI\n\n,SQRTPI#NUM",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"e",a:"e",m:[1,1],p:[{name:"",detail:"\n\n",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:",",a:"",m:[1,2],p:[{name:"",detail:"",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:'[ - 0] - \n\n,""\n\n,,TRUNC0',example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:",",a:"",m:[2,2],p:[{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"\n\n0",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"\n\n,",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"",a:"",m:[3,257],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2,2",detail:"[  ] - ",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"",a:"",m:[2,256],p:[{name:"1",detail:"1",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2,2",detail:"[  ] - ,",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2 ... 30",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:", HYPGEOM.DIST ",a:"",m:[5,5],p:[{name:"Sample_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\ncumulativeTRUE,HYPGEOM.DIST\n\nFALSE,",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:" Y x=0y",a:" Y x=0y",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:",,",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:" n ,n ",a:" n ",m:[2,2],p:[{name:"",detail:"",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"\n\n,n4LARGE4",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:",0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:",",a:",",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:'[-FALSE] - "data"',example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:",",a:",",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:'[-FALSE] - "data"',example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"01,",a:"01,",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[-3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"01,",a:"01,",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[-3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:", x  y ",a:"",m:[3,3],p:[{name:"x",detail:"x",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"y",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"x",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:",",a:"",m:[4,4],p:[{name:"x",detail:"WEIBULL ",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"Weibull \n\n alpha0",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:"Weibull \n\n beta0",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE,FALSE",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:",",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"",a:"",m:[3,3],p:[{name:"alpha",detail:"\n\n100*1 - alpha%,, alpha 0.05, 95%",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:" r",a:" r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:" Lambda ",a:" Lambda ",m:[3,3],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:" lambda ",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"",a:"",m:[2,3],p:[{name:"criteria_range",detail:" criterion ",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:'criteria_range\n\n:""  1  "="  "=1"\n\n:">1"\n\n:">=1"\n\n:"<1"\n\n:"<=1"\n\n:"<>1""<>"',example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[] - ,criteria_range",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"",a:"",m:[2,255],p:[{name:"average_range",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:" criterion1 ",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"criteria_range1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[] - ",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"",a:"",m:[2,2],p:[{name:"number",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"",detail:"\n\n01",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:" K ,K 01,01",a:" K ,K 01,01",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1 , 0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:" K ,K  0  1 , 0  1",a:" K ,K  0  1 , 0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1 , 0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Pearson r",a:"Pearson r",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"0,1",a:"0,1",m:[1,1],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"0,1",a:"0,1",m:[2,2],p:[{name:"z",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\nTRUE,\n\nFALSE,",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\nTRUE,\n\nFALSE,",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_f",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\nTRUE,\n\nFALSE,",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:" x ",a:" x ",m:[3,3],p:[{name:"probability",detail:",0101",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ,",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:" x ",a:" x ",m:[4,4],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ,",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"\n\nTRUE,\n\nFALSE,",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:" z  P ",a:" z  P ",m:[2,3],p:[{name:"array",detail:" x ",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[] - ,",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"",a:"",m:[3,4],p:[{name:"x_range",detail:" x ",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:" x_range ",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:"[ - ] - \n\n,PROB",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"\n\n125%\n\n250%\n\n375%",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"\n\n00%\n\n125%\n\n250%\n\n375%\n\n4100%",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:" ,\n\nTRUE,xx\n\nFALSE,x",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"(Pearson)r",a:"(Pearson)r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:" t ",a:" t ",m:[3,3],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"\n\ncumulativeTRUE,HYPGEOM.DIST\n\nFALSE,",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:" t \n\n 0  1",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"\n\n,\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:"t\n\n 0  1",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"\n\n,\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-",a:"t-",m:[4,4],p:[{name:"array1",detail:"t",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"t",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"\n\n 1:\n\n 2:",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"t\n\n 1:\n\n 2:\n\n 3:",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:" x, F  Fisher-Snedecor Snedecor F ",a:" x",m:[4,4],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:" FALSE\n\n TRUE:F.DIST\n\nFALSE:F.DIST",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"x,FFisher-SnedecorSnedecor F",a:" x",m:[3,3],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:",0",a:"",m:[1,255],p:[{name:"value1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:",0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:" x  y ",a:" x  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:",",a:",",m:[3,3],p:[{name:"x",detail:"",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"k",a:"k",m:[2,2],p:[{name:"array",detail:"k",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"",a:"",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:":",a:":",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:",",a:"",m:[3,4],p:[{name:"",detail:', 42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"VLOOKUP ",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:",1\n\n1,#VALUE",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[TRUE()] -,FALSE\n\nFALSEFALSE,,,,#N/A\n\nTRUE,,#N/A",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:",",a:"",m:[3,4],p:[{name:"",detail:',42"Cats"I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:",1\n\n1,#VALUE",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[ - TRUE()] - \n\nTRUE,,#N/A\n\nTRUE,,\n\nFALSE,,,#N/A",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:",",a:"",m:[2,3],p:[{name:"",detail:',42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:" | ",detail:"LOOKUP,,,",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"[  ] - ,,",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"",a:"",m:[2,5],p:[{name:"row_num",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:",A1",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:"[ - 1] - ,\n\n1$A$1\n\n2,A$1\n\n3,$A1\n\n4A1",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[ - TRUE] - ,A1TRUER1C1FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[ - ] - ",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"",a:"",m:[1,2],p:[{name:"ref_text",detail:"",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[ - TRUE] - ,A1TRUER1C1FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"",a:"",m:[0,1],p:[{name:"reference",detail:"[ - ] - \n\n,,",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:" `A=1` ",a:" `A=1` ",m:[0,1],p:[{name:"reference",detail:"[ - ] - A1\n\n,,",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:",",a:",",m:[3,5],p:[{name:"reference",detail:"",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:"\n\n,,",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"\n\n,,",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:",",a:",",m:[2,3],p:[{name:"lookup_value",detail:" lookup_array ",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:"\n\n1,MATCH#N/A",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:"[ - 1] - \n\n1,MATCH,\n\n0,\n\n-1MATCH,",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:",",a:",",m:[2,3],p:[{name:"array",detail:"",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:",",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"",a:"",m:[2,254],p:[{name:"data_field",detail:'\n\n,""',example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[] - ",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[] - 1",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"",a:"",m:[2,255],p:[{name:"index_num",detail:"\n\n,#VALUE",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[] - ",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"",a:"",p:[{name:"",detail:",\n\n:http://https://mailto:aim:ftp://gopher://telnet://news://,,,\n\n,http://,",example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:'[-] - ,\n\n,,,\n\n"",,',example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"0 32767 ,\n\n 23 24,",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"0 32767 ,\n\n 59 ",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"0 32767 ,\n\n 59 ",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"24",a:"24",m:[1,1],p:[{name:"time_text",detail:"",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:",",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:",/",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"059",a:"059",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"",a:"",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[] - ,\n\nNDATEDATEVALUETO_DATE",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"",a:"",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:'[-1] - \n:01,,,1 ,"0000011"\n:,1 =/,2 =/,7 =/11 =,12 =,17 =',example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[] - ,\nNDATEDATEVALUETO_DATE",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:" ISO ",a:" ISO ",m:[1,1],p:[{name:"date",detail:"-",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:",",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[-1 ] - ,1=,2=",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:",",a:",",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[-1] -,= 1\n\n1,,1,7\n\n2,,1,7\n\n3,,0,6",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"",a:"",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"",a:"",m:[2,2],p:[{name:"end_date",detail:":",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:":",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"360,",a:"360,",m:[2,3],p:[{name:"start_date",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:":",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"[ - FALSE] - \n\nFALSE -NASD,,,30,,30,,30\n\nTRUE -,3130",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"",a:"",m:[3,3],p:[{name:"year",detail:",\n\n0 1899 , 1900 \n\n 1900  9999 ,\n\n0 10000,#NUM",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:",\n\n month  12, month \n\n month  1,month , 1 ",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:",\n\n day , day \n\n day 1, day , 1 ",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"",a:"",m:[1,1],p:[{name:"date_text",detail:"",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"DATEDATE",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"DATEDATE",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:'"M":"Y""M""D""MD""YM""YD"\n\n"Y":\n\n"M":\n\n"D":\n\n"MD":\n\n"YM":\n\n"YD":',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:",",a:",",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date\n\n\n\n",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"[] - ,\n\nNDATEDATEVALUETO_DATE",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:" ",a:" ",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date\n\n\n\n\n\n",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:'[ - 1] - \n:01,,,1,"0000011"\n:,1 =/,2 =/,7 =/11 =,12 =,17 =',example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[] - ,\nNDATEDATEVALUETO_DATE",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Year 1900 - 9999 ",a:"Year 1900 - 9999 ",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:" start_date  end_date ",a:" start_date  end_date ",m:[2,3],p:[{name:"start_date",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:":",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"",a:"",m:[0,0],p:[]},{n:"MONTH",t:6,d:"112",a:"112",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"",a:"",m:[2,2],p:[{name:"nominal_rate",detail:"",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"",a:"",m:[1,2],p:[{name:"number",detail:"",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[ - 2] - \n\n,",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"",a:"",m:[2,2],p:[{name:"fractional_dollar",detail:",",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"",a:"",m:[2,2],p:[{name:"decimal_dollar",detail:"",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:",",a:",",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[ - 12] - ",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:",",a:",",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[ - 2] - ",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"",a:"",m:[3,6],p:[{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[ - 0.1] - ",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:",",a:",",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"\n\n",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"\n\n0\n\n1",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"",a:"",m:[4,4],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[] - ,",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"",a:"",m:[6,8],p:[{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4""30/360""-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[ - TRUE] - ,\n\nTRUE,\n\nFALSE,",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"",a:"",m:[4,5],p:[{name:"issue",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] -\n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"  - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4 ",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[ - 0 ] - ,",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0 ] - \n\n0\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"",a:"",m:[2,2],p:[{name:"principal",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:"\n\n,,UNARY_PERCENT,0.09UNARY_PERCENT9,9",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"",a:"",m:[6,7],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/" - ,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/" - ,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:",",a:",",m:[2,2],p:[{name:"effect_rate",detail:"",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"",a:"",m:[2,3],p:[{name:"values",detail:"\n\n",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"",a:"",m:[3,3],p:[{name:"values",detail:"\n\n",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:" ",a:" ",m:[1,2],p:[{name:"values",detail:"\n\n",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"",a:"",m:[2,255],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[] - ",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:",",a:",",m:[3,3],p:[{name:"rate",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:"dates",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:",",a:",",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"\n\n",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"\n\n0\n\n1",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",,",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:",",a:",",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:",1nper",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:", 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360"-,30360,\n\n1"/" - ,\n\n2"/360" - , 360\n\n3"/365"-,365\n\n4"30 / 360"-0,30360,',example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"100",a:"100",m:[6,7],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"100",a:"100",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"100",a:"100",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"100",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[ - 0] - \n\n0\n\n1",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"",a:"",m:[3,3],p:[{name:"cost",detail:"",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"100",a:"100",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"100Macauley",a:"100Macauley",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"\n\n,frequency = 1\n\n,frequency = 2\n\n,frequency = 4",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:'[ - 0] - \n\n0"NASD30/360" - ,30360,\n\n1"/"-,\n\n2"/360" - , 360\n\n3"/365" - ,365\n\n4"30 / 360"-0,30360,',example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'10\n\n,\n\n,0111111111,1000000000\n\n,,BIN2DEC100BIN2DEC"100",4',example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'10\n\n,\n\n,0111111111,1000000000\n\n,,BIN2HEX11111BIN2HEX"11111",1F',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[  ] -\n\n,0,,BIN2HEX"11111",80000001F\n\n1,1000000000',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'10\n\n,\n\n,0111111111,1000000000\n\n,,BIN2OCT11111BIN2OCT"11111",37',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[  ] - \n\n,0,,BIN2OCT"11111"00000037\n\n1,1000000000',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n,511,-512\n\n,,DEC2BIN199DEC2BIN"199",11000111',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] - \n\n,0,\n\n,",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n549755813887,-549755814888\n\n,,DEC2HEX100DEC2HEX"100",64',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] - \n\n,0,\n\n,",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'\n\n536870911,-53687092\n\n,,DEC2OCT199DEC2OCT"199",307',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[  ] -\n\n,0,\n\n, ",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'40\n\n,\n\n1FF,FFFFFFFE00\n\n,,HEX2BIN199HEX2BIN"199",110011001',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n,0,\n\n1,8000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'40\n\n,\n\n7fffffffff,8000000000\n\n,,HEX2DEC199HEX2DEC"199",409 ',example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'40\n\n,\n\n1FFFFFFF,FFE0000000\n\n,,HEX2OCT199HEX2OCT"199",631',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n,0,\n\n1,8000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'30\n\n,\n\n777,7777777000\n\n,,OCT2BIN177OCT2BIN"177",1111111',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n,0,\n\n1,4000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:'30\n\nba,\n\n3777777777,4000000000\n\n,,OCT2DEC177OCT2DEC"177",127',example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:'30\n\nba,\n\n3777777777,4000000000\n\n,,OCT2HEX177OCT2HEX"177",7F',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[  ] - \n\n,0,\n\n1,4000000000",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,3],p:[{name:"real_num",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[ - "i"] - ',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:" number1=number2,10",a:" number1=number2,10",m:[1,2],p:[{name:"number1",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[ - 0] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] -1",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:" inumber2",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:" inumber1 ",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] -",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:"",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:'-"NOTTRUE"FALSE"NOTFALSE"TRUE',a:'-"NOTTRUE"FALSE"NOTFALSE"TRUE',m:[1,1],p:[{name:"logical",detail:"TRUEFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:" TRUE",a:" TRUE",m:[0,0],p:[]},{n:"FALSE",t:10,d:" FALSE",a:" FALSE",m:[0,0],p:[]},{n:"AND",t:10,d:"TRUE,TRUEFALSE,FALSE",a:"TRUE,TRUEFALSE,FALSE",m:[1,255],p:[{name:"logical1",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[] - ,TRUEFALSE,255",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:",,",a:"",m:[2,2],p:[{name:"value",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:":#N/A#VALUE#REF#DIV/0#NUM#NAME#NULL",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"TRUE,FALSE",a:"TRUE,FALSE",m:[2,3],p:[{name:"logical_test",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"TRUE",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[ - ] - FALSE",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"TRUE,TRUEFALSE,FALSE",a:"TRUE,TRUEFALSE,FALSE",m:[1,255],p:[{name:"logical1",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ,TRUEFALSE",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:',"TRUE""FALSE""<>"',a:',"TRUE""FALSE""<>"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:',"TRUE""FALSE""="',a:',"TRUE""FALSE""="',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"value1",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"TRUEFALSE">"",a:"TRUEFALSE">"",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:'TRUEFALSE">="',a:'TRUEFALSE">="',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:'TRUEFALSE"<"',a:'TRUEFALSE"<"',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:'TRUEFALSE"<="',a:'TRUEFALSE"<="',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:'"+"',a:'"+"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:'"-"',a:'"-"',m:[2,2],p:[{name:"value1",detail:",",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:",value1",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:'"*"',a:'"*"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"`/`",a:"`/`",m:[2,2],p:[{name:"value1",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"\n\n0",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"`&`",a:"`&`",m:[2,2],p:[{name:"value1",detail:"value2 ",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:',"UNARY_PERCENT100"1',a:',"UNARY_PERCENT100"1',m:[1,1],p:[{name:"number",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"",a:"",m:[1,255],p:[{name:"text1",detail:"",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"[] - ",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Unicode",a:"Unicode",m:[1,1],p:[{name:"text",detail:"Unicode",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Unicode,",a:"Unicode,",m:[1,1],p:[{name:"number",detail:"1255",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"",a:"",m:[1,1],p:[{name:"number",detail:",13999",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"text",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,T\n\n,T\n\n,T\n\n,T",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"",a:"",m:[1,3],p:[{name:"number",detail:"",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[-2] - \n\n,,",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[-FALSE] - ,TRUE,FIXED",example:"FALSE",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1] - ",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"",a:"",m:[2,255],p:[{name:"separator",detail:"\n\n,JOIN,{1,2,3}",example:'"and-a"',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[-1] - LEFT",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[-1] - RIGHT",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"MID\n\n,MID",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"DBCS",a:"DBCS",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text1",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"",a:"",m:[4,4],p:[{name:"old_text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:"\n\n100100,REPT100",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1 ] - ",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"new_textold_text",a:"new_textold_text",m:[3,4],p:[{name:"text",detail:",",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:"old_text",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[] - new_textold_textinstance_num,old_text,old_textnew_text",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"ASCII",a:"ASCII",m:[1,1],p:[{name:"text",detail:"",example:'"AF"&amp;CHAR31',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:',\n\n0,TEXT12.3,000.00"012.30,,TEXT12.305,00.00"12.31\n\n#0,,TEXT12.3,###.##"12.3',example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:",,",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"",a:"",m:[3,3],p:[{name:"number",detail:"from_unit",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:"y = mx + b y\n\nknown_y,known_x,\n\nknown_y,known_x,known_y,known_x,known_y",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[-{1,2,3,},known_y] -y = mx + b x\n\nknown_y,known_x,known_y,known_x,known_y",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ - known_x] - TRENDyx",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE] - ,b0\n\nTRUEb\n\nFALSEb0,m y = mx",example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:",",a:",",m:[2,2],p:[{name:"data_array",detail:"",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:"data_array\n\n,,,FREQUENCY",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:"y = b*m^x y\n\n_y,_x,\n\n_y,_x,_y,_x,_y",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,},known_y] - y = b*m^x x\n\n_y,_x,_y,_x,_y",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ - known_x] - GROWTHyx",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE] - ,b1\n\nTRUEb\n\nFALSEb1,my = m^x",example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:",,",a:",,",m:[1,4],p:[{name:"known_y",detail:"y = mx + b y\n\nknown_y,known_x,\n\nknown_y,known_x,known_y,known_x,known_y",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,},known_y] - y = mx + bx\n\nknown_y,known_x,known_y,known_x,known_y",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE] - ,b0\n\nTRUEb\n\nFALSEb0,my = mx",example:"TRUE",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[ - FALSE] - ,\n\nTRUE,y,LINEST:\n\n\n\n01,1\n\n\n\nFF,\n\n,F\n\n,\n\n",example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:",,",a:",,",m:[1,4],p:[{name:"known_y",detail:"y = mx + b y\n\nknown_y,known_x,\n\nknown_y,known_x,known_y,known_x,known_y",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[ - {1,2,3,},known_y] - y = mx + bx\n\nknown_y,known_x,known_y,known_x,known_y",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[ - TRUE] - ,b0\n\nTRUEb\n\nFALSEb0,my = mx",example:"TRUE",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[ - FALSE] - ,\n\nTRUE,b,LOGEST:\n\n\n\n01,1\n\n\n\nFF,\n\n-F\n\n,\n\n",example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"array1,array2",a:"array1,array2",m:[2,2],p:[{name:"array1",detail:"\n\narray1array2",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"\n\narray2array1",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:",,",a:",,",m:[1,255],p:[{name:"array1",detail:"",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[] - ",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"",a:"",m:[1,1],p:[{name:"cell",detail:"\n\n cell , ISFORMULA TRUE cell ,,TRUE,FALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"",a:"",m:[2,2],p:[{name:"info_type",detail:",",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:"#N/A",a:"#N/A",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"error_val",detail:",",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,TRUEFALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"#N/A",a:"#N/A",m:[1,1],p:[{name:"value",detail:"#N/A\n\n#N/A#DIV/0#NAME#NULL#NUM#VALUE#REF,ISERRTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n#DIV/0#N/A#NAME#NULL#NUM#VALUE#REF,ISERRORTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"TRUEFALSE",a:"TRUEFALSE",m:[1,1],p:[{name:"value",detail:" TRUE  FALSE \n\n*TRUEFALSE,TRUEFALSE,ISLOGICALTRUE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"#N/A",a:"#N/A",m:[1,1],p:[{name:"value",detail:"#N/A\n\n*#N/A#N/A,ISNATRUE,FALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*,ISNONTEXTFALSE,TRUE\n\n,ISNONTEXTTRUE\n\n,ISNONTEXTFALSE,",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*,ISNUMBERTRUE,FALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n*,ISREFTRUE,FALSE",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,ISTEXTTRUE,FALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n1\n\n2\n\n4\n\n16\n\n64",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,\n\n,\n\nTRUE,1\n\nFALSE,0\n\n,\n\n,0",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,TO_DATE,30,\n\n30,\n,TO_DATE",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"/",a:"/",m:[1,1],p:[{name:"value",detail:"\n\n,TO_PURE_NUMBER\n\n,TO_PERCENT",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,TO_TEXT,,,,\n\n,TO_TEXT",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,TO_DOLLARS",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:"\n\n,TO_PERCENT1 = 100%,\n\n,TO_PERCENT",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"database\n\nfielddatabase,,1",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:"A1",detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:'"2017-10-01"',detail:",",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:",0:[1900/01/01],1:[1900-01-01],2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"",a:"",m:[1,2],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"tf-idf",a:"tf-idf",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"TextRank",a:"TextRank",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:",",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"",a:"",m:[1,1],p:[{name:"",example:'"1990-01-01"',detail:",1990/01/01, 199011",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"sparklines",a:"",m:[1,8],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#CCF3F4",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:":0000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#999",detail:"0#999",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20-5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"0false1.5",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"10",detail:"false",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"sparklines",a:"",m:[2,3],p:[{name:"",example:"10",detail:"A1100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"8",detail:"A1100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"12",detail:"A11009",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"sparklines",a:"sparklines",m:[1,1],p:[{name:"",example:"PIESPLINES(A1:A20)",detail:"sparklinesA1:A20",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"",a:"",m:[1,4],p:[{name:"array",detail:"",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[] - row1/col1",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[] - 1-1",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - FALSETRUE",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"/",a:"/",m:[2,3],p:[{name:"array",detail:"",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[] - filter",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"",a:"",m:[1,3],p:[{name:"array",detail:"",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - = FALSE= TRUE",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[] - = TRUE= FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"01",a:"01",m:[0,2],p:[{name:"rows",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"",a:"",m:[1,4],p:[{name:"rows",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[] -",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"",a:"",m:[1,1],p:[{name:"",example:'"A1+5*2^2"',detail:"",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"","font-size":"",bold:"Ctrl+B",italic:"Ctrl+I",strikethrough:"Alt+Shift+5",underline:"","font-color":"",chooseColor:"",resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",background:"",border:"",borderStyle:"","merge-cell":"",chooseMergeType:"",horizontalAlign:"",verticalAlign:"",alignment:"",textWrap:"",textWrapMode:"",textRotate:"",textRotateMode:"",freeze:"",sort:"",filter:"",findAndReplace:"","formula-sum":"",autoSum:"",moreFunction:"",conditionalFormat:"",comment:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataVerification:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:""},alternatingColors:{applyRange:"",selectRange:"",header:"",footer:"",errorInfo:",,",textTitle:"",custom:"",close:"",selectionTextColor:"",selectionCellColor:"",removeColor:"",colorShow:"",currentColor:"",tipSelectRange:"",errorNoRange:"",errorExistColors:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:"",prevPage:"",nextPage:"",total:""},paint:{start:"",end:"ESC",tipSelectRange:"",tipNotMulti:""},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total},${totalPage},${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total},${totalPage},"},currencyDetail:{RMB:"",USdollar:"",EUR:"",GBP:"",HK:"",JPY:"",AlbanianLek:"",AlgerianDinar:"",Afghani:"",ArgentinePeso:"",UnitedArabEmiratesDirham:"",ArubanFlorin:"",OmaniRial:"",Azerbaijanimanat:"",EgyptianPound:"",EthiopianBirr:"",AngolaKwanza:"",AustralianDollar:"",Patacas:"",BarbadosDollar:"",PapuaNewGuineaKina:"",BahamianDollar:"",PakistanRupee:"",ParaguayanGuarani:"",BahrainiDinar:"",PanamanianBalboa:"",Brazilianreal:"",Belarusianruble:"",BermudianDollar:"",BulgarianLev:"",IcelandKrona:"",BosniaHerzegovinaConvertibleMark:"",PolishZloty:"",Boliviano:"",BelizeDollar:"",BotswanaPula:"",NotDannuzhamu:"",BurundiFranc:"",NorthKoreanWon:"",DanishKrone:"",EastCaribbeanDollar:"",DominicaPeso:"",RussianRuble:"",EritreanNakfa:"",CFAfranc:"",PhilippinePeso:"",FijiDollar:"",CapeVerdeEscudo:"",FalklandIslandsPound:"",GambianDalasi:"",Congolesefranc:"",ColombianPeso:"",CostaRicanColon:"",CubanPeso:"",Cubanconvertiblepeso:"",GuyanaDollar:"",KazakhstanTenge:"",Haitiangourde:"",won:"",NetherlandsAntillesGuilder:"",Honduraslempiras:"",DjiboutiFranc:"",KyrgyzstanSom:"",GuineaFranc:"",CanadianDollar:"",GhanaianCedi:"",Cambodianriel:"",CzechKoruna:"",ZimbabweDollar:"",QatariRiyal:"",CaymanIslandsDollar:"",Comorianfranc:"",KuwaitiDinar:"",CroatianKuna:"",KenyanShilling:"",LesothoLoti:"",LaoKip:"",LebanesePound:"",Lithuanianlitas:"",LibyanDinar:"",LiberianDollar:"",RwandaFranc:"",RomanianLeu:"",MalagasyAriary:"",MaldivianRufiyaa:"",MalawiKwacha:"",MalaysianRinggit:"",MacedoniawearingDinar:"",MauritiusRupee:"",MauritanianOuguiya:"",MongolianTugrik:"",BangladeshiTaka:"",PeruvianNuevoSol:"",MyanmarKyat:"",MoldovanLeu:"",MoroccanDirham:"",MozambiqueMetical:"",MexicanPeso:"",NamibianDollar:"",SouthAfricanRand:"",SouthSudanesePound:"",NicaraguaCordoba:"",NepaleseRupee:"",NigerianNaira:"",NorwegianKrone:"",GeorgianLari:"",RMBOffshore:"",SwedishKrona:"",SwissFranc:"",SerbianDinar:"",SierraLeone:"",SeychellesRupee:"",SaudiRiyal:"",SaoTomeDobra:"",SaintHelenapound:"",SriLankaRupee:"",SwazilandLilangeni:"",SudanesePound:"",Surinamesedollar:"",SolomonIslandsDollar:"",SomaliShilling:"",TajikistanSomoni:"",PacificFranc:"",ThaiBaht:"",TanzanianShilling:"",TonganPaanga:"",TrinidadandTobagoDollar:"",TunisianDinar:"",TurkishLira:"",VanuatuVatu:"",GuatemalanQuetzal:"",CommissionBolivar:"",BruneiDollar:"",UgandanShilling:"",UkrainianHryvnia:"",UruguayanPeso:"",Uzbekistansom:"",WesternSamoaTala:"",SingaporeDollar:"",NT:"",NewZealandDollar:"",HungarianForint:"",SyrianPound:"",JamaicanDollar:"",ArmenianDram:"",YemeniRial:"",IraqiDinar:"",IranianRial:"",NewIsraeliShekel:"",IndianRupee:"",IndonesianRupiah:"",JordanianDinar:"",VND:"",ZambianKwacha:"",GibraltarPound:"",ChileanPeso:"",CFAFrancBEAC:""},defaultFmt:[{text:"",value:"General",example:""},{text:"",value:"@",example:""},{text:"",value:"split",example:""},{text:"",value:"##0.00",example:"1000.12"},{text:"",value:"#0.00%",example:"12.21%"},{text:"",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"",value:"(0.00)",example:"(1200.09)"},{text:"",value:"w",example:"120002500"},{text:"",value:"0.00",example:"1200.09"},{text:"2",value:"w0.00",example:"22500.55"},{text:"",value:"split",example:""},{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"24H",value:"hh:mm",example:"15:00"},{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"193085",value:'yyyy""M""d""'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"85",value:'M""d""'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"01:30",value:"/ hh:mm"},{name:"1:30",value:"/ h:mm"},{name:"1:30:30",value:"/ h:mm:ss"},{name:"08-05 01:30",value:"MM-dd / hh:mm"}],fontFamily:{MicrosoftYaHei:"Microsoft YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3,:4,"microsoft yahei":4,:5,simsun:5,:6,simhei:6,:7,kaiti:7,:8,fangsong:8,:9,nsimsun:9,:10,stxinwei:10,:11,stxingkai:11,:12,stliti:12},border:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{mergeAll:"",mergeV:"",mergeH:"",mergeCancel:"",overlappingError:"",partiallyError:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},textWrap:{overflow:"",wrap:"",clip:""},rotation:{none:"",angleup:"",angledown:"",vertical:"",rotationUp:"90",rotationDown:"90"},freezen:{default:"",freezenRow:"",freezenColumn:"A",freezenRC:"",freezenRowRange:"",freezenColumnRange:"",freezenRCRange:"",freezenCancel:"",noSeletionError:"",rangeRCOverErrorTitle:"",rangeRCOverError:""},sort:{asc:"",desc:"",custom:"",hasTitle:"",sortBy:"",addOthers:"",close:"",confirm:"",columnOperation:"",secondaryTitle:"",sortTitle:"",sortRangeTitle:"",sortRangeTitleTo:"",noRangeError:",,",mergeError:","},filter:{filter:"",clearFilter:"",sortByAsc:"A-Z",sortByDesc:"Z-A",filterByColor:"",filterByCondition:"",filterByValues:"",filiterInputNone:"",filiterInputTip:"",filiterRangeStartTip:"",filiterRangeEndTip:"",filterValueByAllBtn:"",filterValueByClearBtn:"",filterValueByInverseBtn:"",filterValueByTip:"",filterConform:" ",filterCancel:" ",conditionNone:"",conditionCellIsNull:"",conditionCellNotNull:"",conditionCellTextContain:"",conditionCellTextNotContain:"",conditionCellTextStart:"",conditionCellTextEnd:"",conditionCellTextEqual:"",conditionCellDateEqual:"",conditionCellDateBefore:"",conditionCellDateAfter:"",conditionCellGreater:"",conditionCellGreaterEqual:"",conditionCellLess:"",conditionCellLessEqual:"",conditionCellEqual:"",conditionCellNotEqual:"",conditionCellBetween:"",conditionCellNotBetween:"",filiterMoreDataTip:"",filiterMonthText:"",filiterYearText:"",filiterByColorTip:"",filiterByTextColorTip:"",filterContainerOneColorTip:"",filterDateFormatTip:"",valueBlank:"()",mergeError:","},rightclick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},comment:{insert:"",edit:"",delete:"",showOne:"/",showAll:"/"},screenshot:{screenshotTipNoSelection:"",screenshotTipTitle:"",screenshotTipHasMerge:"",screenshotTipHasMulti:"",screenshotTipSuccess:"",screenshotImageName:"",downLoadClose:"",downLoadCopy:"",downLoadBtn:"",browserNotTip:"IE",rightclickTip:"''",successTip:",''"},splitText:{splitDelimiters:"",splitOther:"",splitContinueSymbol:"",splitDataPreview:"",splitTextTitle:"",splitConfirmToExe:",",tipNoMulti:",,",tipNoMultiColumn:",,,"},imageText:{imageSetting:"",close:"",conventional:"",moveCell1:"",moveCell2:"",moveCell3:"",fixedPos:"",border:"",width:"",radius:"",style:"",solid:"",dashed:"",dotted:"",double:"",color:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},findAndReplace:{find:"",replace:"",goto:"",location:"",formula:"",date:"",number:"",string:"",error:"",condition:"",rowSpan:"",columnSpan:"",locationExample:"",lessTwoRowTip:"",lessTwoColumnTip:"",findTextbox:"",replaceTextbox:"",regexTextbox:"",wholeTextbox:"",distinguishTextbox:"",allReplaceBtn:"",replaceBtn:"",allFindBtn:"",findBtn:"",noFindTip:"",modeTip:"",searchTargetSheet:"",searchTargetCell:"",searchTargetValue:"",searchInputTip:"",noReplceTip:"",noMatchTip:"",successTip:"${xlength}",locationConstant:"",locationFormula:"",locationDate:"",locationDigital:"",locationString:"",locationBool:"",locationError:"",locationNull:"",locationCondition:"",locationRowSpan:"",locationColumnSpan:"",locationTiplessTwoRow:"",locationTiplessTwoColumn:"",locationTipNotFindCell:""},sheetconfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:",",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:",sheet",chartEditNoOpt:"",sheetNameSpecCharError:":[ ] :  ? * / ' \"",sheetNamecannotIsEmptyError:""},conditionformat:{conditionformat_greaterThan:"",conditionformat_greaterThan_title:"",conditionformat_lessThan:"",conditionformat_lessThan_title:"",conditionformat_betweenness:"",conditionformat_betweenness_title:"",conditionformat_equal:"",conditionformat_equal_title:"",conditionformat_textContains:"",conditionformat_textContains_title:"",conditionformat_occurrenceDate:"",conditionformat_occurrenceDate_title:"",conditionformat_duplicateValue:"",conditionformat_duplicateValue_title:"",conditionformat_top10:"10",conditionformat_top10_percent:"10%",conditionformat_top10_title:"",conditionformat_last10:"10",conditionformat_last10_percent:"10%",conditionformat_last10_title:"",conditionformat_AboveAverage:"",conditionformat_AboveAverage_title:"",conditionformat_SubAverage:"",conditionformat_SubAverage_title:"",rule:"",newRule:"",editRule:"",deleteRule:"",deleteCellRule:"",deleteSheetRule:"",manageRules:"",showRules:"",highlightCellRules:"",itemSelectionRules:"",conditionformatManageRules:"",format:"",setFormat:"",setAs:"",setAsByArea:",",applyRange:"",selectRange:"",selectRange_percent:"",selectRange_average:"",selectRange_value:"",pleaseSelectRange:"",selectDataRange:"",selectCell:"",pleaseSelectCell:"",pleaseSelectADate:"",pleaseEnterInteger:"11000",onlySingleCell:"",conditionValueCanOnly:"",ruleTypeItem1:"",ruleTypeItem2:"",ruleTypeItem2_title:"",ruleTypeItem3:"",ruleTypeItem3_title:"",ruleTypeItem4:"",ruleTypeItem4_title:"",ruleTypeItem5:"",ruleTypeItem6:"",formula:"",textColor:"",cellColor:"",confirm:"",confirmColor:"",cancel:"",close:"",clearColorSelect:"",sheet:"",currentSheet:"",dataBar:"",dataBarColor:"",gradientDataBar_1:"-",gradientDataBar_2:"-",gradientDataBar_3:"-",gradientDataBar_4:"-",gradientDataBar_5:"-",gradientDataBar_6:"-",solidColorDataBar_1:"",solidColorDataBar_2:"",solidColorDataBar_3:"",solidColorDataBar_4:"",solidColorDataBar_5:"",solidColorDataBar_6:"",colorGradation:"",colorGradation_1:"--",colorGradation_2:"--",colorGradation_3:"--",colorGradation_4:"--",colorGradation_5:"--",colorGradation_6:"--",colorGradation_7:"-",colorGradation_8:"-",colorGradation_9:"-",colorGradation_10:"-",colorGradation_11:"-",colorGradation_12:"-",icons:"",pleaseSelectIcon:":",cellValue:"",specificText:"",occurrence:"",greaterThan:"",lessThan:"",between:"",equal:"",in:"",to:"",between2:"",contain:"",textContains:"",duplicateValue:"",uniqueValue:"",top:"",top10:"10",top10_percent:"10%",last:"",last10:"10",last10_percent:"10%",oneself:"",above:"",aboveAverage:"",below:"",belowAverage:"",all:"",yesterday:"",today:"",tomorrow:"",lastWeek:"",thisWeek:"",lastMonth:"",thisMonth:"",lastYear:"",thisYear:"",last7days:"7",last30days:"30",next7days:"7",next30days:"30",next60days:"60",chooseRuleType:"",editRuleDescription:"",newFormatRule:"",editFormatRule:"",formatStyle:"",fillType:"",color:"",twocolor:"",tricolor:"",multicolor:"",grayColor:"",gradient:"",solid:"",maxValue:"",medianValue:"",minValue:"",direction:"",threeWayArrow:"",fourWayArrow:"",fiveWayArrow:"",threeTriangles:"3",shape:"",threeColorTrafficLight:"",fourColorTrafficLight:"",threeSigns:"",greenRedBlackGradient:"--",rimless:"",bordered:"",mark:"",threeSymbols:"",tricolorFlag:"",circled:"",noCircle:"",grade:"",grade4:"",grade5:"",threeStars:"3",fiveQuadrantDiagram:"",fiveBoxes:"5"},insertLink:{linkText:"",linkType:"",external:"",internal:"",linkAddress:"",linkSheet:"",linkCell:"",linkTooltip:"",placeholder1:"",placeholder2:",A1",placeholder3:"",tooltipInfo1:"",tooltipInfo2:""},dataVerification:{cellRange:"",selectCellRange:"",selectCellRange2:"",verificationCondition:"",allowMultiSelect:"",dropdown:"",checkbox:"",number:"",number_integer:"-",number_decimal:"-",text_content:"-",text_length:"-",date:"",validity:"",placeholder1:",,1,2,3,4,5",placeholder2:"",placeholder3:",10",placeholder4:"",placeholder5:"",selected:"",notSelected:"",between:"",notBetween:"",equal:"",notEqualTo:"",moreThanThe:"",lessThan:"",greaterOrEqualTo:"",lessThanOrEqualTo:"",include:"",exclude:"",earlierThan:"",noEarlierThan:"",laterThan:"",noLaterThan:"",identificationNumber:"",phoneNumber:"",remote:"",prohibitInput:"",hintShow:"",deleteVerification:"",tooltipInfo1:"",tooltipInfo2:"",tooltipInfo3:"",tooltipInfo4:"21",tooltipInfo5:"",tooltipInfo6:"",tooltipInfo7:"21",textlengthInteger:"0"},formula:{sum:"",average:"",count:"",max:"",min:"",ifGenerate:"if",find:"",tipNotBelongToIf:"if!",tipSelectCell:"",ifGenCompareValueTitle:"",ifGenSelectCellTitle:"",ifGenRangeTitle:"",ifGenRangeTo:"",ifGenRangeEvaluate:"",ifGenSelectRangeTitle:"",ifGenCutWay:"",ifGenCutSame:"",ifGenCutNpiece:"N",ifGenCutCustom:"",ifGenCutConfirm:"",ifGenTipSelectCell:"",ifGenTipSelectCellPlace:"",ifGenTipSelectRange:"",ifGenTipSelectRangePlace:"",ifGenTipNotNullValue:"!",ifGenTipLableTitile:"",ifGenTipRangeNotforNull:"!",ifGenTipCutValueNotforNull:"",ifGenTipNotGenCondition:""},formulaMore:{valueTitle:"",tipSelectDataRange:"",tipDataRangeTile:"",findFunctionTitle:"",tipInputFunctionName:"",Array:"",Database:"",Date:"",Engineering:"",Filter:"",Financial:"",luckysheet:"Luckysheet",other:"",Logical:"",Lookup:"",Math:"",Operator:"",Parser:"",Statistical:"",Text:"",dataMining:"",selectFunctionTitle:"",calculationResult:"",tipSuccessText:"",tipParamErrorText:"",helpClose:"",helpCollapse:"",helpExample:"",helpAbstract:"",execfunctionError:'", "',execfunctionSelfError:"",execfunctionSelfErrorResult:",",allowRepeatText:"",allowOptionText:"",selectCategory:""},drag:{noMerge:"",affectPivot:",",noMulti:",",noPaste:",,",noPartMerge:"",inputCorrect:"",notLessOne:"1",offsetColumnLessZero:"",pasteMustKeybordAlert:"Copy and paste in the Sheet: Ctrl + C to copy, Ctrl + V to paste, Ctrl + X to cut",pasteMustKeybordAlertHTMLTitle:"Copy and paste in the Sheet",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;to copy<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;to paste<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;to cut"},pivotTable:{title:"",closePannel:"",editRange:"",tipPivotFieldSelected:"",tipClearSelectedField:"",btnClearSelectedField:"",btnFilter:"",titleRow:"",titleColumn:"",titleValue:"",tipShowColumn:"",tipShowRow:"",titleSelectionDataRange:"",titleDataRange:"",valueSum:"",valueStatisticsSUM:"",valueStatisticsCOUNT:"",valueStatisticsCOUNTA:"",valueStatisticsCOUNTUNIQUE:"",valueStatisticsAVERAGE:"",valueStatisticsMAX:"",valueStatisticsMIN:"",valueStatisticsMEDIAN:"",valueStatisticsPRODUCT:"",valueStatisticsSTDEV:"",valueStatisticsSTDEVP:"",valueStatisticslet:"",valueStatisticsVARP:"",errorNotAllowEdit:"!",errorNotAllowMulti:",,",errorSelectRange:"",errorIsDamage:"",errorNotAllowPivotData:"!",errorSelectionRange:",",errorIncreaseRange:"!",titleAddColumn:"",titleMoveColumn:"",titleClearColumnFilter:"",titleFilterColumn:"",titleSort:"",titleNoSort:"",titleSortAsc:"",titleSortDesc:"",titleSortBy:"",titleShowSum:"",titleStasticTrue:"",titleStasticFalse:""},dropCell:{copyCell:"",sequence:"",onlyFormat:"",noFormat:"",day:"",workDay:"",month:"",year:"",chineseNumber:""},imageCtrl:{borderTile:"",borderCur:""},protection:{protectiontTitle:"",enterPassword:"",enterHint:",",swichProtectionTip:"",authorityTitle:":",selectLockedCells:"",selectunLockedCells:"",formatCells:"",formatColumns:"",formatRows:"",insertColumns:"",insertRows:"",insertHyperlinks:"",deleteColumns:"",deleteRows:"",sort:"",filter:"",usePivotTablereports:"",editObjects:"",editScenarios:"",allowRangeTitle:"",allowRangeAdd:"...",allowRangeAddTitle:"",allowRangeAddSqrf:"",selectCellRange:"",selectCellRangeHolder:"",allowRangeAddTitlePassword:"",allowRangeAddTitleHint:"",allowRangeAddTitleHintTitle:",",allowRangeAddtitleDefault:"",rangeItemDblclick:"",rangeItemHasPassword:"",rangeItemErrorTitleNull:"",rangeItemErrorRangeNull:"",rangeItemErrorRange:"",validationTitle:"",validationTips:"",validationInputHint:"",checkPasswordNullalert:"!",checkPasswordWrongalert:",",checkPasswordSucceedalert:",!",defaultRangeHintText:"",defaultSheetHintText:",,,"},cellFormat:{cellFormatTitle:"",protection:"",locked:"",hidden:"",protectionTips:",",tipsPart:"",tipsAll:"",selectionIsNullAlert:"",sheetDataIsNullAlert:""},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},edit:{typing:""},websocket:{success:"WebSocket",refresh:"WebSocket,",wait:"WebSocket,",close:"WebSocket",contact:",,",support:"WebSocket"}};var localeObj={en:en,zh:zh,es:es,"zh-TW":zh_tw};function locale(ctx){var _ctx$lang;var langsToTry=[ctx.lang||"",((_ctx$lang=ctx.lang)===null||_ctx$lang===void 0?void 0:_ctx$lang.split("-")[0])||""];for(var i=0;i<langsToTry.length;i+=1){if(langsToTry[i]in localeObj){return localeObj[langsToTry[i]];}}return localeObj.en;}function filterPatch(patches){return lodash.filter(patches,function(p){return p.path[0]==="luckysheetfile"&&p.path[2]!=="luckysheet_select_save";});}function extractFormulaCellOps(ops){var formulaOps=[];ops.forEach(function(op){var _op$value;if(op.op==="remove")return;if(op.path.length===2&&Array.isArray(op.value)){for(var i=0;i<op.value.length;i+=1){var _op$value$i;if((_op$value$i=op.value[i])===null||_op$value$i===void 0?void 0:_op$value$i.f){formulaOps.push({op:"replace",id:op.id,path:[].concat(_toConsumableArray$2(op.path),[i]),value:op.value[i]});}}}else if(op.path.length===3&&((_op$value=op.value)===null||_op$value===void 0?void 0:_op$value.f)){formulaOps.push(op);}});return formulaOps;}function patchToOp(ctx,patches,options){var ops=patches.map(function(p){var op={op:p.op,value:p.value,path:p.path};if(p.path[0]==="luckysheetfile"&&lodash.isNumber(p.path[1])){var id=ctx.luckysheetfile[p.path[1]].id;op.id=id;op.path=p.path.slice(2);}return op;});if(options===null||options===void 0?void 0:options.insertRowColOp){var _$partition=lodash.partition(ops,function(p){return p.path[0]!=="data";}),_$partition2=_slicedToArray$3(_$partition,2),nonDataOps=_$partition2[0],dataOps=_$partition2[1];var formulaOps=extractFormulaCellOps(dataOps);ops=nonDataOps;ops.push({op:"insertRowCol",id:options.insertRowColOp.id,path:[],value:options.insertRowColOp});ops=[].concat(_toConsumableArray$2(ops),_toConsumableArray$2(formulaOps));if(options===null||options===void 0?void 0:options.restoreDeletedCells){var restoreCellsOps=[];var flowdata=getFlowdata(ctx);if(flowdata){var rowlen=flowdata.length;var collen=flowdata[0].length;for(var i=0;i<rowlen;i+=1){for(var j=0;j<collen;j+=1){var cell=flowdata[i][j];if(!cell)continue;if(options.insertRowColOp.type==="row"&&i>=options.insertRowColOp.index&&i<options.insertRowColOp.index+options.insertRowColOp.count||options.insertRowColOp.type==="column"&&j>=options.insertRowColOp.index&&j<options.insertRowColOp.index+options.insertRowColOp.count){restoreCellsOps.push({op:"replace",path:["data",i,j],id:ctx.currentSheetId,value:cell});}}}}ops=[].concat(_toConsumableArray$2(ops),restoreCellsOps);}}else if(options===null||options===void 0?void 0:options.deleteRowColOp){var _$partition3=lodash.partition(ops,function(p){return p.path[0]!=="data";}),_$partition4=_slicedToArray$3(_$partition3,2),_nonDataOps=_$partition4[0],_dataOps=_$partition4[1];var _formulaOps=extractFormulaCellOps(_dataOps);ops=_nonDataOps;ops.push({op:"deleteRowCol",id:options.deleteRowColOp.id,path:[],value:options.deleteRowColOp});ops=[].concat(_toConsumableArray$2(ops),_toConsumableArray$2(_formulaOps));}else if(options===null||options===void 0?void 0:options.addSheetOp){var _addSheetOps$;var _$partition5=lodash.partition(ops,function(op){return op.path.length===0&&op.op==="add";}),_$partition6=_slicedToArray$3(_$partition5,2),addSheetOps=_$partition6[0],otherOps=_$partition6[1];ops=otherOps;ops.push({op:"addSheet",path:[],value:(_addSheetOps$=addSheetOps[0])===null||_addSheetOps$===void 0?void 0:_addSheetOps$.value});}else if(options===null||options===void 0?void 0:options.deleteSheetOp){ops=[{op:"deleteSheet",id:options.deleteSheetOp.id,path:[],value:options.deleteSheetOp}];}return ops;}function opToPatch(ctx,ops){var _$partition7=lodash.partition(ops,function(op){return op.op==="add"||op.op==="remove"||op.op==="replace";}),_$partition8=_slicedToArray$3(_$partition7,2),normalOps=_$partition8[0],specialOps=_$partition8[1];var patches=normalOps.map(function(op){var patch={op:op.op,value:op.value,path:op.path};if(op.id){var i=getSheetIndex(ctx,op.id);if(i!=null){patch.path=["luckysheetfile",i].concat(_toConsumableArray$2(op.path));}else {throw new Error("sheet id: ".concat(op.id," not found"));}}return patch;});return [patches,specialOps];}function inverseRowColOptions(options){if(!options)return options;if(options.insertRowColOp){var index=options.insertRowColOp.index;if(options.insertRowColOp.direction==="rightbottom"){index+=1;}return {deleteRowColOp:{type:options.insertRowColOp.type,id:options.insertRowColOp.id,start:index,end:index+options.insertRowColOp.count-1}};}if(options.deleteRowColOp){return {insertRowColOp:{type:options.deleteRowColOp.type,id:options.deleteRowColOp.id,index:options.deleteRowColOp.start,count:options.deleteRowColOp.end-options.deleteRowColOp.start+1,direction:"lefttop"}};}return options;}function generateRandomSheetName(file,isPivotTable,ctx){var index=file.length;var locale_pivotTable=locale(ctx).pivotTable;var title=locale_pivotTable.title;for(var i=0;i<file.length;i+=1){if(file[i].name.indexOf("Sheet")>-1||file[i].name.indexOf(title)>-1){var suffix=parseFloat(file[i].name.replace("Sheet","").replace(title,""));if(!Number.isNaN(suffix)&&Math.ceil(suffix)>index){index=Math.ceil(suffix);}}}if(isPivotTable){return title+(index+1);}return "Sheet".concat(index+1);}function rgbToHex(color){var rgb;if(color.indexOf("rgba")>-1){rgb=color.replace("rgba(","").replace(")","").split(",");}else {rgb=color.replace("rgb(","").replace(")","").split(",");}var r=Number(rgb[0]);var g=Number(rgb[1]);var b=Number(rgb[2]);return "#".concat(((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1));}function indexToColumnChar(n){var orda="a".charCodeAt(0);var ordz="z".charCodeAt(0);var len=ordz-orda+1;var s="";while(n>=0){s=String.fromCharCode(n%len+orda)+s;n=Math.floor(n/len)-1;}return s.toUpperCase();}function columnCharToIndex(a){if(a==null||a.length===0){return NaN;}var str=a.toLowerCase().split("");var al=str.length;var getCharNumber=function getCharNumber(charx){return charx.charCodeAt(0)-96;};var numout=0;var charnum=0;for(var i=0;i<al;i+=1){charnum=getCharNumber(str[i]);numout+=charnum*Math.pow(26,al-i-1);}if(numout===0){return NaN;}return numout-1;}function escapeScriptTag(str){if(typeof str!=="string")return str;return str.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;");}function getSheetIndex(ctx,id){for(var i=0;i<ctx.luckysheetfile.length;i+=1){var _ctx$luckysheetfile$i;if(((_ctx$luckysheetfile$i=ctx.luckysheetfile[i].id)===null||_ctx$luckysheetfile$i===void 0?void 0:_ctx$luckysheetfile$i.toString())===id.toString()){return i;}}return null;}function getSheetByIndex(ctx,id){if(lodash.isNil(id)){id=ctx.currentSheetId;}var i=getSheetIndex(ctx,id);if(lodash.isNil(i)){return null;}return ctx.luckysheetfile[i];}function getNowDateTime(format){var now=new Date();var year=now.getFullYear();var month=now.getMonth();var date=now.getDate();var hour=now.getHours();var minu=now.getMinutes();var sec=now.getSeconds();month+=1;if(month<10)month="0".concat(month);if(date<10)date="0".concat(date);if(hour<10)hour="0".concat(hour);if(minu<10)minu="0".concat(minu);if(sec<10)sec="0".concat(sec);var time="";if(format===1){time="".concat(year,"-").concat(month,"-").concat(date);}else if(format===2){time="".concat(year,"-").concat(month,"-").concat(date," ").concat(hour,":").concat(minu,":").concat(sec);}return time;}function replaceHtml(temp,dataarry){return temp.replace(/\$\{([\w]+)\}/g,function(s1,s2){var s=dataarry[s2];if(typeof s!=="undefined"){return s;}return s1;});}function moveToEnd(obj){if(document.createRange){if(obj.innerHTML!==obj.innerText||obj.innerHTML===""){obj.focus();var range=window.getSelection();range===null||range===void 0?void 0:range.selectAllChildren(obj);range===null||range===void 0?void 0:range.collapseToEnd();}else {var len=obj.innerText.length;var _range=document.createRange();_range.selectNodeContents(obj);_range.setStart(obj.childNodes[0],len);_range.collapse(true);var selection=window.getSelection();selection===null||selection===void 0?void 0:selection.removeAllRanges();selection===null||selection===void 0?void 0:selection.addRange(_range);}}else if(document.selection){var _range2=document.body.createTextRange();_range2.moveToElementText(obj);_range2.collapse(false);_range2.select();}}function isInPage(node){return node===document.body?false:document.body.contains(node);}function selectTextContent(ele){if(window.getSelection){var range=document.createRange();var content=ele.firstChild;if(content){range.setStart(content,0);range.setEnd(content,content.length);if(range.startContainer&&isInPage(range.startContainer)){var _window$getSelection,_window$getSelection2;(_window$getSelection=window.getSelection())===null||_window$getSelection===void 0?void 0:_window$getSelection.removeAllRanges();(_window$getSelection2=window.getSelection())===null||_window$getSelection2===void 0?void 0:_window$getSelection2.addRange(range);}}}else if(document.selection){var _range3=document.body.createTextRange();_range3.moveToElementText(ele);_range3.select();}}function selectTextContentCross(sEle,eEle){if(window.getSelection){var range=document.createRange();var sContent=sEle.firstChild;var eContent=eEle.firstChild;if(sContent&&eContent){range.setStart(sContent,0);range.setEnd(eContent,eContent.length);if(range.startContainer&&isInPage(range.startContainer)){var _window$getSelection3,_window$getSelection4;(_window$getSelection3=window.getSelection())===null||_window$getSelection3===void 0?void 0:_window$getSelection3.removeAllRanges();(_window$getSelection4=window.getSelection())===null||_window$getSelection4===void 0?void 0:_window$getSelection4.addRange(range);}}}}var attrToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",cl:"text-decoration",un:"border-bottom"};var inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1};var inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1};function isInlineStringCell(cell){var _cell$ct,_cell$ct$s$length,_cell$ct2,_cell$ct2$s;return (cell===null||cell===void 0?void 0:(_cell$ct=cell.ct)===null||_cell$ct===void 0?void 0:_cell$ct.t)==="inlineStr"&&((_cell$ct$s$length=cell===null||cell===void 0?void 0:(_cell$ct2=cell.ct)===null||_cell$ct2===void 0?void 0:(_cell$ct2$s=_cell$ct2.s)===null||_cell$ct2$s===void 0?void 0:_cell$ct2$s.length)!==null&&_cell$ct$s$length!==void 0?_cell$ct$s$length:0)>0;}function isInlineStringCT(ct){var _ct$s$length,_ct$s;return (ct===null||ct===void 0?void 0:ct.t)==="inlineStr"&&((_ct$s$length=ct===null||ct===void 0?void 0:(_ct$s=ct.s)===null||_ct$s===void 0?void 0:_ct$s.length)!==null&&_ct$s$length!==void 0?_ct$s$length:0)>0;}function getInlineStringNoStyle(r,c,data){var ct=getCellValue(r,c,data,"ct");if(isInlineStringCT(ct)){var strings=ct.s;var value="";for(var i=0;i<strings.length;i+=1){var strObj=strings[i];if(strObj.v){value+=strObj.v;}}return value;}return "";}function convertCssToStyleList(cssText){if(lodash.isEmpty(cssText)){return {};}var cssTextArray=cssText.split(";");var styleList={fc:"#000000",fs:10,cl:0,un:0,bl:0,it:0};cssTextArray.forEach(function(s){s=s.toLowerCase();var key=lodash.trim(s.substring(0,s.indexOf(":")));var value=lodash.trim(s.substring(s.indexOf(":")+1));if(key==="font-weight"){if(value==="bold"){styleList.bl=1;}else {styleList.bl=0;}}if(key==="font-style"){if(value==="italic"){styleList.it=1;}else {styleList.it=0;}}if(key==="font-size"){styleList.fs=parseInt(value,10);}if(key==="color"){styleList.fc=value;}if(key==="text-decoration"){styleList.cl=1;}if(key==="border-bottom"){styleList.un=1;}if(key==="lucky-strike"){styleList.cl=Number(value);}if(key==="lucky-underline"){styleList.un=Number(value);}});return styleList;}function convertSpanToShareString($dom){var styles=[];var preStyleList;var preStyleListString=null;for(var i=0;i<$dom.length;i+=1){var span=$dom[i];var styleList=convertCssToStyleList(span.style.cssText);var curStyleListString=JSON.stringify(styleList);var v=span.innerText;v=v.replace(/\n/g,"\r\n");if(curStyleListString===preStyleListString){preStyleList.v+=v;}else {styleList.v=v;styles.push(styleList);preStyleListString=curStyleListString;preStyleList=styleList;}}return styles;}function updateInlineStringFormatOutside(cell,key,value){if(lodash.isNil(cell.ct)){return;}var s=cell.ct.s;if(lodash.isNil(s)){return;}for(var i=0;i<s.length;i+=1){var item=s[i];item[key]=value;}}function getClassWithcss(cssText,ukey){var cssTextArray=cssText.split(";");if(ukey==null||ukey.length===0){return cssText;}if(cssText.indexOf(ukey)>-1){for(var i=0;i<cssTextArray.length;i+=1){var s=cssTextArray[i];s=s.toLowerCase();var key=lodash.trim(s.substring(0,s.indexOf(":")));var value=lodash.trim(s.substring(s.indexOf(":")+1));if(key===ukey){return value;}}}return "";}function upsetClassWithCss(cssText,ukey,uvalue){var cssTextArray=cssText.split(";");var newCss="";if(ukey==null||ukey.length===0){return cssText;}if(cssText.indexOf(ukey)>-1){for(var i=0;i<cssTextArray.length;i+=1){var s=cssTextArray[i];s=s.toLowerCase();var key=lodash.trim(s.substring(0,s.indexOf(":")));var value=lodash.trim(s.substring(s.indexOf(":")+1));if(key===ukey){newCss+="".concat(key,":").concat(uvalue,";");}else if(key.length>0){newCss+="".concat(key,":").concat(value,";");}}}else if(ukey.length>0){cssText+="".concat(ukey,":").concat(uvalue,";");newCss=cssText;}return newCss;}function removeClassWidthCss(cssText,ukey){var cssTextArray=cssText.split(";");var newCss="";var oUkey=ukey;if(ukey==null||ukey.length===0){return cssText;}if(ukey in attrToCssName){ukey=attrToCssName[ukey];}if(cssText.indexOf(ukey)>-1){for(var i=0;i<cssTextArray.length;i+=1){var s=cssTextArray[i];s=s.toLowerCase();var key=lodash.trim(s.substring(0,s.indexOf(":")));var value=lodash.trim(s.substring(s.indexOf(":")+1));if(key===ukey||oUkey==="cl"&&key==="lucky-strike"||oUkey==="un"&&key==="lucky-underline"){continue;}else if(key.length>0){newCss+="".concat(key,":").concat(value,";");}}}else {newCss=cssText;}return newCss;}function getCssText(cssText,attr,value){var styleObj={};styleObj[attr]=value;if(attr==="un"){var fontColor=getClassWithcss(cssText,"color");if(fontColor===""){fontColor="#000000";}var fs=getClassWithcss(cssText,"font-size");if(fs===""){fs="11";}styleObj._fontSize=Number(fs);styleObj._color=fontColor;}var s=getFontStyleByCell(styleObj,undefined,undefined,false);var ukey=lodash.kebabCase(Object.keys(s)[0]);var uvalue=Object.values(s)[0];cssText=removeClassWidthCss(cssText,attr);cssText=upsetClassWithCss(cssText,ukey,uvalue);return cssText;}function extendCssText(origin,cover){var isLimit=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var originArray=origin.split(";");var coverArray=cover.split(";");var newCss="";var addKeyList={};for(var i=0;i<originArray.length;i+=1){var so=originArray[i];var isAdd=true;so=so.toLowerCase();var okey=lodash.trim(so.substring(0,so.indexOf(":")));if(okey==="font-size"){continue;}var ovalue=lodash.trim(so.substring(so.indexOf(":")+1));if(isLimit){if(!(okey in inlineStyleAffectCssName)){continue;}}for(var a=0;a<coverArray.length;a+=1){var sc=coverArray[a];sc=sc.toLowerCase();var ckey=lodash.trim(sc.substring(0,sc.indexOf(":")));var cvalue=lodash.trim(sc.substring(sc.indexOf(":")+1));if(okey===ckey){newCss+="".concat(ckey,":").concat(cvalue,";");isAdd=false;continue;}}if(isAdd){newCss+="".concat(okey,":").concat(ovalue,";");}addKeyList[okey]=1;}for(var _a=0;_a<coverArray.length;_a+=1){var _sc=coverArray[_a];_sc=_sc.toLowerCase();var _ckey=lodash.trim(_sc.substring(0,_sc.indexOf(":")));var _cvalue=lodash.trim(_sc.substring(_sc.indexOf(":")+1));if(isLimit){if(!(_ckey in inlineStyleAffectCssName)){continue;}}if(!(_ckey in addKeyList)){newCss+="".concat(_ckey,":").concat(_cvalue,";");}}return newCss;}function updateInlineStringFormat(ctx,cell,attr,value,cellInput){var w=window.getSelection();if(!w)return;var range=w.getRangeAt(0);var $textEditor=cellInput;if(range.collapsed===true){return;}var endContainer=range.endContainer;var startContainer=range.startContainer;var endOffset=range.endOffset;var startOffset=range.startOffset;if($textEditor){if(startContainer===endContainer){var span=startContainer.parentNode;var spanIndex;var inherit=false;var content=(span===null||span===void 0?void 0:span.innerHTML)||"";var fullContent=$textEditor.innerHTML;if(fullContent.substring(0,5)!=="<span"){inherit=true;}if(span){var _startContainer$paren;var left="";var mid="";var right="";var s1=0;var s2=startOffset;var s3=endOffset;var s4=content.length;left=content.substring(s1,s2);mid=content.substring(s2,s3);right=content.substring(s3,s4);var cont="";if(left!==""){var cssText=span.style.cssText;if(inherit){var box=span.closest("#luckysheet-input-box");if(box!=null){cssText=extendCssText(box.style.cssText,cssText);}}cont+="<span style='".concat(cssText,"'>").concat(left,"</span>");}if(mid!==""){var _cssText=getCssText(span.style.cssText,attr,value);if(inherit){var _box=span.closest("#luckysheet-input-box");if(_box!=null){_cssText=extendCssText(_box.style.cssText,_cssText);}}cont+="<span style='".concat(_cssText,"'>").concat(mid,"</span>");}if(right!==""){var _cssText2=span.style.cssText;if(inherit){var _box2=span.closest("#luckysheet-input-box");if(_box2!=null){_cssText2=extendCssText(_box2.style.cssText,_cssText2);}}cont+="<span style='".concat(_cssText2,"'>").concat(right,"</span>");}if(((_startContainer$paren=startContainer.parentElement)===null||_startContainer$paren===void 0?void 0:_startContainer$paren.tagName)==="SPAN"){spanIndex=lodash.indexOf($textEditor.querySelectorAll("span"),span);span.outerHTML=cont;}else {spanIndex=0;span.innerHTML=cont;}var seletedNodeIndex=0;if(s1===s2){seletedNodeIndex=spanIndex;}else {seletedNodeIndex=spanIndex+1;}selectTextContent($textEditor.querySelectorAll("span")[seletedNodeIndex]);}}else {var _startContainer$paren2,_endContainer$parentE;if(((_startContainer$paren2=startContainer.parentElement)===null||_startContainer$paren2===void 0?void 0:_startContainer$paren2.tagName)==="SPAN"&&((_endContainer$parentE=endContainer.parentElement)===null||_endContainer$parentE===void 0?void 0:_endContainer$parentE.tagName)==="SPAN"){var startSpan=startContainer.parentNode;var endSpan=endContainer.parentNode;var allSpans=$textEditor.querySelectorAll("span");var startSpanIndex=lodash.indexOf(allSpans,startSpan);var endSpanIndex=lodash.indexOf(allSpans,endSpan);var startContent=(startSpan===null||startSpan===void 0?void 0:startSpan.innerHTML)||"";var endContent=(endSpan===null||endSpan===void 0?void 0:endSpan.innerHTML)||"";var sleft="";var sright="";var eleft="";var eright="";var _s=0;var _s2=startOffset;var _s3=endOffset;var _s4=endContent.length;sleft=startContent.substring(_s,_s2);sright=startContent.substring(_s2,startContent.length);eleft=endContent.substring(0,_s3);eright=endContent.substring(_s3,_s4);var spans=$textEditor.querySelectorAll("span");var _cont="";for(var i=0;i<startSpanIndex;i+=1){var _span=spans[i];var _content=_span.innerHTML;_cont+="<span style='".concat(_span.style.cssText,"'>").concat(_content,"</span>");}if(sleft!==""){_cont+="<span style='".concat(startSpan.style.cssText,"'>").concat(sleft,"</span>");}if(sright!==""){var _cssText3=getCssText(startSpan.style.cssText,attr,value);_cont+="<span style='".concat(_cssText3,"'>").concat(sright,"</span>");}if(startSpanIndex<endSpanIndex){for(var _i=startSpanIndex+1;_i<endSpanIndex;_i+=1){var _span2=spans[_i];var _content2=_span2.innerHTML;_cont+="<span style='".concat(_span2.style.cssText,"'>").concat(_content2,"</span>");}}if(eleft!==""){var _cssText4=getCssText(endSpan.style.cssText,attr,value);_cont+="<span style='".concat(_cssText4,"'>").concat(eleft,"</span>");}if(eright!==""){_cont+="<span style='".concat(endSpan.style.cssText,"'>").concat(eright,"</span>");}for(var _i2=endSpanIndex+1;_i2<spans.length;_i2+=1){var _span3=spans[_i2];var _content3=_span3.innerHTML;_cont+="<span style='".concat(_span3.style.cssText,"'>").concat(_content3,"</span>");}$textEditor.innerHTML=_cont;var startSeletedNodeIndex;var endSeletedNodeIndex;if(_s===_s2){startSeletedNodeIndex=startSpanIndex;endSeletedNodeIndex=endSpanIndex;}else {startSeletedNodeIndex=startSpanIndex+1;endSeletedNodeIndex=endSpanIndex+1;}spans=$textEditor.querySelectorAll("span");selectTextContentCross(spans[startSeletedNodeIndex],spans[endSeletedNodeIndex]);}}}}function checkWordByteLength(value){return Math.ceil(value.charCodeAt(0).toString(2).length/8);}function hasChinaword(s){var patrn=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi;if(!patrn.exec(s)){return false;}return true;}var textHeightCache={};var measureTextCache={};var measureTextCellInfoCache={};function clearMeasureTextCache(){measureTextCache={};measureTextCellInfoCache={};}function getTextSize(text,font){if(font in textHeightCache){return textHeightCache[font];}var ele=document.createElement("span");ele.style.float="left";ele.style.whiteSpace="nowrap";ele.style.visibility="hidden";ele.style.margin="0";ele.style.padding="0";ele.innerHTML=text;document.body.append(ele);var w=Math.max(ele.scrollWidth,ele.offsetWidth,ele.clientWidth);var h=Math.max(ele.scrollHeight,ele.offsetHeight,ele.clientHeight);textHeightCache[font]=[w,h];ele.remove();return [w,h];}function defaultFont(defaultFontSize){return "normal normal normal ".concat(defaultFontSize,"pt \"Helvetica Neue\", Helvetica, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\",  \"WenQuanYi Micro Hei\", sans-serif");}function getFontSet(format,defaultFontSize){if(lodash.isPlainObject(format)){var fontAttr=[];if(format.it==="0"||format.it===0||lodash.isNil(format.it)){fontAttr.push("normal");}else {fontAttr.push("italic");}fontAttr.push("normal");if(format.bl==="0"||format.bl===0||lodash.isNil(format.bl)){fontAttr.push("normal");}else {fontAttr.push("bold");}if(!format.fs){fontAttr.push("".concat(defaultFontSize,"pt"));}else {fontAttr.push("".concat(Math.ceil(format.fs),"pt"));}var fontSet="";if(!format.ff){fontSet="\"Helvetica Neue\", Helvetica, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif";}else {fontSet="\"Helvetica Neue\", Helvetica, Arial, \"PingFang SC\", \"Hiragino Sans GB\", \"Heiti SC\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif";}return "".concat(fontAttr.join(" ")," ").concat(fontSet);}return defaultFont(defaultFontSize);}function getMeasureText(value,renderCtx,sheetCtx,fontset){var mtc=measureTextCache["".concat(value,"_").concat(renderCtx.font)];if(fontset){mtc=measureTextCache["".concat(value,"_").concat(fontset)];}if(mtc!=null){return mtc;}if(fontset){renderCtx.font=fontset;}var measureText=renderCtx.measureText(value);var cache={};cache.width=measureText.width;if(fontset){renderCtx.font=fontset;}cache.actualBoundingBoxDescent=measureText.actualBoundingBoxDescent;cache.actualBoundingBoxAscent=measureText.actualBoundingBoxAscent;if(cache.actualBoundingBoxDescent==null||cache.actualBoundingBoxAscent==null||Number.isNaN(cache.actualBoundingBoxDescent)||Number.isNaN(cache.actualBoundingBoxAscent)){var commonWord="M";if(hasChinaword(value)){commonWord="";}var oneLineTextHeight=getTextSize(commonWord,renderCtx.font)[1]*0.8;if(renderCtx.textBaseline==="top"){cache.actualBoundingBoxDescent=oneLineTextHeight;cache.actualBoundingBoxAscent=0;}else if(renderCtx.textBaseline==="middle"){cache.actualBoundingBoxDescent=oneLineTextHeight/2;cache.actualBoundingBoxAscent=oneLineTextHeight/2;}else {cache.actualBoundingBoxDescent=0;cache.actualBoundingBoxAscent=oneLineTextHeight;}}if(renderCtx.textBaseline==="alphabetic"){var descText="gjpqy";var matchText="abcdABCD";var descTextMeasure=measureTextCache["".concat(descText,"_").concat(renderCtx.font)];if(fontset){descTextMeasure=measureTextCache["".concat(descText,"_").concat(fontset)];}var matchTextMeasure=measureTextCache["".concat(matchText,"_").concat(renderCtx.font)];if(fontset){matchTextMeasure=measureTextCache["".concat(matchText,"_").concat(fontset)];}if(descTextMeasure==null){descTextMeasure=renderCtx.measureText(descText);}if(matchTextMeasure==null){matchTextMeasure=renderCtx.measureText(matchText);}if(cache.actualBoundingBoxDescent<=matchTextMeasure.actualBoundingBoxDescent){cache.actualBoundingBoxDescent=descTextMeasure.actualBoundingBoxDescent;if(!cache.actualBoundingBoxDescent){cache.actualBoundingBoxDescent=0;}}}cache.width*=sheetCtx.zoomRatio;cache.actualBoundingBoxDescent*=sheetCtx.zoomRatio;cache.actualBoundingBoxAscent*=sheetCtx.zoomRatio;measureTextCache["".concat(value,"_").concat(sheetCtx.zoomRatio,"_").concat(renderCtx.font)]=cache;return cache;}function isSupportBoundingBox(ctx){var measureText=ctx.measureText("");if(lodash.isNil(measureText.actualBoundingBoxAscent)){return false;}return true;}function drawLineInfo(wordGroup,cancelLine,underLine,option){var left=option.left;var top=option.top;var width=option.width;var asc=option.asc;var desc=option.desc;var fs=option.fs;if(wordGroup.wrap===true){return;}if(wordGroup.inline===true&&!lodash.isNil(wordGroup.style)){cancelLine=wordGroup.style.cl;underLine=wordGroup.style.un;}if(Number(cancelLine)!==0){wordGroup.cancelLine={};wordGroup.cancelLine.startX=left;wordGroup.cancelLine.startY=top-asc/2+1;wordGroup.cancelLine.endX=left+width;wordGroup.cancelLine.endY=top-asc/2+1;wordGroup.cancelLine.fs=fs;}var nUnderline=Number(underLine);if(nUnderline!==0){wordGroup.underLine=[];if(nUnderline===1||nUnderline===2){var item={};item.startX=left;item.startY=top+3;item.endX=left+width;item.endY=top+3;item.fs=fs;wordGroup.underLine.push(item);}if(nUnderline===2){var _item={};_item.startX=left;_item.startY=top+desc;_item.endX=left+width;_item.endY=top+desc;_item.fs=fs;wordGroup.underLine.push(_item);}if(nUnderline===3||nUnderline===4){var _item2={};_item2.startX=left;_item2.startY=top+desc;_item2.endX=left+width;_item2.endY=top+desc;_item2.fs=fs;wordGroup.underLine.push(_item2);}if(nUnderline===4){var _item3={};_item3.startX=left;_item3.startY=top+desc+2;_item3.endX=left+width;_item3.endY=top+desc+2;_item3.fs=fs;wordGroup.underLine.push(_item3);}}}function getCellTextInfo(cell,renderCtx,sheetCtx,option){var cellWidth=option.cellWidth;var cellHeight=option.cellHeight;var isMode="";var isModeSplit="";if(cellWidth==null){isMode="onlyWidth";isModeSplit="_";}var textInfo=measureTextCellInfoCache["".concat(option.r,"_").concat(option.c).concat(isModeSplit).concat(isMode)];if(textInfo){return textInfo;}var space_width=option.space_width;var space_height=option.space_height;if(space_width===undefined){space_width=2;}if(space_height===undefined){space_height=2;}var horizonAlign=normalizedCellAttr(cell,"ht");var verticalAlign=normalizedCellAttr(cell,"vt");var tb=normalizedCellAttr(cell,"tb");var tr=normalizedCellAttr(cell,"tr");var rt=normalizedCellAttr(cell,"rt");var isRotateUp=1;if(lodash.isNil(rt)){if(tr==="0"){rt=0;}else if(tr==="1"){rt=45;}else if(tr==="4"){rt=90;}else if(tr==="2"){rt=135;}else if(tr==="5"){rt=180;}if(lodash.isNil(rt)){rt=0;}}if(rt>180||rt<0){rt=0;}rt=parseInt(rt,10);if(rt>90){rt=90-rt;isRotateUp=0;}renderCtx.textAlign="start";var textContent={};textContent.values=[];var fontset;var cancelLine="0";var underLine="0";var fontSize=11;var isInline=false;var value;var inlineStringArr=[];if(isInlineStringCell(cell)){var sharedStrings=cell.ct.s;var similarIndex=0;for(var i=0;i<sharedStrings.length;i+=1){var shareCell=sharedStrings[i];var scfontset=getFontSet(shareCell,sheetCtx.defaultFontSize);var fc=shareCell.fc;var cl=shareCell.cl;var un=shareCell.un;var v=shareCell.v;var fs=shareCell.fs;v=v.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_");var splitArr=v.split("_x000D_");for(var x=0;x<splitArr.length;x+=1){var newValue=splitArr[x];if(newValue===""&&x!==splitArr.length-1){inlineStringArr.push({fontset:scfontset,fc:!fc?"#000":fc,cl:!cl?0:cl,un:!un?0:un,wrap:true,fs:!fs?11:fs});similarIndex+=1;}else {var newValueArray=newValue.split("");for(var n=0;n<newValueArray.length;n+=1){var nv=newValueArray[n];inlineStringArr.push({fontset:scfontset,fc:!fc?"#000":fc,cl:!cl?0:cl,un:!un?0:un,v:nv,si:similarIndex,fs:!fs?11:fs});}if(x!==splitArr.length-1){inlineStringArr.push({fontset:scfontset,fc:!fc?"#000":fc,cl:!cl?0:cl,un:!un?0:un,wrap:true,fs:!fs?11:fs});similarIndex+=1;}}}similarIndex+=1;}isInline=true;}else {fontset=getFontSet(cell,sheetCtx.defaultFontSize);renderCtx.font=fontset;cancelLine=normalizedCellAttr(cell,"cl");underLine=normalizedCellAttr(cell,"un");fontSize=normalizedCellAttr(cell,"fs");if(cell instanceof Object){value=cell.m;if(lodash.isNil(value)){value=cell.v;}}else {value=cell;}if(lodash.isEmpty(value)){return null;}}if(tr==="3"){renderCtx.textBaseline="top";var textW_all=0;var textH_all=0;var colIndex=0;var textH_all_cache=0;var textH_all_Column={};var textH_all_ColumnHeight=[];if(isInline){var preShareCell=null;for(var _i=0;_i<inlineStringArr.length;_i+=1){var _shareCell=inlineStringArr[_i];var value1=_shareCell.v;var showValue=_shareCell.v;if(_shareCell.wrap===true){value1="M";showValue="";if(!lodash.isNil(preShareCell)&&preShareCell.wrap!==true&&_i<inlineStringArr.length-1){textH_all_ColumnHeight.push(textH_all_cache);textH_all_cache=0;colIndex+=1;preShareCell=_shareCell;continue;}}var measureText=getMeasureText(value1,renderCtx,sheetCtx,_shareCell.fontset);var textW=measureText.width+space_width;var textH=measureText.actualBoundingBoxAscent+measureText.actualBoundingBoxDescent+space_height;textH_all_cache+=textH;if(tb==="2"&&!_shareCell.wrap){if(textH_all_cache>cellHeight&&!lodash.isNil(textH_all_Column[colIndex])){textH_all_ColumnHeight.push(textH_all_cache-textH);textH_all_cache=textH;colIndex+=1;}}if(_i===inlineStringArr.length-1){textH_all_ColumnHeight.push(textH_all_cache);}if(lodash.isNil(textH_all_Column[colIndex])){textH_all_Column[colIndex]=[];}var item={content:showValue,style:_shareCell,width:textW,height:textH,left:0,top:0,colIndex:colIndex,asc:measureText.actualBoundingBoxAscent,desc:measureText.actualBoundingBoxDescent,inline:true,wrap:false};if(_shareCell.wrap===true){item.wrap=true;}textH_all_Column[colIndex].push(item);preShareCell=_shareCell;}}else {var _measureText=getMeasureText(value,renderCtx,sheetCtx);var textHeight=_measureText.actualBoundingBoxDescent+_measureText.actualBoundingBoxAscent;value=value.toString();var vArr=[];if(value.length>1){vArr=value.split("");}else {vArr.push(value);}var oneWordWidth=getMeasureText(vArr[0],renderCtx,sheetCtx).width;for(var _i2=0;_i2<vArr.length;_i2+=1){var _textW=oneWordWidth+space_width;var _textH=textHeight+space_height;textH_all_cache+=_textH;if(tb==="2"){if(textH_all_cache>cellHeight&&!lodash.isNil(textH_all_Column[colIndex])){textH_all_ColumnHeight.push(textH_all_cache-_textH);textH_all_cache=_textH;colIndex+=1;}}if(_i2===vArr.length-1){textH_all_ColumnHeight.push(textH_all_cache);}if(lodash.isNil(textH_all_Column[colIndex])){textH_all_Column[colIndex]=[];}textH_all_Column[colIndex].push({content:vArr[_i2],style:fontset,width:_textW,height:_textH,left:0,top:0,colIndex:colIndex,asc:_measureText.actualBoundingBoxAscent,desc:_measureText.actualBoundingBoxDescent});}}var textH_all_ColumWidth=[];for(var _i3=0;_i3<textH_all_ColumnHeight.length;_i3+=1){var columnHeight=textH_all_ColumnHeight[_i3];var col=textH_all_Column[_i3];var colMaxW=0;for(var c=0;c<col.length;c+=1){var word=col[c];colMaxW=Math.max(colMaxW,word.width);}textH_all_ColumWidth.push(colMaxW);textW_all+=colMaxW;textH_all=Math.max(textH_all,columnHeight);}textContent.type="verticalWrap";textContent.textWidthAll=textW_all;textContent.textHeightAll=textH_all;if(isMode==="onlyWidth"){return textContent;}var cumColumnWidth=0;for(var _i4=0;_i4<textH_all_ColumnHeight.length;_i4+=1){var _columnHeight=textH_all_ColumnHeight[_i4];var columnWidth=textH_all_ColumWidth[_i4];var _col=textH_all_Column[_i4];var cumWordHeight=0;for(var _c=0;_c<_col.length;_c+=1){var _word=_col[_c];var left=space_width+cumColumnWidth;if(horizonAlign==="0"){left=cellWidth/2+cumColumnWidth-textW_all/2+space_width*textH_all_ColumnHeight.length;}else if(horizonAlign==="2"){left=cellWidth+cumColumnWidth-textW_all+space_width;}var top=cellHeight-space_height+cumWordHeight-_columnHeight;if(verticalAlign==="0"){top=cellHeight/2+cumWordHeight-_columnHeight/2;}else if(verticalAlign==="1"){top=space_height+cumWordHeight;}cumWordHeight+=_word.height;_word.left=left;_word.top=top;drawLineInfo(_word,cancelLine,underLine,{width:columnWidth,height:_word.height,left:left,top:top+_word.height-space_height,asc:_word.height,desc:0,fs:fontSize});textContent.values.push(_word);}cumColumnWidth+=columnWidth;}}else {var supportBoundBox=isSupportBoundingBox(renderCtx);if(supportBoundBox){renderCtx.textBaseline="alphabetic";}else {renderCtx.textBaseline="bottom";}if(tb==="2"||isInline){var _textW_all=0;var _textH_all=0;var textW_all_inner=0;var splitIndex=0;var text_all_split={};textContent.rotate=rt;rt=Math.abs(rt);var anchor=0;var preStr;var preTextHeight;var preTextWidth;var preMeasureText;var _i5=1;var spaceOrTwoByte=null;var spaceOrTwoByteIndex=null;if(isInline){while(_i5<=inlineStringArr.length){var shareCells=inlineStringArr.slice(anchor,_i5);if(shareCells[shareCells.length-1].wrap===true){anchor=_i5;if(shareCells.length>1){for(var s=0;s<shareCells.length-1;s+=1){var sc=shareCells[s];var _item4={content:sc.v,style:sc,width:sc.measureText.width,height:sc.measureText.actualBoundingBoxAscent+sc.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:sc.measureText.actualBoundingBoxAscent,desc:sc.measureText.actualBoundingBoxDescent,inline:true,fs:sc.fs};text_all_split[splitIndex].push(_item4);}}if(shareCells.length===1||_i5===inlineStringArr.length){var _sc=shareCells[0];var _measureText2=getMeasureText("M",renderCtx,sheetCtx,_sc.fontset);if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}text_all_split[splitIndex].push({content:"",style:_sc,width:_measureText2.width,height:_measureText2.actualBoundingBoxAscent+_measureText2.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_measureText2.actualBoundingBoxAscent,desc:_measureText2.actualBoundingBoxDescent,inline:true,wrap:true,fs:_sc.fs});}splitIndex+=1;_i5+=1;continue;}var textWidth=0;var _textHeight=0;for(var _s=0;_s<shareCells.length;_s+=1){var _sc2=shareCells[_s];if(lodash.isNil(_sc2.measureText)){_sc2.measureText=getMeasureText(_sc2.v,renderCtx,sheetCtx,_sc2.fontset);}textWidth+=_sc2.measureText.width;_textHeight=Math.max(_sc2.measureText.actualBoundingBoxAscent+_sc2.measureText.actualBoundingBoxDescent);}var width=textWidth*Math.cos(rt*Math.PI/180)+_textHeight*Math.sin(rt*Math.PI/180);var height=textWidth*Math.sin(rt*Math.PI/180)+_textHeight*Math.cos(rt*Math.PI/180);var lastWord=shareCells[shareCells.length-1];if(lastWord.v===" "||checkWordByteLength(lastWord.v)===2){spaceOrTwoByteIndex=_i5;}if(rt!==0){if(height+space_height>cellHeight&&!lodash.isNil(text_all_split[splitIndex])&&tb==="2"&&_i5!==inlineStringArr.length){if(!lodash.isNil(spaceOrTwoByteIndex)&&spaceOrTwoByteIndex<_i5){for(var _s2=0;_s2<spaceOrTwoByteIndex-anchor;_s2+=1){var _sc3=shareCells[_s2];text_all_split[splitIndex].push({content:_sc3.v,style:_sc3,width:_sc3.measureText.width,height:_sc3.measureText.actualBoundingBoxAscent+_sc3.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc3.measureText.actualBoundingBoxAscent,desc:_sc3.measureText.actualBoundingBoxDescent,inline:true,fs:_sc3.fs});}anchor=spaceOrTwoByteIndex;_i5=spaceOrTwoByteIndex+1;splitIndex+=1;spaceOrTwoByteIndex=null;}else {anchor=_i5-1;for(var _s3=0;_s3<shareCells.length-1;_s3+=1){var _sc4=shareCells[_s3];text_all_split[splitIndex].push({content:_sc4.v,style:_sc4,width:_sc4.measureText.width,height:_sc4.measureText.actualBoundingBoxAscent+_sc4.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc4.measureText.actualBoundingBoxAscent,desc:_sc4.measureText.actualBoundingBoxDescent,inline:true,fs:_sc4.fs});}splitIndex+=1;}}else if(_i5===inlineStringArr.length){if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}for(var _s4=0;_s4<shareCells.length;_s4+=1){var _sc5=shareCells[_s4];text_all_split[splitIndex].push({content:_sc5.v,style:_sc5,width:_sc5.measureText.width,height:_sc5.measureText.actualBoundingBoxAscent+_sc5.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc5.measureText.actualBoundingBoxAscent,desc:_sc5.measureText.actualBoundingBoxDescent,inline:true,fs:_sc5.fs});}break;}else {if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}_i5+=1;}}else {if(width+space_width>cellWidth&&!lodash.isNil(text_all_split[splitIndex])&&tb==="2"&&_i5!==inlineStringArr.length){if(!lodash.isNil(spaceOrTwoByteIndex)&&spaceOrTwoByteIndex<_i5){for(var _s5=0;_s5<spaceOrTwoByteIndex-anchor;_s5+=1){var _sc6=shareCells[_s5];text_all_split[splitIndex].push({content:_sc6.v,style:_sc6,width:_sc6.measureText.width,height:_sc6.measureText.actualBoundingBoxAscent+_sc6.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc6.measureText.actualBoundingBoxAscent,desc:_sc6.measureText.actualBoundingBoxDescent,inline:true,fs:_sc6.fs});}anchor=spaceOrTwoByteIndex;_i5=spaceOrTwoByteIndex+1;splitIndex+=1;spaceOrTwoByteIndex=null;}else {anchor=_i5-1;for(var _s6=0;_s6<shareCells.length-1;_s6+=1){var _sc7=shareCells[_s6];text_all_split[splitIndex].push({content:_sc7.v,style:_sc7,width:_sc7.measureText.width,height:_sc7.measureText.actualBoundingBoxAscent+_sc7.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc7.measureText.actualBoundingBoxAscent,desc:_sc7.measureText.actualBoundingBoxDescent,inline:true,fs:_sc7.fs});}splitIndex+=1;}}else if(_i5===inlineStringArr.length){if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}for(var _s7=0;_s7<shareCells.length;_s7+=1){var _sc8=shareCells[_s7];text_all_split[splitIndex].push({content:_sc8.v,style:_sc8,width:_sc8.measureText.width,height:_sc8.measureText.actualBoundingBoxAscent+_sc8.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:splitIndex,asc:_sc8.measureText.actualBoundingBoxAscent,desc:_sc8.measureText.actualBoundingBoxDescent,inline:true,fs:_sc8.fs});}break;}else {if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}_i5+=1;}}}}else {value=value.toString();while(_i5<=value.length){var str=value.substring(anchor,_i5);var _measureText3=getMeasureText(str,renderCtx,sheetCtx);var _textWidth=_measureText3.width;var _textHeight2=_measureText3.actualBoundingBoxAscent+_measureText3.actualBoundingBoxDescent;var _width=_textWidth*Math.cos(rt*Math.PI/180)+_textHeight2*Math.sin(rt*Math.PI/180);var _height=_textWidth*Math.sin(rt*Math.PI/180)+_textHeight2*Math.cos(rt*Math.PI/180);var _lastWord=str.substr(str.length-1,1);if(_lastWord===" "||checkWordByteLength(_lastWord)===2){if(!lodash.isNil(preMeasureText)){spaceOrTwoByte={index:_i5,str:preStr+_lastWord,width:preTextWidth,height:preTextHeight,asc:preMeasureText.actualBoundingBoxAscent,desc:preMeasureText.actualBoundingBoxDescent};}}if(rt!==0){if(_height+space_height>cellHeight&&!lodash.isNil(text_all_split[splitIndex])&&_i5!==value.length){if(!lodash.isNil(spaceOrTwoByte)&&spaceOrTwoByte.index<_i5){anchor=spaceOrTwoByte.index;_i5=spaceOrTwoByte.index+1;text_all_split[splitIndex].push({content:spaceOrTwoByte.str,style:fontset,width:spaceOrTwoByte.width,height:spaceOrTwoByte.height,left:0,top:0,splitIndex:splitIndex,asc:spaceOrTwoByte.asc,desc:spaceOrTwoByte.desc,fs:fontSize});splitIndex+=1;spaceOrTwoByte=null;}else {anchor=_i5-1;text_all_split[splitIndex].push({content:preStr,style:fontset,left:0,top:0,splitIndex:splitIndex,height:preTextHeight,width:preTextWidth,asc:_measureText3.actualBoundingBoxAscent,desc:_measureText3.actualBoundingBoxDescent,fs:fontSize});splitIndex+=1;}}else if(_i5===value.length){if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}text_all_split[splitIndex].push({content:str,style:fontset,left:0,top:0,splitIndex:splitIndex,height:_textHeight2,width:_textWidth,asc:_measureText3.actualBoundingBoxAscent,desc:_measureText3.actualBoundingBoxDescent,fs:fontSize});break;}else {if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}_i5+=1;}}else {if(_width+space_width>cellWidth&&!lodash.isNil(text_all_split[splitIndex])&&_i5!==value.length){if(!lodash.isNil(spaceOrTwoByte)&&spaceOrTwoByte.index<_i5){anchor=spaceOrTwoByte.index;_i5=spaceOrTwoByte.index+1;text_all_split[splitIndex].push({content:spaceOrTwoByte.str,style:fontset,width:spaceOrTwoByte.width,height:spaceOrTwoByte.height,left:0,top:0,splitIndex:splitIndex,asc:spaceOrTwoByte.asc,desc:spaceOrTwoByte.desc,fs:fontSize});splitIndex+=1;spaceOrTwoByte=null;}else {spaceOrTwoByte=null;anchor=_i5-1;text_all_split[splitIndex].push({content:preStr,style:fontset,width:preTextWidth,height:preTextHeight,left:0,top:0,splitIndex:splitIndex,asc:_measureText3.actualBoundingBoxAscent,desc:_measureText3.actualBoundingBoxDescent,fs:fontSize});splitIndex+=1;}}else if(_i5===value.length){if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}text_all_split[splitIndex].push({content:str,style:fontset,width:_textWidth,height:_textHeight2,left:0,top:0,splitIndex:splitIndex,asc:_measureText3.actualBoundingBoxAscent,desc:_measureText3.actualBoundingBoxDescent,fs:fontSize});break;}else {if(lodash.isNil(text_all_split[splitIndex])){text_all_split[splitIndex]=[];}_i5+=1;}}preStr=str;preTextHeight=_textHeight2;preTextWidth=_textWidth;preMeasureText=_measureText3;}}var split_all_size=[];var splitLen=Object.keys(text_all_split).length;for(var j=0;j<splitLen;j+=1){var splitLists=text_all_split[j];if(lodash.isNil(splitLists)){continue;}var sWidth=0;var sHeight=0;var maxDesc=0;var maxAsc=0;var lineHeight=0;var maxWordCount=0;for(var _s8=0;_s8<splitLists.length;_s8+=1){var sp=splitLists[_s8];if(rt!==0){sWidth+=sp.width;sHeight=Math.max(sHeight,sp.height-(supportBoundBox?sp.desc:0));}else {sWidth+=sp.width;sHeight=Math.max(sHeight,sp.height-(supportBoundBox?sp.desc:0));}maxDesc=Math.max(maxDesc,supportBoundBox?sp.desc:0);maxAsc=Math.max(maxAsc,sp.asc);maxWordCount+=1;}lineHeight=sHeight/2;if(rt!==0){sHeight+=lineHeight;textW_all_inner=Math.max(textW_all_inner,sWidth);_textH_all+=sHeight;}else {sHeight+=lineHeight;_textW_all=Math.max(_textW_all,sWidth);_textH_all+=sHeight;}split_all_size.push({width:sWidth,height:sHeight,desc:maxDesc,asc:maxAsc,lineHeight:lineHeight,wordCount:maxWordCount});}var _cumWordHeight=0;var _cumColumnWidth=0;var rtPI=rt*Math.PI/180;var lastLine=split_all_size[splitLen-1];var lastLineSpaceHeight=lastLine.lineHeight;_textH_all=_textH_all-lastLineSpaceHeight+lastLine.desc;var rw=_textH_all/Math.sin(rtPI)+textW_all_inner*Math.cos(rtPI);var rh=textW_all_inner*Math.sin(rtPI);var fixOneLineLeft=0;if(rt!==0){if(splitLen===1){_textW_all=textW_all_inner+2*(_textH_all/Math.tan(rtPI));fixOneLineLeft=_textH_all/Math.tan(rtPI);}else {_textW_all=textW_all_inner+_textH_all/Math.tan(rtPI);}textContent.textWidthAll=rw;textContent.textHeightAll=rh;}else {textContent.textWidthAll=_textW_all;textContent.textHeightAll=_textH_all;}if(isMode==="onlyWidth"){return textContent;}if(rt!==0&&Number(isRotateUp)===1){renderCtx.textAlign="end";for(var _j=0;_j<splitLen;_j+=1){var _splitLists=text_all_split[_j];if(lodash.isNil(_splitLists)){continue;}var size=split_all_size[_j];_cumColumnWidth=0;for(var _c2=_splitLists.length-1;_c2>=0;_c2-=1){var wordGroup=_splitLists[_c2];var _left=void 0;var _top=void 0;if(rt!==0){var y=_cumWordHeight+size.asc;var _x=_cumWordHeight/Math.tan(rtPI)-_cumColumnWidth+textW_all_inner;if(horizonAlign==="0"){if(verticalAlign==="0"){_left=_x+cellWidth/2-_textW_all/2+lastLineSpaceHeight*Math.cos(rtPI)/2;_top=y+cellHeight/2-_textH_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left=_x+cellWidth/2-_textW_all/2;_top=y-(_textH_all/2-rh/2);}else if(verticalAlign==="2"){_left=_x+cellWidth/2-_textW_all/2+lastLineSpaceHeight*Math.cos(rtPI);_top=y+cellHeight-rh/2-_textH_all/2-lastLineSpaceHeight*Math.cos(rtPI);}}else if(horizonAlign==="1"){if(verticalAlign==="0"){_left=_x-rh*Math.sin(rtPI)/2+lastLineSpaceHeight*Math.cos(rtPI)/2;_top=y+cellHeight/2+rh*Math.cos(rtPI)/2-lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left=_x-rh*Math.sin(rtPI);_top=y+rh*Math.cos(rtPI);}else if(verticalAlign==="2"){_left=_x+lastLineSpaceHeight*Math.cos(rtPI);_top=y+cellHeight-lastLineSpaceHeight*Math.cos(rtPI);}}else if(horizonAlign==="2"){if(verticalAlign==="0"){_left=_x+cellWidth-rw/2-(textW_all_inner/2+_textH_all/2/Math.tan(rtPI))+lastLineSpaceHeight*Math.cos(rtPI)/2;_top=y+cellHeight/2-_textH_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left=_x+cellWidth-_textW_all+fixOneLineLeft;_top=y-_textH_all;}else if(verticalAlign==="2"){_left=_x+cellWidth-rw*Math.cos(rtPI)+lastLineSpaceHeight*Math.cos(rtPI);_top=y+cellHeight-rw*Math.sin(rtPI)-lastLineSpaceHeight*Math.cos(rtPI);}}}wordGroup.left=_left;wordGroup.top=_top;drawLineInfo(wordGroup,cancelLine,underLine,{width:wordGroup.width,height:wordGroup.height,left:(_left||0)-wordGroup.width,top:_top,asc:size.asc,desc:size.desc,fs:wordGroup.fs});textContent.values.push(wordGroup);_cumColumnWidth+=wordGroup.width;}_cumWordHeight+=size.height;}}else {for(var _j2=0;_j2<splitLen;_j2+=1){var _splitLists2=text_all_split[_j2];if(lodash.isNil(_splitLists2)){continue;}var _size=split_all_size[_j2];_cumColumnWidth=0;for(var _c3=0;_c3<_splitLists2.length;_c3+=1){var _wordGroup=_splitLists2[_c3];var _left2=void 0;var _top2=void 0;if(rt!==0){var _y=_cumWordHeight+_size.asc;var _x2=(_textH_all-_cumWordHeight)/Math.tan(rtPI)+_cumColumnWidth;if(horizonAlign==="0"){if(verticalAlign==="0"){_left2=_x2+cellWidth/2-_textW_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;_top2=_y+cellHeight/2-_textH_all/2+lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left2=_x2+cellWidth/2-_textW_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;_top2=_y-(_textH_all/2-rh/2)+lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="2"){_left2=_x2+cellWidth/2-_textW_all/2-lastLineSpaceHeight*Math.cos(rtPI);_top2=_y+cellHeight-rh/2-_textH_all/2-lastLineSpaceHeight*Math.cos(rtPI);}}else if(horizonAlign==="1"){if(verticalAlign==="0"){_left2=_x2-rh*Math.sin(rtPI)/2-lastLineSpaceHeight*Math.cos(rtPI)/2;_top2=_y-_textH_all+cellHeight/2-rh*Math.cos(rtPI)/2-lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left2=_x2;_top2=_y-_textH_all;}else if(verticalAlign==="2"){_left2=_x2-rh*Math.sin(rtPI)-lastLineSpaceHeight*Math.cos(rtPI);_top2=_y-_textH_all+cellHeight-rh*Math.cos(rtPI)-lastLineSpaceHeight*Math.cos(rtPI);}}else if(horizonAlign==="2"){if(verticalAlign==="0"){_left2=_x2+cellWidth-rw/2-_textW_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;_top2=_y+cellHeight/2-_textH_all/2-lastLineSpaceHeight*Math.cos(rtPI)/2;}else if(verticalAlign==="1"){_left2=_x2+cellWidth-rw*Math.cos(rtPI);_top2=_y+rh*Math.cos(rtPI);}else if(verticalAlign==="2"){_left2=_x2+cellWidth-_textW_all-lastLineSpaceHeight*Math.cos(rtPI)+fixOneLineLeft;_top2=_y+cellHeight-lastLineSpaceHeight*Math.cos(rtPI);}}drawLineInfo(_wordGroup,cancelLine,underLine,{width:_wordGroup.width,height:_wordGroup.height,left:_left2,top:_top2,asc:_size.asc,desc:_size.desc,fs:_wordGroup.fs});}else {_left2=space_width+_cumColumnWidth;if(horizonAlign==="0"){_left2=cellWidth/2+_cumColumnWidth-_size.width/2;}else if(horizonAlign==="2"){_left2=cellWidth+_cumColumnWidth-_size.width;}_top2=cellHeight-space_height+_cumWordHeight+_size.asc-_textH_all;if(verticalAlign==="0"){_top2=cellHeight/2+_cumWordHeight-_textH_all/2+_size.asc;}else if(verticalAlign==="1"){_top2=space_height+_cumWordHeight+_size.asc;}drawLineInfo(_wordGroup,cancelLine,underLine,{width:_wordGroup.width,height:_wordGroup.height,left:_left2,top:_top2,asc:_size.asc,desc:_size.desc,fs:_wordGroup.fs});}_wordGroup.left=_left2;_wordGroup.top=_top2;textContent.values.push(_wordGroup);_cumColumnWidth+=_wordGroup.width;}_cumWordHeight+=_size.height;}}textContent.type="plainWrap";if(rt!==0){if(horizonAlign==="0"){if(verticalAlign==="0"){textContent.textLeftAll=cellWidth/2;textContent.textTopAll=cellHeight/2;}else if(verticalAlign==="1"){textContent.textLeftAll=cellWidth/2;textContent.textTopAll=rh/2;}else if(verticalAlign==="2"){textContent.textLeftAll=cellWidth/2;textContent.textTopAll=cellHeight-rh/2;}}else if(horizonAlign==="1"){if(verticalAlign==="0"){textContent.textLeftAll=0;textContent.textTopAll=cellHeight/2;}else if(verticalAlign==="1"){textContent.textLeftAll=0;textContent.textTopAll=0;}else if(verticalAlign==="2"){textContent.textLeftAll=0;textContent.textTopAll=cellHeight;}}else if(horizonAlign==="2"){if(verticalAlign==="0"){textContent.textLeftAll=cellWidth-rw/2;textContent.textTopAll=cellHeight/2;}else if(verticalAlign==="1"){textContent.textLeftAll=cellWidth;textContent.textTopAll=0;}else if(verticalAlign==="2"){textContent.textLeftAll=cellWidth;textContent.textTopAll=cellHeight;}}}}else {var _measureText4=getMeasureText(value,renderCtx,sheetCtx);var _textWidth2=_measureText4.width;var _textHeight3=_measureText4.actualBoundingBoxDescent+_measureText4.actualBoundingBoxAscent;textContent.rotate=rt;rt=Math.abs(rt);var _rtPI=rt*Math.PI/180;var textWidthAll=_textWidth2*Math.cos(_rtPI)+_textHeight3*Math.sin(_rtPI);var textHeightAll=_textWidth2*Math.sin(_rtPI)+_textHeight3*Math.cos(_rtPI);if(rt!==0){textContent.textHeightAll=textHeightAll;}else {textContent.textHeightAll=textHeightAll+_textHeight3/2-_measureText4.actualBoundingBoxDescent-space_height;}textContent.textWidthAll=textWidthAll;if(isMode==="onlyWidth"){return textContent;}var _width2=textWidthAll;var _height2=textHeightAll;var _left3=space_width+_textHeight3*Math.sin(_rtPI)*isRotateUp;if(horizonAlign==="0"){_left3=cellWidth/2-_width2/2+_textHeight3*Math.sin(_rtPI)*isRotateUp;}else if(horizonAlign==="2"){_left3=cellWidth-space_width-_width2+_textHeight3*Math.sin(_rtPI)*isRotateUp;}var _top3=cellHeight-space_height-_height2+_measureText4.actualBoundingBoxAscent*Math.cos(_rtPI)+_textWidth2*Math.sin(_rtPI)*isRotateUp;if(verticalAlign==="0"){_top3=cellHeight/2-_height2/2+_measureText4.actualBoundingBoxAscent*Math.cos(_rtPI)+_textWidth2*Math.sin(_rtPI)*isRotateUp;}else if(verticalAlign==="1"){_top3=space_height+_measureText4.actualBoundingBoxAscent*Math.cos(_rtPI)+_textWidth2*Math.sin(_rtPI)*isRotateUp;}textContent.type="plain";var _wordGroup2={content:value,style:fontset,width:_width2,height:_height2,left:_left3,top:_top3};drawLineInfo(_wordGroup2,cancelLine,underLine,{width:_textWidth2,height:_textHeight3,left:_left3,top:_top3,asc:_measureText4.actualBoundingBoxAscent,desc:_measureText4.actualBoundingBoxDescent,fs:fontSize});textContent.values.push(_wordGroup2);textContent.textLeftAll=_left3;textContent.textTopAll=_top3;textContent.asc=_measureText4.actualBoundingBoxAscent;textContent.desc=_measureText4.actualBoundingBoxDescent;}}return textContent;}var error$2={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};var errorValues=Object.values(error$2);function valueIsError(value){return errorValues.includes(value);}function isRealNull(val){return lodash.isNil(val)||val.toString().replace(/\s/g,"")==="";}function isRealNum(val){if(lodash.isNil(val)||val.toString().replace(/\s/g,"")===""){return false;}if(typeof val==="boolean"){return false;}return !Number.isNaN(Number(val));}function checkDateTime(str){var reg1=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;var reg2=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!reg1.test(str)&&!reg2.test(str)){return false;}var year=Number(RegExp.$1);var month=Number(RegExp.$2);var day=Number(RegExp.$3);if(year<1900){return false;}if(month>12){return false;}if(day>31){return false;}if(month===2){if(new Date(year,1,29).getDate()===29&&day>29){return false;}if(new Date(year,1,29).getDate()!==29&&day>28){return false;}}return true;}function isdatetime(s){if(s===null||s.toString().length<5){return false;}if(checkDateTime(s)){return true;}return false;}function diff(now,then){return dayjs_min(now).diff(dayjs_min(then));}function isdatatypemulti(s){var type={};if(isdatetime(s)){type.date=true;}if(!Number.isNaN(parseFloat(s))&&!hasChinaword(s)){type.num=true;}return type;}function hasPartMC(ctx,cfg,r1,r2,c1,c2){var ret=false;lodash.forEach(ctx.config.merge,function(mc){if(r1<mc.r){if(r2>=mc.r&&r2<mc.r+mc.rs-1){if(c1>=mc.c&&c1<=mc.c+mc.cs-1){ret=true;return false;}if(c2>=mc.c&&c2<=mc.c+mc.cs-1){ret=true;return false;}if(c1<mc.c&&c2>mc.c+mc.cs-1){ret=true;return false;}}else if(r2>=mc.r&&r2===mc.r+mc.rs-1){if(c1>mc.c&&c1<mc.c+mc.cs-1){ret=true;return false;}if(c2>mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1===mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1>mc.c&&c2===mc.c+mc.cs-1){ret=true;return false;}}else if(r2>mc.r+mc.rs-1){if(c1>mc.c&&c1<=mc.c+mc.cs-1){ret=true;return false;}if(c2>=mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1===mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1>mc.c&&c2===mc.c+mc.cs-1){ret=true;return false;}}}else if(r1===mc.r){if(r2<mc.r+mc.rs-1){if(c1>=mc.c&&c1<=mc.c+mc.cs-1){ret=true;return false;}if(c2>=mc.c&&c2<=mc.c+mc.cs-1){ret=true;return false;}if(c1<mc.c&&c2>mc.c+mc.cs-1){ret=true;return false;}}else if(r2>=mc.r+mc.rs-1){if(c1>mc.c&&c1<=mc.c+mc.cs-1){ret=true;return false;}if(c2>=mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1===mc.c&&c2<mc.c+mc.cs-1){ret=true;return false;}if(c1>mc.c&&c2===mc.c+mc.cs-1){ret=true;return false;}}}else if(r1<=mc.r+mc.rs-1){if(c1>=mc.c&&c1<=mc.c+mc.cs-1){ret=true;return false;}if(c2>=mc.c&&c2<=mc.c+mc.cs-1){ret=true;return false;}if(c1<mc.c&&c2>mc.c+mc.cs-1){ret=true;return false;}}return true;});return ret;}var SSF={};var make_ssf=function make_ssf(SSF){SSF.version="0.11.2";function _strrev(x){var o="",i=x.length-1;while(i>=0){o+=x.charAt(i--);}return o;}function fill(c,l){var o="";while(o.length<l){o+=c;}return o;}function pad0(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t;}function pad_(v,d){var t=""+v;return t.length>=d?t:fill(" ",d-t.length)+t;}function rpad_(v,d){var t=""+v;return t.length>=d?t:t+fill(" ",d-t.length);}function pad0r1(v,d){var t=""+Math.round(v);return t.length>=d?t:fill("0",d-t.length)+t;}function pad0r2(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t;}var p2_32=Math.pow(2,32);function pad0r(v,d){if(v>p2_32||v<-p2_32)return pad0r1(v,d);var i=Math.round(v);return pad0r2(i,d);}function isgeneral(s,i){i=i||0;return s.length>=7+i&&(s.charCodeAt(i)|32)===103&&(s.charCodeAt(i+1)|32)===101&&(s.charCodeAt(i+2)|32)===110&&(s.charCodeAt(i+3)|32)===101&&(s.charCodeAt(i+4)|32)===114&&(s.charCodeAt(i+5)|32)===97&&(s.charCodeAt(i+6)|32)===108;}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function init_table(t){t[0]="General";t[1]="0";t[2]="0.00";t[3]="#,##0";t[4]="#,##0.00";t[9]="0%";t[10]="0.00%";t[11]="0.00E+00";t[12]="# ?/?";t[13]="# ??/??";t[14]="m/d/yy";t[15]="d-mmm-yy";t[16]="d-mmm";t[17]="mmm-yy";t[18]="h:mm AM/PM";t[19]="h:mm:ss AM/PM";t[20]="h:mm";t[21]="h:mm:ss";t[22]="m/d/yy h:mm";t[37]="#,##0 ;(#,##0)";t[38]="#,##0 ;[Red](#,##0)";t[39]="#,##0.00;(#,##0.00)";t[40]="#,##0.00;[Red](#,##0.00)";t[45]="mm:ss";t[46]="[h]:mm:ss";t[47]="mmss.0";t[48]="##0.0E+0";t[49]="@";t[56]='"/ "hh""mm""ss" "';t[65535]="General";}var table_fmt={};init_table(table_fmt);/* Defaults determined by systematically testing in Excel 2019 */ /* These formats appear to default to other formats in the table */var default_map=[];var defi=0;//  5 -> 37 ...  8 -> 40
  for(defi=5;defi<=8;++defi){default_map[defi]=32+defi;}// 23 ->  0 ... 26 ->  0
  for(defi=23;defi<=26;++defi){default_map[defi]=0;}// 27 -> 14 ... 31 -> 14
  for(defi=27;defi<=31;++defi){default_map[defi]=14;}// 50 -> 14 ... 58 -> 14
  for(defi=50;defi<=58;++defi){default_map[defi]=14;}// 59 ->  1 ... 62 ->  4
  for(defi=59;defi<=62;++defi){default_map[defi]=defi-58;}// 67 ->  9 ... 68 -> 10
  for(defi=67;defi<=68;++defi){default_map[defi]=defi-58;}// 72 -> 14 ... 75 -> 17
  for(defi=72;defi<=75;++defi){default_map[defi]=defi-58;}// 69 -> 12 ... 71 -> 14
  for(defi=67;defi<=68;++defi){default_map[defi]=defi-57;}// 76 -> 20 ... 78 -> 22
  for(defi=76;defi<=78;++defi){default_map[defi]=defi-56;}// 79 -> 45 ... 81 -> 47
  for(defi=79;defi<=81;++defi){default_map[defi]=defi-34;}// 82 ->  0 ... 65536 -> 0 (omitted)
  /* These formats technically refer to Accounting formats with no equivalent */var default_str=[];//  5 -- Currency,   0 decimal, black negative
  default_str[5]=default_str[63]='"$"#,##0_);\\("$"#,##0\\)';//  6 -- Currency,   0 decimal, red   negative
  default_str[6]=default_str[64]='"$"#,##0_);[Red]\\("$"#,##0\\)';//  7 -- Currency,   2 decimal, black negative
  default_str[7]=default_str[65]='"$"#,##0.00_);\\("$"#,##0.00\\)';//  8 -- Currency,   2 decimal, red   negative
  default_str[8]=default_str[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)';// 41 -- Accounting, 0 decimal, No Symbol
  default_str[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)';// 42 -- Accounting, 0 decimal, $  Symbol
  default_str[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)';// 43 -- Accounting, 2 decimal, No Symbol
  default_str[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)';// 44 -- Accounting, 2 decimal, $  Symbol
  default_str[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function frac(x,D,mixed){var sgn=x<0?-1:1;var B=x*sgn;var P_2=0,P_1=1,P=0;var Q_2=1,Q_1=0,Q=0;var A=Math.floor(B);while(Q_1<D){A=Math.floor(B);P=A*P_1+P_2;Q=A*Q_1+Q_2;if(B-A<0.00000005)break;B=1/(B-A);P_2=P_1;P_1=P;Q_2=Q_1;Q_1=Q;}if(Q>D){if(Q_1>D){Q=Q_2;P=P_2;}else {Q=Q_1;P=P_1;}}if(!mixed)return [0,sgn*P,Q];var q=Math.floor(sgn*P/Q);return [q,sgn*P-q*Q,Q];}function parse_date_code(v,opts,b2){if(v>2958465||v<0)return null;var date=v|0,time=Math.floor(86400*(v-date)),dow=0;var dout=[];var out={D:date,T:time,u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(out.u)<1e-6)out.u=0;if(opts&&opts.date1904)date+=1462;if(out.u>0.9999){out.u=0;if(++time==86400){out.T=time=0;++date;++out.D;}}if(date===60){dout=b2?[1317,10,29]:[1900,2,29];dow=3;}else if(date===0){dout=b2?[1317,8,29]:[1900,1,0];dow=6;}else {if(date>60)--date;/* 1 = Jan 1 1900 in Gregorian */var d=new Date(1900,0,1);d.setDate(d.getDate()+date-1);dout=[d.getFullYear(),d.getMonth()+1,d.getDate()];dow=d.getDay();if(date<60)dow=(dow+6)%7;if(b2)dow=fix_hijri(d,dout);}out.y=dout[0];out.m=dout[1];out.d=dout[2];out.S=time%60;time=Math.floor(time/60);out.M=time%60;time=Math.floor(time/60);out.H=time;out.q=dow;return out;}SSF.parse_date_code=parse_date_code;var basedate=new Date(1899,11,31,0,0,0);var dnthresh=basedate.getTime();var base1904=new Date(1900,2,1,0,0,0);function datenum_local(v,date1904){var epoch=v.getTime();if(date1904)epoch-=1461*24*60*60*1000;else if(v>=base1904)epoch+=24*60*60*1000;return (epoch-(dnthresh+(v.getTimezoneOffset()-basedate.getTimezoneOffset())*60000))/(24*60*60*1000);}/* The longest 32-bit integer text is "-4294967296", exactly 11 chars */function general_fmt_int(v){return v.toString(10);}SSF._general_int=general_fmt_int;/* ECMA-376 18.8.30 numFmt*/ /* Note: `toPrecision` uses standard form when prec > E and E >= -6 */var general_fmt_num=function make_general_fmt_num(){var trailing_zeroes_and_decimal=/(?:\.0*|(\.\d*[1-9])0+)$/;function strip_decimal(o){return o.indexOf(".")==-1?o:o.replace(trailing_zeroes_and_decimal,"$1");}/* General Exponential always shows 2 digits exp and trims the mantissa */var mantissa_zeroes_and_decimal=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/;var exp_with_single_digit=/(E[+-])(\d)$/;function normalize_exp(o){if(o.indexOf("E")==-1)return o;return o.replace(mantissa_zeroes_and_decimal,"$1E").replace(exp_with_single_digit,"$10$2");}/* exponent >= -9 and <= 9 */function small_exp(v){var w=v<0?12:11;var o=strip_decimal(v.toFixed(12));if(o.length<=w)return o;o=v.toPrecision(10);if(o.length<=w)return o;return v.toExponential(5);}/* exponent >= 11 or <= -10 likely exponential */function large_exp(v){var o=strip_decimal(v.toFixed(11));return o.length>(v<0?12:11)||o==="0"||o==="-0"?v.toPrecision(6):o;}function general_fmt_num_base(v){var V=Math.floor(Math.log(Math.abs(v))*Math.LOG10E),o;if(V>=-4&&V<=-1)o=v.toPrecision(10+V);else if(Math.abs(V)<=9)o=small_exp(v);else if(V===10)o=v.toFixed(10).substr(0,12);else o=large_exp(v);return strip_decimal(normalize_exp(o.toUpperCase()));}return general_fmt_num_base;}();SSF._general_num=general_fmt_num;/*
          "General" rules:
          - text is passed through ("@")
          - booleans are rendered as TRUE/FALSE
          - "up to 11 characters" displayed for numbers
          - Default date format (code 14) used for Dates
          TODO: technically the display depends on the width of the cell
      */function general_fmt(v,opts){switch(_typeof$1(v)){case"string":return v;case"boolean":return v?"TRUE":"FALSE";case"number":return (v|0)===v?v.toString(10):general_fmt_num(v);case"undefined":return "";case"object":if(v==null)return "";if(v instanceof Date)return format(14,datenum_local(v,opts&&opts.date1904),opts);}throw new Error("unsupported value in General format: "+v);}SSF._general=general_fmt;function fix_hijri(date,o){/* TODO: properly adjust y/m/d and  */o[0]-=581;var dow=date.getDay();if(date<60)dow=(dow+6)%7;return dow;}/*jshint -W086 */function write_date(type,fmt,val,ss0){var o="",ss=0,tt=0,y=val.y,out,outl=0;switch(type){case 98:/* 'b' buddhist year */y=val.y+543;/* falls through */case 121:/* 'y' year */switch(fmt.length){case 1:case 2:out=y%100;outl=2;break;default:out=y%10000;outl=4;break;}break;case 109:/* 'm' month */switch(fmt.length){case 1:case 2:out=val.m;outl=fmt.length;break;case 3:return months[val.m-1][1];case 5:return months[val.m-1][0];default:return months[val.m-1][2];}break;case 100:/* 'd' day */switch(fmt.length){case 1:case 2:out=val.d;outl=fmt.length;break;case 3:return days[val.q][0];default:return days[val.q][1];}break;case 104:/* 'h' 12-hour */switch(fmt.length){case 1:case 2:out=1+(val.H+11)%12;outl=fmt.length;break;default:throw "bad hour format: "+fmt;}break;case 72:/* 'H' 24-hour */switch(fmt.length){case 1:case 2:out=val.H;outl=fmt.length;break;default:throw "bad hour format: "+fmt;}break;case 77:/* 'M' minutes */switch(fmt.length){case 1:case 2:out=val.M;outl=fmt.length;break;default:throw "bad minute format: "+fmt;}break;case 115:/* 's' seconds */if(fmt!="s"&&fmt!="ss"&&fmt!=".0"&&fmt!=".00"&&fmt!=".000")throw "bad second format: "+fmt;if(val.u===0&&(fmt=="s"||fmt=="ss"))return pad0(val.S,fmt.length);if(ss0>=2)tt=ss0===3?1000:100;else tt=ss0===1?10:1;ss=Math.round(tt*(val.S+val.u));if(ss>=60*tt)ss=0;if(fmt==="s")return ss===0?"0":""+ss/tt;o=pad0(ss,2+ss0);if(fmt==="ss")return o.substr(0,2);return "."+o.substr(2,fmt.length-1);case 90:/* 'Z' absolute time */switch(fmt){case"[h]":case"[hh]":out=val.D*24+val.H;break;case"[m]":case"[mm]":out=(val.D*24+val.H)*60+val.M;break;case"[s]":case"[ss]":out=((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u);break;default:throw "bad abstime format: "+fmt;}outl=fmt.length===3?1:2;break;case 101:/* 'e' era */out=y;outl=1;break;}var outstr=outl>0?pad0(out,outl):"";return outstr;}/*jshint +W086 */function commaify(s){var w=3;if(s.length<=w)return s;var j=s.length%w,o=s.substr(0,j);for(;j!=s.length;j+=w){o+=(o.length>0?",":"")+s.substr(j,w);}return o;}var write_num=function make_write_num(){var pct1=/%/g;function write_num_pct(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul);}function write_num_cm(type,fmt,val){var idx=fmt.length-1;while(fmt.charCodeAt(idx-1)===44){--idx;}return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)));}function write_num_exp(fmt,val){var o;var idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return "0.0E+0";else if(val<0)return "-"+write_num_exp(fmt,-val);var period=fmt.indexOf(".");if(period===-1)period=fmt.indexOf("E");var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0)ee+=period;o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);if(o.indexOf("e")===-1){var fakee=Math.floor(Math.log(val)*Math.LOG10E);if(o.indexOf(".")===-1)o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee);else o+="E+"+(fakee-ee);while(o.substr(0,2)==="0."){o=o.charAt(0)+o.substr(2,period)+"."+o.substr(2+period);o=o.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");}o=o.replace(/\+-/,"-");}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E";});}else o=val.toExponential(idx);if(fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/))o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1);if(fmt.match(/E\-/)&&o.match(/e\+/))o=o.replace(/e\+/,"e");return o.replace("e","E");}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(r,aval,sign){var den=parseInt(r[4],10),rr=Math.round(aval*den),base=Math.floor(rr/den);var myn=rr-base*den,myd=den;return sign+(base===0?"":""+base)+" "+(myn===0?fill(" ",r[1].length+1+r[4].length):pad_(myn,r[1].length)+r[2]+"/"+r[3]+pad0(myd,r[4].length));}function write_num_f2(r,aval,sign){return sign+(aval===0?"":""+aval)+fill(" ",r[1].length+2+r[4].length);}var dec1=/^#*0*\.([0#]+)/;var closeparen=/\).*[0#]/;var phone=/\(###\) ###\\?-####/;function hashq(str){var o="",cc;for(var i=0;i!=str.length;++i){switch(cc=str.charCodeAt(i)){case 35:break;case 63:o+=" ";break;case 48:o+="0";break;default:o+=String.fromCharCode(cc);}}return o;}function rnd(val,d){var dd=Math.pow(10,d);return ""+Math.round(val*dd)/dd;}function dec(val,d){var _frac=val-Math.floor(val),dd=Math.pow(10,d);if(d<(""+Math.round(_frac*dd)).length)return 0;return Math.round(_frac*dd);}function carry(val,d){if(d<(""+Math.round((val-Math.floor(val))*Math.pow(10,d))).length){return 1;}return 0;}function flr(val){if(val<2147483647&&val>-2147483648)return ""+(val>=0?val|0:val-1|0);return ""+Math.floor(val);}function write_num_flt(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(val>=0)return write_num_flt("n",ffmt,val);return "("+write_num_flt("n",ffmt,-val)+")";}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp(fmt,val);if(fmt.charCodeAt(0)===36)return "$"+write_num_flt(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o;var r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0r(aval,fmt.length);if(fmt.match(/^[#?]+$/)){o=pad0r(val,0);if(o==="0")o="";return o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;}if(r=fmt.match(frac1))return write_num_f1(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0r(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1)){o=rnd(val,r[1].length).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])).replace(/\.(\d*)$/,function($$,$1){return "."+$1+fill("0",hashq(r[1]).length-$1.length);});return fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".");}fmt=fmt.replace(/^#+([0.])/,"$1");if(r=fmt.match(/^(0*)\.(#*)$/)){return sign+rnd(aval,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");}if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(pad0r(aval,0));if(r=fmt.match(/^#,##0\.([#0]*0)$/)){return val<0?"-"+write_num_flt(type,fmt,-val):commaify(""+(Math.floor(val)+carry(val,r[1].length)))+"."+pad0(dec(val,r[1].length),r[1].length);}if(r=fmt.match(/^#,#*,#0/))return write_num_flt(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/)){o=_strrev(write_num_flt(type,fmt.replace(/[\\-]/g,""),val));ri=0;return _strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==="0"?"0":"";}));}if(fmt.match(phone)){o=write_num_flt(type,"##########",val);return "("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);}var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(r[4].length,7);ff=frac(aval,Math.pow(10,ri)-1,false);o=""+sign;oa=write_num("n",r[1],ff[1]);if(oa.charAt(oa.length-1)==" ")oa=oa.substr(0,oa.length-1)+"0";o+=oa+r[2]+"/"+r[3];oa=rpad_(ff[2],ri);if(oa.length<r[4].length)oa=hashq(r[4].substr(r[4].length-oa.length))+oa;o+=oa;return o;}if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(Math.max(r[1].length,r[4].length),7);ff=frac(aval,Math.pow(10,ri)-1,true);return sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));}if(r=fmt.match(/^[#0?]+$/)){o=pad0r(val,0);if(fmt.length<=o.length)return o;return hashq(fmt.substr(0,fmt.length-o.length))+o;}if(r=fmt.match(/^([#0?]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1");ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres));}if(r=fmt.match(/^00,000\.([#0]*0)$/)){ri=dec(val,r[1].length);return val<0?"-"+write_num_flt(type,fmt,-val):commaify(flr(val)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return "00,"+($$.length<3?pad0(0,3-$$.length):"")+$$;})+"."+pad0(ri,r[1].length);}switch(fmt){case"###,##0.00":return write_num_flt(type,"#,##0.00",val);case"###,###":case"##,###":case"#,###":var x=commaify(pad0r(aval,0));return x!=="0"?sign+x:"";case"###,###.00":return write_num_flt(type,"###,##0.00",val).replace(/^0\./,".");case"#,###.00":return write_num_flt(type,"#,##0.00",val).replace(/^0\./,".");}throw new Error("unsupported format |"+fmt+"|");}function write_num_cm2(type,fmt,val){var idx=fmt.length-1;while(fmt.charCodeAt(idx-1)===44){--idx;}return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)));}function write_num_pct2(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul);}function write_num_exp2(fmt,val){var o;var idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return "0.0E+0";else if(val<0)return "-"+write_num_exp2(fmt,-val);var period=fmt.indexOf(".");if(period===-1)period=fmt.indexOf("E");var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0)ee+=period;o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);if(!o.match(/[Ee]/)){var fakee=Math.floor(Math.log(val)*Math.LOG10E);if(o.indexOf(".")===-1)o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee);else o+="E+"+(fakee-ee);o=o.replace(/\+-/,"-");}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E";});}else o=val.toExponential(idx);if(fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/))o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1);if(fmt.match(/E\-/)&&o.match(/e\+/))o=o.replace(/e\+/,"e");return o.replace("e","E");}function write_num_int(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(val>=0)return write_num_int("n",ffmt,val);return "("+write_num_int("n",ffmt,-val)+")";}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm2(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct2(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp2(fmt,val);if(fmt.charCodeAt(0)===36)return "$"+write_num_int(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o;var r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0(aval,fmt.length);if(fmt.match(/^[#?]+$/)){o=""+val;if(val===0)o="";return o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o;}if(r=fmt.match(frac1))return write_num_f2(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1)){o=(""+val).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1]));o=o.replace(/\.(\d*)$/,function($$,$1){return "."+$1+fill("0",hashq(r[1]).length-$1.length);});return fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".");}fmt=fmt.replace(/^#+([0.])/,"$1");if(r=fmt.match(/^(0*)\.(#*)$/)){return sign+(""+aval).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");}if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(""+aval);if(r=fmt.match(/^#,##0\.([#0]*0)$/)){return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val)+"."+fill("0",r[1].length);}if(r=fmt.match(/^#,#*,#0/))return write_num_int(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/)){o=_strrev(write_num_int(type,fmt.replace(/[\\-]/g,""),val));ri=0;return _strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==="0"?"0":"";}));}if(fmt.match(phone)){o=write_num_int(type,"##########",val);return "("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);}var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(r[4].length,7);ff=frac(aval,Math.pow(10,ri)-1,false);o=""+sign;oa=write_num("n",r[1],ff[1]);if(oa.charAt(oa.length-1)==" ")oa=oa.substr(0,oa.length-1)+"0";o+=oa+r[2]+"/"+r[3];oa=rpad_(ff[2],ri);if(oa.length<r[4].length)oa=hashq(r[4].substr(r[4].length-oa.length))+oa;o+=oa;return o;}if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(Math.max(r[1].length,r[4].length),7);ff=frac(aval,Math.pow(10,ri)-1,true);return sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));}if(r=fmt.match(/^[#0?]+$/)){o=""+val;if(fmt.length<=o.length)return o;return hashq(fmt.substr(0,fmt.length-o.length))+o;}if(r=fmt.match(/^([#0]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1");ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres));}if(r=fmt.match(/^00,000\.([#0]*0)$/)){return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return "00,"+($$.length<3?pad0(0,3-$$.length):"")+$$;})+"."+pad0(0,r[1].length);}switch(fmt){case"###,###":case"##,###":case"#,###":var x=commaify(""+aval);return x!=="0"?sign+x:"";default:if(fmt.match(/\.[0#?]*$/))return write_num_int(type,fmt.slice(0,fmt.lastIndexOf(".")),val)+hashq(fmt.slice(fmt.lastIndexOf(".")));}throw new Error("unsupported format |"+fmt+"|");}return function write_num(type,fmt,val){return (val|0)===val?write_num_int(type,fmt,val):write_num_flt(type,fmt,val);};}();function split_fmt(fmt){var out=[];var in_str=false;/*, cc*/for(var i=0,j=0;i<fmt.length;++i){switch(/*cc=*/fmt.charCodeAt(i)){case 34:/* '"' */in_str=!in_str;break;case 95:case 42:case 92:/* '_' '*' '\\' */++i;break;case 59:/* ';' */out[out.length]=fmt.substr(j,i-j);j=i+1;}}out[out.length]=fmt.substr(j);if(in_str===true)throw new Error("Format |"+fmt+"| unterminated string ");return out;}SSF._split=split_fmt;var abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(fmt){var i=0,/*cc = 0,*/c="",o="";while(i<fmt.length){switch(c=fmt.charAt(i)){case"G":if(isgeneral(fmt,i))i+=6;i++;break;case'"':for(;/*cc=*/fmt.charCodeAt(++i)!==34&&i<fmt.length;){/*empty*/}++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2")return true;/* falls through */case"M":case"D":case"Y":case"H":case"S":case"E":/* falls through */case"m":case"d":case"y":case"h":case"s":case"e":case"g":return true;case"A":case"a":case"":if(fmt.substr(i,3).toUpperCase()==="A/P")return true;if(fmt.substr(i,5).toUpperCase()==="AM/PM")return true;if(fmt.substr(i,5).toUpperCase()==="/")return true;++i;break;case"[":o=c;while(fmt.charAt(i++)!=="]"&&i<fmt.length){o+=fmt.charAt(i);}if(o.match(abstime))return true;break;case".":/* falls through */case"0":case"#":while(i<fmt.length&&("0#?.,E+-%".indexOf(c=fmt.charAt(++i))>-1||c=="\\"&&fmt.charAt(i+1)=="-"&&"0#".indexOf(fmt.charAt(i+2))>-1)){/* empty */}break;case"?":while(fmt.charAt(++i)===c){/* empty */}break;case"*":++i;if(fmt.charAt(i)==" "||fmt.charAt(i)=="*")++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":while(i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1){/* empty */}break;case" ":++i;break;default:++i;break;}}return false;}SSF.is_date=fmt_is_date;function eval_fmt(fmt,v,opts,flen){var out=[],o="",i=0,c="",lst="t",dt,j,cc;var hr="H";/* Tokenize */while(i<fmt.length){switch(c=fmt.charAt(i)){case"G":/* General */if(!isgeneral(fmt,i))throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"G",v:"General"};i+=7;break;case'"':/* Literal text */for(o="";(cc=fmt.charCodeAt(++i))!==34&&i<fmt.length;){o+=String.fromCharCode(cc);}out[out.length]={t:"t",v:o};++i;break;case"\\":var w=fmt.charAt(++i),t=w==="("||w===")"?w:"t";out[out.length]={t:t,v:w};++i;break;case"_":out[out.length]={t:"t",v:" "};i+=2;break;case"@":/* Text Placeholder */out[out.length]={t:"T",v:v};++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2"){if(dt==null){dt=parse_date_code(v,opts,fmt.charAt(i+1)==="2");if(dt==null)return "";}out[out.length]={t:"X",v:fmt.substr(i,2)};lst=c;i+=2;break;}/* falls through */case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();/* falls through */case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(v<0)return "";if(dt==null){dt=parse_date_code(v,opts);if(dt==null)return "#####";}o=c;while(++i<fmt.length&&fmt.charAt(i).toLowerCase()===c){o+=c;}if(c==="m"&&lst.toLowerCase()==="h")c="M";if(c==="h")c=hr;out[out.length]={t:c,v:o};lst=c;break;case"A":case"a":case"":var q={t:c,v:c};if(dt==null)dt=parse_date_code(v,opts);if(fmt.substr(i,3).toUpperCase()==="A/P"){if(dt!=null)q.v=dt.H>=12?"P":"A";q.t="T";hr="h";i+=3;}else if(fmt.substr(i,5).toUpperCase()==="AM/PM"){if(dt!=null)q.v=dt.H>=12?"PM":"AM";q.t="T";i+=5;hr="h";}else if(fmt.substr(i,5).toUpperCase()==="/"){if(dt!=null)q.v=dt.H>=12?"":"";q.t="T";i+=5;hr="h";}else {q.t="t";++i;}if(dt==null&&q.t==="T")return "";out[out.length]=q;lst=c;break;case"[":o=c;while(fmt.charAt(i++)!=="]"&&i<fmt.length){o+=fmt.charAt(i);}if(o.slice(-1)!=="]")throw 'unterminated "[" block: |'+o+"|";if(o.match(abstime)){if(dt==null){dt=parse_date_code(v,opts);if(dt==null)return "";}out[out.length]={t:"Z",v:o.toLowerCase()};lst=o.charAt(1);}else if(o.indexOf("$")>-1){o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$";if(!fmt_is_date(fmt))out[out.length]={t:"t",v:o};}break;/* Numbers */case".":if(dt!=null){o=c;while(++i<fmt.length&&(c=fmt.charAt(i))==="0"){o+=c;}out[out.length]={t:"s",v:o};break;}/* falls through */case"0":case"#":o=c;while(++i<fmt.length&&"0#?.,E+-%".indexOf(c=fmt.charAt(i))>-1){o+=c;}out[out.length]={t:"n",v:o};break;case"?":o=c;while(fmt.charAt(++i)===c){o+=c;}out[out.length]={t:c,v:o};lst=c;break;case"*":++i;if(fmt.charAt(i)==" "||fmt.charAt(i)=="*")++i;break;// **
  case"(":case")":out[out.length]={t:flen===1?"t":c,v:c};++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o=c;while(i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1){o+=fmt.charAt(i);}out[out.length]={t:"D",v:o};break;case" ":out[out.length]={t:c,v:c};++i;break;case"$":out[out.length]={t:"t",v:"$"};++i;break;default:// if ("BsBrFtRs.krLmPQRSkRpR$S/.NTz,$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);
  if("BsBrFtRs.krLmPQRSkRpR$S/.NTz,$-+/():!^&'~{}<>=acfijklopqrtuvwxzP$LekdinAf$dhAflRial?BirrKzMOPPGKRsGsB/R$levkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLLLtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$krGELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGXsomWSTNT$FtDramRpZMWFCFA".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"t",v:c};++i;break;}}/* Scan for date/time parts */var bt=0,ss0=0,ssm;for(i=out.length-1,lst="t";i>=0;--i){switch(out[i].t){case"h":case"H":out[i].t=hr;lst="h";if(bt<1)bt=1;break;case"s":if(ssm=out[i].v.match(/\.0+$/))ss0=Math.max(ss0,ssm[0].length-1);if(bt<3)bt=3;/* falls through */case"d":case"y":case"M":case"e":lst=out[i].t;break;case"m":if(lst==="s"){out[i].t="M";if(bt<2)bt=2;}break;case"X":/*if(out[i].v === "B2");*/break;case"Z":if(bt<1&&out[i].v.match(/[Hh]/))bt=1;if(bt<2&&out[i].v.match(/[Mm]/))bt=2;if(bt<3&&out[i].v.match(/[Ss]/))bt=3;}}/* time rounding depends on presence of minute / second / usec fields */switch(bt){case 0:break;case 1:if(dt.u>=0.5){dt.u=0;++dt.S;}if(dt.S>=60){dt.S=0;++dt.M;}if(dt.M>=60){dt.M=0;++dt.H;}break;case 2:if(dt.u>=0.5){dt.u=0;++dt.S;}if(dt.S>=60){dt.S=0;++dt.M;}break;}/* replace fields */var nstr="",jj;for(i=0;i<out.length;++i){switch(out[i].t){case"t":case"T":case" ":case"D":break;case"X":out[i].v="";out[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":out[i].v=write_date(out[i].t.charCodeAt(0),out[i].v,dt,ss0);out[i].t="t";break;case"n":case"?":jj=i+1;while(out[jj]!=null&&((c=out[jj].t)==="?"||c==="D"||(c===" "||c==="t")&&out[jj+1]!=null&&(out[jj+1].t==="?"||out[jj+1].t==="t"&&out[jj+1].v==="/")||out[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(out[jj].v==="/"||out[jj].v===" "&&out[jj+1]!=null&&out[jj+1].t=="?"))){out[i].v+=out[jj].v;out[jj]={v:"",t:";"};++jj;}nstr+=out[i].v;i=jj-1;break;case"G":out[i].t="t";out[i].v=general_fmt(v,opts);break;}}var vv="",myv,ostr;if(nstr.length>0){if(nstr.charCodeAt(0)==40){/* '(' */myv=v<0&&nstr.charCodeAt(0)===45?-v:v;ostr=write_num("n",nstr,myv);}else {myv=v<0&&flen>1?-v:v;ostr=write_num("n",nstr,myv);if(myv<0&&out[0]&&out[0].t=="t"){ostr=ostr.substr(1);out[0].v="-"+out[0].v;}}jj=ostr.length-1;var decpt=out.length;for(i=0;i<out.length;++i){if(out[i]!=null&&out[i].t!="t"&&out[i].v.indexOf(".")>-1){decpt=i;break;}}var lasti=out.length;if(decpt===out.length&&ostr.indexOf("E")===-1){for(i=out.length-1;i>=0;--i){if(out[i]==null||"n?".indexOf(out[i].t)===-1)continue;if(jj>=out[i].v.length-1){jj-=out[i].v.length;out[i].v=ostr.substr(jj+1,out[i].v.length);}else if(jj<0)out[i].v="";else {out[i].v=ostr.substr(0,jj+1);jj=-1;}out[i].t="t";lasti=i;}if(jj>=0&&lasti<out.length)out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v;}else if(decpt!==out.length&&ostr.indexOf("E")===-1){jj=ostr.indexOf(".")-1;for(i=decpt;i>=0;--i){if(out[i]==null||"n?".indexOf(out[i].t)===-1)continue;j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")-1:out[i].v.length-1;vv=out[i].v.substr(j+1);for(;j>=0;--j){if(jj>=0&&(out[i].v.charAt(j)==="0"||out[i].v.charAt(j)==="#"))vv=ostr.charAt(jj--)+vv;}out[i].v=vv;out[i].t="t";lasti=i;}if(jj>=0&&lasti<out.length)out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v;jj=ostr.indexOf(".")+1;for(i=decpt;i<out.length;++i){if(out[i]==null||"n?(".indexOf(out[i].t)===-1&&i!==decpt)continue;j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")+1:0;vv=out[i].v.substr(0,j);for(;j<out[i].v.length;++j){if(jj<ostr.length)vv+=ostr.charAt(jj++);}out[i].v=vv;out[i].t="t";lasti=i;}}}for(i=0;i<out.length;++i){if(out[i]!=null&&"n?".indexOf(out[i].t)>-1){myv=flen>1&&v<0&&i>0&&out[i-1].v==="-"?-v:v;out[i].v=write_num(out[i].t,out[i].v,myv);out[i].t="t";}}var retval="";for(i=0;i!==out.length;++i){if(out[i]!=null)retval+=out[i].v;}return retval;}SSF._eval=eval_fmt;var cfregex=/\[[=<>]/;var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(v,rr){if(rr==null)return false;var thresh=parseFloat(rr[2]);switch(rr[1]){case"=":if(v==thresh)return true;break;case">":if(v>thresh)return true;break;case"<":if(v<thresh)return true;break;case"<>":if(v!=thresh)return true;break;case">=":if(v>=thresh)return true;break;case"<=":if(v<=thresh)return true;break;}return false;}function choose_fmt(f,v){var fmt=split_fmt(f);var l=fmt.length,lat=fmt[l-1].indexOf("@");if(l<4&&lat>-1)--l;if(fmt.length>4)throw new Error("cannot find right format for |"+fmt.join("|")+"|");if(typeof v!=="number")return [4,fmt.length===4||lat>-1?fmt[fmt.length-1]:"@"];switch(fmt.length){case 1:fmt=lat>-1?["General","General","General",fmt[0]]:[fmt[0],fmt[0],fmt[0],"@"];break;case 2:fmt=lat>-1?[fmt[0],fmt[0],fmt[0],fmt[1]]:[fmt[0],fmt[1],fmt[0],"@"];break;case 3:fmt=lat>-1?[fmt[0],fmt[1],fmt[0],fmt[2]]:[fmt[0],fmt[1],fmt[2],"@"];break;}var ff=v>0?fmt[0]:v<0?fmt[1]:fmt[2];if(fmt[0].indexOf("[")===-1&&fmt[1].indexOf("[")===-1)return [l,ff];if(fmt[0].match(cfregex)!=null||fmt[1].match(cfregex)!=null){var m1=fmt[0].match(cfregex2);var m2=fmt[1].match(cfregex2);return chkcond(v,m1)?[l,fmt[0]]:chkcond(v,m2)?[l,fmt[1]]:[l,fmt[m1!=null&&m2!=null?2:1]];}return [l,ff];}function format(fmt,v,o){if(o==null)o={};var sfmt="";switch(_typeof$1(fmt)){case"string":if(fmt=="m/d/yy"&&o.dateNF)sfmt=o.dateNF;else sfmt=fmt;break;case"number":if(fmt==14&&o.dateNF)sfmt=o.dateNF;else sfmt=(o.table!=null?o.table:table_fmt)[fmt];if(sfmt==null)sfmt=o.table&&o.table[default_map[fmt]]||table_fmt[default_map[fmt]];if(sfmt==null)sfmt=default_str[fmt]||"General";break;}//new runze   
  //"w":22500  "w0":22500  "w0.0":22500.2  "w0.00":22500.23......
  var reg=/^(w|W)((0?)|(0\.0+))$/;if(!!sfmt.match(reg)){if(isNaN(v)){return v;}//var v =300101886.436;
  var acc=sfmt.slice(1);//0/0.0/0.00
  var isNegative=false;if(!isNaN(v)&&Number(v)<0){isNegative=true;v=Math.abs(v);}var vInt=parseInt(v);var vlength=vInt.toString().length;if(vlength>4){if(vlength>8){var y=parseInt(v/100000000);//
  var w=parseInt(parseFloat(v).subtract(y*100000000)/10000);//
  var q=parseFloat(v).subtract(y*100000000+w*10000);//
  if(acc!=""){q=numeral(q).format(acc);//
  }v=y+""+w+""+q;}else {var w=parseInt(v/10000);//
  var q=parseFloat(v).subtract(w*10000);//
  if(acc!=""){q=numeral(q).format(acc);//
  }v=w+""+q;}if(v.indexOf("00")!=-1){v=v.replace("00","");}else if(v.indexOf("0")!=-1){v=v.replace("0","");}else if(v.indexOf("0")!=-1){v=v.replace("0","");}//360 V9
  if(v.indexOf("")!=-1&&v.indexOf("")==-1){//1/1111 => 1/10111
  var afterYi=v.substring(v.indexOf("")+1);if(afterYi.substring(0,1)!=="."&&afterYi!=""){switch((parseInt(afterYi)+"").length){case 1:afterYi="000"+afterYi;break;case 2:afterYi="00"+afterYi;break;case 3:afterYi="0"+afterYi;break;}v=v.substring(0,v.indexOf("")+1)+afterYi;}}else if(v.indexOf("")==-1&&v.indexOf("")!=-1){//30011
  var afterWan=v.substring(v.indexOf("")+1);if(afterWan.substring(0,1)!=="."&&afterWan!=""){switch((parseInt(afterWan)+"").length){case 1:afterWan="000"+afterWan;break;case 2:afterWan="00"+afterWan;break;case 3:afterWan="0"+afterWan;break;}v=v.substring(0,v.indexOf("")+1)+afterWan;}}else if(v.indexOf("")!=-1&&v.indexOf("")!=-1){//100530611
  var afterYi=v.substring(v.indexOf("")+1,v.indexOf("")),afterWan=v.substring(v.indexOf("")+1);switch((parseInt(afterYi)+"").length){case 1:afterYi="000"+afterYi;break;case 2:afterYi="00"+afterYi;break;case 3:afterYi="0"+afterYi;break;}v=v.substring(0,v.indexOf("")+1)+afterYi+v.substring(v.indexOf(""));if(afterWan.substring(0,1)!=="."&&afterWan!=""){switch((parseInt(afterWan)+"").length){case 1:afterWan="000"+afterWan;break;case 2:afterWan="00"+afterWan;break;case 3:afterWan="0"+afterWan;break;}v=v.substring(0,v.indexOf("")+1)+afterWan;}}}else {if(acc!=""){v=numeral(v).format(acc);//
  }}if(isNegative){return "-"+v;}else {return v;}}if(isgeneral(sfmt,0))return general_fmt(v,o);if(v instanceof Date)v=datenum_local(v,o.date1904);var f=choose_fmt(sfmt,v);if(isgeneral(f[1]))return general_fmt(v,o);if(v===true)v="TRUE";else if(v===false)v="FALSE";else if(v===""||v==null)return "";return eval_fmt(f[1],v,o,f[0]);}function load_entry(fmt,idx){if(typeof idx!="number"){idx=+idx||-1;for(var i=0;i<0x0188;++i){if(table_fmt[i]==undefined){if(idx<0)idx=i;continue;}if(table_fmt[i]==fmt){idx=i;break;}}if(idx<0)idx=0x187;}table_fmt[idx]=fmt;return idx;}SSF.load=load_entry;SSF._table=table_fmt;SSF.get_table=function get_table(){return table_fmt;};SSF.load_table=function load_table(tbl){for(var i=0;i!=0x0188;++i){if(tbl[i]!==undefined)load_entry(tbl[i],i);}};SSF.init_table=init_table;SSF.format=format;};make_ssf(SSF);var base1904=new Date(1900,2,1,0,0,0);function datenum_local(v,date1904){var epoch=Date.UTC(v.getFullYear(),v.getMonth(),v.getDate(),v.getHours(),v.getMinutes(),v.getSeconds());var dnthresh_utc=Date.UTC(1899,11,31,0,0,0);if(date1904)epoch-=1461*24*60*60*1000;else if(v>=base1904)epoch+=24*60*60*1000;return (epoch-dnthresh_utc)/(24*60*60*1000);}var good_pd_date=new Date("2017-02-19T19:06:09.000Z");if(Number.isNaN(good_pd_date.getFullYear()))good_pd_date=new Date("2/19/17");var good_pd=good_pd_date.getFullYear()===2017;function parseDate(str,fixdate){var d=new Date(str);if(good_pd){if(!lodash.isNil(fixdate)){if(fixdate>0)d.setTime(d.getTime()+d.getTimezoneOffset()*60*1000);else if(fixdate<0)d.setTime(d.getTime()-d.getTimezoneOffset()*60*1000);}return d;}if(str instanceof Date)return str;if(good_pd_date.getFullYear()===1917&&!Number.isNaN(d.getFullYear())){var s=d.getFullYear();if(str.indexOf("".concat(s))>-1)return d;d.setFullYear(d.getFullYear()+100);return d;}var n=str.match(/\d+/g)||["2017","2","19","0","0","0"];var out=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);if(str.indexOf("Z")>-1)out=new Date(out.getTime()-out.getTimezoneOffset()*60*1000);return out;}function genarate(value){var m=null;var ct={};var v=value;if(lodash.isNil(value)){return null;}if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(value)){value=value;m=value;v=Number(value.split(".")[0].replace(",",""));var fa="#,##0";if(value.split(".")[1]){fa="#,##0.";for(var i=0;i<value.split(".")[1].length;i+=1){fa+=0;}}ct={fa:fa,t:"n"};}else if(value.toString().substring(0,1)==="'"){m=value.toString().substring(1);ct={fa:"@",t:"s"};}else if(value.toString().toUpperCase()==="TRUE"){m="TRUE";ct={fa:"General",t:"b"};v=true;}else if(value.toString().toUpperCase()==="FALSE"){m="FALSE";ct={fa:"General",t:"b"};v=false;}else if(valueIsError(value.toString())){m=value.toString();ct={fa:"General",t:"e"};}else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(value)){m=value.toString();ct={fa:"@",t:"s"};}else if(isRealNum(value)&&Math.abs(parseFloat(value))>0&&(Math.abs(parseFloat(value))>=1e11||Math.abs(parseFloat(value))<1e-9)){v=numeral(value).value();var str=v.toExponential();if(str.indexOf(".")>-1){var strlen=str.split(".")[1].split("e")[0].length;if(strlen>5){strlen=5;}ct={fa:"#0.".concat(new Array(strlen+1).join("0"),"E+00"),t:"n"};}else {ct={fa:"#0.E+00",t:"n"};}m=SSF.format(ct.fa,v);}else if(value.toString().indexOf("%")>-1){var index=value.toString().indexOf("%");var value2=value.toString().substring(0,index);var value3=value2.replace(/,/g,"");if(index===value.toString().length-1&&isRealNum(value3)){if(value2.indexOf(".")>-1){if(value2.indexOf(".")===value2.lastIndexOf(".")){var value4=value2.split(".")[0];var value5=value2.split(".")[1];var len=value5.length;if(len>9){len=9;}if(value4.indexOf(",")>-1){var isThousands=true;var ThousandsArr=value4.split(",");for(var _i=1;_i<ThousandsArr.length;_i+=1){if(ThousandsArr[_i].length<3){isThousands=false;break;}}if(isThousands){ct={fa:"#,##0.".concat(new Array(len+1).join("0"),"%"),t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}else {m=value.toString();ct={fa:"@",t:"s"};}}else {ct={fa:"0.".concat(new Array(len+1).join("0"),"%"),t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}}else {m=value.toString();ct={fa:"@",t:"s"};}}else if(value2.indexOf(",")>-1){var _isThousands=true;var _ThousandsArr=value2.split(",");for(var _i2=1;_i2<_ThousandsArr.length;_i2+=1){if(_ThousandsArr[_i2].length<3){_isThousands=false;break;}}if(_isThousands){ct={fa:"#,##0%",t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}else {m=value.toString();ct={fa:"@",t:"s"};}}else {ct={fa:"0%",t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}}else {m=value.toString();ct={fa:"@",t:"s"};}}else if(value.toString().indexOf(".")>-1){if(value.toString().indexOf(".")===value.toString().lastIndexOf(".")){var value1=value.toString().split(".")[0];var _value=value.toString().split(".")[1];var _len=_value.length;if(_len>9){_len=9;}if(value1.indexOf(",")>-1){var _isThousands2=true;var _ThousandsArr2=value1.split(",");for(var _i3=1;_i3<_ThousandsArr2.length;_i3+=1){if(!isRealNum(_ThousandsArr2[_i3])||_ThousandsArr2[_i3].length<3){_isThousands2=false;break;}}if(_isThousands2){ct={fa:"#,##0.".concat(new Array(_len+1).join("0")),t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}else {m=value.toString();ct={fa:"@",t:"s"};}}else {if(isRealNum(value1)&&isRealNum(_value)){ct={fa:"0.".concat(new Array(_len+1).join("0")),t:"n"};v=numeral(value).value();m=SSF.format(ct.fa,v);}else {m=value.toString();ct={fa:"@",t:"s"};}}}else {m=value.toString();ct={fa:"@",t:"s"};}}else if(isRealNum(value)){m=value.toString();ct={fa:"General",t:"n"};v=parseFloat(value);}else if(isdatetime(value)&&(value.toString().indexOf(".")>-1||value.toString().indexOf(":")>-1||value.toString().length<16)){v=datenum_local(parseDate(value.toString().replace(/-/g,"/")));if(v.toString().indexOf(".")>-1){if(value.toString().length>18){ct.fa="yyyy-MM-dd hh:mm:ss";}else if(value.toString().length>11){ct.fa="yyyy-MM-dd hh:mm";}else {ct.fa="yyyy-MM-dd";}}else {ct.fa="yyyy-MM-dd";}ct.t="d";m=SSF.format(ct.fa,v);}else {m=value;ct.fa="General";ct.t="g";}return [m,ct,v];}function update(fmt,v){return SSF.format(fmt,v);}function is_date(fmt,v){return SSF.is_date(fmt,v);}function fuzzynum(s){var v=Number(s);if(typeof s==="number"){return s;}if(!Number.isNaN(v))return v;var wt=1;var ss=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){wt*=100;return "";});v=Number(ss);if(!Number.isNaN(v))return v/wt;ss=ss.replace(/[(](.*)[)]/,function($$,$1){wt=-wt;return $1;});v=Number(ss);if(!Number.isNaN(v))return v/wt;return v;}function valueShowEs(r,c,d){var value=getCellValue(r,c,d,"m");if(value==null){value=getCellValue(r,c,d,"v");}else {var _d$r,_d$r$c,_d$r$c$ct,_d$r2,_d$r2$c,_d$r2$c$ct;if(!Number.isNaN(fuzzynum(value))){if(lodash.isString(value)&&value.indexOf("%")>-1);else {value=getCellValue(r,c,d,"v");}}else if(((_d$r=d[r])===null||_d$r===void 0?void 0:(_d$r$c=_d$r[c])===null||_d$r$c===void 0?void 0:(_d$r$c$ct=_d$r$c.ct)===null||_d$r$c$ct===void 0?void 0:_d$r$c$ct.t)==="d");else if(((_d$r2=d[r])===null||_d$r2===void 0?void 0:(_d$r2$c=_d$r2[c])===null||_d$r2$c===void 0?void 0:(_d$r2$c$ct=_d$r2$c.ct)===null||_d$r2$c$ct===void 0?void 0:_d$r2$c$ct.t)==="b");else {value=getCellValue(r,c,d,"v");}}return value;}var colors=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];function rowLocationByIndex(row_index,visibleRow){var row=0;var row_pre=0;row=visibleRow[row_index];if(row_index===0){row_pre=0;}else {row_pre=visibleRow[row_index-1];}return [row_pre,row,row_index];}function rowLocation(y,visibleRow){var row_index=lodash.sortedIndex(visibleRow,y);if(row_index>=visibleRow.length&&y>0){row_index=visibleRow.length-1;}else if(row_index===-1&&y<=0){row_index=0;}return rowLocationByIndex(row_index,visibleRow);}function colLocationByIndex(col_index,visibleCol){var col=0;var col_pre=0;col=visibleCol[col_index];if(col_index===0){col_pre=0;}else {col_pre=visibleCol[col_index-1];}return [col_pre,col,col_index];}function colLocation(x,visibleCol){var col_index=lodash.sortedIndex(visibleCol,x);if(col_index>=visibleCol.length&&x>0){col_index=visibleCol.length-1;}else if(col_index===-1&&x<=0){col_index=0;}return colLocationByIndex(col_index,visibleCol);}var functionHTMLIndex=0;var operatorPriority={"^":0,"%":1,"*":1,"/":1,"+":2,"-":2};var operatorArr="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^".split("|");var operatorjson={};for(var i=0;i<operatorArr.length;i+=1){operatorjson[operatorArr[i].toString()]=1;}var FormulaCache=/*#__PURE__*/function(){function FormulaCache(){_classCallCheck$2(this,FormulaCache);this.parser=void 0;this.func_selectedrange=void 0;this.data_parm_index=void 0;this.cellTextToIndexList=void 0;this.rangechangeindex=void 0;this.selectingRangeIndex=void 0;this.rangeResizeObj=void 0;this.rangeResize=void 0;this.rangeResizeIndex=void 0;this.rangeResizexy=void 0;this.rangeResizeWinH=void 0;this.rangeResizeWinW=void 0;this.rangeResizeTo=void 0;this.rangeSetValueTo=void 0;this.rangeIndex=void 0;this.rangestart=void 0;this.rangetosheet=void 0;this.rangedrag_column_start=void 0;this.rangedrag_row_start=void 0;this.functionRangeIndex=void 0;this.functionlistMap=void 0;this.execFunctionExist=void 0;this.execFunctionGlobalData=void 0;var that=this;this.data_parm_index=0;this.selectingRangeIndex=-1;this.functionlistMap={};this.execFunctionGlobalData={};this.cellTextToIndexList={};this.parser=new Parser$1();this.parser.on("callCellValue",function(cellCoord,done){var _context$formulaCache,_flowdata$cellCoord$r;var context=that.parser.context;var flowdata=getFlowdata(context);var id=context===null||context===void 0?void 0:context.currentSheetId;var cell=(context===null||context===void 0?void 0:(_context$formulaCache=context.formulaCache.execFunctionGlobalData)===null||_context$formulaCache===void 0?void 0:_context$formulaCache["".concat(cellCoord.row.index,"_").concat(cellCoord.column.index,"_").concat(id)])||(flowdata===null||flowdata===void 0?void 0:(_flowdata$cellCoord$r=flowdata[cellCoord.row.index])===null||_flowdata$cellCoord$r===void 0?void 0:_flowdata$cellCoord$r[cellCoord.column.index]);var v=that.tryGetCellAsNumber(cell);done(v);});this.parser.on("callRangeValue",function(startCellCoord,endCellCoord,done){var context=that.parser.context;var flowdata=getFlowdata(context);var id=context===null||context===void 0?void 0:context.currentSheetId;var fragment=[];for(var row=startCellCoord.row.index;row<=endCellCoord.row.index;row+=1){var colFragment=[];for(var col=startCellCoord.column.index;col<=endCellCoord.column.index;col+=1){var _context$formulaCache2,_flowdata$row;var cell=(context===null||context===void 0?void 0:(_context$formulaCache2=context.formulaCache.execFunctionGlobalData)===null||_context$formulaCache2===void 0?void 0:_context$formulaCache2["".concat(row,"_").concat(col,"_").concat(id)])||(flowdata===null||flowdata===void 0?void 0:(_flowdata$row=flowdata[row])===null||_flowdata$row===void 0?void 0:_flowdata$row[col]);var v=that.tryGetCellAsNumber(cell);colFragment.push(v);}fragment.push(colFragment);}if(fragment){done(fragment);}});}_createClass$2(FormulaCache,[{key:"tryGetCellAsNumber",value:function tryGetCellAsNumber(cell){var _cell$ct;if((cell===null||cell===void 0?void 0:(_cell$ct=cell.ct)===null||_cell$ct===void 0?void 0:_cell$ct.t)==="n"){var n=Number(cell===null||cell===void 0?void 0:cell.v);return Number.isNaN(n)?cell.v:n;}return cell===null||cell===void 0?void 0:cell.v;}}]);return FormulaCache;}();function parseElement(eleString){return new DOMParser().parseFromString(eleString,"text/html").body.childNodes[0];}function iscelldata(txt){var val=txt.split("!");var rangetxt;if(val.length>1){var _val=_slicedToArray$3(val,2);rangetxt=_val[1];}else {var _val2=_slicedToArray$3(val,1);rangetxt=_val2[0];}var reg_cell=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g;var reg_cellRange=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(rangetxt.indexOf(":")===-1){var _row=parseInt(rangetxt.replace(/[^0-9]/g,""),10)-1;var _col=columnCharToIndex(rangetxt.replace(/[^A-Za-z]/g,""));if(!Number.isNaN(_row)&&!Number.isNaN(_col)&&rangetxt.toString().match(reg_cell)){return true;}if(!Number.isNaN(_row)){return false;}if(!Number.isNaN(_col)){return false;}return false;}reg_cellRange=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g;var rangetxtArr=rangetxt.split(":");var row=[];var col=[];row[0]=parseInt(rangetxtArr[0].replace(/[^0-9]/g,""),10)-1;row[1]=parseInt(rangetxtArr[1].replace(/[^0-9]/g,""),10)-1;if(row[0]>row[1]){return false;}col[0]=columnCharToIndex(rangetxtArr[0].replace(/[^A-Za-z]/g,""));col[1]=columnCharToIndex(rangetxtArr[1].replace(/[^A-Za-z]/g,""));if(col[0]>col[1]){return false;}if(rangetxtArr[0].toString().match(reg_cellRange)&&rangetxtArr[1].toString().match(reg_cellRange)){return true;}return false;}function addToCellIndexList(ctx,txt,infoObj){if(lodash.isNil(txt)||txt.length===0||lodash.isNil(infoObj)){return;}if(lodash.isNil(ctx.formulaCache.cellTextToIndexList)){ctx.formulaCache.cellTextToIndexList={};}if(txt.indexOf("!")>-1){txt=txt.replace(/\\'/g,"'").replace(/''/g,"'");ctx.formulaCache.cellTextToIndexList[txt]=infoObj;}else {ctx.formulaCache.cellTextToIndexList["".concat(txt,"_").concat(infoObj.sheetId)]=infoObj;}}function getcellrange(ctx,txt,formulaId){if(lodash.isNil(txt)||txt.length===0){return null;}var flowdata=getFlowdata(ctx);var sheettxt="";var rangetxt="";var sheetId=null;var sheetdata=null;var luckysheetfile=ctx.luckysheetfile;if(txt.indexOf("!")>-1){if(txt in ctx.formulaCache.cellTextToIndexList){return ctx.formulaCache.cellTextToIndexList[txt];}var val=txt.split("!");var _val3=_slicedToArray$3(val,2);sheettxt=_val3[0];rangetxt=_val3[1];sheettxt=sheettxt.replace(/\\'/g,"'").replace(/''/g,"'");if(sheettxt.substring(0,1)==="'"&&sheettxt.substring(sheettxt.length-1,1)==="'"){sheettxt=sheettxt.substring(1,sheettxt.length-1);}lodash.forEach(luckysheetfile,function(f){if(sheettxt===f.name){sheetId=f.id;sheetdata=f.data;return false;}return true;});}else {var _i=formulaId;if(lodash.isNil(_i)){_i=ctx.currentSheetId;}if("".concat(txt,"_").concat(_i)in ctx.formulaCache.cellTextToIndexList){return ctx.formulaCache.cellTextToIndexList["".concat(txt,"_").concat(_i)];}var index=getSheetIndex(ctx,_i);if(lodash.isNil(index)){return null;}sheettxt=luckysheetfile[index].name;sheetId=luckysheetfile[index].id;sheetdata=flowdata;rangetxt=txt;}if(lodash.isNil(sheetdata)){return null;}if(rangetxt.indexOf(":")===-1){var _row2=parseInt(rangetxt.replace(/[^0-9]/g,""),10)-1;var _col2=columnCharToIndex(rangetxt.replace(/[^A-Za-z]/g,""));if(!Number.isNaN(_row2)&&!Number.isNaN(_col2)){var _item={row:[_row2,_row2],column:[_col2,_col2],sheetId:sheetId};addToCellIndexList(ctx,txt,_item);return _item;}return null;}var rangetxtArr=rangetxt.split(":");var row=[];var col=[];row[0]=parseInt(rangetxtArr[0].replace(/[^0-9]/g,""),10)-1;row[1]=parseInt(rangetxtArr[1].replace(/[^0-9]/g,""),10)-1;if(Number.isNaN(row[0])){row[0]=0;}if(Number.isNaN(row[1])){row[1]=sheetdata.length-1;}if(row[0]>row[1]){return null;}col[0]=columnCharToIndex(rangetxtArr[0].replace(/[^A-Za-z]/g,""));col[1]=columnCharToIndex(rangetxtArr[1].replace(/[^A-Za-z]/g,""));if(Number.isNaN(col[0])){col[0]=0;}if(Number.isNaN(col[1])){col[1]=sheetdata[0].length-1;}if(col[0]>col[1]){return null;}var item={row:row,column:col,sheetId:sheetId};addToCellIndexList(ctx,txt,item);return item;}function calPostfixExpression(cal){if(cal.length===0){return "";}var stack=[];for(var _i2=cal.length-1;_i2>=0;_i2-=1){var c=cal[_i2];if(c in operatorjson){var s2=stack.pop();var s1=stack.pop();var str="luckysheet_compareWith(".concat(s1,",'").concat(c,"', ").concat(s2,")");stack.push(str);}else {stack.push(c);}}if(stack.length>0){return stack[0];}return "";}function checkSpecialFunctionRange(ctx,function_str,r,c,id,dynamicArray_compute,cellRangeFunction){if(function_str.substring(0,30)==="luckysheet_getSpecialReference"||function_str.substring(0,20)==="luckysheet_function."){if(function_str.substring(0,20)==="luckysheet_function."){var funcName=function_str.split(".")[1];if(!lodash.isNil(funcName)){funcName=funcName.toUpperCase();if(funcName!=="INDIRECT"&&funcName!=="OFFSET"&&funcName!=="INDEX"){return;}}}try{ctx.calculateSheetId=id;var str=new Function("return ".concat(function_str))();if(str instanceof Object&&!lodash.isNil(str.startCell)){str=str.startCell;}var str_nb=lodash.trim(str);if(iscelldata(str_nb)){if(typeof cellRangeFunction==="function"){cellRangeFunction(str_nb);}}}catch(_unused){}}}function isFunctionRange(ctx,txt,r,c,id,dynamicArray_compute,cellRangeFunction){if(txt.substring(0,1)==="="){txt=txt.substring(1);}var funcstack=txt.split("");var i=0;var str="";var function_str="";var matchConfig={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0};var cal1=[];var cal2=[];var bracket=[];while(i<funcstack.length){var s=funcstack[i];if(s==="("&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){if(str.length>0&&bracket.length===0){str=str.toUpperCase();if(str.indexOf(":")>-1){var funcArray=str.split(":");function_str+="luckysheet_getSpecialReference(true,'".concat(lodash.trim(funcArray[0]).replace(/'/g,"\\'"),"', luckysheet_function.").concat(funcArray[1],".f(#lucky#");}else {function_str+="luckysheet_function.".concat(str,".f(");}bracket.push(1);str="";}else if(bracket.length===0){function_str+="(";bracket.push(0);str="";}else {bracket.push(0);str+=s;}}else if(s===")"&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){bracket.pop();if(bracket.length===0){var functionS=isFunctionRange(ctx,str,r,c,id,dynamicArray_compute,cellRangeFunction);if(functionS.indexOf("#lucky#")>-1){functionS="".concat(functionS.replace(/#lucky#/g,""),")");}function_str+="".concat(functionS,")");str="";}else {str+=s;}}else if(s==="{"&&matchConfig.squote===0&&matchConfig.dquote===0){str+="{";matchConfig.braces+=1;}else if(s==="}"&&matchConfig.squote===0&&matchConfig.dquote===0){str+="}";matchConfig.braces-=1;}else if(s==='"'&&matchConfig.squote===0){if(matchConfig.dquote>0){if(i<funcstack.length-1&&funcstack[i+1]==='"'){i+=1;str+="\x7F";}else {matchConfig.dquote-=1;str+='"';}}else {matchConfig.dquote+=1;str+='"';}}else if(s==="'"&&matchConfig.dquote===0){str+="'";if(matchConfig.squote>0){if(i<funcstack.length-1&&funcstack[i+1]==="'"){i+=1;str+="'";}else {matchConfig.squote-=1;}}else {matchConfig.squote+=1;}}else if(s===","&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){if(bracket.length<=1){var _functionS=isFunctionRange(ctx,str,r,c,id,dynamicArray_compute,cellRangeFunction);if(_functionS.indexOf("#lucky#")>-1){_functionS="".concat(_functionS.replace(/#lucky#/g,""),")");}function_str+="".concat(_functionS,",");str="";}else {str+=",";}}else if(s in operatorjson&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){var s_next="";var op=operatorPriority;if(i+1<funcstack.length){s_next=funcstack[i+1];}if(s+s_next in operatorjson){if(bracket.length===0){if(lodash.trim(str).length>0){cal2.unshift(isFunctionRange(ctx,lodash.trim(str),r,c,id,dynamicArray_compute,cellRangeFunction));}else if(lodash.trim(function_str).length>0){cal2.unshift(lodash.trim(function_str));}if(cal1[0]in operatorjson){var stackCeilPri=op[cal1[0]];while(cal1.length>0&&!lodash.isNil(stackCeilPri)){cal2.unshift(cal1.shift());stackCeilPri=op[cal1[0]];}}cal1.unshift(s+s_next);function_str="";str="";}else {str+=s+s_next;}i+=1;}else {if(bracket.length===0){if(lodash.trim(str).length>0){cal2.unshift(isFunctionRange(ctx,lodash.trim(str),r,c,id,dynamicArray_compute,cellRangeFunction));}else if(lodash.trim(function_str).length>0){cal2.unshift(lodash.trim(function_str));}if(cal1[0]in operatorjson){var _stackCeilPri=op[cal1[0]];_stackCeilPri=lodash.isNil(_stackCeilPri)?1000:_stackCeilPri;var sPri=op[s];sPri=lodash.isNil(sPri)?1000:sPri;while(cal1.length>0&&sPri>=_stackCeilPri){cal2.unshift(cal1.shift());_stackCeilPri=op[cal1[0]];_stackCeilPri=lodash.isNil(_stackCeilPri)?1000:_stackCeilPri;}}cal1.unshift(s);function_str="";str="";}else {str+=s;}}}else {if(matchConfig.dquote===0&&matchConfig.squote===0){str+=lodash.trim(s);}else {str+=s;}}if(i===funcstack.length-1){var endstr="";var str_nb=lodash.trim(str).replace(/'/g,"\\'");if(iscelldata(str_nb)&&str_nb.substring(0,1)!==":"){endstr="luckysheet_getcelldata('".concat(str_nb,"')");}else if(str_nb.substring(0,1)===":"){str_nb=str_nb.substring(1);if(iscelldata(str_nb)){endstr="luckysheet_getSpecialReference(false,".concat(function_str,",'").concat(str_nb,"')");}}else {str=lodash.trim(str);var regx=/{.*?}/;if(regx.test(str)&&str.substring(0,1)!=='"'&&str.substring(str.length-1,1)!=='"'){var _regx$exec;var arraytxt=(_regx$exec=regx.exec(str))===null||_regx$exec===void 0?void 0:_regx$exec[0];var arraystart=str.search(regx);if(arraystart>0){endstr+=str.substring(0,arraystart);}endstr+="luckysheet_getarraydata('".concat(arraytxt,"')");if(arraystart+arraytxt.length<str.length){endstr+=str.substring(arraystart+arraytxt.length,str.length);}}else {endstr=str;}}if(endstr.length>0){cal2.unshift(endstr);}if(cal1.length>0){if(function_str.length>0){cal2.unshift(function_str);function_str="";}while(cal1.length>0){cal2.unshift(cal1.shift());}}if(cal2.length>0){function_str=calPostfixExpression(cal2);}else {function_str+=endstr;}}i+=1;}checkSpecialFunctionRange(ctx,function_str,r,c,id,dynamicArray_compute,cellRangeFunction);return function_str;}function getAllFunctionGroup(ctx){var luckysheetfile=ctx.luckysheetfile;var ret=[];for(var _i3=0;_i3<luckysheetfile.length;_i3+=1){var file=luckysheetfile[_i3];var calcChain=file.calcChain;var dynamicArray_compute=file.dynamicArray_compute;if(lodash.isNil(calcChain)){calcChain=[];}if(lodash.isNil(dynamicArray_compute)){dynamicArray_compute=[];}ret=ret.concat(calcChain);for(var j=0;j<dynamicArray_compute.length;j+=1){var d=dynamicArray_compute[0];ret.push({r:d.r,c:d.c,id:d.id});}}return ret;}function delFunctionGroup(ctx,r,c,id){if(lodash.isNil(id)){id=ctx.currentSheetId;}var file=ctx.luckysheetfile[getSheetIndex(ctx,id)];var calcChain=file.calcChain;if(!lodash.isNil(calcChain)){var modified=false;var calcChainClone=lodash.cloneDeep(calcChain);for(var _i4=0;_i4<calcChainClone.length;_i4+=1){var calc=calcChainClone[_i4];if(calc.r===r&&calc.c===c&&calc.id===id){calcChainClone.splice(_i4,1);modified=true;break;}}if(modified){file.calcChain=calcChainClone;}}var dynamicArray=file.dynamicArray;if(!lodash.isNil(dynamicArray)){var _modified=false;var dynamicArrayClone=lodash.cloneDeep(dynamicArray);for(var _i5=0;_i5<dynamicArrayClone.length;_i5+=1){var _calc=dynamicArrayClone[_i5];if(_calc.r===r&&_calc.c===c&&(lodash.isNil(_calc.id)||_calc.id===id)){dynamicArrayClone.splice(_i5,1);_modified=true;break;}}if(_modified){file.dynamicArray=dynamicArrayClone;}}}function checkBracketNum(fp){var bra_l=fp.match(/\(/g);var bra_r=fp.match(/\)/g);var bra_tl_txt=fp.match(/(['"])(?:(?!\1).)*?\1/g);var bra_tr_txt=fp.match(/(['"])(?:(?!\1).)*?\1/g);var bra_l_len=0;var bra_r_len=0;if(!lodash.isNil(bra_l)){bra_l_len+=bra_l.length;}if(!lodash.isNil(bra_r)){bra_r_len+=bra_r.length;}var bra_tl_len=0;var bra_tr_len=0;if(!lodash.isNil(bra_tl_txt)){for(var _i6=0;_i6<bra_tl_txt.length;_i6+=1){var bra_tl=bra_tl_txt[_i6].match(/\(/g);if(!lodash.isNil(bra_tl)){bra_tl_len+=bra_tl.length;}}}if(!lodash.isNil(bra_tr_txt)){for(var _i7=0;_i7<bra_tr_txt.length;_i7+=1){var bra_tr=bra_tr_txt[_i7].match(/\)/g);if(!lodash.isNil(bra_tr)){bra_tr_len+=bra_tr.length;}}}bra_l_len-=bra_tl_len;bra_r_len-=bra_tr_len;if(bra_l_len!==bra_r_len){return false;}return true;}function insertUpdateFunctionGroup(ctx,r,c,id){if(lodash.isNil(id)){id=ctx.currentSheetId;}var luckysheetfile=ctx.luckysheetfile;var idx=getSheetIndex(ctx,id);if(lodash.isNil(idx)){return;}var file=luckysheetfile[idx];var calcChain=file.calcChain;if(lodash.isNil(calcChain)){calcChain=[];}for(var _i8=0;_i8<calcChain.length;_i8+=1){var calc=calcChain[_i8];if(calc.r===r&&calc.c===c&&calc.id===id){return;}}var cc={r:r,c:c,id:id};calcChain.push(cc);file.calcChain=calcChain;ctx.luckysheetfile=luckysheetfile;}function execfunction(ctx,txt,r,c,id,isrefresh,notInsertFunc){if(txt.indexOf(error$2.r)>-1){return [false,error$2.r,txt];}if(!checkBracketNum(txt)){txt+=")";}if(lodash.isNil(id)){id=ctx.currentSheetId;}ctx.calculateSheetId=id;ctx.formulaCache.parser.context=ctx;var _ctx$formulaCache$par=ctx.formulaCache.parser.parse(txt.substring(1)),result=_ctx$formulaCache$par.result,formulaError=_ctx$formulaCache$par.error;if(!lodash.isNil(r)&&!lodash.isNil(c)){if(isrefresh){execFunctionGroup(ctx,r,c,lodash.isNil(formulaError)?result:formulaError,id);}if(!notInsertFunc){insertUpdateFunctionGroup(ctx,r,c,id);}}return [true,lodash.isNil(formulaError)?result:formulaError,txt];}function insertUpdateDynamicArray(ctx,dynamicArrayItem){var r=dynamicArrayItem.r,c=dynamicArrayItem.c;var id=dynamicArrayItem.id;if(lodash.isNil(id)){id=ctx.currentSheetId;}var luckysheetfile=ctx.luckysheetfile;var idx=getSheetIndex(ctx,id);if(idx==null)return [];var file=luckysheetfile[idx];var dynamicArray=file.dynamicArray;if(lodash.isNil(dynamicArray)){dynamicArray=[];}for(var _i9=0;_i9<dynamicArray.length;_i9+=1){var calc=dynamicArray[_i9];if(calc.r===r&&calc.c===c&&calc.id===id){calc.data=dynamicArrayItem.data;calc.f=dynamicArrayItem.f;return dynamicArray;}}dynamicArray.push(dynamicArrayItem);return dynamicArray;}function groupValuesRefresh(ctx){var luckysheetfile=ctx.luckysheetfile;if(ctx.groupValuesRefreshData.length>0){for(var _i10=0;_i10<ctx.groupValuesRefreshData.length;_i10+=1){var item=ctx.groupValuesRefreshData[_i10];var idx=getSheetIndex(ctx,item.id);if(idx==null)continue;var file=luckysheetfile[idx];var data=file.data;if(lodash.isNil(data)){continue;}var updateValue={};if(!lodash.isNil(item.spe)){if(item.spe.type==="sparklines"){updateValue.spl=item.spe.data;}else if(item.spe.type==="dynamicArrayItem"){file.dynamicArray=insertUpdateDynamicArray(ctx,item.spe.data);}}updateValue.v=item.v;updateValue.f=item.f;setCellValue(ctx,item.r,item.c,data,updateValue);}ctx.groupValuesRefreshData=[];}}function execFunctionGroup(ctx,origin_r,origin_c,value,id,data){var isForce=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;if(lodash.isNil(data)){data=getFlowdata(ctx);}if(lodash.isNil(ctx.formulaCache.execFunctionGlobalData)){ctx.formulaCache.execFunctionGlobalData={};}if(lodash.isNil(id)){id=ctx.currentSheetId;}if(!lodash.isNil(value)){var cellCache=[[{v:undefined}]];setCellValue(ctx,0,0,cellCache,value);var _cellCache$=_slicedToArray$3(cellCache[0],1);ctx.formulaCache.execFunctionGlobalData["".concat(origin_r,"_").concat(origin_c,"_").concat(id)]=_cellCache$[0];}var calcChains=getAllFunctionGroup(ctx);var formulaObjects={};var sheets=ctx.luckysheetfile;var sheetData={};for(var _i11=0;_i11<sheets.length;_i11+=1){var sheet=sheets[_i11];sheetData[sheet.id]=sheet.data;}var updateValueOjects={};var updateValueArray=[];if(lodash.isNil(ctx.formulaCache.execFunctionExist)){var key="r".concat(origin_r,"c").concat(origin_c,"i").concat(id);updateValueOjects[key]=1;}else {for(var x=0;x<ctx.formulaCache.execFunctionExist.length;x+=1){var cell=ctx.formulaCache.execFunctionExist[x];var _key="r".concat(cell.r,"c").concat(cell.c,"i").concat(cell.i);updateValueOjects[_key]=1;}}var arrayMatchCache={};var arrayMatch=function arrayMatch(formulaArray,_formulaObjects,_updateValueOjects,func){for(var a=0;a<formulaArray.length;a+=1){var range=formulaArray[a];var cacheKey="r".concat(range.row[0]).concat(range.row[1],"c").concat(range.column[0]).concat(range.column[1],"id").concat(range.sheetId);if(cacheKey in arrayMatchCache){var amc=arrayMatchCache[cacheKey];amc.forEach(function(item){func(item.key,item.r,item.c,item.sheetId);});}else {var functionArr=[];for(var r=range.row[0];r<=range.row[1];r+=1){for(var c=range.column[0];c<=range.column[1];c+=1){var _key2="r".concat(r,"c").concat(c,"i").concat(range.sheetId);func(_key2,r,c,range.sheetId);if(_formulaObjects&&_key2 in _formulaObjects||_updateValueOjects&&_key2 in _updateValueOjects){functionArr.push({key:_key2,r:r,c:c,sheetId:range.sheetId});}}}if(_formulaObjects||_updateValueOjects){arrayMatchCache[cacheKey]=functionArr;}}}};var _loop=function _loop(_i12){var formulaCell=calcChains[_i12];var key="r".concat(formulaCell.r,"c").concat(formulaCell.c,"i").concat(formulaCell.id);var calc_funcStr=getcellFormula(ctx,formulaCell.r,formulaCell.c,formulaCell.id);if(lodash.isNil(calc_funcStr)){return "continue";}var txt1=calc_funcStr.toUpperCase();var isOffsetFunc=txt1.indexOf("INDIRECT(")>-1||txt1.indexOf("OFFSET(")>-1||txt1.indexOf("INDEX(")>-1;var formulaArray=[];if(isOffsetFunc){isFunctionRange(ctx,calc_funcStr,null,null,formulaCell.id,null,function(str_nb){var range=getcellrange(ctx,lodash.trim(str_nb),formulaCell.id);if(!lodash.isNil(range)){formulaArray.push(range);}});}else if(!(calc_funcStr.substring(0,2)==='="'&&calc_funcStr.substring(calc_funcStr.length-1,1)==='"')){var point=0;var squote=-1;var dquote=-1;var formulaTextArray=[];var sq_end_array=[];var calc_funcStr_length=calc_funcStr.length;for(var j=0;j<calc_funcStr_length;j+=1){var char=calc_funcStr.charAt(j);if(char==="'"&&dquote===-1){if(squote===-1){if(point!==j){formulaTextArray.push.apply(formulaTextArray,_toConsumableArray$2(calc_funcStr.substring(point,j).split(/==|!=|<>|<=|>=|[,()=+-/*%&^><]/)));}squote=j;point=j;}else {if(j<calc_funcStr_length-1&&calc_funcStr.charAt(j+1)==="'"){j+=1;}else {point=j+1;formulaTextArray.push(calc_funcStr.substring(squote,point));sq_end_array.push(formulaTextArray.length-1);squote=-1;}}}if(char==='"'&&squote===-1){if(dquote===-1){if(point!==j){formulaTextArray.push.apply(formulaTextArray,_toConsumableArray$2(calc_funcStr.substring(point,j).split(/==|!=|<>|<=|>=|[,()=+-/*%&^><]/)));}dquote=j;point=j;}else {if(j<calc_funcStr_length-1&&calc_funcStr.charAt(j+1)==='"'){j+=1;}else {point=j+1;formulaTextArray.push(calc_funcStr.substring(dquote,point));dquote=-1;}}}}if(point!==calc_funcStr_length){formulaTextArray.push.apply(formulaTextArray,_toConsumableArray$2(calc_funcStr.substring(point,calc_funcStr_length).split(/==|!=|<>|<=|>=|[,()=+-/*%&^><]/)));}for(var _j=sq_end_array.length-1;_j>=0;_j-=1){if(sq_end_array[_j]!==formulaTextArray.length-1){formulaTextArray[sq_end_array[_j]]+=formulaTextArray[sq_end_array[_j]+1];formulaTextArray.splice(sq_end_array[_j]+1,1);}}for(var _j2=0;_j2<formulaTextArray.length;_j2+=1){var t=formulaTextArray[_j2];if(t.length<=1){continue;}if(t.substring(0,1)==='"'&&t.substring(t.length-1,1)==='"'&&!iscelldata(t)){continue;}var range=getcellrange(ctx,lodash.trim(t),formulaCell.id);if(lodash.isNil(range)){continue;}formulaArray.push(range);}}var item={formulaArray:formulaArray,calc_funcStr:calc_funcStr,key:key,r:formulaCell.r,c:formulaCell.c,id:formulaCell.id,parents:{},chidren:{},color:"w"};formulaObjects[key]=item;};for(var _i12=0;_i12<calcChains.length;_i12+=1){var _ret=_loop(_i12);if(_ret==="continue")continue;}Object.keys(formulaObjects).forEach(function(key){var formulaObject=formulaObjects[key];arrayMatch(formulaObject.formulaArray,formulaObjects,updateValueOjects,function(childKey){if(childKey in formulaObjects){var childFormulaObject=formulaObjects[childKey];formulaObject.chidren[childKey]=1;childFormulaObject.parents[key]=1;}if(!isForce&&childKey in updateValueOjects){updateValueArray.push(formulaObject);}});if(isForce){updateValueArray.push(formulaObject);}});var formulaRunList=[];var stack=updateValueArray;var existsFormulaRunList={};var _loop2=function _loop2(){var formulaObject=stack.pop();if(lodash.isNil(formulaObject)||formulaObject.key in existsFormulaRunList){return "continue";}if(formulaObject.color==="b"){formulaRunList.push(formulaObject);existsFormulaRunList[formulaObject.key]=1;return "continue";}var cacheStack=[];Object.keys(formulaObject.parents).forEach(function(parentKey){var parentFormulaObject=formulaObjects[parentKey];if(!lodash.isNil(parentFormulaObject)){cacheStack.push(parentFormulaObject);}});if(cacheStack.length===0){formulaRunList.push(formulaObject);existsFormulaRunList[formulaObject.key]=1;}else {formulaObject.color="b";stack.push(formulaObject);stack=stack.concat(cacheStack);}};while(stack.length>0){var _ret2=_loop2();if(_ret2==="continue")continue;}formulaRunList.reverse();for(var _i13=0;_i13<formulaRunList.length;_i13+=1){var formulaCell=formulaRunList[_i13];if(formulaCell.level===Math.max){continue;}var calc_funcStr=formulaCell.calc_funcStr;var v=execfunction(ctx,calc_funcStr,formulaCell.r,formulaCell.c,formulaCell.id);ctx.groupValuesRefreshData.push({r:formulaCell.r,c:formulaCell.c,v:v[1],f:v[2],spe:v[3],id:formulaCell.id});ctx.formulaCache.execFunctionGlobalData["".concat(formulaCell.r,"_").concat(formulaCell.c,"_").concat(formulaCell.id)]={v:v[1],f:v[2]};}ctx.formulaCache.execFunctionExist=undefined;}function findrangeindex(ctx,v,vp){var re=/<span.*?>/g;var v_a=v.replace(re,"").split("</span>");var vp_a=vp.replace(re,"").split("</span>");v_a.pop();vp_a.pop();var pfri=ctx.formulaCache.functionRangeIndex;if(pfri==null)return [];var vplen=vp_a.length;var vlen=v_a.length;if(vplen===vlen){var _i14=pfri[0];var p=vp_a[_i14];var n=v_a[_i14];if(lodash.isNil(p)){if(vp_a.length<=_i14){pfri=[vp_a.length-1,vp_a.length-1];}else if(v_a.length<=_i14){pfri=[v_a.length-1,v_a.length-1];}return pfri;}if(p.length===n.length){if(!lodash.isNil(vp_a[_i14+1])&&!lodash.isNil(v_a[_i14+1])&&vp_a[_i14+1].length<v_a[_i14+1].length){pfri[0]+=1;pfri[1]=1;}return pfri;}if(p.length>n.length){if(!lodash.isNil(p)&&!lodash.isNil(v_a[_i14+1])&&v_a[_i14+1].substring(0,1)==='"'&&(p.indexOf("{")>-1||p.indexOf("}")>-1)){pfri[0]+=1;pfri[1]=1;}return pfri;}if(p.length<n.length){if(pfri[1]>n.length){pfri[1]=n.length;}return pfri;}}else if(vplen>vlen){var _i15=pfri[0];var _p=vp_a[_i15];var _n=v_a[_i15];if(lodash.isNil(_n)){if(v_a[_i15-1].indexOf("{")>-1){pfri[0]-=1;var start=v_a[_i15-1].search("{");pfri[1]+=start;}else {pfri[0]=0;pfri[1]=0;}}else if(_p.length===_n.length){if(!lodash.isNil(v_a[_i15+1])&&(v_a[_i15+1].substring(0,1)==='"'||v_a[_i15+1].substring(0,1)==="{"||v_a[_i15+1].substring(0,1)==="}")){pfri[0]+=1;pfri[1]=1;}else if(!lodash.isNil(_p)&&_p.length>2&&_p.substring(0,1)==='"'&&_p.substring(_p.length-1,1)==='"');else if(!lodash.isNil(v_a[_i15])&&v_a[_i15]==='")'){pfri[1]=1;}else if(!lodash.isNil(v_a[_i15])&&v_a[_i15]==='"}'){pfri[1]=1;}else if(!lodash.isNil(v_a[_i15])&&v_a[_i15]==="{)"){pfri[1]=1;}else {pfri[1]=_n.length;}return pfri;}else if(_p.length>_n.length){if(!lodash.isNil(v_a[_i15+1])&&(v_a[_i15+1].substring(0,1)==='"'||v_a[_i15+1].substring(0,1)==="{"||v_a[_i15+1].substring(0,1)==="}")){pfri[0]+=1;pfri[1]=1;}return pfri;}else if(_p.length<_n.length){return pfri;}return pfri;}else if(vplen<vlen){var _i16=pfri[0];var _p2=vp_a[_i16];var _n2=v_a[_i16];if(lodash.isNil(_p2)){pfri[0]=v_a.length-1;if(!lodash.isNil(_n2)){pfri[1]=_n2.length;}else {pfri[1]=1;}}else if(_p2.length===_n2.length){if(lodash.isNil(vp_a[_i16+1])&&(vp_a[_i16+1].substring(0,1)==='"'||vp_a[_i16+1].substring(0,1)==="{"||vp_a[_i16+1].substring(0,1)==="}")){pfri[1]=_n2.length;}else if(!lodash.isNil(v_a[_i16+1])&&v_a[_i16+1].substring(0,1)==='"'&&(v_a[_i16+1].substring(0,1)==="{"||v_a[_i16+1].substring(0,1)==="}")){pfri[0]+=1;pfri[1]=1;}else if(!lodash.isNil(_n2)&&_n2.substring(0,1)==='"'&&_n2.substring(_n2.length-1,1)==='"'&&_p2.substring(0,1)==='"'&&_p2.substring(_p2.length-1,1)===")"){pfri[1]=_n2.length;}else if(!lodash.isNil(_n2)&&_n2.substring(0,1)==="{"&&_n2.substring(_n2.length-1,1)==="}"&&_p2.substring(0,1)==="{"&&_p2.substring(_p2.length-1,1)===")"){pfri[1]=_n2.length;}else {pfri[0]=pfri[0]+vlen-vplen;if(v_a.length>vp_a.length){pfri[1]=v_a[_i16+1].length;}else {pfri[1]=1;}}return pfri;}else if(_p2.length>_n2.length){if(!lodash.isNil(_p2)&&_p2.substring(0,1)==='"'){pfri[1]=_n2.length;}else if(lodash.isNil(v_a[_i16+1])&&/{.*?}/.test(v_a[_i16+1])){pfri[0]+=1;pfri[1]=v_a[_i16+1].length;}else if(!lodash.isNil(_p2)&&v_a[_i16+1].substring(0,1)==='"'&&(_p2.indexOf("{")>-1||_p2.indexOf("}")>-1)){pfri[0]+=1;pfri[1]=1;}else if(!lodash.isNil(_p2)&&(_p2.indexOf("{")>-1||_p2.indexOf("}")>-1));else {pfri[0]=pfri[0]+vlen-vplen-1;pfri[1]=v_a[_i16-1].length;}return pfri;}else if(_p2.length<_n2.length){return pfri;}return pfri;}return null;}function createFormulaRangeSelect(ctx,select){ctx.formulaRangeSelect=select;}function createRangeHightlight(ctx,inputInnerHtmlStr){var $span=parseElement("<div>".concat(inputInnerHtmlStr,"</div>"));var formulaRanges=[];$span.querySelectorAll("span.fortune-formula-functionrange-cell").forEach(function(ele){var rangeIndex=parseInt(ele.getAttribute("rangeindex")||"0",10);var cellrange=getcellrange(ctx,ele.textContent||"");if(rangeIndex===ctx.formulaCache.selectingRangeIndex||cellrange==null)return;if(cellrange.sheetId===ctx.currentSheetId||cellrange.sheetId===-1&&ctx.formulaCache.rangetosheet===ctx.currentSheetId){formulaRanges.push(_objectSpread2$1(_objectSpread2$1({rangeIndex:rangeIndex},seletedHighlistByindex(ctx,cellrange.row[0],cellrange.row[1],cellrange.column[0],cellrange.column[1])),{},{backgroundColor:colors[rangeIndex]}));}});ctx.formulaRangeHighlight=formulaRanges;}function setCaretPosition(ctx,textDom,children,pos){try{var el=textDom;var range=document.createRange();var sel=window.getSelection();range.setStart(el.childNodes[children],pos);range.collapse(true);sel===null||sel===void 0?void 0:sel.removeAllRanges();sel===null||sel===void 0?void 0:sel.addRange(range);el.focus();}catch(err){moveToEnd(ctx.formulaCache.rangeResizeTo[0]);}}function functionRange(ctx,obj,v,vp){if(window.getSelection){var currSelection=window.getSelection();if(!currSelection)return;var fri=findrangeindex(ctx,v,vp);if(lodash.isNil(fri)){currSelection.selectAllChildren(obj);currSelection.collapseToEnd();}else {setCaretPosition(ctx,obj.querySelectorAll("span")[fri[0]],0,fri[1]);}}else if(document.selection){ctx.formulaCache.functionRangeIndex.moveToElementText(obj);ctx.formulaCache.functionRangeIndex.collapse(false);ctx.formulaCache.functionRangeIndex.select();}}function searchFunction(ctx,searchtxt){var _locale=locale(ctx),functionlist=_locale.functionlist;var f=[];var s=[];var t=[];var result_i=0;for(var _i17=0;_i17<functionlist.length;_i17+=1){var item=functionlist[_i17];var n=item.n;if(n===searchtxt){f.unshift(item);result_i+=1;}else if(n.startsWith(searchtxt)){s.unshift(item);result_i+=1;}else if(n.indexOf(searchtxt)>-1){t.unshift(item);result_i+=1;}if(result_i>=10){break;}}var list=[].concat(f,s,t);if(list.length<=0){return;}ctx.functionCandidates=list;}function getrangeseleciton(){var _anchorNode$parentNod,_anchorNode$parentNod2,_anchorNode$parentEle,_anchorNode$parentEle2;var currSelection=window.getSelection();if(!currSelection)return null;var anchorNode=currSelection.anchorNode,anchorOffset=currSelection.anchorOffset;if(!anchorNode)return null;if(((_anchorNode$parentNod=anchorNode.parentNode)===null||_anchorNode$parentNod===void 0?void 0:(_anchorNode$parentNod2=_anchorNode$parentNod.nodeName)===null||_anchorNode$parentNod2===void 0?void 0:_anchorNode$parentNod2.toLowerCase())==="span"&&anchorOffset!==0){var txt=lodash.trim(anchorNode.textContent||"");if(txt.length===0&&anchorNode.parentNode.previousSibling){var ahr=anchorNode.parentNode.previousSibling;txt=lodash.trim(ahr.textContent||"");return ahr;}return anchorNode.parentNode;}var anchorElement=anchorNode;if(anchorElement.id==="luckysheet-rich-text-editor"||anchorElement.id==="luckysheet-functionbox-cell"){var _$last;var _txt=lodash.trim((_$last=lodash.last(anchorElement.querySelectorAll("span")))===null||_$last===void 0?void 0:_$last.innerText);if(_txt.length===0&&anchorElement.querySelectorAll("span").length>1){var _ahr=anchorElement.querySelectorAll("span");_txt=lodash.trim(_ahr[_ahr.length-2].innerText);return _ahr===null||_ahr===void 0?void 0:_ahr[0];}return lodash.last(anchorElement.querySelectorAll("span"));}if((anchorNode===null||anchorNode===void 0?void 0:(_anchorNode$parentEle=anchorNode.parentElement)===null||_anchorNode$parentEle===void 0?void 0:_anchorNode$parentEle.id)==="luckysheet-rich-text-editor"||(anchorNode===null||anchorNode===void 0?void 0:(_anchorNode$parentEle2=anchorNode.parentElement)===null||_anchorNode$parentEle2===void 0?void 0:_anchorNode$parentEle2.id)==="luckysheet-functionbox-cell"||anchorOffset===0){var newAnchorNode=anchorOffset===0?anchorNode===null||anchorNode===void 0?void 0:anchorNode.parentNode:anchorNode;if(newAnchorNode===null||newAnchorNode===void 0?void 0:newAnchorNode.previousSibling){return newAnchorNode===null||newAnchorNode===void 0?void 0:newAnchorNode.previousSibling;}}return null;}function helpFunctionExe($editer,currSelection,ctx){var _currSelection$parent;var _locale2=locale(ctx),functionlist=_locale2.functionlist;if(lodash.isEmpty(ctx.formulaCache.functionlistMap)){for(var _i18=0;_i18<functionlist.length;_i18+=1){ctx.formulaCache.functionlistMap[functionlist[_i18].n]=functionlist[_i18];}}if(!currSelection){return null;}var $prev=currSelection;var $span=$editer.querySelectorAll("span");var currentIndex=lodash.indexOf((_currSelection$parent=currSelection.parentNode)===null||_currSelection$parent===void 0?void 0:_currSelection$parent.childNodes,currSelection);var i=currentIndex;if($prev==null){return null;}var funcName=null;if($span[i].classList.contains("luckysheet-formula-text-func")){funcName=$span[i].textContent;}else {var $cur=null;var exceptIndex=[-1,-1];while(--i>0){$cur=$span[i];if($cur.classList.contains("luckysheet-formula-text-func")||lodash.trim($cur.textContent||"").toUpperCase()in ctx.formulaCache.functionlistMap){funcName=$cur.textContent;var endstate=true;for(var a=i;a<=currentIndex;a+=1){if(a>=exceptIndex[0]&&a<=exceptIndex[1]){continue;}$cur=$span[a];if($cur.classList.contains("luckysheet-formula-text-rpar")){exceptIndex=[i,a];funcName=null;endstate=false;break;}if($cur.classList.contains("luckysheet-formula-text-comma"));}if(endstate){break;}}}}return funcName;}function rangeHightlightselected(ctx,$editor){var currSelection=getrangeseleciton();if(!currSelection)return;var currText=lodash.trim(currSelection.textContent||"");if(currText===null||currText===void 0?void 0:currText.match(/^[a-zA-Z_]+$/)){searchFunction(ctx,currText.toUpperCase());ctx.functionHint=null;}else {var funcName=helpFunctionExe($editor,currSelection,ctx);ctx.functionHint=funcName===null||funcName===void 0?void 0:funcName.toUpperCase();ctx.functionCandidates=[];}}function functionHTML(txt){if(txt.substr(0,1)==="="){txt=txt.substr(1);}var funcstack=txt.split("");var i=0;var str="";var function_str="";var matchConfig={bracket:0,comma:0,squote:0,dquote:0,braces:0};while(i<funcstack.length){var s=funcstack[i];if(s==="("&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){matchConfig.bracket+=1;if(str.length>0){function_str+="<span dir=\"auto\" class=\"luckysheet-formula-text-func\">".concat(str,"</span><span dir=\"auto\" class=\"luckysheet-formula-text-lpar\">(</span>");}else {function_str+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>';}str="";}else if(s===")"&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){matchConfig.bracket-=1;function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-rpar\">)</span>");str="";}else if(s==="{"&&matchConfig.squote===0&&matchConfig.dquote===0){str+="{";matchConfig.braces+=1;}else if(s==="}"&&matchConfig.squote===0&&matchConfig.dquote===0){str+="}";matchConfig.braces-=1;}else if(s==='"'&&matchConfig.squote===0){if(matchConfig.dquote>0){if(str.length>0){function_str+="".concat(str,"\"</span>");}else {function_str+='"</span>';}matchConfig.dquote-=1;str="";}else {matchConfig.dquote+=1;if(str.length>0){function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-string\">\"");}else {function_str+='<span dir="auto" class="luckysheet-formula-text-string">"';}str="";}}else if(s==="'"&&matchConfig.dquote===0){str+="'";matchConfig.squote=matchConfig.squote===0?1:0;}else if(s===","&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-comma\">,</span>");str="";}else if(s==="&"&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){if(str.length>0){function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-calc\">")+"&"+"</span>";str="";}else {function_str+='<span dir="auto" class="luckysheet-formula-text-calc">'+"&"+"</span>";}}else if(s in operatorjson&&matchConfig.squote===0&&matchConfig.dquote===0&&matchConfig.braces===0){var s_next="";if(i+1<funcstack.length){s_next=funcstack[i+1];}var p=i-1;var s_pre=null;if(p>=0){do{s_pre=funcstack[p-=1];}while(p>=0&&s_pre===" ");}if(s+s_next in operatorjson){if(str.length>0){function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-calc\">").concat(s).concat(s_next,"</span>");str="";}else {function_str+="<span dir=\"auto\" class=\"luckysheet-formula-text-calc\">".concat(s).concat(s_next,"</span>");}i+=1;}else if(!/[^0-9]/.test(s_next)&&s==="-"&&(s_pre==="("||lodash.isNil(s_pre)||s_pre===","||s_pre===" "||s_pre in operatorjson)){str+=s;}else {if(str.length>0){function_str+="".concat(functionHTML(str),"<span dir=\"auto\" class=\"luckysheet-formula-text-calc\">").concat(s,"</span>");str="";}else {function_str+="<span dir=\"auto\" class=\"luckysheet-formula-text-calc\">".concat(s,"</span>");}}}else {str+=s;}if(i===funcstack.length-1){if(iscelldata(lodash.trim(str))){function_str+="<span class=\"fortune-formula-functionrange-cell\" rangeindex=\"".concat(functionHTMLIndex,"\" dir=\"auto\" style=\"color:").concat(colors[functionHTMLIndex],";\">").concat(str,"</span>");functionHTMLIndex+=1;}else if(matchConfig.dquote>0){function_str+="".concat(str,"</span>");}else if(str.indexOf("</span>")===-1&&str.length>0){var regx=/{.*?}/;if(regx.test(lodash.trim(str))){var arraytxt=regx.exec(str)[0];var arraystart=str.search(regx);var alltxt="";if(arraystart>0){alltxt+="<span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(str.substr(0,arraystart),"</span>");}alltxt+="<span dir=\"auto\" style=\"color:#959a05\" class=\"luckysheet-formula-text-array\">".concat(arraytxt,"</span>");if(arraystart+arraytxt.length<str.length){alltxt+="<span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(str.substr(arraystart+arraytxt.length,str.length),"</span>");}function_str+=alltxt;}else {function_str+="<span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(str,"</span>");}}}i+=1;}return function_str;}function functionHTMLGenerate(txt){if(txt.length===0||txt.substring(0,1)!=="="){return txt;}functionHTMLIndex=0;return "<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span>".concat(functionHTML(txt));}function handleFormulaInput(ctx,$copyTo,$editor,kcode){var value1=$editor.innerHTML;var value1txt=$editor.innerText;var value=$editor.innerText;value=escapeScriptTag(value);if(value.length>0&&value.substring(0,1)==="="&&(kcode!==229||value.length===1)){value=functionHTMLGenerate(value);value1=functionHTMLGenerate(value1txt);if(window.getSelection){var _currSelection$anchor;var currSelection=window.getSelection();if(!currSelection)return;if(((_currSelection$anchor=currSelection.anchorNode)===null||_currSelection$anchor===void 0?void 0:_currSelection$anchor.nodeName.toLowerCase())==="div"){var _$editor$querySelecto;var editorlen=$editor.querySelectorAll("span").length;ctx.formulaCache.functionRangeIndex=[editorlen-1,(_$editor$querySelecto=$editor.querySelectorAll("span").item(editorlen-1).textContent)===null||_$editor$querySelecto===void 0?void 0:_$editor$querySelecto.length];}else {var _currSelection$anchor2,_currSelection$anchor3,_currSelection$anchor4,_currSelection$anchor5;ctx.formulaCache.functionRangeIndex=[lodash.indexOf((_currSelection$anchor2=currSelection.anchorNode)===null||_currSelection$anchor2===void 0?void 0:(_currSelection$anchor3=_currSelection$anchor2.parentNode)===null||_currSelection$anchor3===void 0?void 0:(_currSelection$anchor4=_currSelection$anchor3.parentNode)===null||_currSelection$anchor4===void 0?void 0:_currSelection$anchor4.childNodes,(_currSelection$anchor5=currSelection.anchorNode)===null||_currSelection$anchor5===void 0?void 0:_currSelection$anchor5.parentNode),currSelection.anchorOffset];}}else {var textRange=document.selection.createRange();ctx.formulaCache.functionRangeIndex=textRange;}$editor.innerHTML=value;functionRange(ctx,$editor,value,value1);cancelFunctionrangeSelected(ctx);if(kcode!==46){createRangeHightlight(ctx,value);}$copyTo.innerHTML=value;rangeHightlightselected(ctx,$editor);}else if(value1txt.substring(0,1)!=="="){if($copyTo.id==="luckysheet-rich-text-editor"){if(!$copyTo.innerHTML.startsWith("<span")){$copyTo.innerHTML=value;}}else {$copyTo.innerHTML=value;}}}function isfreezonFuc(txt){var row=txt.replace(/[^0-9]/g,"");var col=txt.replace(/[^A-Za-z]/g,"");var row$=txt.substr(txt.indexOf(row)-1,1);var col$=txt.substr(txt.indexOf(col)-1,1);var ret=[false,false];if(row$==="$"){ret[0]=true;}if(col$==="$"){ret[1]=true;}return ret;}function functionStrChange_range(txt,type,rc,orient,stindex,step){var val=txt.split("!");var rangetxt;var prefix="";if(val.length>1){var _val4=_slicedToArray$3(val,2);rangetxt=_val4[1];prefix="".concat(val[0],"!");}else {var _val5=_slicedToArray$3(val,1);rangetxt=_val5[0];}var r1;var r2;var c1;var c2;var $row0;var $row1;var $col0;var $col1;if(rangetxt.indexOf(":")===-1){r1=parseInt(rangetxt.replace(/[^0-9]/g,""),10)-1;r2=r1;c1=columnCharToIndex(rangetxt.replace(/[^A-Za-z]/g,""));c2=c1;var freezonFuc=isfreezonFuc(rangetxt);$row0=freezonFuc[0]?"$":"";$row1=$row0;$col0=freezonFuc[1]?"$":"";$col1=$col0;}else {rangetxt=rangetxt.split(":");r1=parseInt(rangetxt[0].replace(/[^0-9]/g,""),10)-1;r2=parseInt(rangetxt[1].replace(/[^0-9]/g,""),10)-1;if(r1>r2){return txt;}c1=columnCharToIndex(rangetxt[0].replace(/[^A-Za-z]/g,""));c2=columnCharToIndex(rangetxt[1].replace(/[^A-Za-z]/g,""));if(c1>c2){return txt;}var freezonFuc0=isfreezonFuc(rangetxt[0]);$row0=freezonFuc0[0]?"$":"";$col0=freezonFuc0[1]?"$":"";var freezonFuc1=isfreezonFuc(rangetxt[1]);$row1=freezonFuc1[0]?"$":"";$col1=freezonFuc1[1]?"$":"";}if(type==="del"){if(rc==="row"){if(r1>=stindex&&r2<=stindex+step-1){return error$2.r;}if(r1>stindex+step-1){r1-=step;}else if(r1>=stindex){r1=stindex;}if(r2>stindex+step-1){r2-=step;}else if(r2>=stindex){r2=stindex-1;}if(r1<0){r1=0;}if(r2<r1){r2=r1;}}else if(rc==="col"){if(c1>=stindex&&c2<=stindex+step-1){return error$2.r;}if(c1>stindex+step-1){c1-=step;}else if(c1>=stindex){c1=stindex;}if(c2>stindex+step-1){c2-=step;}else if(c2>=stindex){c2=stindex-1;}if(c1<0){c1=0;}if(c2<c1){c2=c1;}}if(r1===r2&&c1===c2){if(!Number.isNaN(r1)&&!Number.isNaN(c1)){return prefix+$col0+indexToColumnChar(c1)+$row0+(r1+1);}if(!Number.isNaN(r1)){return prefix+$row0+(r1+1);}if(!Number.isNaN(c1)){return prefix+$col0+indexToColumnChar(c1);}return txt;}if(Number.isNaN(c1)&&Number.isNaN(c2)){return "".concat(prefix+$row0+(r1+1),":").concat($row1).concat(r2+1);}if(Number.isNaN(r1)&&Number.isNaN(r2)){return "".concat(prefix+$col0+indexToColumnChar(c1),":").concat($col1).concat(indexToColumnChar(c2));}return "".concat(prefix+$col0+indexToColumnChar(c1)+$row0+(r1+1),":").concat($col1).concat(indexToColumnChar(c2)).concat($row1).concat(r2+1);}if(type==="add"){if(rc==="row"){if(orient==="lefttop"){if(r1>=stindex){r1+=step;}if(r2>=stindex){r2+=step;}}else if(orient==="rightbottom"){if(r1>stindex){r1+=step;}if(r2>stindex){r2+=step;}}}else if(rc==="col"){if(orient==="lefttop"){if(c1>=stindex){c1+=step;}if(c2>=stindex){c2+=step;}}else if(orient==="rightbottom"){if(c1>stindex){c1+=step;}if(c2>stindex){c2+=step;}}}if(r1===r2&&c1===c2){if(!Number.isNaN(r1)&&!Number.isNaN(c1)){return prefix+$col0+indexToColumnChar(c1)+$row0+(r1+1);}if(!Number.isNaN(r1)){return prefix+$row0+(r1+1);}if(!Number.isNaN(c1)){return prefix+$col0+indexToColumnChar(c1);}return txt;}if(Number.isNaN(c1)&&Number.isNaN(c2)){return "".concat(prefix+$row0+(r1+1),":").concat($row1).concat(r2+1);}if(Number.isNaN(r1)&&Number.isNaN(r2)){return "".concat(prefix+$col0+indexToColumnChar(c1),":").concat($col1).concat(indexToColumnChar(c2));}return "".concat(prefix+$col0+indexToColumnChar(c1)+$row0+(r1+1),":").concat($col1).concat(indexToColumnChar(c2)).concat($row1).concat(r2+1);}return "";}function israngeseleciton(ctx,istooltip){var _anchor,_anchor2,_anchor2$parentNode;if(istooltip==null){istooltip=false;}var currSelection=window.getSelection();if(currSelection==null)return false;var anchor=currSelection.anchorNode;if(!((_anchor=anchor)===null||_anchor===void 0?void 0:_anchor.textContent))return false;var anchorOffset=currSelection.anchorOffset;var anchorElement=anchor;var parentElement=anchor.parentNode;if(((_anchor2=anchor)===null||_anchor2===void 0?void 0:(_anchor2$parentNode=_anchor2.parentNode)===null||_anchor2$parentNode===void 0?void 0:_anchor2$parentNode.nodeName.toLowerCase())==="span"&&anchorOffset!==0){var txt=lodash.trim(anchor.textContent);var lasttxt="";if(txt.length===0&&anchor.parentNode.previousSibling){var ahr=anchor.parentNode.previousSibling;txt=lodash.trim(ahr.textContent||"");lasttxt=txt.substring(txt.length-1,1);ctx.formulaCache.rangeSetValueTo=ahr;}else {lasttxt=txt.substring(anchorOffset-1,1);ctx.formulaCache.rangeSetValueTo=anchor.parentNode.nextSibling;}if(istooltip&&(lasttxt==="("||lasttxt===",")||!istooltip&&(lasttxt==="("||lasttxt===","||lasttxt==="="||lasttxt in operatorjson||lasttxt==="&")){return true;}}else if(anchorElement.id==="luckysheet-rich-text-editor"||anchorElement.id==="luckysheet-functionbox-cell"){var _$last2;var _txt2=lodash.trim((_$last2=lodash.last(anchorElement.querySelectorAll("span")))===null||_$last2===void 0?void 0:_$last2.innerText);ctx.formulaCache.rangeSetValueTo=lodash.last(anchorElement.querySelectorAll("span"));if(_txt2.length===0&&anchorElement.querySelectorAll("span").length>1){var _ahr2=anchorElement.querySelectorAll("span");_txt2=lodash.trim(_ahr2[_ahr2.length-2].innerText);_txt2=lodash.trim(_ahr2[_ahr2.length-2].innerText);ctx.formulaCache.rangeSetValueTo=_ahr2;}var _lasttxt=_txt2.substring(_txt2.length-1,1);if(istooltip&&(_lasttxt==="("||_lasttxt===",")||!istooltip&&(_lasttxt==="("||_lasttxt===","||_lasttxt==="="||_lasttxt in operatorjson||_lasttxt==="&")){return true;}}else if(parentElement.id==="luckysheet-rich-text-editor"||parentElement.id==="luckysheet-functionbox-cell"||anchorOffset===0){var _anchor$previousSibli;if(anchorOffset===0){anchor=anchor.parentNode;}if(!anchor)return false;if(((_anchor$previousSibli=anchor.previousSibling)===null||_anchor$previousSibli===void 0?void 0:_anchor$previousSibli.textContent)==null)return false;if(anchor.previousSibling){var _txt3=lodash.trim(anchor.previousSibling.textContent);var _lasttxt2=_txt3.substring(_txt3.length-1,1);ctx.formulaCache.rangeSetValueTo=anchor.previousSibling;if(istooltip&&(_lasttxt2==="("||_lasttxt2===",")||!istooltip&&(_lasttxt2==="("||_lasttxt2===","||_lasttxt2==="="||_lasttxt2 in operatorjson||_lasttxt2==="&")){return true;}}}return false;}function functionStrChange(txt,type,rc,orient,stindex,step){if(!txt){return "";}if(txt.substring(0,1)==="="){txt=txt.substring(1);}var funcstack=txt.split("");var i=0;var str="";var function_str="";var matchConfig={bracket:0,comma:0,squote:0,dquote:0};while(i<funcstack.length){var s=funcstack[i];if(s==="("&&matchConfig.dquote===0){matchConfig.bracket+=1;if(str.length>0){function_str+="".concat(str,"(");}else {function_str+="(";}str="";}else if(s===")"&&matchConfig.dquote===0){matchConfig.bracket-=1;function_str+="".concat(functionStrChange(str,type,rc,orient,stindex,step),")");str="";}else if(s==='"'&&matchConfig.squote===0){if(matchConfig.dquote>0){function_str+="".concat(str,"\"");matchConfig.dquote-=1;str="";}else {matchConfig.dquote+=1;str+='"';}}else if(s===","&&matchConfig.dquote===0){function_str+="".concat(functionStrChange(str,type,rc,orient,stindex,step),",");str="";}else if(s==="&"&&matchConfig.dquote===0){if(str.length>0){function_str+="".concat(functionStrChange(str,type,rc,orient,stindex,step),"&");str="";}else {function_str+="&";}}else if(s in operatorjson&&matchConfig.dquote===0){var s_next="";if(i+1<funcstack.length){s_next=funcstack[i+1];}var p=i-1;var s_pre=null;if(p>=0){do{s_pre=funcstack[p-=1];}while(p>=0&&s_pre===" ");}if(s+s_next in operatorjson){if(str.length>0){function_str+=functionStrChange(str,type,rc,orient,stindex,step)+s+s_next;str="";}else {function_str+=s+s_next;}i+=1;}else if(!/[^0-9]/.test(s_next)&&s==="-"&&(s_pre==="("||s_pre==null||s_pre===","||s_pre===" "||s_pre in operatorjson)){str+=s;}else {if(str.length>0){function_str+=functionStrChange(str,type,rc,orient,stindex,step)+s;str="";}else {function_str+=s;}}}else {str+=s;}if(i===funcstack.length-1){if(iscelldata(lodash.trim(str))){function_str+=functionStrChange_range(lodash.trim(str),type,rc,orient,stindex,step);}else {function_str+=lodash.trim(str);}}i+=1;}return function_str;}function rangeSetValue(ctx,cellInput,selected){var range="";var rf=selected.row[0];var cf=selected.column[0];if(ctx.config.merge!=null&&"".concat(rf,"_").concat(cf)in ctx.config.merge){range=getRangetxt(ctx,ctx.currentSheetId,{column:[cf,cf],row:[rf,rf]},ctx.formulaCache.rangetosheet);}else {range=getRangetxt(ctx,ctx.currentSheetId,selected,ctx.formulaCache.rangetosheet);}if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start){var span=cellInput.querySelector("span[rangeindex='".concat(ctx.formulaCache.rangechangeindex,"']"));if(span){span.innerHTML=range;setCaretPosition(ctx,span,0,range.length);}}else {var function_str="<span class=\"fortune-formula-functionrange-cell\" rangeindex=\"".concat(functionHTMLIndex,"\" dir=\"auto\" style=\"color:").concat(colors[functionHTMLIndex],";\">").concat(range,"</span>");cellInput.insertBefore(parseElement(function_str),ctx.formulaCache.rangeSetValueTo);ctx.formulaCache.rangechangeindex=functionHTMLIndex;var _span=cellInput.querySelector("span[rangeindex='".concat(ctx.formulaCache.rangechangeindex,"']"));setCaretPosition(ctx,_span,0,range.length);functionHTMLIndex+=1;}}function onFormulaRangeDragEnd(ctx){if(ctx.formulaCache.func_selectedrange){var _ctx$formulaCache$fun=ctx.formulaCache.func_selectedrange,left=_ctx$formulaCache$fun.left_move,top=_ctx$formulaCache$fun.top_move,width=_ctx$formulaCache$fun.width_move,height=_ctx$formulaCache$fun.height_move;if(left==null||top==null||width==null||height==null||!ctx.formulaCache.rangestart)return;ctx.formulaRangeSelect={rangeIndex:ctx.formulaCache.rangeIndex||0,left:left,top:top,width:width,height:height};}ctx.formulaCache.selectingRangeIndex=-1;}function rangeDrag(ctx,e,cellInput,scrollLeft,scrollTop,container){var func_selectedrange=ctx.formulaCache.func_selectedrange;if(!func_selectedrange||func_selectedrange.left==null||func_selectedrange.height==null||func_selectedrange.top==null||func_selectedrange.width==null)return;var rect=container.getBoundingClientRect();var x=e.pageX-rect.left-ctx.rowHeaderWidth+scrollLeft;var y=e.pageY-rect.top-ctx.columnHeaderHeight+scrollTop;var row_location=rowLocation(y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];var top=0;var height=0;var rowseleted=[];if(func_selectedrange.top>row_pre){top=row_pre;height=func_selectedrange.top+func_selectedrange.height-row_pre;rowseleted=[row_index,func_selectedrange.row[1]];}else if(func_selectedrange.top===row_pre){top=row_pre;height=func_selectedrange.top+func_selectedrange.height-row_pre;rowseleted=[row_index,func_selectedrange.row[0]];}else {top=func_selectedrange.top;height=row-func_selectedrange.top-1;rowseleted=[func_selectedrange.row[0],row_index];}var left=0;var width=0;var columnseleted=[];if(func_selectedrange.left>col_pre){left=col_pre;width=func_selectedrange.left+func_selectedrange.width-col_pre;columnseleted=[col_index,func_selectedrange.column[1]];}else if(func_selectedrange.left===col_pre){left=col_pre;width=func_selectedrange.left+func_selectedrange.width-col_pre;columnseleted=[col_index,func_selectedrange.column[0]];}else {left=func_selectedrange.left;width=col-func_selectedrange.left-1;columnseleted=[func_selectedrange.column[0],col_index];}var changeparam=mergeMoveMain(ctx,columnseleted,rowseleted,func_selectedrange,top,height,left,width);if(changeparam!=null){var _changeparam=_slicedToArray$3(changeparam,6);columnseleted=_changeparam[0];rowseleted=_changeparam[1];top=_changeparam[2];height=_changeparam[3];left=_changeparam[4];width=_changeparam[5];}func_selectedrange.row=rowseleted;func_selectedrange.column=columnseleted;func_selectedrange.left_move=left;func_selectedrange.width_move=width;func_selectedrange.top_move=top;func_selectedrange.height_move=height;var rangeElement=container.querySelector(".fortune-formula-functionrange-select");rangeSetValue(ctx,cellInput,{row:rowseleted,column:columnseleted});if(rangeElement==null)return;rangeElement.style.left="".concat(left,"px");rangeElement.style.top="".concat(top,"px");rangeElement.style.height="".concat(height,"px");rangeElement.style.width="".concat(width,"px");}function updateparam(orient,txt,step){var val=txt.split("!");var rangetxt;var prefix="";if(val.length>1){var _val6=_slicedToArray$3(val,2);rangetxt=_val6[1];prefix="".concat(val[0],"!");}else {var _val7=_slicedToArray$3(val,1);rangetxt=_val7[0];}if(rangetxt.indexOf(":")===-1){var _row3=parseInt(rangetxt.replace(/[^0-9]/g,""),10);var _col3=columnCharToIndex(rangetxt.replace(/[^A-Za-z]/g,""));var freezonFuc=isfreezonFuc(rangetxt);var $row=freezonFuc[0]?"$":"";var $col=freezonFuc[1]?"$":"";if(orient==="u"&&!freezonFuc[0]){_row3-=step;}else if(orient==="r"&&!freezonFuc[1]){_col3+=step;}else if(orient==="l"&&!freezonFuc[1]){_col3-=step;}else if(orient==="d"&&!freezonFuc[0]){_row3+=step;}if(!Number.isNaN(_row3)&&!Number.isNaN(_col3)){return prefix+$col+indexToColumnChar(_col3)+$row+_row3;}if(!Number.isNaN(_row3)){return prefix+$row+_row3;}if(!Number.isNaN(_col3)){return prefix+$col+indexToColumnChar(_col3);}return txt;}rangetxt=rangetxt.split(":");var row=[];var col=[];row[0]=parseInt(rangetxt[0].replace(/[^0-9]/g,""),10);row[1]=parseInt(rangetxt[1].replace(/[^0-9]/g,""),10);if(row[0]>row[1]){return txt;}col[0]=columnCharToIndex(rangetxt[0].replace(/[^A-Za-z]/g,""));col[1]=columnCharToIndex(rangetxt[1].replace(/[^A-Za-z]/g,""));if(col[0]>col[1]){return txt;}var freezonFuc0=isfreezonFuc(rangetxt[0]);var freezonFuc1=isfreezonFuc(rangetxt[1]);var $row0=freezonFuc0[0]?"$":"";var $col0=freezonFuc0[1]?"$":"";var $row1=freezonFuc1[0]?"$":"";var $col1=freezonFuc1[1]?"$":"";if(orient==="u"){if(!freezonFuc0[0]){row[0]-=step;}if(!freezonFuc1[0]){row[1]-=step;}}else if(orient==="r"){if(!freezonFuc0[1]){col[0]+=step;}if(!freezonFuc1[1]){col[1]+=step;}}else if(orient==="l"){if(!freezonFuc0[1]){col[0]-=step;}if(!freezonFuc1[1]){col[1]-=step;}}else if(orient==="d"){if(!freezonFuc0[0]){row[0]+=step;}if(!freezonFuc1[0]){row[1]+=step;}}if(row[0]<0||col[0]<0){return error$2.r;}if(Number.isNaN(col[0])&&Number.isNaN(col[1])){return "".concat(prefix+$row0+row[0],":").concat($row1).concat(row[1]);}if(Number.isNaN(row[0])&&Number.isNaN(row[1])){return "".concat(prefix+$col0+indexToColumnChar(col[0]),":").concat($col1).concat(indexToColumnChar(col[1]));}return "".concat(prefix+$col0+indexToColumnChar(col[0])+$row0+row[0],":").concat($col1).concat(indexToColumnChar(col[1])).concat($row1).concat(row[1]);}function downparam(txt,step){return updateparam("d",txt,step);}function upparam(txt,step){return updateparam("u",txt,step);}function leftparam(txt,step){return updateparam("l",txt,step);}function rightparam(txt,step){return updateparam("r",txt,step);}function functionCopy(ctx,txt,mode,step){if(mode==null){mode="down";}if(step==null){step=1;}if(txt.substring(0,1)==="="){txt=txt.substring(1);}var funcstack=txt.split("");var i=0;var str="";var function_str="";var matchConfig={bracket:0,comma:0,squote:0,dquote:0};while(i<funcstack.length){var s=funcstack[i];if(s==="("&&matchConfig.dquote===0){matchConfig.bracket+=1;if(str.length>0){function_str+="".concat(str,"(");}else {function_str+="(";}str="";}else if(s===")"&&matchConfig.dquote===0){matchConfig.bracket-=1;function_str+="".concat(functionCopy(ctx,str,mode,step),")");str="";}else if(s==='"'&&matchConfig.squote===0){if(matchConfig.dquote>0){function_str+="".concat(str,"\"");matchConfig.dquote-=1;str="";}else {matchConfig.dquote+=1;str+='"';}}else if(s===","&&matchConfig.dquote===0){function_str+="".concat(functionCopy(ctx,str,mode,step),",");str="";}else if(s==="&"&&matchConfig.dquote===0){if(str.length>0){function_str+="".concat(functionCopy(ctx,str,mode,step),"&");str="";}else {function_str+="&";}}else if(s in operatorjson&&matchConfig.dquote===0){var s_next="";if(i+1<funcstack.length){s_next=funcstack[i+1];}var p=i-1;var s_pre=null;if(p>=0){do{s_pre=funcstack[p];p-=1;}while(p>=0&&s_pre===" ");}if(s+s_next in operatorjson){if(str.length>0){function_str+=functionCopy(ctx,str,mode,step)+s+s_next;str="";}else {function_str+=s+s_next;}i+=1;}else if(!/[^0-9]/.test(s_next)&&s==="-"&&(s_pre==="("||s_pre==null||s_pre===","||s_pre===" "||s_pre in operatorjson)){str+=s;}else {if(str.length>0){function_str+=functionCopy(ctx,str,mode,step)+s;str="";}else {function_str+=s;}}}else {str+=s;}if(i===funcstack.length-1){if(iscelldata(lodash.trim(str))){if(mode==="down"){function_str+=downparam(lodash.trim(str),step);}else if(mode==="up"){function_str+=upparam(lodash.trim(str),step);}else if(mode==="left"){function_str+=leftparam(lodash.trim(str),step);}else if(mode==="right"){function_str+=rightparam(lodash.trim(str),step);}}else {function_str+=lodash.trim(str);}}i+=1;}return function_str;}function normalizedCellAttr(cell,attr){var tf={bl:1,it:1,ff:1,cl:1,un:1};var value=cell===null||cell===void 0?void 0:cell[attr];if(attr in tf||attr==="fs"&&isInlineStringCell(cell)){value||(value="0");}else if(["fc","bg","bc"].includes(attr)){var _value;if(["fc","bc"].includes(attr)){value||(value="#000000");}if(((_value=value)===null||_value===void 0?void 0:_value.indexOf("rgba"))>-1){value=rgbToHex(value);}}else if(attr.substring(0,2)==="bs"){value||(value="none");}else if(attr==="ht"||attr==="vt"){var defaultValue=attr==="ht"?"1":"0";value||(value=defaultValue);if(["0","1","2"].indexOf(value.toString())===-1){value=defaultValue;}}else if(attr==="fs"){value||(value="10");}else if(attr==="tb"||attr==="tr"){value||(value="0");}return value;}function normalizedAttr(data,r,c,attr){if(!data||!data[r]){console.warn("cell (%d, %d) is null",r,c);return null;}var cell=data[r][c];if(!cell)return undefined;return normalizedCellAttr(cell,attr);}function getCellValue(r,c,data,attr){if(!attr){attr="v";}var d_value;if(!lodash.isNil(r)&&!lodash.isNil(c)){d_value=data[r][c];}else if(!lodash.isNil(r)){d_value=data[r];}else if(!lodash.isNil(c)){var newData=data[0].map(function(col,i){return data.map(function(row){return row[i];});});d_value=newData[c];}else {return data;}var retv=d_value;if(lodash.isPlainObject(d_value)){var d=d_value;retv=d[attr];if(attr==="f"&&!lodash.isNil(retv)){retv=functionHTMLGenerate(retv);}else if(attr==="f"){retv=d.v;}else if(d&&d.ct&&d.ct.t==="d"){retv=d.m;}}if(retv===undefined){retv=null;}return retv;}function setCellValue(ctx,r,c,d,v){if(lodash.isNil(d)){d=getFlowdata(ctx);}if(!d)return;var cell=d[r][c];var vupdate;if(lodash.isPlainObject(v)){if(lodash.isNil(cell)){cell=v;}else {if(!lodash.isNil(v.f)){cell.f=v.f;}else if("f"in cell){delete cell.f;}if(!lodash.isNil(v.ct)){cell.ct=v.ct;}}if(lodash.isPlainObject(v.v)){vupdate=v.v.v;}else {vupdate=v.v;}}else {vupdate=v;}if(isRealNull(vupdate)){if(lodash.isPlainObject(cell)){delete cell.m;delete cell.v;}else {cell=null;}d[r][c]=cell;return;}if(isRealNull(cell)||(lodash.isString(cell)||lodash.isNumber(cell))&&cell===v){cell={};}if(!cell)return;var vupdateStr=vupdate.toString();if(vupdateStr.substr(0,1)==="'"){cell.m=vupdateStr.substr(1);cell.ct={fa:"@",t:"s"};cell.v=vupdateStr.substr(1);cell.qp=1;}else if(cell.qp===1){cell.m=vupdateStr;cell.ct={fa:"@",t:"s"};cell.v=vupdateStr;}else if(vupdateStr.toUpperCase()==="TRUE"){cell.m="TRUE";cell.ct={fa:"General",t:"b"};cell.v=true;}else if(vupdateStr.toUpperCase()==="FALSE"){cell.m="FALSE";cell.ct={fa:"General",t:"b"};cell.v=false;}else if(vupdateStr.substr(-1)==="%"&&isRealNum(vupdateStr.substring(0,vupdateStr.length-1))){cell.ct={fa:"0%",t:"n"};cell.v=vupdateStr.substring(0,vupdateStr.length-1)/100;cell.m=vupdate;}else if(valueIsError(vupdate)){cell.m=vupdateStr;if(!lodash.isNil(cell.ct)){cell.ct.t="e";}else {cell.ct={fa:"General",t:"e"};}cell.v=vupdate;}else {if(!lodash.isNil(cell.f)&&isRealNum(vupdate)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(vupdate)){cell.v=parseFloat(vupdate);if(lodash.isNil(cell.ct)){cell.ct={fa:"General",t:"n"};}if(cell.v===Infinity||cell.v===-Infinity){cell.m=cell.v.toString();}else {if(cell.v.toString().indexOf("e")>-1){var len;if(cell.v.toString().split(".").length===1){len=0;}else {len=cell.v.toString().split(".")[1].split("e")[0].length;}if(len>5){len=5;}cell.m=cell.v.toExponential(len).toString();}else {var v_p=Math.round(cell.v*1000000000)/1000000000;if(lodash.isNil(cell.ct)){var mask=genarate(v_p);if(mask!=null){cell.m=mask[0].toString();}}else {var _mask=update(cell.ct.fa,v_p);cell.m=_mask.toString();}}}}else if(!lodash.isNil(cell.ct)&&cell.ct.fa==="@"){cell.m=vupdateStr;cell.v=vupdate;}else if(!lodash.isNil(cell.ct)&&!lodash.isNil(cell.ct.fa)&&cell.ct.fa!=="General"){if(isRealNum(vupdate)){vupdate=parseFloat(vupdate);}var _mask2=update(cell.ct.fa,vupdate);if(_mask2===vupdate){_mask2=genarate(vupdate);cell.m=_mask2[0].toString();var _mask3=_mask2;var _mask4=_slicedToArray$3(_mask3,3);cell.ct=_mask4[1];cell.v=_mask4[2];}else {cell.m=_mask2.toString();cell.v=vupdate;}}else {if(isRealNum(vupdate)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(vupdate)){if(typeof vupdate==="string"){var flag=vupdate.split("").every(function(ele){return ele==="0"||ele===".";});if(flag){vupdate=parseFloat(vupdate);}}cell.v=vupdate;cell.ct={fa:"General",t:"n"};if(cell.v===Infinity||cell.v===-Infinity){cell.m=cell.v.toString();}else if(cell.v!=null){var _mask5=genarate(cell.v);if(_mask5){cell.m=_mask5[0].toString();}}}else {var _mask6=genarate(vupdate);if(_mask6){cell.m=_mask6[0].toString();var _mask7=_slicedToArray$3(_mask6,3);cell.ct=_mask7[1];cell.v=_mask7[2];}}}}d[r][c]=cell;}function getRealCellValue(r,c,data,attr){var value=getCellValue(r,c,data,"m");if(lodash.isNil(value)){value=getCellValue(r,c,data,attr);if(lodash.isNil(value)){var ct=getCellValue(r,c,data,"ct");if(isInlineStringCT(ct)){value=ct.s;}}}return value;}function mergeBorder(ctx,d,row_index,col_index){if(!d||!d[row_index]){console.warn("Merge info is null",row_index,col_index);return null;}var value=d[row_index][col_index];if(!value)return null;if("mc"in value){var _d$row_index,_d$row_index2,_d$row_index2$col_ind,_d$row_index2$col_ind2,_d$row_index3,_d$row_index3$col_ind,_d$row_index3$col_ind2,_d$row_index4,_d$row_index4$col_ind;var margeMaindata=value.mc;if(!margeMaindata){console.warn("Merge info is null",row_index,col_index);return null;}col_index=margeMaindata.c;row_index=margeMaindata.r;if(lodash.isNil(d===null||d===void 0?void 0:(_d$row_index=d[row_index])===null||_d$row_index===void 0?void 0:_d$row_index[col_index])){console.warn("Main merge Cell info is null",row_index,col_index);return null;}var col_rs=(_d$row_index2=d[row_index])===null||_d$row_index2===void 0?void 0:(_d$row_index2$col_ind=_d$row_index2[col_index])===null||_d$row_index2$col_ind===void 0?void 0:(_d$row_index2$col_ind2=_d$row_index2$col_ind.mc)===null||_d$row_index2$col_ind2===void 0?void 0:_d$row_index2$col_ind2.cs;var row_rs=(_d$row_index3=d[row_index])===null||_d$row_index3===void 0?void 0:(_d$row_index3$col_ind=_d$row_index3[col_index])===null||_d$row_index3$col_ind===void 0?void 0:(_d$row_index3$col_ind2=_d$row_index3$col_ind.mc)===null||_d$row_index3$col_ind2===void 0?void 0:_d$row_index3$col_ind2.rs;var mergeMain=(_d$row_index4=d[row_index])===null||_d$row_index4===void 0?void 0:(_d$row_index4$col_ind=_d$row_index4[col_index])===null||_d$row_index4$col_ind===void 0?void 0:_d$row_index4$col_ind.mc;if(!mergeMain||lodash.isNil(mergeMain===null||mergeMain===void 0?void 0:mergeMain.rs)||lodash.isNil(mergeMain===null||mergeMain===void 0?void 0:mergeMain.cs)||lodash.isNil(col_rs)||lodash.isNil(row_rs)){console.warn("Main merge info is null",mergeMain);return null;}var start_r;var end_r;var row;var row_pre;for(var r=row_index;r<mergeMain.rs+row_index;r+=1){if(r===0){start_r=-1;}else {start_r=ctx.visibledatarow[r-1]-1;}end_r=ctx.visibledatarow[r];if(row_pre===undefined){row_pre=start_r;row=end_r;}else if(row!==undefined){row+=end_r-start_r-1;}}var start_c;var end_c;var col;var col_pre;for(var c=col_index;c<mergeMain.cs+col_index;c+=1){if(c===0){start_c=0;}else {start_c=ctx.visibledatacolumn[c-1];}end_c=ctx.visibledatacolumn[c];if(col_pre===undefined){col_pre=start_c;col=end_c;}else if(col!==undefined){col+=end_c-start_c;}}if(lodash.isNil(row_pre)||lodash.isNil(col_pre)||lodash.isNil(row)||lodash.isNil(col)){console.warn("Main merge info row_pre or col_pre or row or col is null",mergeMain);return null;}return {row:[row_pre,row,row_index,row_index+row_rs-1],column:[col_pre,col,col_index,col_index+col_rs-1]};}return null;}function mergeMove(ctx,mc,columnseleted,rowseleted,s,top,height,left,width){var row_st=mc.r;var row_ed=mc.r+mc.rs-1;var col_st=mc.c;var col_ed=mc.c+mc.cs-1;var ismatch=false;columnseleted[0]=Math.min(columnseleted[0],columnseleted[1]);rowseleted[0]=Math.min(rowseleted[0],rowseleted[1]);if(columnseleted[0]<=col_st&&columnseleted[1]>=col_ed&&rowseleted[0]<=row_st&&rowseleted[1]>=row_ed||!(columnseleted[1]<col_st||columnseleted[0]>col_ed)&&!(rowseleted[1]<row_st||rowseleted[0]>row_ed)){var flowdata=getFlowdata(ctx);if(!flowdata)return null;var margeset=mergeBorder(ctx,flowdata,mc.r,mc.c);if(margeset){var row=margeset.row[1];var row_pre=margeset.row[0];var col=margeset.column[1];var col_pre=margeset.column[0];if(!(columnseleted[1]<col_st||columnseleted[0]>col_ed)){if(rowseleted[0]<=row_ed&&rowseleted[0]>=row_st){height+=top-row_pre;top=row_pre;rowseleted[0]=row_st;}if(rowseleted[1]>=row_st&&rowseleted[1]<=row_ed){if(s.row_focus>=row_st&&s.row_focus<=row_ed){height=row-top;}else {height=row-top;}rowseleted[1]=row_ed;}}if(!(rowseleted[1]<row_st||rowseleted[0]>row_ed)){if(columnseleted[0]<=col_ed&&columnseleted[0]>=col_st){width+=left-col_pre;left=col_pre;columnseleted[0]=col_st;}if(columnseleted[1]>=col_st&&columnseleted[1]<=col_ed){if(s.column_focus>=col_st&&s.column_focus<=col_ed){width=col-left;}else {width=col-left;}columnseleted[1]=col_ed;}}ismatch=true;}}if(ismatch){return [columnseleted,rowseleted,top,height,left,width];}return null;}function mergeMoveMain(ctx,columnseleted,rowseleted,s,top,height,left,width){var mergesetting=ctx.config.merge;if(!mergesetting){return null;}var mcset=Object.keys(mergesetting);rowseleted[1]=Math.max(rowseleted[0],rowseleted[1]);columnseleted[1]=Math.max(columnseleted[0],columnseleted[1]);var offloop=true;var mergeMoveData={};while(offloop){offloop=false;for(var i=0;i<mcset.length;i+=1){var key=mcset[i];var mc=mergesetting[key];if(key in mergeMoveData){continue;}var changeparam=mergeMove(ctx,mc,columnseleted,rowseleted,s,top,height,left,width);if(changeparam!=null){mergeMoveData[key]=mc;var _changeparam=_slicedToArray$3(changeparam,6);columnseleted=_changeparam[0];rowseleted=_changeparam[1];top=_changeparam[2];height=_changeparam[3];left=_changeparam[4];width=_changeparam[5];offloop=true;}else {delete mergeMoveData[key];}}}return [columnseleted,rowseleted,top,height,left,width];}function cancelFunctionrangeSelected(ctx){if(ctx.formulaCache.selectingRangeIndex===-1){ctx.formulaRangeSelect=undefined;}}function cancelNormalSelected(ctx){cancelFunctionrangeSelected(ctx);ctx.luckysheetCellUpdate=[];ctx.formulaRangeHighlight=[];ctx.functionHint=null;ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;}function updateCell(ctx,r,c,$input,value){var _inputText,_curv,_ctx$hooks$beforeUpda,_ctx$hooks;var inputText=$input===null||$input===void 0?void 0:$input.innerText;var inputHtml=$input===null||$input===void 0?void 0:$input.innerHTML;var flowdata=getFlowdata(ctx);if(!flowdata)return;var curv=flowdata[r][c];var oldValue=lodash.cloneDeep(curv);var isPrevInline=isInlineStringCell(curv);var isCurInline=((_inputText=inputText)===null||_inputText===void 0?void 0:_inputText.slice(0,1))!=="="&&(inputHtml===null||inputHtml===void 0?void 0:inputHtml.substring(0,5))==="<span";var isCopyVal=false;if(!isCurInline&&inputText&&inputText.length>0){var splitArr=inputText.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_").split("_x000D_");if(splitArr.length>1){isCopyVal=true;isCurInline=true;inputText=splitArr.join("\r\n");}}if(((_curv=curv)===null||_curv===void 0?void 0:_curv.ct)&&!value&&!isCurInline&&isPrevInline){delete curv.ct.s;curv.ct.t="g";curv.ct.fa="General";value="";}else if(isCurInline){if(!lodash.isPlainObject(curv)){curv={};}curv||(curv={});delete curv.f;delete curv.v;delete curv.m;if(!curv.ct){curv.ct={};curv.ct.fa="General";}curv.ct.t="inlineStr";curv.ct.s=convertSpanToShareString($input.querySelectorAll("span"));if(isCopyVal){curv.ct.s=[{v:inputText}];}}value=value||($input===null||$input===void 0?void 0:$input.innerText);if(((_ctx$hooks$beforeUpda=(_ctx$hooks=ctx.hooks).beforeUpdateCell)===null||_ctx$hooks$beforeUpda===void 0?void 0:_ctx$hooks$beforeUpda.call(_ctx$hooks,r,c,value))===false){cancelNormalSelected(ctx);return;}if(!isCurInline){if(isRealNull(value)&&!isPrevInline){if(!curv||isRealNull(curv.v)&&!curv.spl&&!curv.f){cancelNormalSelected(ctx);return;}}else if(curv&&curv.qp!==1){if(lodash.isPlainObject(curv)&&(value===curv.f||value===curv.v||value===curv.m)){cancelNormalSelected(ctx);return;}if(value===curv){cancelNormalSelected(ctx);return;}}if(lodash.isString(value)&&value.slice(0,1)==="="&&value.length>1);else if(lodash.isPlainObject(curv)&&curv&&curv.ct&&curv.ct.fa&&curv.ct.fa!=="@"&&!isRealNull(value)){delete curv.m;if(curv.f){delete curv.f;delete curv.spl;}}}var d=flowdata;var dynamicArrayItem=null;if(lodash.isPlainObject(curv)){if(!isCurInline){if(lodash.isString(value)&&value.slice(0,1)==="="&&value.length>1){var _d$r;var v=execfunction(ctx,value,r,c,undefined,true);curv=lodash.cloneDeep((d===null||d===void 0?void 0:(_d$r=d[r])===null||_d$r===void 0?void 0:_d$r[c])||{});var _v=_slicedToArray$3(v,3);curv.v=_v[1];curv.f=_v[2];if(v.length===4&&v[3].type==="sparklines"){delete curv.m;delete curv.v;var curCalv=v[3].data;if(lodash.isArray(curCalv)&&!lodash.isPlainObject(curCalv[0])){var _curCalv=_slicedToArray$3(curCalv,1);curv.v=_curCalv[0];}else {curv.spl=v[3].data;}}else if(v.length===4&&v[3].type==="dynamicArrayItem"){dynamicArrayItem=v[3].data;}}else if(lodash.isPlainObject(value)){var valueFunction=value.f;if(lodash.isString(valueFunction)&&valueFunction.slice(0,1)==="="&&valueFunction.length>1){var _d$r2;var _v2=execfunction(ctx,valueFunction,r,c,undefined,true);curv=lodash.cloneDeep((d===null||d===void 0?void 0:(_d$r2=d[r])===null||_d$r2===void 0?void 0:_d$r2[c])||{});var _v3=_slicedToArray$3(_v2,3);curv.v=_v3[1];curv.f=_v3[2];if(_v2.length===4&&_v2[3].type==="sparklines"){delete curv.m;delete curv.v;var _curCalv2=_v2[3].data;if(lodash.isArray(_curCalv2)&&!lodash.isPlainObject(_curCalv2[0])){var _curCalv3=_slicedToArray$3(_curCalv2,1);curv.v=_curCalv3[0];}else {curv.spl=_v2[3].data;}}else if(_v2.length===4&&_v2[3].type==="dynamicArrayItem"){dynamicArrayItem=_v2[3].data;}}else {Object.keys(value).forEach(function(attr){curv[attr]=value[attr];});}}else {var _d$r3;delFunctionGroup(ctx,r,c);execFunctionGroup(ctx,r,c,value);curv=lodash.cloneDeep((d===null||d===void 0?void 0:(_d$r3=d[r])===null||_d$r3===void 0?void 0:_d$r3[c])||{});curv.v=value;delete curv.f;delete curv.spl;if(curv.qp===1&&"".concat(value).substring(0,1)!=="'"){curv.qp=0;if(curv.ct){curv.ct.fa="General";curv.ct.t="n";}}}}value=curv;}else {if(lodash.isString(value)&&value.slice(0,1)==="="&&value.length>1){var _v4=execfunction(ctx,value,r,c,undefined,true);value={v:_v4[1],f:_v4[2]};if(_v4.length===4&&_v4[3].type==="sparklines"){var _curCalv4=_v4[3].data;if(lodash.isArray(_curCalv4)&&!lodash.isPlainObject(_curCalv4[0])){var _curCalv5=_slicedToArray$3(_curCalv4,1);value.v=_curCalv5[0];}else {value.spl=_v4[3].data;}}else if(_v4.length===4&&_v4[3].type==="dynamicArrayItem"){dynamicArrayItem=_v4[3].data;}}else if(lodash.isPlainObject(value)){var _valueFunction=value.f;if(lodash.isString(_valueFunction)&&_valueFunction.slice(0,1)==="="&&_valueFunction.length>1){var _v5=execfunction(ctx,_valueFunction,r,c,undefined,true);var _v6=_slicedToArray$3(_v5,3);value.v=_v6[1];value.f=_v6[2];if(_v5.length===4&&_v5[3].type==="sparklines"){var _curCalv6=_v5[3].data;if(lodash.isArray(_curCalv6)&&!lodash.isPlainObject(_curCalv6[0])){var _curCalv7=_slicedToArray$3(_curCalv6,1);value.v=_curCalv7[0];}else {value.spl=_v5[3].data;}}else if(_v5.length===4&&_v5[3].type==="dynamicArrayItem"){dynamicArrayItem=_v5[3].data;}}else {var _v7=curv;if(lodash.isNil(value.v)){value.v=_v7;}}}else {delFunctionGroup(ctx,r,c);execFunctionGroup(ctx,r,c,value);}}setCellValue(ctx,r,c,d,value);cancelNormalSelected(ctx);if(ctx.hooks.afterUpdateCell){setTimeout(function(){var _ctx$hooks$afterUpdat,_ctx$hooks2;(_ctx$hooks$afterUpdat=(_ctx$hooks2=ctx.hooks).afterUpdateCell)===null||_ctx$hooks$afterUpdat===void 0?void 0:_ctx$hooks$afterUpdat.call(_ctx$hooks2,r,c,oldValue,lodash.cloneDeep(flowdata[r][c]));});}ctx.formulaCache.execFunctionGlobalData=null;}function getOrigincell(ctx,r,c,i){var flowdata=getFlowdata(ctx);if(lodash.isNil(r)||lodash.isNil(c)){return null;}var data;if(lodash.isNil(i)){data=flowdata;}else {var sheet=getSheetByIndex(ctx,i);data=sheet===null||sheet===void 0?void 0:sheet.data;}if(!data||!data[r]||!data[r][c]){return null;}return data[r][c];}function getcellFormula(ctx,r,c,i,data){var cell;if(!lodash.isNil(data)){cell=data[r][c];}else {cell=getOrigincell(ctx,r,c,i);}if(lodash.isNil(cell)){return null;}return cell.f;}function getRange(ctx){var rangeArr=lodash.cloneDeep(ctx.luckysheet_select_save);var result=[];if(!rangeArr)return result;for(var i=0;i<rangeArr.length;i+=1){var rangeItem=rangeArr[i];var temp={row:rangeItem.row,column:rangeItem.column};result.push(temp);}return result;}function getFlattenedRange(ctx,range){range=range||getRange(ctx);var result=[];range.forEach(function(ele){var rs=ele.row;var cs=ele.column;for(var r=rs[0];r<=rs[1];r+=1){for(var c=cs[0];c<=cs[1];c+=1){result.push({r:r,c:c});}}});return result;}function getRangetxt(ctx,sheetId,range,currentId){var sheettxt="";if(currentId==null){currentId=ctx.currentSheetId;}if(sheetId!==currentId){var index=getSheetIndex(ctx,sheetId);if(index==null)return "";sheettxt=ctx.luckysheetfile[index].name.replace(/'/g,"''");if(/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/.test(sheettxt)){sheettxt+="!";}else {sheettxt="'".concat(sheettxt,"'!");}}var row0=range.row[0];var row1=range.row[1];var column0=range.column[0];var column1=range.column[1];if(row0==null&&row1==null){return "".concat(sheettxt+indexToColumnChar(column0),":").concat(indexToColumnChar(column1));}if(column0==null&&column1==null){return "".concat(sheettxt+(row0+1),":").concat(row1+1);}if(column0===column1&&row0===row1){return sheettxt+indexToColumnChar(column0)+(row0+1);}return "".concat(sheettxt+indexToColumnChar(column0)+(row0+1),":").concat(indexToColumnChar(column1)).concat(row1+1);}function isAllSelectedCellsInStatus(ctx,attr,status){if(!lodash.isEmpty(ctx.luckysheetCellUpdate)){var _startContainer$paren2,_endContainer$parentE;var w=window.getSelection();if(!w)return false;var range=w.getRangeAt(0);if(range.collapsed===true){return false;}var endContainer=range.endContainer;var startContainer=range.startContainer;var cssField=lodash.camelCase(attrToCssName[attr]);if(startContainer===endContainer){var _startContainer$paren;return !lodash.isEmpty((_startContainer$paren=startContainer.parentElement)===null||_startContainer$paren===void 0?void 0:_startContainer$paren.style[cssField]);}if(((_startContainer$paren2=startContainer.parentElement)===null||_startContainer$paren2===void 0?void 0:_startContainer$paren2.tagName)==="SPAN"&&((_endContainer$parentE=endContainer.parentElement)===null||_endContainer$parentE===void 0?void 0:_endContainer$parentE.tagName)==="SPAN"){var _startSpan$parentNode;var startSpan=startContainer.parentNode;var endSpan=endContainer.parentNode;var allSpans=startSpan===null||startSpan===void 0?void 0:(_startSpan$parentNode=startSpan.parentNode)===null||_startSpan$parentNode===void 0?void 0:_startSpan$parentNode.querySelectorAll("span");if(allSpans){var startSpanIndex=lodash.indexOf(allSpans,startSpan);var endSpanIndex=lodash.indexOf(allSpans,endSpan);var rangeSpans=[];for(var i=startSpanIndex;i<=endSpanIndex;i+=1){rangeSpans.push(allSpans[i]);}return lodash.every(rangeSpans,function(s){return !lodash.isEmpty(s.style[cssField]);});}}}var cells=getFlattenedRange(ctx);var flowdata=getFlowdata(ctx);return cells.every(function(_ref){var _flowdata$r;var r=_ref.r,c=_ref.c;var cell=flowdata===null||flowdata===void 0?void 0:(_flowdata$r=flowdata[r])===null||_flowdata$r===void 0?void 0:_flowdata$r[c];if(lodash.isNil(cell)){return false;}return cell[attr]===status;});}function getFontStyleByCell(cell,checksAF,checksCF){var isCheck=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var style={};if(!cell){return style;}lodash.forEach(cell,function(v,key){var _checksAF$length;var value=cell[key];if(isCheck){value=normalizedCellAttr(cell,key);}var valueNum=Number(value);if(key==="bl"&&valueNum!==0){style.fontWeight="bold";}if(key==="it"&&valueNum!==0){style.fontStyle="italic";}if(key==="fs"&&valueNum!==10){style.fontSize="".concat(valueNum,"pt");}if(key==="fc"&&value!=="#000000"||((_checksAF$length=checksAF===null||checksAF===void 0?void 0:checksAF.length)!==null&&_checksAF$length!==void 0?_checksAF$length:0)>0||(checksCF===null||checksCF===void 0?void 0:checksCF.textColor)){var _checksAF$length2;if(checksCF===null||checksCF===void 0?void 0:checksCF.textColor){style.color=checksCF.textColor;}else if(((_checksAF$length2=checksAF===null||checksAF===void 0?void 0:checksAF.length)!==null&&_checksAF$length2!==void 0?_checksAF$length2:0)>0){var _checksAF=_slicedToArray$3(checksAF,1);style.color=_checksAF[0];}else {style.color=value;}}if(key==="cl"&&valueNum!==0){style.textDecoration="line-through";}if(key==="un"&&(valueNum===1||valueNum===3)){var _cell$_color,_cell$_fontSize;var color=(_cell$_color=cell._color)!==null&&_cell$_color!==void 0?_cell$_color:cell.fc;var fs=(_cell$_fontSize=cell._fontSize)!==null&&_cell$_fontSize!==void 0?_cell$_fontSize:cell.fs;style.borderBottom="".concat(Math.floor(fs/9),"px solid ").concat(color);}});return style;}function getStyleByCell(d,r,c){var style={};var checksAF=[];var checksCF={};var cell=d[r][c];if(!cell)return {};var isInline=isInlineStringCell(cell);if("bg"in cell){var value=normalizedCellAttr(cell,"bg");if(checksCF===null||checksCF===void 0?void 0:checksCF.cellColor){if(checksCF===null||checksCF===void 0?void 0:checksCF.cellColor){style.background="".concat(checksCF.cellColor);}else if(checksAF.length>1){style.background="".concat(checksAF[1]);}else {style.background="".concat(value);}}}if("ht"in cell){var _value2=normalizedCellAttr(cell,"ht");if(Number(_value2)===0){style.textAlign="center";}else if(Number(_value2)===2){style.textAlign="right";}}if("vt"in cell){var _value3=normalizedCellAttr(cell,"vt");if(Number(_value3)===0){style.alignItems="center";}else if(Number(_value3)===2){style.alignItems="flex-end";}}if(!isInline){style=lodash.assign(style,getFontStyleByCell(cell,checksAF,checksCF));}return style;}function getInlineStringHTML(r,c,data){var ct=getCellValue(r,c,data,"ct");if(isInlineStringCT(ct)){var strings=ct.s;var value="";for(var i=0;i<strings.length;i+=1){var strObj=strings[i];if(strObj.v){var style=getFontStyleByCell(strObj);var styleStr=lodash.map(style,function(v,key){return "".concat(lodash.kebabCase(key),":").concat(lodash.isNumber(v)?"".concat(v,"px"):v,";");}).join("");value+="<span index='".concat(i,"' style='").concat(styleStr,"'>").concat(strObj.v,"</span>");}}return value;}return "";}function getQKBorder(width,type,color){var bordertype="";if(width.toString().indexOf("pt")>-1){var nWidth=parseFloat(width);if(nWidth<1);else if(nWidth<1.5){bordertype="Medium";}else {bordertype="Thick";}}else {var _nWidth=parseFloat(width);if(_nWidth<2);else if(_nWidth<3){bordertype="Medium";}else {bordertype="Thick";}}var style=0;type=type.toLowerCase();if(type==="double"){style=2;}else if(type==="dotted"){if(bordertype==="Medium"||bordertype==="Thick"){style=3;}else {style=10;}}else if(type==="dashed"){if(bordertype==="Medium"||bordertype==="Thick"){style=4;}else {style=9;}}else if(type==="solid"){if(bordertype==="Medium"){style=8;}else if(bordertype==="Thick"){style=13;}else {style=1;}}return [style,color];}function getdatabyselection(ctx,range,sheetId){if(range==null&&ctx.luckysheet_select_save){var _ctx$luckysheet_selec=_slicedToArray$3(ctx.luckysheet_select_save,1);range=_ctx$luckysheet_selec[0];}if(!range)return [];if(range.row==null||range.row.length===0){return [];}var d;var cfg;if(sheetId!=null&&sheetId!==ctx.currentSheetId){d=ctx.luckysheetfile[getSheetIndex(ctx,sheetId)].data;cfg=ctx.luckysheetfile[getSheetIndex(ctx,sheetId)].config;}else {d=getFlowdata(ctx);cfg=ctx.config;}var data=[];for(var r=range.row[0];r<=range.row[1];r+=1){var _d,_cfg;if(((_d=d)===null||_d===void 0?void 0:_d[r])==null){continue;}if(((_cfg=cfg)===null||_cfg===void 0?void 0:_cfg.rowhidden)!=null&&cfg.rowhidden[r]!=null){continue;}var row=[];for(var c=range.column[0];c<=range.column[1];c+=1){row.push(d[r][c]);}data.push(row);}return data;}function luckysheetUpdateCell(ctx,row_index,col_index){ctx.luckysheetCellUpdate=[row_index,col_index];}var clipboard=/*#__PURE__*/function(){function clipboard(){_classCallCheck$2(this,clipboard);}_createClass$2(clipboard,null,[{key:"writeHtml",value:function writeHtml(str){try{var ele=document.getElementById("fortune-copy-content");if(!ele){var _document$querySelect;ele=document.createElement("div");ele.setAttribute("contentEditable","true");ele.id="fortune-copy-content";ele.style.position="fixed";ele.style.height="0";ele.style.width="0";ele.style.left="-10000px";(_document$querySelect=document.querySelector(".fortune-container"))===null||_document$querySelect===void 0?void 0:_document$querySelect.append(ele);}ele.style.display="block";ele.innerHTML=str;ele.focus({preventScroll:true});document.execCommand("selectAll");document.execCommand("copy");ele.style.display="none";}catch(e){console.error(e);}}}]);return clipboard;}();var selectionCache={isPasteAction:false};function seletedHighlistByindex(ctx,r1,r2,c1,c2){var row=ctx.visibledatarow[r2];var row_pre=r1-1===-1?0:ctx.visibledatarow[r1-1];var col=ctx.visibledatacolumn[c2];var col_pre=c1-1===-1?0:ctx.visibledatacolumn[c1-1];return {left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1};}function normalizeSelection(ctx,selection){if(!selection)return selection;var flowdata=getFlowdata(ctx);if(!flowdata)return selection;for(var i=0;i<selection.length;i+=1){var r1=selection[i].row[0];var r2=selection[i].row[1];var c1=selection[i].column[0];var c2=selection[i].column[1];var rf=void 0;var cf=void 0;if(lodash.isNil(selection[i].row_focus)){rf=r1;}else {rf=selection[i].row_focus;}if(lodash.isNil(selection[i].column_focus)){cf=c1;}else {cf=selection[i].column_focus;}if(lodash.isNil(rf)||lodash.isNil(cf)){console.error("normalizeSelection: rf and cf is nil");return selection;}var row=ctx.visibledatarow[r2];var row_pre=r1-1===-1?0:ctx.visibledatarow[r1-1];var col=ctx.visibledatacolumn[c2];var col_pre=c1-1===-1?0:ctx.visibledatacolumn[c1-1];var row_f=ctx.visibledatarow[rf];var row_pre_f=rf-1===-1?0:ctx.visibledatarow[rf-1];var col_f=ctx.visibledatacolumn[cf];var col_pre_f=cf-1===-1?0:ctx.visibledatacolumn[cf-1];var margeset=mergeBorder(ctx,flowdata,rf,cf);if(margeset){var _margeset$row=_slicedToArray$3(margeset.row,2);row_pre_f=_margeset$row[0];row_f=_margeset$row[1];var _margeset$column=_slicedToArray$3(margeset.column,2);col_pre_f=_margeset$column[0];col_f=_margeset$column[1];}selection[i].row=[r1,r2];selection[i].column=[c1,c2];selection[i].row_focus=rf;selection[i].column_focus=cf;selection[i].left=col_pre_f;selection[i].width=col_f-col_pre_f-1;selection[i].top=row_pre_f;selection[i].height=row_f-row_pre_f-1;selection[i].left_move=col_pre;selection[i].width_move=col-col_pre-1;selection[i].top_move=row_pre;selection[i].height_move=row-row_pre-1;}return selection;}function selectTitlesMap(rangeMap,range1,range2){var map=rangeMap||{};for(var i=range1;i<=range2;i+=1){if(i in map){continue;}map[i]=0;}return map;}function selectTitlesRange(map){var mapArr=Object.keys(map).map(Number);mapArr.sort(function(a,b){return a-b;});var rangeArr;var item=[];if(mapArr.length>1){rangeArr=[];for(var j=1;j<mapArr.length;j+=1){if(mapArr[j]-mapArr[j-1]===1){item.push(mapArr[j-1]);if(j===mapArr.length-1){item.push(mapArr[j]);rangeArr.push(item);}}else {if(j===1){if(j===mapArr.length-1){item.push(mapArr[j-1]);rangeArr.push(item);rangeArr.push([mapArr[j]]);}else {rangeArr.push([mapArr[0]]);}}else if(j===mapArr.length-1){item.push(mapArr[j-1]);rangeArr.push(item);rangeArr.push([mapArr[j]]);}else {item.push(mapArr[j-1]);rangeArr.push(item);item=[];}}}}else {rangeArr=[];rangeArr.push([mapArr[0]]);}return rangeArr;}function pasteHandlerOfPaintModel(ctx,copyRange){var cfg=ctx.config;if(cfg.merge==null){cfg.merge={};}if(!copyRange)return;var copyHasMC=copyRange.HasMC;var copySheetIndex=copyRange.dataSheetId;var c_r1=copyRange.copyRange[0].row[0];var c_r2=copyRange.copyRange[0].row[1];var c_c1=copyRange.copyRange[0].column[0];var c_c2=copyRange.copyRange[0].column[1];var copyData=lodash.cloneDeep(getdatabyselection(ctx,{row:[c_r1,c_r2],column:[c_c1,c_c2]},copySheetIndex));if(!ctx.luckysheet_select_save)return;var last=ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1];var minh=last.row[0];var maxh=last.row[1];var minc=last.column[0];var maxc=last.column[1];var copyh=copyData.length;var copyc=copyData[0].length;if(minh===maxh&&minc===maxc){var has_PartMC=false;if(cfg.merge!=null){has_PartMC=hasPartMC(ctx,cfg,minh,minh+copyh-1,minc,minc+copyc-1);}if(has_PartMC){return;}maxh=minh+copyh-1;maxc=minc+copyc-1;}var timesH=Math.ceil((maxh-minh+1)/copyh);var timesC=Math.ceil((maxc-minc+1)/copyc);var flowdata=getFlowdata(ctx);if(flowdata==null)return;var cellMaxLength=flowdata[0].length;var rowMaxLength=flowdata.length;var borderInfoCompute=getBorderInfoCompute(ctx,copySheetIndex);var c_dataVerification=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetIndex)].dataVerification)||{};var dataVerification=null;var mth=0;var mtc=0;var maxcellCahe=0;var maxrowCache=0;for(var th=1;th<=timesH;th+=1){for(var tc=1;tc<=timesC;tc+=1){mth=minh+(th-1)*copyh;mtc=minc+(tc-1)*copyc;maxrowCache=minh+th*copyh>rowMaxLength?rowMaxLength:minh+th*copyh;if(maxrowCache>maxh+1){maxrowCache=maxh+1;}maxcellCahe=minc+tc*copyc>cellMaxLength?cellMaxLength:minc+tc*copyc;if(maxcellCahe>maxc+1){maxcellCahe=maxc+1;}var offsetMC={};var _loop=function _loop(h){if(h==null)return {v:void 0};if(flowdata[h]==null)return {v:void 0};var x=[];x=flowdata[h];var _loop2=function _loop2(c){if(borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)]){var bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].l,r:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].r,t:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].t,b:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].b}};if(cfg.borderInfo==null){cfg.borderInfo=[];}cfg.borderInfo.push(bd_obj);}else if(borderInfoCompute["".concat(h,"_").concat(c)]){var _bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:null,r:null,t:null,b:null}};if(cfg.borderInfo==null){cfg.borderInfo=[];}cfg.borderInfo.push(_bd_obj);}if(c_dataVerification["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)]){if(dataVerification==null){dataVerification=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].dataVerification);}dataVerification["".concat(h,"_").concat(c)]=c_dataVerification["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)];}if(lodash.isPlainObject(x[c])&&x[c].mc){if(x[c].mc.rs){delete cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)];}delete x[c].mc;}var value=null;if(copyData[h-mth]!=null&&copyData[h-mth][c-mtc]!=null){value=copyData[h-mth][c-mtc];}if(value!=null){delete value.v;delete value.m;delete value.f;delete value.spl;if(value.ct&&value.ct.t==="inlineStr"){delete value.ct;}if(lodash.isPlainObject(x[c])){if(x[c].ct&&x[c].ct.t==="inlineStr"){delete value.ct;}else {var format=["bg","fc","ct","ht","vt","bl","it","cl","un","fs","ff","tb"];format.forEach(function(item){Reflect.deleteProperty(x[c],item);});}}else {x[c]={v:x[c]};}x[c]=lodash.assign(value,x[c]);if(x[c].ct&&x[c].ct.t==="inlineStr"){x[c].ct.s.forEach(function(item){return lodash.assign(value,item);});}if(copyHasMC&&x[c].mc){if(x[c].mc.rs!=null){x[c].mc.r=h;if(x[c].mc.rs+h>=maxrowCache){x[c].mc.rs=maxrowCache-h;}x[c].mc.c=c;if(x[c].mc.cs+c>=maxcellCahe){x[c].mc.cs=maxcellCahe-c;}cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)]=x[c].mc;offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)]=[x[c].mc.r,x[c].mc.c];}else {x[c]={mc:{r:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][0],c:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][1]}};}}if(x[c].v!=null){if(value.ct!=null&&value.ct.fa!=null){var mask=update(value.ct.fa,x[c].v);x[c].m=mask;}}}};for(var c=mtc;c<maxcellCahe;c+=1){_loop2(c);}flowdata[h]=x;};for(var h=mth;h<maxrowCache;h+=1){var _ret=_loop(h);if(_typeof$1(_ret)==="object")return _ret.v;}}}var currFile=ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)];currFile.config=cfg;currFile.dataVerification=dataVerification;}function selectionCopyShow(range,ctx){if(range==null){range=ctx.luckysheet_selection_range;}range=JSON.parse(JSON.stringify(range));}function moveHighlightCell(ctx,postion,index,type){var flowdata=getFlowdata(ctx);if(!flowdata)return;var datarowlen=flowdata.length;var datacolumnlen=flowdata[0].length;var row;var row_pre;var row_index;var row_index_ed;var col;var col_pre;var col_index;var col_index_ed;if(type==="rangeOfSelect"){var _ctx$luckysheet_selec;var last=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[ctx.luckysheet_select_save.length-1];if(!last){console.error("moveHighlightCell: no selection found");return;}var curR;if(lodash.isNil(last.row_focus)){var _last$row=_slicedToArray$3(last.row,1);curR=_last$row[0];}else {curR=last.row_focus;}var curC;if(lodash.isNil(last.column_focus)){var _last$column=_slicedToArray$3(last.column,1);curC=_last$column[0];}else {curC=last.column_focus;}var margeset=mergeBorder(ctx,flowdata,curR,curC);if(margeset){var str_r=margeset.row[2];var end_r=margeset.row[3];var str_c=margeset.column[2];var end_c=margeset.column[3];if(index>0){if(postion==="down"){curR=end_r;curC=str_c;}else if(postion==="right"){curR=str_r;curC=end_c;}}else {curR=str_r;curC=str_c;}}if(lodash.isNil(curR)||lodash.isNil(curC)){console.error("moveHighlightCell: curR or curC is nil");return;}var moveX=lodash.isNil(last.moveXY)?curR:last.moveXY.x;var moveY=lodash.isNil(last.moveXY)?curC:last.moveXY.y;if(postion==="down"){curR+=index;moveX=curR;}else if(postion==="right"){curC+=index;moveY=curC;}if(curR>=datarowlen){curR=datarowlen-1;moveX=curR;}if(curR<0){curR=0;moveX=curR;}if(curC>=datacolumnlen){curC=datacolumnlen-1;moveY=curC;}if(curC<0){curC=0;moveY=curC;}var margeset2=mergeBorder(ctx,flowdata,curR,curC);if(margeset2){var _margeset2$row=_slicedToArray$3(margeset2.row,4);row_pre=_margeset2$row[0];row=_margeset2$row[1];row_index=_margeset2$row[2];row_index_ed=_margeset2$row[3];var _margeset2$column=_slicedToArray$3(margeset2.column,4);col_pre=_margeset2$column[0];col=_margeset2$column[1];col_index=_margeset2$column[2];col_index_ed=_margeset2$column[3];}else {row=ctx.visibledatarow[moveX];row_pre=moveX-1===-1?0:ctx.visibledatarow[moveX-1];col=ctx.visibledatacolumn[moveY];col_pre=moveY-1===-1?0:ctx.visibledatacolumn[moveY-1];row_index=curR;row_index_ed=curR;col_index=curC;col_index_ed=curC;}if(lodash.isNil(row_index)||lodash.isNil(row_index_ed)||lodash.isNil(col_index)||lodash.isNil(col_index_ed)){console.error("moveHighlightCell: row_index or row_index_ed or col_index or col_index_ed is nil");return;}last.row=[row_index,row_index_ed];last.column=[col_index,col_index_ed];last.row_focus=row_index;last.column_focus=col_index;last.moveXY={x:moveX,y:moveY};normalizeSelection(ctx,ctx.luckysheet_select_save);}else if(type==="rangeOfFormula"){var _last=ctx.formulaCache.func_selectedrange;if(!_last)return;var _curR;if(lodash.isNil(_last.row_focus)){var _last$row2=_slicedToArray$3(_last.row,1);_curR=_last$row2[0];}else {_curR=_last.row_focus;}var _curC;if(lodash.isNil(_last.column_focus)){var _last$column2=_slicedToArray$3(_last.column,1);_curC=_last$column2[0];}else {_curC=_last.column_focus;}var _margeset=mergeBorder(ctx,flowdata,_curR,_curC);if(_margeset){var _str_r=_margeset.row[2];var _end_r=_margeset.row[3];var _str_c=_margeset.column[2];var _end_c=_margeset.column[3];if(index>0){if(postion==="down"){_curR=_end_r;_curC=_str_c;}else if(postion==="right"){_curR=_str_r;_curC=_end_c;}}else {_curR=_str_r;_curC=_str_c;}}if(lodash.isNil(_curR)||lodash.isNil(_curC)){console.error("moveHighlightCell: curR or curC is nil");return;}var _moveX=lodash.isNil(_last.moveXY)?_curR:_last.moveXY.x;var _moveY=lodash.isNil(_last.moveXY)?_curC:_last.moveXY.y;if(postion==="down"){_curR+=index;_moveX=_curR;}else if(postion==="right"){_curC+=index;_moveY=_curC;}if(_curR>=datarowlen){_curR=datarowlen-1;_moveX=_curR;}if(_curR<0){_curR=0;_moveX=_curR;}if(_curC>=datacolumnlen){_curC=datacolumnlen-1;_moveY=_curC;}if(_curC<0){_curC=0;_moveY=_curC;}var _margeset2=mergeBorder(ctx,flowdata,_curR,_curC);if(_margeset2){var _margeset2$row2=_slicedToArray$3(_margeset2.row,4);row_pre=_margeset2$row2[0];row=_margeset2$row2[1];row_index=_margeset2$row2[2];row_index_ed=_margeset2$row2[3];var _margeset2$column2=_slicedToArray$3(_margeset2.column,4);col_pre=_margeset2$column2[0];col=_margeset2$column2[1];col_index=_margeset2$column2[2];col_index_ed=_margeset2$column2[3];}else {row=ctx.visibledatarow[_moveX];row_pre=_moveX-1===-1?0:ctx.visibledatarow[_moveX-1];row_index=_moveX;row_index_ed=_moveX;col=ctx.visibledatacolumn[_moveY];col_pre=_moveY-1===-1?0:ctx.visibledatacolumn[_moveY-1];col_index=_moveY;col_index_ed=_moveY;}if(lodash.isNil(col)||lodash.isNil(col_pre)||lodash.isNil(row)||lodash.isNil(row_pre)||lodash.isNil(row_index)||lodash.isNil(row_index_ed)||lodash.isNil(col_index)||lodash.isNil(col_index_ed)){console.error("moveHighlightCell: some values of func_selectedrange is nil");return;}ctx.formulaCache.func_selectedrange={left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1,left_move:col_pre,width_move:col-col_pre-1,top_move:row_pre,height_move:row-row_pre-1,row:[row_index,row_index_ed],column:[col_index,col_index_ed],row_focus:row_index,column_focus:col_index,moveXY:{x:_moveX,y:_moveY}};}}function getHtmlBorderStyle(type,color){var style="";var borderType={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"};type=borderType[type.toString()];if(type.indexOf("Medium")>-1){style+="1pt ";}else if(type==="Thick"){style+="1.5pt ";}else {style+="0.5pt ";}if(type==="Hair"){style+="double ";}else if(type.indexOf("DashDotDot")>-1){style+="dotted ";}else if(type.indexOf("DashDot")>-1){style+="dashed ";}else if(type.indexOf("Dotted")>-1){style+="dotted ";}else if(type.indexOf("Dashed")>-1){style+="dashed ";}else {style+="solid ";}return "".concat(style+color,";");}function rangeValueToHtml(ctx,sheetId,ranges){var _sheet$config5;var idx=getSheetIndex(ctx,sheetId);if(idx==null)return "";var sheet=ctx.luckysheetfile[idx];var rowIndexArr=[];var colIndexArr=[];for(var s=0;s<((_ranges$length=ranges===null||ranges===void 0?void 0:ranges.length)!==null&&_ranges$length!==void 0?_ranges$length:0);s+=1){var _ranges$length;var range=ranges[s];var r1=range.row[0];var r2=range.row[1];var c1=range.column[0];var c2=range.column[1];for(var copyR=r1;copyR<=r2;copyR+=1){var _sheet$config,_sheet$config2;if(!lodash.isNil((_sheet$config=sheet.config)===null||_sheet$config===void 0?void 0:_sheet$config.rowhidden)&&!lodash.isNil((_sheet$config2=sheet.config)===null||_sheet$config2===void 0?void 0:_sheet$config2.rowhidden[copyR])){continue;}if(!rowIndexArr.includes(copyR)){rowIndexArr.push(copyR);}for(var copyC=c1;copyC<=c2;copyC+=1){var _sheet$config3,_sheet$config4;if(!lodash.isNil((_sheet$config3=sheet.config)===null||_sheet$config3===void 0?void 0:_sheet$config3.colhidden)&&!lodash.isNil((_sheet$config4=sheet.config)===null||_sheet$config4===void 0?void 0:_sheet$config4.colhidden[copyC])){continue;}if(!colIndexArr.includes(copyC)){colIndexArr.push(copyC);}}}}var borderInfoCompute;if(((_sheet$config5=sheet.config)===null||_sheet$config5===void 0?void 0:_sheet$config5.borderInfo)&&sheet.config.borderInfo.length>0){borderInfoCompute=getBorderInfoCompute(ctx,sheetId);}var cpdata="";var d=sheet.data;if(!d)return null;var colgroup="";for(var i=0;i<rowIndexArr.length;i+=1){var _sheet$config6,_sheet$config7;var r=rowIndexArr[i];if(!lodash.isNil((_sheet$config6=sheet.config)===null||_sheet$config6===void 0?void 0:_sheet$config6.rowhidden)&&!lodash.isNil((_sheet$config7=sheet.config)===null||_sheet$config7===void 0?void 0:_sheet$config7.rowhidden[r])){continue;}cpdata+="<tr>";for(var j=0;j<colIndexArr.length;j+=1){var _sheet$config8,_sheet$config9,_d$r;var c=colIndexArr[j];if(!lodash.isNil((_sheet$config8=sheet.config)===null||_sheet$config8===void 0?void 0:_sheet$config8.colhidden)&&!lodash.isNil((_sheet$config9=sheet.config)===null||_sheet$config9===void 0?void 0:_sheet$config9.colhidden[c])){continue;}var column='<td ${span} style="${style}">';var cell=(_d$r=d[r])===null||_d$r===void 0?void 0:_d$r[c];if(cell!=null){var style="";var span="";if(r===rowIndexArr[0]){if(lodash.isNil(sheet.config)||lodash.isNil(sheet.config.columnlen)||lodash.isNil(sheet.config.columnlen[c.toString()])){colgroup+='<colgroup width="72px"></colgroup>';}else {colgroup+="<colgroup width=\"".concat(sheet.config.columnlen[c.toString()],"px\"></colgroup>");}}if(c===colIndexArr[0]){if(lodash.isNil(sheet.config)||lodash.isNil(sheet.config.rowlen)||lodash.isNil(sheet.config.rowlen[r.toString()])){style+="height:19px;";}else {style+="height:".concat(sheet.config.rowlen[r.toString()],"px;");}}var reg=/^(w|W)((0?)|(0\.0+))$/;var c_value=void 0;if(!lodash.isNil(cell.ct)&&!lodash.isNil(cell.ct.fa)&&cell.ct.fa.match(reg)){c_value=getCellValue(r,c,d);}else {c_value=getCellValue(r,c,d,"m");}var styleObj=getStyleByCell(d,r,c);style+=lodash.map(styleObj,function(v,key){return "".concat(lodash.kebabCase(key),":").concat(lodash.isNumber(v)?"".concat(v,"px"):v,";");}).join("");if(cell.mc){if("rs"in cell.mc){span="rowspan=\"".concat(cell.mc.rs,"\" colspan=\"").concat(cell.mc.cs,"\"");if(borderInfoCompute&&borderInfoCompute["".concat(r,"_").concat(c)]){(function(){var bl_obj={color:{},style:{}};var br_obj={color:{},style:{}};var bt_obj={color:{},style:{}};var bb_obj={color:{},style:{}};for(var bd_r=r;bd_r<r+cell.mc.rs;bd_r+=1){for(var bd_c=c;bd_c<c+cell.mc.cs;bd_c+=1){if(bd_r===r&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t){var linetype=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t.style;var bcolor=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t.color;if(lodash.isNil(bt_obj.style[linetype])){bt_obj.style[linetype]=1;}else {bt_obj.style[linetype]+=1;}if(lodash.isNil(bt_obj.color[bcolor])){bt_obj.color[bcolor]=1;}else {bt_obj.color[bcolor]+=1;}}if(bd_r===r+cell.mc.rs-1&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b){var _linetype=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b.style;var _bcolor=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b.color;if(lodash.isNil(bb_obj.style[_linetype])){bb_obj.style[_linetype]=1;}else {bb_obj.style[_linetype]+=1;}if(lodash.isNil(bb_obj.color[_bcolor])){bb_obj.color[_bcolor]=1;}else {bb_obj.color[_bcolor]+=1;}}if(bd_c===c&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l){var _linetype2=borderInfoCompute["".concat(r,"_").concat(c)].l.style;var _bcolor2=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l.color;if(lodash.isNil(bl_obj.style[_linetype2])){bl_obj.style[_linetype2]=1;}else {bl_obj.style[_linetype2]+=1;}if(lodash.isNil(bl_obj.color[_bcolor2])){bl_obj.color[_bcolor2]=1;}else {bl_obj.color[_bcolor2]+=1;}}if(bd_c===c+cell.mc.cs-1&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r){var _linetype3=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r.style;var _bcolor3=borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r.color;if(lodash.isNil(br_obj.style[_linetype3])){br_obj.style[_linetype3]=1;}else {br_obj.style[_linetype3]+=1;}if(lodash.isNil(br_obj.color[_bcolor3])){br_obj.color[_bcolor3]=1;}else {br_obj.color[_bcolor3]+=1;}}}}var rowlen=cell.mc.rs;var collen=cell.mc.cs;if(JSON.stringify(bl_obj).length>23){var bl_color=null;var bl_style=null;Object.keys(bl_obj.color).forEach(function(x){if(bl_obj.color[x]>=rowlen/2){bl_color=x;}});Object.keys(bl_obj.style).forEach(function(x){if(bl_obj.style[x]>=rowlen/2){bl_style=x;}});if(!lodash.isNil(bl_color)&&!lodash.isNil(bl_style)){style+="border-left:".concat(getHtmlBorderStyle(bl_style,bl_color));}}if(JSON.stringify(br_obj).length>23){var br_color=null;var br_style=null;Object.keys(br_obj.color).forEach(function(x){if(br_obj.color[x]>=rowlen/2){br_color=x;}});Object.keys(br_obj.style).forEach(function(x){if(br_obj.style[x]>=rowlen/2){br_style=x;}});if(!lodash.isNil(br_color)&&!lodash.isNil(br_style)){style+="border-right:".concat(getHtmlBorderStyle(br_style,br_color));}}if(JSON.stringify(bt_obj).length>23){var bt_color=null;var bt_style=null;Object.keys(bt_obj.color).forEach(function(x){if(bt_obj.color[x]>=collen/2){bt_color=x;}});Object.keys(bt_obj.style).forEach(function(x){if(bt_obj.style[x]>=collen/2){bt_style=x;}});if(!lodash.isNil(bt_color)&&!lodash.isNil(bt_style)){style+="border-top:".concat(getHtmlBorderStyle(bt_style,bt_color));}}if(JSON.stringify(bb_obj).length>23){var bb_color=null;var bb_style=null;Object.keys(bb_obj.color).forEach(function(x){if(bb_obj.color[x]>=collen/2){bb_color=x;}});Object.keys(bb_obj.style).forEach(function(x){if(bb_obj.style[x]>=collen/2){bb_style=x;}});if(!lodash.isNil(bb_color)&&!lodash.isNil(bb_style)){style+="border-bottom:".concat(getHtmlBorderStyle(bb_style,bb_color));}}})();}}else {continue;}}else {if(borderInfoCompute&&borderInfoCompute["".concat(r,"_").concat(c)]){if(borderInfoCompute["".concat(r,"_").concat(c)].l){var linetype=borderInfoCompute["".concat(r,"_").concat(c)].l.style;var bcolor=borderInfoCompute["".concat(r,"_").concat(c)].l.color;style+="border-left:".concat(getHtmlBorderStyle(linetype,bcolor));}if(borderInfoCompute["".concat(r,"_").concat(c)].r){var _linetype4=borderInfoCompute["".concat(r,"_").concat(c)].r.style;var _bcolor4=borderInfoCompute["".concat(r,"_").concat(c)].r.color;style+="border-right:".concat(getHtmlBorderStyle(_linetype4,_bcolor4));}if(borderInfoCompute["".concat(r,"_").concat(c)].b){var _linetype5=borderInfoCompute["".concat(r,"_").concat(c)].b.style;var _bcolor5=borderInfoCompute["".concat(r,"_").concat(c)].b.color;style+="border-bottom:".concat(getHtmlBorderStyle(_linetype5,_bcolor5));}if(borderInfoCompute["".concat(r,"_").concat(c)].t){var _linetype6=borderInfoCompute["".concat(r,"_").concat(c)].t.style;var _bcolor6=borderInfoCompute["".concat(r,"_").concat(c)].t.color;style+="border-top:".concat(getHtmlBorderStyle(_linetype6,_bcolor6));}}}column=replaceHtml(column,{style:style,span:span});if(lodash.isNil(c_value)){c_value=getCellValue(r,c,d);}if(lodash.isNil(c_value)){c_value="";}column+=c_value;}else {var _style="";if(borderInfoCompute&&borderInfoCompute["".concat(r,"_").concat(c)]){if(borderInfoCompute["".concat(r,"_").concat(c)].l){var _linetype7=borderInfoCompute["".concat(r,"_").concat(c)].l.style;var _bcolor7=borderInfoCompute["".concat(r,"_").concat(c)].l.color;_style+="border-left:".concat(getHtmlBorderStyle(_linetype7,_bcolor7));}if(borderInfoCompute["".concat(r,"_").concat(c)].r){var _linetype8=borderInfoCompute["".concat(r,"_").concat(c)].r.style;var _bcolor8=borderInfoCompute["".concat(r,"_").concat(c)].r.color;_style+="border-right:".concat(getHtmlBorderStyle(_linetype8,_bcolor8));}if(borderInfoCompute["".concat(r,"_").concat(c)].b){var _linetype9=borderInfoCompute["".concat(r,"_").concat(c)].b.style;var _bcolor9=borderInfoCompute["".concat(r,"_").concat(c)].b.color;_style+="border-bottom:".concat(getHtmlBorderStyle(_linetype9,_bcolor9));}if(borderInfoCompute["".concat(r,"_").concat(c)].t){var _linetype10=borderInfoCompute["".concat(r,"_").concat(c)].t.style;var _bcolor10=borderInfoCompute["".concat(r,"_").concat(c)].t.color;_style+="border-top:".concat(getHtmlBorderStyle(_linetype10,_bcolor10));}}column+="";if(r===rowIndexArr[0]){if(lodash.isNil(sheet.config)||lodash.isNil(sheet.config.columnlen)||lodash.isNil(sheet.config.columnlen[c.toString()])){colgroup+='<colgroup width="72px"></colgroup>';}else {colgroup+="<colgroup width=\"".concat(sheet.config.columnlen[c.toString()],"px\"></colgroup>");}}if(c===colIndexArr[0]){if(lodash.isNil(sheet.config)||lodash.isNil(sheet.config.rowlen)||lodash.isNil(sheet.config.rowlen[r.toString()])){_style+="height:19px;";}else {_style+="height:".concat(sheet.config.rowlen[r.toString()],"px;");}}column=replaceHtml(column,{style:_style,span:""});column+="";}column+="</td>";cpdata+=column;}cpdata+="</tr>";}return "<table data-type=\"fortune-copy-action-table\">".concat(colgroup).concat(cpdata,"</table>");}function copy(ctx){var flowdata=getFlowdata(ctx);ctx.luckysheet_selection_range=[];var copyRange=[];var RowlChange=false;var HasMC=false;for(var s=0;s<((_ctx$luckysheet_selec2=(_ctx$luckysheet_selec3=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec3===void 0?void 0:_ctx$luckysheet_selec3.length)!==null&&_ctx$luckysheet_selec2!==void 0?_ctx$luckysheet_selec2:0);s+=1){var _ctx$luckysheet_selec2,_ctx$luckysheet_selec3;var range=ctx.luckysheet_select_save[s];var r1=range.row[0];var r2=range.row[1];var c1=range.column[0];var c2=range.column[1];for(var copyR=r1;copyR<=r2;copyR+=1){if(!lodash.isNil(ctx.config.rowhidden)&&!lodash.isNil(ctx.config.rowhidden[copyR])){continue;}if(!lodash.isNil(ctx.config.rowlen)&&copyR in ctx.config.rowlen){RowlChange=true;}for(var copyC=c1;copyC<=c2;copyC+=1){var _flowdata$copyR,_cell$mc;if(!lodash.isNil(ctx.config.colhidden)&&!lodash.isNil(ctx.config.colhidden[copyC])){continue;}var cell=flowdata===null||flowdata===void 0?void 0:(_flowdata$copyR=flowdata[copyR])===null||_flowdata$copyR===void 0?void 0:_flowdata$copyR[copyC];if(!lodash.isNil(cell===null||cell===void 0?void 0:(_cell$mc=cell.mc)===null||_cell$mc===void 0?void 0:_cell$mc.rs)){HasMC=true;}}}ctx.luckysheet_selection_range.push({row:range.row,column:range.column});copyRange.push({row:range.row,column:range.column});}ctx.luckysheet_copy_save={dataSheetId:ctx.currentSheetId,copyRange:copyRange,RowlChange:RowlChange,HasMC:HasMC};var cpdata=rangeValueToHtml(ctx,ctx.currentSheetId,ctx.luckysheet_select_save);if(cpdata){ctx.iscopyself=true;clipboard.writeHtml(cpdata);}}function deleteSelectedCellText(ctx){if(ctx.allowEdit===false){return;}var selection=ctx.luckysheet_select_save;if(selection&&!lodash.isEmpty(selection)){var d=getFlowdata(ctx);if(!d)return;var has_PartMC=false;for(var s=0;s<selection.length;s+=1){var r1=selection[s].row[0];var r2=selection[s].row[1];var c1=selection[s].column[0];var c2=selection[s].column[1];if(hasPartMC(ctx,ctx.config,r1,r2,c1,c2)){has_PartMC=true;break;}}if(has_PartMC){return;}var hyperlinkMap=ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].hyperlink;for(var _s=0;_s<selection.length;_s+=1){var _r=selection[_s].row[0];var _r2=selection[_s].row[1];var _c=selection[_s].column[0];var _c2=selection[_s].column[1];for(var r=_r;r<=_r2;r+=1){for(var c=_c;c<=_c2;c+=1){if(lodash.isPlainObject(d[r][c])){var cell=d[r][c];delete cell.m;delete cell.v;if(cell.f!=null){delete cell.f;delFunctionGroup(ctx,r,c,ctx.currentSheetId);delete cell.spl;}if(cell.ct!=null&&cell.ct.t==="inlineStr"){delete cell.ct;}}else {d[r][c]=null;}if(hyperlinkMap&&hyperlinkMap["".concat(r,"_").concat(c)]){delete hyperlinkMap["".concat(r,"_").concat(c)];}}}}}}function selectIsOverlap(ctx,range){if(range==null){range=ctx.luckysheet_select_save;}range=lodash.cloneDeep(range);var overlap=false;var map={};for(var s=0;s<range.length;s+=1){var str_r=range[s].row[0];var end_r=range[s].row[1];var str_c=range[s].column[0];var end_c=range[s].column[1];for(var r=str_r;r<=end_r;r+=1){for(var c=str_c;c<=end_c;c+=1){if("".concat(r,"_").concat(c)in map){overlap=true;break;}else {map["".concat(r,"_").concat(c)]=0;}}}}return overlap;}function selectAll(ctx){var flowdata=getFlowdata(ctx);if(!flowdata)return;ctx.luckysheet_select_status=false;ctx.luckysheet_select_save=[{row:[0,flowdata.length-1],column:[0,flowdata[0].length-1],row_focus:0,column_focus:0,row_select:true,column_select:true}];normalizeSelection(ctx,ctx.luckysheet_select_save);}function getSelectionStyle(ctx,selection,freeze){var _freeze$vertical,_freeze$horizontal;var ret={left:selection.left_move,top:selection.top_move,width:selection.width_move,height:selection.height_move,display:"block"};if(!freeze)return ret;var scrollTop=ctx.scrollTop;var scrollLeft=ctx.scrollLeft;var freezenverticaldata=freeze===null||freeze===void 0?void 0:(_freeze$vertical=freeze.vertical)===null||_freeze$vertical===void 0?void 0:_freeze$vertical.freezenverticaldata;var freezenhorizontaldata=freeze===null||freeze===void 0?void 0:(_freeze$horizontal=freeze.horizontal)===null||_freeze$horizontal===void 0?void 0:_freeze$horizontal.freezenhorizontaldata;var obj=selection;var rangeshow=true;if(freezenhorizontaldata!=null){var freezenTop=freezenhorizontaldata[0];var freezen_rowindex=freezenhorizontaldata[1];var offTop=scrollTop-freezenhorizontaldata[2];var r1=obj.row[0];var r2=obj.row[1];var row=ctx.visibledatarow[r2];var row_pre=r1-1===-1?0:ctx.visibledatarow[r1-1];var top_move=row_pre;var height_move=row-row_pre-1;if(r1>=freezen_rowindex){if(top_move+height_move<freezenTop+offTop){rangeshow=false;}else if(top_move<freezenTop+offTop){ret.top=freezenTop+offTop;ret.height=height_move-(freezenTop+offTop-top_move);}else;}else if(r2>=freezen_rowindex){if(top_move+height_move<freezenTop+offTop){ret.top=top_move+offTop;ret.height=freezenTop-top_move;}else {ret.top=top_move+offTop;ret.height=height_move-offTop;}}else {ret.top=top_move+offTop;}}if(freezenverticaldata!=null){var freezenLeft=freezenverticaldata[0];var freezen_colindex=freezenverticaldata[1];var offLeft=scrollLeft-freezenverticaldata[2];var c1=obj.column[0];var c2=obj.column[1];var col=ctx.visibledatacolumn[c2];var col_pre=c1-1===-1?0:ctx.visibledatacolumn[c1-1];var left_move=col_pre;var width_move=col-col_pre-1;if(c1>=freezen_colindex){if(left_move+width_move<freezenLeft+offLeft){rangeshow=false;}else if(left_move<freezenLeft+offLeft){ret.left=freezenLeft+offLeft;ret.width=width_move-(freezenLeft+offLeft-left_move);}else;}else if(c2>=freezen_colindex){if(left_move+width_move<freezenLeft+offLeft){ret.left=left_move+offLeft;ret.width=freezenLeft-left_move;}else {ret.left=left_move+offLeft;ret.width=width_move-offLeft;}}else {ret.left=left_move+offLeft;}}if(!rangeshow){ret.display="none";}return ret;}function defaultContext(){return {luckysheetfile:[],defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:true,devicePixelRatio:(global||window).devicePixelRatio,contextMenu:{},sheetTabContextMenu:{},currentSheetId:"",calculateSheetId:"",config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:41,infobarHeight:57,calculatebarHeight:29,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,scrollLeft:0,scrollTop:0,luckysheet_select_status:false,luckysheet_select_save:undefined,luckysheet_selection_range:[],formulaRangeHighlight:[],formulaRangeSelect:undefined,functionCandidates:[],functionHint:null,luckysheet_copy_save:undefined,luckysheet_paste_iscut:false,filterchage:true,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:false,luckysheet_sheet_move_data:[],luckysheet_scroll_status:false,luckysheetcurrentisPivotTable:false,luckysheet_rows_selected_status:false,luckysheet_cols_selected_status:false,luckysheet_rows_change_size:false,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:false,luckysheet_cols_change_size_start:[],luckysheetCellUpdate:[],luckysheet_shiftkeydown:false,luckysheet_shiftpositon:undefined,iscopyself:true,activeImg:undefined,orderbyindex:0,luckysheet_model_move_state:false,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:false,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:false,luckysheet_cell_selected_extend_index:[],lang:null,chart_selection:{},zoomRatio:1,showGridLines:true,allowEdit:true,fontList:[],defaultFontSize:10,luckysheetPaintModelOn:false,luckysheetPaintSingle:false,defaultCell:{bl:0,ct:{fa:"General",t:"n"},fc:"rgb(51, 51, 51)",ff:0,fs:11,ht:1,it:0,vt:1,m:"",v:""},groupValuesRefreshData:[],formulaCache:new FormulaCache(),hooks:{}};}function getFlowdata(ctx){var _ctx$luckysheetfile,_ctx$luckysheetfile$i;if(!ctx)return null;var i=getSheetIndex(ctx,ctx.currentSheetId);if(lodash.isNil(i)){return null;}return (_ctx$luckysheetfile=ctx.luckysheetfile)===null||_ctx$luckysheetfile===void 0?void 0:(_ctx$luckysheetfile$i=_ctx$luckysheetfile[i])===null||_ctx$luckysheetfile$i===void 0?void 0:_ctx$luckysheetfile$i.data;}function calcRowColSize(ctx,rowCount,colCount){ctx.visibledatarow=[];ctx.rh_height=0;for(var r=0;r<rowCount;r+=1){var _ctx$config$rowlen,_ctx$config2,_ctx$config2$rowhidde;var rowlen=ctx.defaultrowlen;if((_ctx$config$rowlen=ctx.config.rowlen)===null||_ctx$config$rowlen===void 0?void 0:_ctx$config$rowlen[r]){var _ctx$config,_ctx$config$rowlen2;rowlen=(_ctx$config=ctx.config)===null||_ctx$config===void 0?void 0:(_ctx$config$rowlen2=_ctx$config.rowlen)===null||_ctx$config$rowlen2===void 0?void 0:_ctx$config$rowlen2[r];}if(((_ctx$config2=ctx.config)===null||_ctx$config2===void 0?void 0:(_ctx$config2$rowhidde=_ctx$config2.rowhidden)===null||_ctx$config2$rowhidde===void 0?void 0:_ctx$config2$rowhidde[r])!=null){ctx.visibledatarow.push(ctx.rh_height);continue;}ctx.rh_height+=Math.round((rowlen+1)*ctx.zoomRatio);ctx.visibledatarow.push(ctx.rh_height);}ctx.visibledatacolumn=[];ctx.ch_width=0;var maxColumnlen=120;var flowdata=getFlowdata(ctx);for(var c=0;c<colCount;c+=1){var _ctx$config3,_ctx$config3$columnle,_ctx$config5,_ctx$config5$colhidde;var firstcolumnlen=ctx.defaultcollen;if((_ctx$config3=ctx.config)===null||_ctx$config3===void 0?void 0:(_ctx$config3$columnle=_ctx$config3.columnlen)===null||_ctx$config3$columnle===void 0?void 0:_ctx$config3$columnle[c]){firstcolumnlen=ctx.config.columnlen[c];}else {var _flowdata$;if(flowdata===null||flowdata===void 0?void 0:(_flowdata$=flowdata[0])===null||_flowdata$===void 0?void 0:_flowdata$[c]){if(firstcolumnlen>300){firstcolumnlen=300;}else if(firstcolumnlen<ctx.defaultcollen){firstcolumnlen=ctx.defaultcollen;}if(firstcolumnlen!==ctx.defaultcollen){var _ctx$config4;if(!((_ctx$config4=ctx.config)===null||_ctx$config4===void 0?void 0:_ctx$config4.columnlen)){ctx.config.columnlen={};}ctx.config.columnlen[c]=firstcolumnlen;}}}if(((_ctx$config5=ctx.config)===null||_ctx$config5===void 0?void 0:(_ctx$config5$colhidde=_ctx$config5.colhidden)===null||_ctx$config5$colhidde===void 0?void 0:_ctx$config5$colhidde[c])!=null){ctx.visibledatacolumn.push(ctx.ch_width);continue;}ctx.ch_width+=Math.round((firstcolumnlen+1)*ctx.zoomRatio);ctx.visibledatacolumn.push(ctx.ch_width);}ctx.ch_width+=maxColumnlen;}function ensureSheetIndex(data,generateSheetId){if((data===null||data===void 0?void 0:data.length)>0){var hasActive=false;var indexs=[];data.forEach(function(item){if(item.id==null){item.id=generateSheetId();}if(indexs.includes(item.id)){item.id=generateSheetId();}else {indexs.push(item.id);}if(item.status==null){item.status=0;}if(item.status===1){if(hasActive){item.status=0;}else {hasActive=true;}}});if(!hasActive){data[0].status=1;}}}function initSheetIndex(ctx){ctx.currentSheetId=ctx.luckysheetfile[0].id;for(var i=0;i<ctx.luckysheetfile.length;i+=1){if(ctx.luckysheetfile[i].status===1){ctx.currentSheetId=ctx.luckysheetfile[i].id;break;}}}function updateContextWithSheetData(ctx,data){var rowCount=data.length;var colCount=rowCount===0?0:data[0].length;calcRowColSize(ctx,rowCount,colCount);normalizeSelection(ctx,ctx.luckysheet_select_save);}function updateContextWithCanvas(ctx,canvas,placeholder){ctx.luckysheetTableContentHW=[placeholder.clientWidth,placeholder.clientHeight];ctx.cellmainHeight=placeholder.clientHeight-ctx.columnHeaderHeight;ctx.cellmainWidth=canvas.clientWidth-ctx.rowHeaderWidth;canvas.style.width="".concat(ctx.luckysheetTableContentHW[0],"px");canvas.style.height="".concat(ctx.luckysheetTableContentHW[1],"px");canvas.width=Math.ceil(ctx.luckysheetTableContentHW[0]*ctx.devicePixelRatio);canvas.height=Math.ceil(ctx.luckysheetTableContentHW[1]*ctx.devicePixelRatio);}function getBorderInfoComputeRange(ctx,dataset_row_st,dataset_row_ed,dataset_col_st,dataset_col_ed,sheetId){var borderInfoCompute={};var flowdata=getFlowdata(ctx);var cfg;var data;if(!sheetId){cfg=ctx.config;data=flowdata;}else {var index=getSheetIndex(ctx,sheetId);if(!lodash.isNil(index)){cfg=ctx.luckysheetfile[index].config;data=ctx.luckysheetfile[index].data;}else {return borderInfoCompute;}}if(!data||!cfg)return borderInfoCompute;var _cfg=cfg,borderInfo=_cfg.borderInfo;if(!borderInfo||lodash.isEmpty(borderInfo))return borderInfoCompute;for(var i=0;i<borderInfo.length;i+=1){var rangeType=borderInfo[i].rangeType;if(rangeType==="range"){var borderType=borderInfo[i].borderType;var borderColor=borderInfo[i].color;var borderStyle=borderInfo[i].style;var borderRange=borderInfo[i].range;var _loop=function _loop(j){var bd_r1=borderRange[j].row[0];var bd_r2=borderRange[j].row[1];var bd_c1=borderRange[j].column[0];var bd_c2=borderRange[j].column[1];if(bd_r1<dataset_row_st){bd_r1=dataset_row_st;}if(bd_r2>dataset_row_ed){bd_r2=dataset_row_ed;}if(bd_c1<dataset_col_st){bd_c1=dataset_col_st;}if(bd_c2>dataset_col_ed){bd_c2=dataset_col_ed;}if(borderType==="border-left"){var _loop2=function _loop2(bd_r){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[bd_r])){return "continue";}if(borderInfoCompute["".concat(bd_r,"_").concat(bd_c1)]===undefined){borderInfoCompute["".concat(bd_r,"_").concat(bd_c1)]={};}borderInfoCompute["".concat(bd_r,"_").concat(bd_c1)].l={color:borderColor,style:borderStyle};var bd_c_left=bd_c1-1;if(bd_c_left>=0&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)]){var _data$bd_r,_data$bd_r$bd_c_left;if(!lodash.isNil((_data$bd_r=data[bd_r])===null||_data$bd_r===void 0?void 0:(_data$bd_r$bd_c_left=_data$bd_r[bd_c_left])===null||_data$bd_r$bd_c_left===void 0?void 0:_data$bd_r$bd_c_left.mc)){var _cfg$merge,_cell_left$mc,_cell_left$mc2;var cell_left=data[bd_r][bd_c_left];var _mc=(_cfg$merge=cfg.merge)===null||_cfg$merge===void 0?void 0:_cfg$merge["".concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc=cell_left.mc)===null||_cell_left$mc===void 0?void 0:_cell_left$mc.r,"_").concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc2=cell_left.mc)===null||_cell_left$mc2===void 0?void 0:_cell_left$mc2.c)];if(_mc&&_mc.c+_mc.cs-1===bd_c_left){borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)].r={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)].r={color:borderColor,style:borderStyle};}}var mc=cfg.merge||{};Object.keys(mc).forEach(function(key){var _mc$key=mc[key],c=_mc$key.c,r=_mc$key.r,cs=_mc$key.cs,rs=_mc$key.rs;if(bd_c1<=c+cs-1&&bd_c1>c&&bd_r>=r&&bd_r<=r+rs-1){borderInfoCompute["".concat(bd_r,"_").concat(bd_c1)].l=null;}});};for(var bd_r=bd_r1;bd_r<=bd_r2;bd_r+=1){var _ret2=_loop2(bd_r);if(_ret2==="continue")continue;}}else if(borderType==="border-right"){var _loop3=function _loop3(_bd_r){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r])){return "continue";}if(borderInfoCompute["".concat(_bd_r,"_").concat(bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r,"_").concat(bd_c2)]={};}borderInfoCompute["".concat(_bd_r,"_").concat(bd_c2)].r={color:borderColor,style:borderStyle};var bd_c_right=bd_c2+1;if(bd_c_right<data[0].length&&borderInfoCompute["".concat(_bd_r,"_").concat(bd_c_right)]){var _data$_bd_r,_data$_bd_r$bd_c_righ;if(!lodash.isNil((_data$_bd_r=data[_bd_r])===null||_data$_bd_r===void 0?void 0:(_data$_bd_r$bd_c_righ=_data$_bd_r[bd_c_right])===null||_data$_bd_r$bd_c_righ===void 0?void 0:_data$_bd_r$bd_c_righ.mc)){var _cfg$merge2,_cell_right$mc,_cell_right$mc2;var cell_right=data[_bd_r][bd_c_right];var _mc2=(_cfg$merge2=cfg.merge)===null||_cfg$merge2===void 0?void 0:_cfg$merge2["".concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc=cell_right.mc)===null||_cell_right$mc===void 0?void 0:_cell_right$mc.r,"_").concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc2=cell_right.mc)===null||_cell_right$mc2===void 0?void 0:_cell_right$mc2.c)];if(_mc2&&_mc2.c===bd_c_right){borderInfoCompute["".concat(_bd_r,"_").concat(bd_c_right)].l={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r,"_").concat(bd_c_right)].l={color:borderColor,style:borderStyle};}}var mc=cfg.merge||{};Object.keys(mc).forEach(function(key){var _mc$key2=mc[key],c=_mc$key2.c,r=_mc$key2.r,cs=_mc$key2.cs,rs=_mc$key2.rs;if(bd_c2<c+cs-1&&bd_c2>=c&&_bd_r>=r&&_bd_r<=r+rs-1){borderInfoCompute["".concat(_bd_r,"_").concat(bd_c2)].r=null;}});};for(var _bd_r=bd_r1;_bd_r<=bd_r2;_bd_r+=1){var _ret3=_loop3(_bd_r);if(_ret3==="continue")continue;}}else if(borderType==="border-top"){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[bd_r1])){return "continue";}var _loop4=function _loop4(bd_c){if(borderInfoCompute["".concat(bd_r1,"_").concat(bd_c)]===undefined){borderInfoCompute["".concat(bd_r1,"_").concat(bd_c)]={};}borderInfoCompute["".concat(bd_r1,"_").concat(bd_c)].t={color:borderColor,style:borderStyle};var bd_r_top=bd_r1-1;if(bd_r_top>=0&&borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)]){var _data$bd_r_top,_data$bd_r_top$bd_c;if(!lodash.isNil((_data$bd_r_top=data[bd_r_top])===null||_data$bd_r_top===void 0?void 0:(_data$bd_r_top$bd_c=_data$bd_r_top[bd_c])===null||_data$bd_r_top$bd_c===void 0?void 0:_data$bd_r_top$bd_c.mc)){var _cfg$merge3,_cell_top$mc,_cell_top$mc2;var cell_top=data[bd_r_top][bd_c];var _mc3=(_cfg$merge3=cfg.merge)===null||_cfg$merge3===void 0?void 0:_cfg$merge3["".concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc=cell_top.mc)===null||_cell_top$mc===void 0?void 0:_cell_top$mc.r,"_").concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc2=cell_top.mc)===null||_cell_top$mc2===void 0?void 0:_cell_top$mc2.c)];if(_mc3&&_mc3.r+_mc3.rs-1===bd_r_top){borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)].b={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)].b={color:borderColor,style:borderStyle};}}var mc=cfg.merge||{};Object.keys(mc).forEach(function(key){var _mc$key3=mc[key],c=_mc$key3.c,r=_mc$key3.r,cs=_mc$key3.cs,rs=_mc$key3.rs;if(bd_r1<=r+rs-1&&bd_r1>r&&bd_c>=c&&bd_c<=c+cs-1){borderInfoCompute["".concat(bd_r1,"_").concat(bd_c)].t=null;}});};for(var bd_c=bd_c1;bd_c<=bd_c2;bd_c+=1){_loop4(bd_c);}}else if(borderType==="border-bottom"){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[bd_r2])){return "continue";}var _loop5=function _loop5(_bd_c){if(borderInfoCompute["".concat(bd_r2,"_").concat(_bd_c)]===undefined){borderInfoCompute["".concat(bd_r2,"_").concat(_bd_c)]={};}borderInfoCompute["".concat(bd_r2,"_").concat(_bd_c)].b={color:borderColor,style:borderStyle};var bd_r_bottom=bd_r2+1;if(bd_r_bottom<data.length&&borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c)]){var _data$bd_r_bottom,_data$bd_r_bottom$_bd;if(!lodash.isNil((_data$bd_r_bottom=data[bd_r_bottom])===null||_data$bd_r_bottom===void 0?void 0:(_data$bd_r_bottom$_bd=_data$bd_r_bottom[_bd_c])===null||_data$bd_r_bottom$_bd===void 0?void 0:_data$bd_r_bottom$_bd.mc)){var _cfg$merge4,_cell_bottom$mc,_cell_bottom$mc2;var cell_bottom=data[bd_r_bottom][_bd_c];var _mc4=(_cfg$merge4=cfg.merge)===null||_cfg$merge4===void 0?void 0:_cfg$merge4["".concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc=cell_bottom.mc)===null||_cell_bottom$mc===void 0?void 0:_cell_bottom$mc.r,"_").concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc2=cell_bottom.mc)===null||_cell_bottom$mc2===void 0?void 0:_cell_bottom$mc2.c)];if((_mc4===null||_mc4===void 0?void 0:_mc4.r)===bd_r_bottom){borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c)].t={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c)].t={color:borderColor,style:borderStyle};}}var mc=cfg.merge||{};Object.keys(mc).forEach(function(key){var _mc$key4=mc[key],c=_mc$key4.c,r=_mc$key4.r,cs=_mc$key4.cs,rs=_mc$key4.rs;if(bd_r2<r+rs-1&&bd_r2>=r&&_bd_c>=c&&_bd_c<=c+cs-1){borderInfoCompute["".concat(bd_r2,"_").concat(_bd_c)].b=null;}});};for(var _bd_c=bd_c1;_bd_c<=bd_c2;_bd_c+=1){_loop5(_bd_c);}}else if(borderType==="border-all"){for(var _bd_r2=bd_r1;_bd_r2<=bd_r2;_bd_r2+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r2])){continue;}for(var _bd_c2=bd_c1;_bd_c2<=bd_c2;_bd_c2+=1){var _data$_bd_r2,_data$_bd_r2$_bd_c;if(!lodash.isNil((_data$_bd_r2=data[_bd_r2])===null||_data$_bd_r2===void 0?void 0:(_data$_bd_r2$_bd_c=_data$_bd_r2[_bd_c2])===null||_data$_bd_r2$_bd_c===void 0?void 0:_data$_bd_r2$_bd_c.mc)){var _cfg$merge5,_cell$mc,_cell$mc2;var cell=data[_bd_r2][_bd_c2];var mc=(_cfg$merge5=cfg.merge)===null||_cfg$merge5===void 0?void 0:_cfg$merge5["".concat(cell===null||cell===void 0?void 0:(_cell$mc=cell.mc)===null||_cell$mc===void 0?void 0:_cell$mc.r,"_").concat(cell===null||cell===void 0?void 0:(_cell$mc2=cell.mc)===null||_cell$mc2===void 0?void 0:_cell$mc2.c)];if((mc===null||mc===void 0?void 0:mc.r)===_bd_r2){if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]={};}borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].t={color:borderColor,style:borderStyle};}if(mc&&mc.r+mc.rs-1===_bd_r2){if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]={};}borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].b={color:borderColor,style:borderStyle};}if((mc===null||mc===void 0?void 0:mc.c)===_bd_c2){if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]={};}borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].l={color:borderColor,style:borderStyle};}if(mc&&mc.c+mc.cs-1===_bd_c2){if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]={};}borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].r={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]===undefined){borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]={};}borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].t={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].b={color:borderColor,style:borderStyle};}if(_bd_r2===bd_r1){var bd_r_top=bd_r1-1;if(bd_r_top>=0&&borderInfoCompute["".concat(bd_r_top,"_").concat(_bd_c2)]){var _data$bd_r_top2,_data$bd_r_top2$_bd_c;if(!lodash.isNil((_data$bd_r_top2=data[bd_r_top])===null||_data$bd_r_top2===void 0?void 0:(_data$bd_r_top2$_bd_c=_data$bd_r_top2[_bd_c2])===null||_data$bd_r_top2$_bd_c===void 0?void 0:_data$bd_r_top2$_bd_c.mc)){var _cfg$merge6,_cell_top$mc3,_cell_top$mc4;var cell_top=data[bd_r_top][_bd_c2];var _mc5=(_cfg$merge6=cfg.merge)===null||_cfg$merge6===void 0?void 0:_cfg$merge6["".concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc3=cell_top.mc)===null||_cell_top$mc3===void 0?void 0:_cell_top$mc3.r,"_").concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc4=cell_top.mc)===null||_cell_top$mc4===void 0?void 0:_cell_top$mc4.c)];if(_mc5&&_mc5.r+_mc5.rs-1===bd_r_top){borderInfoCompute["".concat(bd_r_top,"_").concat(_bd_c2)].b={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(bd_r_top,"_").concat(_bd_c2)].b={color:borderColor,style:borderStyle};}}}if(_bd_r2===bd_r2){var bd_r_bottom=bd_r2+1;if(bd_r_bottom<data.length&&borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c2)]){var _data$bd_r_bottom2,_data$bd_r_bottom2$_b;if(!lodash.isNil((_data$bd_r_bottom2=data[bd_r_bottom])===null||_data$bd_r_bottom2===void 0?void 0:(_data$bd_r_bottom2$_b=_data$bd_r_bottom2[_bd_c2])===null||_data$bd_r_bottom2$_b===void 0?void 0:_data$bd_r_bottom2$_b.mc)){var _cfg$merge7,_cell_bottom$mc3,_cell_bottom$mc4;var cell_bottom=data[bd_r_bottom][_bd_c2];var _mc6=(_cfg$merge7=cfg.merge)===null||_cfg$merge7===void 0?void 0:_cfg$merge7["".concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc3=cell_bottom.mc)===null||_cell_bottom$mc3===void 0?void 0:_cell_bottom$mc3.r,"_").concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc4=cell_bottom.mc)===null||_cell_bottom$mc4===void 0?void 0:_cell_bottom$mc4.c)];if((_mc6===null||_mc6===void 0?void 0:_mc6.r)===bd_r_bottom){borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c2)].t={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(bd_r_bottom,"_").concat(_bd_c2)].t={color:borderColor,style:borderStyle};}}}if(_bd_c2===bd_c1){var bd_c_left=bd_c1-1;if(bd_c_left>=0&&borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_left)]){var _data$_bd_r3,_data$_bd_r3$bd_c_lef;if(!lodash.isNil((_data$_bd_r3=data[_bd_r2])===null||_data$_bd_r3===void 0?void 0:(_data$_bd_r3$bd_c_lef=_data$_bd_r3[bd_c_left])===null||_data$_bd_r3$bd_c_lef===void 0?void 0:_data$_bd_r3$bd_c_lef.mc)){var _cfg$merge8,_cell_left$mc3,_cell_left$mc4;var cell_left=data[_bd_r2][bd_c_left];var _mc7=(_cfg$merge8=cfg.merge)===null||_cfg$merge8===void 0?void 0:_cfg$merge8["".concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc3=cell_left.mc)===null||_cell_left$mc3===void 0?void 0:_cell_left$mc3.r,"_").concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc4=cell_left.mc)===null||_cell_left$mc4===void 0?void 0:_cell_left$mc4.c)];if(_mc7&&_mc7.c+_mc7.cs-1===bd_c_left){borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_left)].r={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_left)].r={color:borderColor,style:borderStyle};}}}if(_bd_c2===bd_c2){var bd_c_right=bd_c2+1;if(bd_c_right<data[0].length&&borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_right)]){var _data$_bd_r4,_data$_bd_r4$bd_c_rig;if(!lodash.isNil((_data$_bd_r4=data[_bd_r2])===null||_data$_bd_r4===void 0?void 0:(_data$_bd_r4$bd_c_rig=_data$_bd_r4[bd_c_right])===null||_data$_bd_r4$bd_c_rig===void 0?void 0:_data$_bd_r4$bd_c_rig.mc)){var _cfg$merge9,_cell_right$mc3,_cell_right$mc4;var cell_right=data[_bd_r2][bd_c_right];var _mc8=(_cfg$merge9=cfg.merge)===null||_cfg$merge9===void 0?void 0:_cfg$merge9["".concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc3=cell_right.mc)===null||_cell_right$mc3===void 0?void 0:_cell_right$mc3.r,"_").concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc4=cell_right.mc)===null||_cell_right$mc4===void 0?void 0:_cell_right$mc4.c)];if((_mc8===null||_mc8===void 0?void 0:_mc8.c)===bd_c_right){borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_right)].l={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r2,"_").concat(bd_c_right)].l={color:borderColor,style:borderStyle};}}}}}}else if(borderType==="border-outside"){for(var _bd_r3=bd_r1;_bd_r3<=bd_r2;_bd_r3+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r3])){continue;}for(var _bd_c3=bd_c1;_bd_c3<=bd_c2;_bd_c3+=1){if(!(_bd_r3===bd_r1||_bd_r3===bd_r2||_bd_c3===bd_c1||_bd_c3===bd_c2)){continue;}if(_bd_r3===bd_r1){if(borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]===undefined){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]={};}borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].t={color:borderColor,style:borderStyle};var _bd_r_top=bd_r1-1;if(_bd_r_top>=0&&borderInfoCompute["".concat(_bd_r_top,"_").concat(_bd_c3)]){var _data$_bd_r_top,_data$_bd_r_top$_bd_c;if(!lodash.isNil((_data$_bd_r_top=data[_bd_r_top])===null||_data$_bd_r_top===void 0?void 0:(_data$_bd_r_top$_bd_c=_data$_bd_r_top[_bd_c3])===null||_data$_bd_r_top$_bd_c===void 0?void 0:_data$_bd_r_top$_bd_c.mc)){var _cfg$merge10,_cell_top$mc5,_cell_top$mc6;var _cell_top=data[_bd_r_top][_bd_c3];var _mc9=(_cfg$merge10=cfg.merge)===null||_cfg$merge10===void 0?void 0:_cfg$merge10["".concat(_cell_top===null||_cell_top===void 0?void 0:(_cell_top$mc5=_cell_top.mc)===null||_cell_top$mc5===void 0?void 0:_cell_top$mc5.r,"_").concat(_cell_top===null||_cell_top===void 0?void 0:(_cell_top$mc6=_cell_top.mc)===null||_cell_top$mc6===void 0?void 0:_cell_top$mc6.c)];if(_mc9&&_mc9.r+_mc9.rs-1===_bd_r_top){borderInfoCompute["".concat(_bd_r_top,"_").concat(_bd_c3)].b={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r_top,"_").concat(_bd_c3)].b={color:borderColor,style:borderStyle};}}}if(_bd_r3===bd_r2){if(borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]===undefined){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]={};}borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].b={color:borderColor,style:borderStyle};var _bd_r_bottom=bd_r2+1;if(_bd_r_bottom<data.length&&borderInfoCompute["".concat(_bd_r_bottom,"_").concat(_bd_c3)]){var _data$_bd_r_bottom,_data$_bd_r_bottom$_b;if(!lodash.isNil((_data$_bd_r_bottom=data[_bd_r_bottom])===null||_data$_bd_r_bottom===void 0?void 0:(_data$_bd_r_bottom$_b=_data$_bd_r_bottom[_bd_c3])===null||_data$_bd_r_bottom$_b===void 0?void 0:_data$_bd_r_bottom$_b.mc)){var _cfg$merge11,_cell_bottom$mc5,_cell_bottom$mc6;var _cell_bottom=data[_bd_r_bottom][_bd_c3];var _mc10=(_cfg$merge11=cfg.merge)===null||_cfg$merge11===void 0?void 0:_cfg$merge11["".concat(_cell_bottom===null||_cell_bottom===void 0?void 0:(_cell_bottom$mc5=_cell_bottom.mc)===null||_cell_bottom$mc5===void 0?void 0:_cell_bottom$mc5.r,"_").concat(_cell_bottom===null||_cell_bottom===void 0?void 0:(_cell_bottom$mc6=_cell_bottom.mc)===null||_cell_bottom$mc6===void 0?void 0:_cell_bottom$mc6.c)];if((_mc10===null||_mc10===void 0?void 0:_mc10.r)===_bd_r_bottom){borderInfoCompute["".concat(_bd_r_bottom,"_").concat(_bd_c3)].t={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r_bottom,"_").concat(_bd_c3)].t={color:borderColor,style:borderStyle};}}}if(_bd_c3===bd_c1){if(borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]===undefined){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]={};}borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].l={color:borderColor,style:borderStyle};var _bd_c_left=bd_c1-1;if(_bd_c_left>=0&&borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_left)]){var _data$_bd_r5,_data$_bd_r5$_bd_c_le;if(!lodash.isNil((_data$_bd_r5=data[_bd_r3])===null||_data$_bd_r5===void 0?void 0:(_data$_bd_r5$_bd_c_le=_data$_bd_r5[_bd_c_left])===null||_data$_bd_r5$_bd_c_le===void 0?void 0:_data$_bd_r5$_bd_c_le.mc)){var _cfg$merge12,_cell_left$mc5,_cell_left$mc6;var _cell_left=data[_bd_r3][_bd_c_left];var _mc11=(_cfg$merge12=cfg.merge)===null||_cfg$merge12===void 0?void 0:_cfg$merge12["".concat(_cell_left===null||_cell_left===void 0?void 0:(_cell_left$mc5=_cell_left.mc)===null||_cell_left$mc5===void 0?void 0:_cell_left$mc5.r,"_").concat(_cell_left===null||_cell_left===void 0?void 0:(_cell_left$mc6=_cell_left.mc)===null||_cell_left$mc6===void 0?void 0:_cell_left$mc6.c)];if(_mc11&&_mc11.c+_mc11.cs-1===_bd_c_left){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_left)].r={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_left)].r={color:borderColor,style:borderStyle};}}}if(_bd_c3===bd_c2){if(borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]===undefined){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]={};}borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].r={color:borderColor,style:borderStyle};var _bd_c_right=bd_c2+1;if(_bd_c_right<data[0].length&&borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_right)]){var _data$_bd_r6,_data$_bd_r6$_bd_c_ri;if(!lodash.isNil((_data$_bd_r6=data[_bd_r3])===null||_data$_bd_r6===void 0?void 0:(_data$_bd_r6$_bd_c_ri=_data$_bd_r6[_bd_c_right])===null||_data$_bd_r6$_bd_c_ri===void 0?void 0:_data$_bd_r6$_bd_c_ri.mc)){var _cfg$merge13,_cell_right$mc5,_cell_right$mc6;var _cell_right=data[_bd_r3][_bd_c_right];var _mc12=(_cfg$merge13=cfg.merge)===null||_cfg$merge13===void 0?void 0:_cfg$merge13["".concat(_cell_right===null||_cell_right===void 0?void 0:(_cell_right$mc5=_cell_right.mc)===null||_cell_right$mc5===void 0?void 0:_cell_right$mc5.r,"_").concat(_cell_right===null||_cell_right===void 0?void 0:(_cell_right$mc6=_cell_right.mc)===null||_cell_right$mc6===void 0?void 0:_cell_right$mc6.c)];if((_mc12===null||_mc12===void 0?void 0:_mc12.c)===_bd_c_right){borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_right)].l={color:borderColor,style:borderStyle};}}else {borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c_right)].l={color:borderColor,style:borderStyle};}}}}}}else if(borderType==="border-inside"){for(var _bd_r4=bd_r1;_bd_r4<=bd_r2;_bd_r4+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r4])){continue;}for(var _bd_c4=bd_c1;_bd_c4<=bd_c2;_bd_c4+=1){if(_bd_r4===bd_r1&&_bd_c4===bd_c1){var _data$_bd_r7,_data$_bd_r7$_bd_c;if(!lodash.isNil((_data$_bd_r7=data[_bd_r4])===null||_data$_bd_r7===void 0?void 0:(_data$_bd_r7$_bd_c=_data$_bd_r7[_bd_c4])===null||_data$_bd_r7$_bd_c===void 0?void 0:_data$_bd_r7$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else if(_bd_r4===bd_r2&&_bd_c4===bd_c1){var _data$_bd_r8,_data$_bd_r8$_bd_c;if(!lodash.isNil((_data$_bd_r8=data[_bd_r4])===null||_data$_bd_r8===void 0?void 0:(_data$_bd_r8$_bd_c=_data$_bd_r8[_bd_c4])===null||_data$_bd_r8$_bd_c===void 0?void 0:_data$_bd_r8$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}}else if(_bd_r4===bd_r1&&_bd_c4===bd_c2){var _data$_bd_r9,_data$_bd_r9$_bd_c;if(!lodash.isNil((_data$_bd_r9=data[_bd_r4])===null||_data$_bd_r9===void 0?void 0:(_data$_bd_r9$_bd_c=_data$_bd_r9[_bd_c4])===null||_data$_bd_r9$_bd_c===void 0?void 0:_data$_bd_r9$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else if(_bd_r4===bd_r2&&_bd_c4===bd_c2){var _data$_bd_r10,_data$_bd_r10$_bd_c;if(!lodash.isNil((_data$_bd_r10=data[_bd_r4])===null||_data$_bd_r10===void 0?void 0:(_data$_bd_r10$_bd_c=_data$_bd_r10[_bd_c4])===null||_data$_bd_r10$_bd_c===void 0?void 0:_data$_bd_r10$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}}else if(_bd_r4===bd_r1){var _data$_bd_r11,_data$_bd_r11$_bd_c;if(!lodash.isNil((_data$_bd_r11=data[_bd_r4])===null||_data$_bd_r11===void 0?void 0:(_data$_bd_r11$_bd_c=_data$_bd_r11[_bd_c4])===null||_data$_bd_r11$_bd_c===void 0?void 0:_data$_bd_r11$_bd_c.mc)){var _cfg$merge14,_cell$mc3,_cell$mc4;var _cell=data[_bd_r4][_bd_c4];var _mc13=(_cfg$merge14=cfg.merge)===null||_cfg$merge14===void 0?void 0:_cfg$merge14["".concat(_cell===null||_cell===void 0?void 0:(_cell$mc3=_cell.mc)===null||_cell$mc3===void 0?void 0:_cell$mc3.r,"_").concat(_cell===null||_cell===void 0?void 0:(_cell$mc4=_cell.mc)===null||_cell$mc4===void 0?void 0:_cell$mc4.c)];if((_mc13===null||_mc13===void 0?void 0:_mc13.c)===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};}else if(_mc13&&_mc13.c+_mc13.cs-1===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else if(_bd_r4===bd_r2){var _data$_bd_r12,_data$_bd_r12$_bd_c;if(!lodash.isNil((_data$_bd_r12=data[_bd_r4])===null||_data$_bd_r12===void 0?void 0:(_data$_bd_r12$_bd_c=_data$_bd_r12[_bd_c4])===null||_data$_bd_r12$_bd_c===void 0?void 0:_data$_bd_r12$_bd_c.mc)){var _cfg$merge15,_cell2$mc,_cell2$mc2;var _cell2=data[_bd_r4][_bd_c4];var _mc14=(_cfg$merge15=cfg.merge)===null||_cfg$merge15===void 0?void 0:_cfg$merge15["".concat(_cell2===null||_cell2===void 0?void 0:(_cell2$mc=_cell2.mc)===null||_cell2$mc===void 0?void 0:_cell2$mc.r,"_").concat(_cell2===null||_cell2===void 0?void 0:(_cell2$mc2=_cell2.mc)===null||_cell2$mc2===void 0?void 0:_cell2$mc2.c)];if((_mc14===null||_mc14===void 0?void 0:_mc14.c)===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};}else if(_mc14&&_mc14.c+_mc14.cs-1===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}}else if(_bd_c4===bd_c1){var _data$_bd_r13,_data$_bd_r13$_bd_c;if(!lodash.isNil((_data$_bd_r13=data[_bd_r4])===null||_data$_bd_r13===void 0?void 0:(_data$_bd_r13$_bd_c=_data$_bd_r13[_bd_c4])===null||_data$_bd_r13$_bd_c===void 0?void 0:_data$_bd_r13$_bd_c.mc)){var _cfg$merge16,_cell3$mc,_cell3$mc2;var _cell3=data[_bd_r4][_bd_c4];var _mc15=(_cfg$merge16=cfg.merge)===null||_cfg$merge16===void 0?void 0:_cfg$merge16["".concat(_cell3===null||_cell3===void 0?void 0:(_cell3$mc=_cell3.mc)===null||_cell3$mc===void 0?void 0:_cell3$mc.r,"_").concat(_cell3===null||_cell3===void 0?void 0:(_cell3$mc2=_cell3.mc)===null||_cell3$mc2===void 0?void 0:_cell3$mc2.c)];if((_mc15===null||_mc15===void 0?void 0:_mc15.r)===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}else if(_mc15&&_mc15.r+_mc15.rs-1===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else if(_bd_c4===bd_c2){var _data$_bd_r14,_data$_bd_r14$_bd_c;if(!lodash.isNil((_data$_bd_r14=data[_bd_r4])===null||_data$_bd_r14===void 0?void 0:(_data$_bd_r14$_bd_c=_data$_bd_r14[_bd_c4])===null||_data$_bd_r14$_bd_c===void 0?void 0:_data$_bd_r14$_bd_c.mc)){var _cfg$merge17,_cell4$mc,_cell4$mc2;var _cell4=data[_bd_r4][_bd_c4];var _mc16=(_cfg$merge17=cfg.merge)===null||_cfg$merge17===void 0?void 0:_cfg$merge17["".concat(_cell4===null||_cell4===void 0?void 0:(_cell4$mc=_cell4.mc)===null||_cell4$mc===void 0?void 0:_cell4$mc.r,"_").concat(_cell4===null||_cell4===void 0?void 0:(_cell4$mc2=_cell4.mc)===null||_cell4$mc2===void 0?void 0:_cell4$mc2.c)];if((_mc16===null||_mc16===void 0?void 0:_mc16.r)===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}else if(_mc16&&_mc16.r+_mc16.rs-1===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}else {var _data$_bd_r15,_data$_bd_r15$_bd_c;if(!lodash.isNil((_data$_bd_r15=data[_bd_r4])===null||_data$_bd_r15===void 0?void 0:(_data$_bd_r15$_bd_c=_data$_bd_r15[_bd_c4])===null||_data$_bd_r15$_bd_c===void 0?void 0:_data$_bd_r15$_bd_c.mc)){var _cfg$merge18,_cell5$mc,_cell5$mc2;var _cell5=data[_bd_r4][_bd_c4];var _mc17=(_cfg$merge18=cfg.merge)===null||_cfg$merge18===void 0?void 0:_cfg$merge18["".concat(_cell5===null||_cell5===void 0?void 0:(_cell5$mc=_cell5.mc)===null||_cell5$mc===void 0?void 0:_cell5$mc.r,"_").concat(_cell5===null||_cell5===void 0?void 0:(_cell5$mc2=_cell5.mc)===null||_cell5$mc2===void 0?void 0:_cell5$mc2.c)];if((_mc17===null||_mc17===void 0?void 0:_mc17.r)===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};}else if(_mc17&&_mc17.r+_mc17.rs-1===_bd_r4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}if((_mc17===null||_mc17===void 0?void 0:_mc17.c)===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};}else if(_mc17&&_mc17.c+_mc17.cs-1===_bd_c4){if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]===undefined){borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)]={};}borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].r={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].t={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r4,"_").concat(_bd_c4)].b={color:borderColor,style:borderStyle};}}}}}else if(borderType==="border-horizontal"){for(var _bd_r5=bd_r1;_bd_r5<=bd_r2;_bd_r5+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r5])){continue;}for(var _bd_c5=bd_c1;_bd_c5<=bd_c2;_bd_c5+=1){if(_bd_r5===bd_r1){var _data$_bd_r16,_data$_bd_r16$_bd_c;if(!lodash.isNil((_data$_bd_r16=data[_bd_r5])===null||_data$_bd_r16===void 0?void 0:(_data$_bd_r16$_bd_c=_data$_bd_r16[_bd_c5])===null||_data$_bd_r16$_bd_c===void 0?void 0:_data$_bd_r16$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]===undefined){borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]={};}borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].b={color:borderColor,style:borderStyle};}}else if(_bd_r5===bd_r2){var _data$_bd_r17,_data$_bd_r17$_bd_c;if(!lodash.isNil((_data$_bd_r17=data[_bd_r5])===null||_data$_bd_r17===void 0?void 0:(_data$_bd_r17$_bd_c=_data$_bd_r17[_bd_c5])===null||_data$_bd_r17$_bd_c===void 0?void 0:_data$_bd_r17$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]===undefined){borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]={};}borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].t={color:borderColor,style:borderStyle};}}else {var _data$_bd_r18,_data$_bd_r18$_bd_c;if(!lodash.isNil((_data$_bd_r18=data[_bd_r5])===null||_data$_bd_r18===void 0?void 0:(_data$_bd_r18$_bd_c=_data$_bd_r18[_bd_c5])===null||_data$_bd_r18$_bd_c===void 0?void 0:_data$_bd_r18$_bd_c.mc)){var _cfg$merge19,_cell6$mc,_cell6$mc2;var _cell6=data[_bd_r5][_bd_c5];var _mc18=(_cfg$merge19=cfg.merge)===null||_cfg$merge19===void 0?void 0:_cfg$merge19["".concat(_cell6===null||_cell6===void 0?void 0:(_cell6$mc=_cell6.mc)===null||_cell6$mc===void 0?void 0:_cell6$mc.r,"_").concat(_cell6===null||_cell6===void 0?void 0:(_cell6$mc2=_cell6.mc)===null||_cell6$mc2===void 0?void 0:_cell6$mc2.c)];if((_mc18===null||_mc18===void 0?void 0:_mc18.r)===_bd_r5){if(borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]===undefined){borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]={};}borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].t={color:borderColor,style:borderStyle};}else if(_mc18&&_mc18.r+_mc18.rs-1===_bd_r5){if(borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]===undefined){borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]={};}borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].b={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]===undefined){borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)]={};}borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].t={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r5,"_").concat(_bd_c5)].b={color:borderColor,style:borderStyle};}}}}}else if(borderType==="border-vertical"){for(var _bd_r6=bd_r1;_bd_r6<=bd_r2;_bd_r6+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r6])){continue;}for(var _bd_c6=bd_c1;_bd_c6<=bd_c2;_bd_c6+=1){if(_bd_c6===bd_c1){var _data$_bd_r19,_data$_bd_r19$_bd_c;if(!lodash.isNil((_data$_bd_r19=data[_bd_r6])===null||_data$_bd_r19===void 0?void 0:(_data$_bd_r19$_bd_c=_data$_bd_r19[_bd_c6])===null||_data$_bd_r19$_bd_c===void 0?void 0:_data$_bd_r19$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]===undefined){borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]={};}borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].r={color:borderColor,style:borderStyle};}}else if(_bd_c6===bd_c2){var _data$_bd_r20,_data$_bd_r20$_bd_c;if(!lodash.isNil((_data$_bd_r20=data[_bd_r6])===null||_data$_bd_r20===void 0?void 0:(_data$_bd_r20$_bd_c=_data$_bd_r20[_bd_c6])===null||_data$_bd_r20$_bd_c===void 0?void 0:_data$_bd_r20$_bd_c.mc));else {if(borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]===undefined){borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]={};}borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].l={color:borderColor,style:borderStyle};}}else {var _data$_bd_r21,_data$_bd_r21$_bd_c;if(!lodash.isNil((_data$_bd_r21=data[_bd_r6])===null||_data$_bd_r21===void 0?void 0:(_data$_bd_r21$_bd_c=_data$_bd_r21[_bd_c6])===null||_data$_bd_r21$_bd_c===void 0?void 0:_data$_bd_r21$_bd_c.mc)){var _cfg$merge20,_cell7$mc,_cell7$mc2;var _cell7=data[_bd_r6][_bd_c6];var _mc19=(_cfg$merge20=cfg.merge)===null||_cfg$merge20===void 0?void 0:_cfg$merge20["".concat(_cell7===null||_cell7===void 0?void 0:(_cell7$mc=_cell7.mc)===null||_cell7$mc===void 0?void 0:_cell7$mc.r,"_").concat(_cell7===null||_cell7===void 0?void 0:(_cell7$mc2=_cell7.mc)===null||_cell7$mc2===void 0?void 0:_cell7$mc2.c)];if((_mc19===null||_mc19===void 0?void 0:_mc19.c)===_bd_c6){if(borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]===undefined){borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]={};}borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].l={color:borderColor,style:borderStyle};}else if(_mc19&&_mc19.c+_mc19.cs-1===_bd_c6){if(borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]===undefined){borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]={};}borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].r={color:borderColor,style:borderStyle};}}else {if(borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]===undefined){borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)]={};}borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].l={color:borderColor,style:borderStyle};borderInfoCompute["".concat(_bd_r6,"_").concat(_bd_c6)].r={color:borderColor,style:borderStyle};}}}}}else if(borderType==="border-none"){for(var _bd_r7=bd_r1;_bd_r7<=bd_r2;_bd_r7+=1){if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[_bd_r7])){continue;}for(var _bd_c7=bd_c1;_bd_c7<=bd_c2;_bd_c7+=1){if(!lodash.isNil(borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c7)])){delete borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c7)];}if(_bd_r7===bd_r1){var _bd_r_top2=bd_r1-1;if(_bd_r_top2>=0&&borderInfoCompute["".concat(_bd_r_top2,"_").concat(_bd_c7)]){delete borderInfoCompute["".concat(_bd_r_top2,"_").concat(_bd_c7)].b;}}if(_bd_r7===bd_r2){var _bd_r_bottom2=bd_r2+1;if(_bd_r_bottom2<data.length&&borderInfoCompute["".concat(_bd_r_bottom2,"_").concat(_bd_c7)]){delete borderInfoCompute["".concat(_bd_r_bottom2,"_").concat(_bd_c7)].t;}}if(_bd_c7===bd_c1){var _bd_c_left2=bd_c1-1;if(_bd_c_left2>=0&&borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c_left2)]){delete borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c_left2)].r;}}if(_bd_c7===bd_c2){var _bd_c_right2=bd_c2+1;if(_bd_c_right2<data[0].length&&borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c_right2)]){delete borderInfoCompute["".concat(_bd_r7,"_").concat(_bd_c_right2)].l;}}}}}};for(var j=0;j<borderRange.length;j+=1){var _ret=_loop(j);if(_ret==="continue")continue;}}else if(rangeType==="cell"){var value=borderInfo[i].value;var bd_r=value.row_index;var bd_c=value.col_index;if(bd_r<dataset_row_st||bd_r>dataset_row_ed||bd_c<dataset_col_st||bd_c>dataset_col_ed){continue;}if(!lodash.isNil(cfg.rowhidden)&&!lodash.isNil(cfg.rowhidden[bd_r])){continue;}if(!lodash.isNil(value.l)||!lodash.isNil(value.r)||!lodash.isNil(value.t)||!lodash.isNil(value.b)){var _data$bd_r2,_data$bd_r2$bd_c;if(borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]===undefined){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]={};}if(!lodash.isNil((_data$bd_r2=data[bd_r])===null||_data$bd_r2===void 0?void 0:(_data$bd_r2$bd_c=_data$bd_r2[bd_c])===null||_data$bd_r2$bd_c===void 0?void 0:_data$bd_r2$bd_c.mc)){var _cfg$merge21,_cell$mc5,_cell$mc6;var cell=data[bd_r][bd_c];var mc=(_cfg$merge21=cfg.merge)===null||_cfg$merge21===void 0?void 0:_cfg$merge21["".concat(cell===null||cell===void 0?void 0:(_cell$mc5=cell.mc)===null||_cell$mc5===void 0?void 0:_cell$mc5.r,"_").concat(cell===null||cell===void 0?void 0:(_cell$mc6=cell.mc)===null||_cell$mc6===void 0?void 0:_cell$mc6.c)];if(!lodash.isNil(value.l)&&bd_c===(mc===null||mc===void 0?void 0:mc.c)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l={color:value.l.color,style:value.l.style};var bd_c_left=bd_c-1;if(bd_c_left>=0&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)]){var _data$bd_r3,_data$bd_r3$bd_c_left;if(!lodash.isNil((_data$bd_r3=data[bd_r])===null||_data$bd_r3===void 0?void 0:(_data$bd_r3$bd_c_left=_data$bd_r3[bd_c_left])===null||_data$bd_r3$bd_c_left===void 0?void 0:_data$bd_r3$bd_c_left.mc)){var _cfg$merge22,_cell_left$mc7,_cell_left$mc8;var cell_left=data[bd_r][bd_c_left];var mc_l=(_cfg$merge22=cfg.merge)===null||_cfg$merge22===void 0?void 0:_cfg$merge22["".concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc7=cell_left.mc)===null||_cell_left$mc7===void 0?void 0:_cell_left$mc7.r,"_").concat(cell_left===null||cell_left===void 0?void 0:(_cell_left$mc8=cell_left.mc)===null||_cell_left$mc8===void 0?void 0:_cell_left$mc8.c)];if(mc_l&&mc_l.c+mc_l.cs-1===bd_c_left){borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)].r={color:value.l.color,style:value.l.style};}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c_left)].r={color:value.l.color,style:value.l.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l=null;}if(!lodash.isNil(value.r)&&mc&&bd_c===mc.c+mc.cs-1){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r={color:value.r.color,style:value.r.style};var bd_c_right=bd_c+1;if(bd_c_right<data[0].length&&borderInfoCompute["".concat(bd_r,"_").concat(bd_c_right)]){var _data$bd_r4,_data$bd_r4$bd_c_righ;if(!lodash.isNil((_data$bd_r4=data[bd_r])===null||_data$bd_r4===void 0?void 0:(_data$bd_r4$bd_c_righ=_data$bd_r4[bd_c_right])===null||_data$bd_r4$bd_c_righ===void 0?void 0:_data$bd_r4$bd_c_righ.mc)){var _cfg$merge23,_cell_right$mc7,_cell_right$mc8;var cell_right=data[bd_r][bd_c_right];var mc_r=(_cfg$merge23=cfg.merge)===null||_cfg$merge23===void 0?void 0:_cfg$merge23["".concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc7=cell_right.mc)===null||_cell_right$mc7===void 0?void 0:_cell_right$mc7.r,"_").concat(cell_right===null||cell_right===void 0?void 0:(_cell_right$mc8=cell_right.mc)===null||_cell_right$mc8===void 0?void 0:_cell_right$mc8.c)];if((mc_r===null||mc_r===void 0?void 0:mc_r.c)===bd_c_right){borderInfoCompute["".concat(bd_r,"_").concat(bd_c_right)].l={color:value.r.color,style:value.r.style};}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c_right)].l={color:value.r.color,style:value.r.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r=null;}if(!lodash.isNil(value.t)&&bd_r===(mc===null||mc===void 0?void 0:mc.r)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t={color:value.t.color,style:value.t.style};var bd_r_top=bd_r-1;if(bd_r_top>=0&&borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)]){var _data$bd_r_top3,_data$bd_r_top3$bd_c;if(!lodash.isNil((_data$bd_r_top3=data[bd_r_top])===null||_data$bd_r_top3===void 0?void 0:(_data$bd_r_top3$bd_c=_data$bd_r_top3[bd_c])===null||_data$bd_r_top3$bd_c===void 0?void 0:_data$bd_r_top3$bd_c.mc)){var _cfg$merge24,_cell_top$mc7,_cell_top$mc8;var cell_top=data[bd_r_top][bd_c];var mc_t=(_cfg$merge24=cfg.merge)===null||_cfg$merge24===void 0?void 0:_cfg$merge24["".concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc7=cell_top.mc)===null||_cell_top$mc7===void 0?void 0:_cell_top$mc7.r,"_").concat(cell_top===null||cell_top===void 0?void 0:(_cell_top$mc8=cell_top.mc)===null||_cell_top$mc8===void 0?void 0:_cell_top$mc8.c)];if(mc_t&&mc_t.r+mc_t.rs-1===bd_r_top){borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)].b={color:value.t.color,style:value.t.style};}}else {borderInfoCompute["".concat(bd_r_top,"_").concat(bd_c)].b={color:value.t.color,style:value.t.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t=null;}if(!lodash.isNil(value.b)&&mc&&bd_r===mc.r+mc.rs-1){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b={color:value.b.color,style:value.b.style};var bd_r_bottom=bd_r+1;if(bd_r_bottom<data.length&&borderInfoCompute["".concat(bd_r_bottom,"_").concat(bd_c)]){var _data$bd_r_bottom3,_data$bd_r_bottom3$bd;if(!lodash.isNil((_data$bd_r_bottom3=data[bd_r_bottom])===null||_data$bd_r_bottom3===void 0?void 0:(_data$bd_r_bottom3$bd=_data$bd_r_bottom3[bd_c])===null||_data$bd_r_bottom3$bd===void 0?void 0:_data$bd_r_bottom3$bd.mc)){var _cfg$merge25,_cell_bottom$mc7,_cell_bottom$mc8;var cell_bottom=data[bd_r_bottom][bd_c];var mc_b=(_cfg$merge25=cfg.merge)===null||_cfg$merge25===void 0?void 0:_cfg$merge25["".concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc7=cell_bottom.mc)===null||_cell_bottom$mc7===void 0?void 0:_cell_bottom$mc7.r,"_").concat(cell_bottom===null||cell_bottom===void 0?void 0:(_cell_bottom$mc8=cell_bottom.mc)===null||_cell_bottom$mc8===void 0?void 0:_cell_bottom$mc8.c)];if((mc_b===null||mc_b===void 0?void 0:mc_b.r)===bd_r_bottom){borderInfoCompute["".concat(bd_r_bottom,"_").concat(bd_c)].t={color:value.b.color,style:value.b.style};}}else {borderInfoCompute["".concat(bd_r_bottom,"_").concat(bd_c)].t={color:value.b.color,style:value.b.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b=null;}}else {if(!lodash.isNil(value.l)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l={color:value.l.color,style:value.l.style};var _bd_c_left3=bd_c-1;if(_bd_c_left3>=0&&borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_left3)]){var _data$bd_r5,_data$bd_r5$_bd_c_lef;if(!lodash.isNil((_data$bd_r5=data[bd_r])===null||_data$bd_r5===void 0?void 0:(_data$bd_r5$_bd_c_lef=_data$bd_r5[_bd_c_left3])===null||_data$bd_r5$_bd_c_lef===void 0?void 0:_data$bd_r5$_bd_c_lef.mc)){var _cfg$merge26,_cell_left2$mc,_cell_left2$mc2;var _cell_left2=data[bd_r][_bd_c_left3];var _mc_l=(_cfg$merge26=cfg.merge)===null||_cfg$merge26===void 0?void 0:_cfg$merge26["".concat(_cell_left2===null||_cell_left2===void 0?void 0:(_cell_left2$mc=_cell_left2.mc)===null||_cell_left2$mc===void 0?void 0:_cell_left2$mc.r,"_").concat(_cell_left2===null||_cell_left2===void 0?void 0:(_cell_left2$mc2=_cell_left2.mc)===null||_cell_left2$mc2===void 0?void 0:_cell_left2$mc2.c)];if(_mc_l&&_mc_l.c+_mc_l.cs-1===_bd_c_left3){borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_left3)].r={color:value.l.color,style:value.l.style};}}else {borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_left3)].r={color:value.l.color,style:value.l.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l=null;}if(!lodash.isNil(value.r)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r={color:value.r.color,style:value.r.style};var _bd_c_right3=bd_c+1;if(_bd_c_right3<data[0].length&&borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_right3)]){var _data$bd_r6,_data$bd_r6$_bd_c_rig;if(!lodash.isNil(data[bd_r])&&lodash.isPlainObject(data[bd_r][_bd_c_right3])&&!lodash.isNil((_data$bd_r6=data[bd_r])===null||_data$bd_r6===void 0?void 0:(_data$bd_r6$_bd_c_rig=_data$bd_r6[_bd_c_right3])===null||_data$bd_r6$_bd_c_rig===void 0?void 0:_data$bd_r6$_bd_c_rig.mc)){var _cfg$merge27,_cell_right2$mc,_cell_right2$mc2;var _cell_right2=data[bd_r][_bd_c_right3];var _mc_r=(_cfg$merge27=cfg.merge)===null||_cfg$merge27===void 0?void 0:_cfg$merge27["".concat(_cell_right2===null||_cell_right2===void 0?void 0:(_cell_right2$mc=_cell_right2.mc)===null||_cell_right2$mc===void 0?void 0:_cell_right2$mc.r,"_").concat(_cell_right2===null||_cell_right2===void 0?void 0:(_cell_right2$mc2=_cell_right2.mc)===null||_cell_right2$mc2===void 0?void 0:_cell_right2$mc2.c)];if((_mc_r===null||_mc_r===void 0?void 0:_mc_r.c)===_bd_c_right3){borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_right3)].l={color:value.r.color,style:value.r.style};}}else {borderInfoCompute["".concat(bd_r,"_").concat(_bd_c_right3)].l={color:value.r.color,style:value.r.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r=null;}if(!lodash.isNil(value.t)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t={color:value.t.color,style:value.t.style};var _bd_r_top3=bd_r-1;if(_bd_r_top3>=0&&borderInfoCompute["".concat(_bd_r_top3,"_").concat(bd_c)]){var _data$_bd_r_top2,_data$_bd_r_top2$bd_c;if(!lodash.isNil((_data$_bd_r_top2=data[_bd_r_top3])===null||_data$_bd_r_top2===void 0?void 0:(_data$_bd_r_top2$bd_c=_data$_bd_r_top2[bd_c])===null||_data$_bd_r_top2$bd_c===void 0?void 0:_data$_bd_r_top2$bd_c.mc)){var _cfg$merge28,_cell_top2$mc,_cell_top2$mc2;var _cell_top2=data[_bd_r_top3][bd_c];var _mc_t=(_cfg$merge28=cfg.merge)===null||_cfg$merge28===void 0?void 0:_cfg$merge28["".concat(_cell_top2===null||_cell_top2===void 0?void 0:(_cell_top2$mc=_cell_top2.mc)===null||_cell_top2$mc===void 0?void 0:_cell_top2$mc.r,"_").concat(_cell_top2===null||_cell_top2===void 0?void 0:(_cell_top2$mc2=_cell_top2.mc)===null||_cell_top2$mc2===void 0?void 0:_cell_top2$mc2.c)];if(_mc_t&&_mc_t.r+_mc_t.rs-1===_bd_r_top3){borderInfoCompute["".concat(_bd_r_top3,"_").concat(bd_c)].b={color:value.t.color,style:value.t.style};}}else {borderInfoCompute["".concat(_bd_r_top3,"_").concat(bd_c)].b={color:value.t.color,style:value.t.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t=null;}if(!lodash.isNil(value.b)){borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b={color:value.b.color,style:value.b.style};var _bd_r_bottom3=bd_r+1;if(_bd_r_bottom3<data.length&&borderInfoCompute["".concat(_bd_r_bottom3,"_").concat(bd_c)]){var _data$_bd_r_bottom2,_data$_bd_r_bottom2$b;if(!lodash.isNil((_data$_bd_r_bottom2=data[_bd_r_bottom3])===null||_data$_bd_r_bottom2===void 0?void 0:(_data$_bd_r_bottom2$b=_data$_bd_r_bottom2[bd_c])===null||_data$_bd_r_bottom2$b===void 0?void 0:_data$_bd_r_bottom2$b.mc)){var _cfg$merge29,_cell_bottom2$mc,_cell_bottom2$mc2;var _cell_bottom2=data[_bd_r_bottom3][bd_c];var _mc_b=(_cfg$merge29=cfg.merge)===null||_cfg$merge29===void 0?void 0:_cfg$merge29["".concat(_cell_bottom2===null||_cell_bottom2===void 0?void 0:(_cell_bottom2$mc=_cell_bottom2.mc)===null||_cell_bottom2$mc===void 0?void 0:_cell_bottom2$mc.r,"_").concat(_cell_bottom2===null||_cell_bottom2===void 0?void 0:(_cell_bottom2$mc2=_cell_bottom2.mc)===null||_cell_bottom2$mc2===void 0?void 0:_cell_bottom2$mc2.c)];if((_mc_b===null||_mc_b===void 0?void 0:_mc_b.r)===_bd_r_bottom3){borderInfoCompute["".concat(_bd_r_bottom3,"_").concat(bd_c)].t={color:value.b.color,style:value.b.style};}}else {borderInfoCompute["".concat(_bd_r_bottom3,"_").concat(bd_c)].t={color:value.b.color,style:value.b.style};}}}else {borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b=null;}}}else {delete borderInfoCompute["".concat(bd_r,"_").concat(bd_c)];}}}return borderInfoCompute;}function getBorderInfoCompute(ctx,sheetId){var borderInfoCompute={};var flowdata=getFlowdata(ctx);var data={};if(sheetId===undefined){data=flowdata;}else {var index=getSheetIndex(ctx,sheetId);if(!lodash.isNil(index)){data=ctx.luckysheetfile[index].data;}else {return borderInfoCompute;}}borderInfoCompute=getBorderInfoComputeRange(ctx,0,data.length,0,data[0].length,sheetId);return borderInfoCompute;}function cutVolumn(arr,cutindex){if(cutindex<=0){return arr;}var ret=arr.slice(cutindex);return ret;}function frozenTofreezen(ctx,cache,sheetId){var file=ctx.luckysheetfile[getSheetIndex(ctx,sheetId)];var frozen=file.frozen;if(frozen==null){delete cache.freezen;return;}var freezen={};var range=frozen.range;if(!range){range={row_focus:0,column_focus:0};}var type=frozen.type;if(type==="row"){type="rangeRow";}else if(type==="column"){type="rangeColumn";}else if(type==="both"){type="rangeBoth";}if(type==="rangeRow"||type==="rangeBoth"){var scrollTop=0;var row_st=lodash.sortedIndex(ctx.visibledatarow,scrollTop);var _range=range,row_focus=_range.row_focus;if(row_focus>row_st){row_st=row_focus;}if(row_st===-1){row_st=0;}var top=ctx.visibledatarow[row_st]-2-scrollTop+ctx.columnHeaderHeight;var freezenhorizontaldata=[ctx.visibledatarow[row_st],row_st+1,scrollTop,cutVolumn(ctx.visibledatarow,row_st+1),top];freezen.horizontal={freezenhorizontaldata:freezenhorizontaldata,top:top};}if(type==="rangeColumn"||type==="rangeBoth"){var scrollLeft=0;var col_st=lodash.sortedIndex(ctx.visibledatacolumn,scrollLeft);var _range2=range,column_focus=_range2.column_focus;if(column_focus>col_st){col_st=column_focus;}if(col_st===-1){col_st=0;}var left=ctx.visibledatacolumn[col_st]-2-scrollLeft+ctx.rowHeaderWidth;var freezenverticaldata=[ctx.visibledatacolumn[col_st],col_st+1,scrollLeft,cutVolumn(ctx.visibledatacolumn,col_st+1),left];freezen.vertical={freezenverticaldata:freezenverticaldata,left:left};}cache.freezen||(cache.freezen={});cache.freezen[ctx.currentSheetId]=freezen;}function initFreeze(ctx,cache,sheetId){frozenTofreezen(ctx,cache,sheetId);}function scrollToFrozenRowCol(ctx,freeze){var _freeze$vertical,_freeze$horizontal;var select_save=ctx.luckysheet_select_save;if(!select_save)return;var row;var row_focus=select_save[0].row_focus;if(row_focus===select_save[0].row[0]){var _select_save$0$row=_slicedToArray$3(select_save[0].row,2);row=_select_save$0$row[1];}else if(row_focus===select_save[0].row[1]){var _select_save$0$row2=_slicedToArray$3(select_save[0].row,1);row=_select_save$0$row2[0];}var column;var column_focus=select_save[0].column_focus;if(column_focus===select_save[0].column[0]){var _select_save$0$column=_slicedToArray$3(select_save[0].column,2);column=_select_save$0$column[1];}else if(column_focus===select_save[0].column[1]){var _select_save$0$column2=_slicedToArray$3(select_save[0].column,1);column=_select_save$0$column2[0];}var freezenverticaldata=freeze===null||freeze===void 0?void 0:(_freeze$vertical=freeze.vertical)===null||_freeze$vertical===void 0?void 0:_freeze$vertical.freezenverticaldata;var freezenhorizontaldata=freeze===null||freeze===void 0?void 0:(_freeze$horizontal=freeze.horizontal)===null||_freeze$horizontal===void 0?void 0:_freeze$horizontal.freezenhorizontaldata;if(freezenverticaldata!=null&&column!=null){var freezen_colindex=freezenverticaldata[1];var offset=lodash.sortedIndex(freezenverticaldata[3],ctx.scrollLeft);var top=freezenverticaldata[4];freezen_colindex+=offset;if(column>=ctx.visibledatacolumn.length){column=ctx.visibledatacolumn.length-1;}if(freezen_colindex>=ctx.visibledatacolumn.length){freezen_colindex=ctx.visibledatacolumn.length-1;}var column_px=ctx.visibledatacolumn[column];var freezen_px=ctx.visibledatacolumn[freezen_colindex];if(column_px<=freezen_px+top){ctx.scrollLeft=0;}}if(freezenhorizontaldata!=null&&row!=null){var freezen_rowindex=freezenhorizontaldata[1];var _offset=lodash.sortedIndex(freezenhorizontaldata[3],ctx.scrollTop);var left=freezenhorizontaldata[4];freezen_rowindex+=_offset;if(row>=ctx.visibledatarow.length){row=ctx.visibledatarow.length-1;}if(freezen_rowindex>=ctx.visibledatarow.length){freezen_rowindex=ctx.visibledatarow.length-1;}var row_px=ctx.visibledatarow[row];var _freezen_px=ctx.visibledatarow[freezen_rowindex];if(row_px<=_freezen_px+left){ctx.scrollTop=0;}}}function checkProtectionSelectLockedOrUnLockedCells(ctx,r,c,sheetId){var _data$r;var sheetFile=getSheetByIndex(ctx,sheetId);if(lodash.isNil(sheetFile)){return true;}if(lodash.isNil(sheetFile.config)||lodash.isNil(sheetFile.config.authority)){return true;}var aut=sheetFile.config.authority;if(lodash.isNil(aut)||lodash.isNil(aut.sheet)||aut.sheet===0){return true;}var data=sheetFile.data;var cell=data===null||data===void 0?void 0:(_data$r=data[r])===null||_data$r===void 0?void 0:_data$r[c];if(cell&&cell.lo===0){if(aut.selectunLockedCells===1||lodash.isNil(aut.selectunLockedCells)){return true;}return false;}if(aut.selectLockedCells===1||lodash.isNil(aut.selectLockedCells)){return true;}return false;}function checkProtectionAllSelected(ctx,sheetId){var sheetFile=getSheetByIndex(ctx,sheetId);if(lodash.isNil(sheetFile)){return true;}if(lodash.isNil(sheetFile.config)||lodash.isNil(sheetFile.config.authority)){return true;}var aut=sheetFile.config.authority;if(lodash.isNil(aut)||lodash.isNil(aut.sheet)||aut.sheet===0){return true;}var selectunLockedCells=false;if(aut.selectunLockedCells===1||lodash.isNil(aut.selectunLockedCells)){selectunLockedCells=true;}var selectLockedCells=false;if(aut.selectLockedCells===1||lodash.isNil(aut.selectLockedCells)){selectLockedCells=true;}if(selectunLockedCells&&selectLockedCells){return true;}return false;}function insertRowCol(ctx,op){var count=op.count,id=op.id;var type=op.type,index=op.index,direction=op.direction;id=id||ctx.currentSheetId;var curOrder=getSheetIndex(ctx,id);if(curOrder==null)return;var file=ctx.luckysheetfile[curOrder];if(!file)return;var d=file.data;if(!d)return;count=Math.floor(count);var cfg=file.config||{};if(cfg.merge==null){cfg.merge={};}var merge_new={};lodash.forEach(cfg.merge,function(mc){var r=mc.r,c=mc.c,rs=mc.rs,cs=mc.cs;if(type==="row"){if(index<r){merge_new["".concat(r+count,"_").concat(c)]={r:r+count,c:c,rs:rs,cs:cs};}else if(index===r){if(direction==="lefttop"){merge_new["".concat(r+count,"_").concat(c)]={r:r+count,c:c,rs:rs,cs:cs};}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs+count,cs:cs};}}else if(index<r+rs-1){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs+count,cs:cs};}else if(index===r+rs-1){if(direction==="lefttop"){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs+count,cs:cs};}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}}else if(type==="column"){if(index<c){merge_new["".concat(r,"_").concat(c+count)]={r:r,c:c+count,rs:rs,cs:cs};}else if(index===c){if(direction==="lefttop"){merge_new["".concat(r,"_").concat(c+count)]={r:r,c:c+count,rs:rs,cs:cs};}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs+count};}}else if(index<c+cs-1){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs+count};}else if(index===c+cs-1){if(direction==="lefttop"){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs+count};}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}}else {merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}}});cfg.merge=merge_new;var calcChain=file.calcChain;var newCalcChain=[];if(calcChain!=null&&calcChain.length>0){for(var i=0;i<calcChain.length;i+=1){var calc=lodash.cloneDeep(calcChain[i]);var calc_r=calc.r;var calc_c=calc.c;var calc_i=calc.id;var calc_funcStr=getcellFormula(ctx,calc_r,calc_c,calc_i);if(type==="row"){var _d$calc_r,_d$calc_r$calc_c;var functionStr="=".concat(functionStrChange(calc_funcStr,"add","row",direction,index,count));if(((_d$calc_r=d[calc_r])===null||_d$calc_r===void 0?void 0:(_d$calc_r$calc_c=_d$calc_r[calc_c])===null||_d$calc_r$calc_c===void 0?void 0:_d$calc_r$calc_c.f)===calc_funcStr){d[calc_r][calc_c].f=functionStr;}if(direction==="lefttop"){if(calc_r>=index){calc.r+=count;}}else if(direction==="rightbottom"){if(calc_r>index){calc.r+=count;}}newCalcChain.push(calc);}else if(type==="column"){var _d$calc_r2,_d$calc_r2$calc_c;var _functionStr="=".concat(functionStrChange(calc_funcStr,"add","col",direction,index,count));if(((_d$calc_r2=d[calc_r])===null||_d$calc_r2===void 0?void 0:(_d$calc_r2$calc_c=_d$calc_r2[calc_c])===null||_d$calc_r2$calc_c===void 0?void 0:_d$calc_r2$calc_c.f)===calc_funcStr){d[calc_r][calc_c].f=_functionStr;}if(direction==="lefttop"){if(calc_c>=index){calc.c+=count;}}else if(direction==="rightbottom"){if(calc_c>index){calc.c+=count;}}newCalcChain.push(calc);}}}var filter_select=file.filter_select;var filter=file.filter;var newFilterObj=null;if(!lodash.isEmpty(filter_select)){newFilterObj={filter_select:null,filter:null};var f_r1=filter_select.row[0];var f_r2=filter_select.row[1];var f_c1=filter_select.column[0];var f_c2=filter_select.column[1];if(type==="row"){if(f_r1<index){if(f_r2===index&&direction==="lefttop"){f_r2+=count;}else if(f_r2>index){f_r2+=count;}}else if(f_r1===index){if(direction==="lefttop"){f_r1+=count;f_r2+=count;}else if(direction==="rightbottom"&&f_r2>index){f_r2+=count;}}else {f_r1+=count;f_r2+=count;}if(filter!=null){newFilterObj.filter={};lodash.forEach(filter,function(v,k){var f_rowhidden=filter[k].rowhidden;var f_rowhidden_new={};lodash.forEach(f_rowhidden,function(v1,nstr){var n=parseFloat(nstr);if(n<index){f_rowhidden_new[n]=0;}else if(n===index){if(direction==="lefttop"){f_rowhidden_new[n+count]=0;}else if(direction==="rightbottom"){f_rowhidden_new[n]=0;}}else {f_rowhidden_new[n+count]=0;}});newFilterObj.filter[k]=lodash.cloneDeep(filter[k]);newFilterObj.filter[k].rowhidden=f_rowhidden_new;newFilterObj.filter[k].str=f_r1;newFilterObj.filter[k].edr=f_r2;});}}else if(type==="column"){if(f_c1<index){if(f_c2===index&&direction==="lefttop"){f_c2+=count;}else if(f_c2>index){f_c2+=count;}}else if(f_c1===index){if(direction==="lefttop"){f_c1+=count;f_c2+=count;}else if(direction==="rightbottom"&&f_c2>index){f_c2+=count;}}else {f_c1+=count;f_c2+=count;}if(filter!=null){newFilterObj.filter={};lodash.forEach(filter,function(v,k){var f_cindex=filter[k].cindex;if(f_cindex===index&&direction==="lefttop"){f_cindex+=count;}else if(f_cindex>index){f_cindex+=count;}newFilterObj.filter[f_cindex-f_c1]=lodash.cloneDeep(filter[k]);newFilterObj.filter[f_cindex-f_c1].cindex=f_cindex;newFilterObj.filter[f_cindex-f_c1].stc=f_c1;newFilterObj.filter[f_cindex-f_c1].edc=f_c2;});}}newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}if(newFilterObj!=null&&newFilterObj.filter!=null){if(cfg.rowhidden==null){cfg.rowhidden={};}lodash.forEach(newFilterObj.filter,function(v,k){var f_rowhidden=newFilterObj.filter[k].rowhidden;lodash.forEach(f_rowhidden,function(v1,n){cfg.rowhidden[n]=0;});});}var CFarr=file.luckysheet_conditionformat_save;var newCFarr=[];if(CFarr!=null&&CFarr.length>0){for(var _i=0;_i<CFarr.length;_i+=1){var cf_range=CFarr[_i].cellrange;var cf_new_range=[];for(var j=0;j<cf_range.length;j+=1){var CFr1=cf_range[j].row[0];var CFr2=cf_range[j].row[1];var CFc1=cf_range[j].column[0];var CFc2=cf_range[j].column[1];if(type==="row"){if(CFr1<index){if(CFr2===index&&direction==="lefttop"){CFr2+=count;}else if(CFr2>index){CFr2+=count;}}else if(CFr1===index){if(direction==="lefttop"){CFr1+=count;CFr2+=count;}else if(direction==="rightbottom"&&CFr2>index){CFr2+=count;}}else {CFr1+=count;CFr2+=count;}}else if(type==="column"){if(CFc1<index){if(CFc2===index&&direction==="lefttop"){CFc2+=count;}else if(CFc2>index){CFc2+=count;}}else if(CFc1===index){if(direction==="lefttop"){CFc1+=count;CFc2+=count;}else if(direction==="rightbottom"&&CFc2>index){CFc2+=count;}}else {CFc1+=count;CFc2+=count;}}cf_new_range.push({row:[CFr1,CFr2],column:[CFc1,CFc2]});}var cf=lodash.clone(CFarr[_i]);cf.cellrange=cf_new_range;newCFarr.push(cf);}}var AFarr=file.luckysheet_alternateformat_save;var newAFarr=[];if(AFarr!=null&&AFarr.length>0){for(var _i2=0;_i2<AFarr.length;_i2+=1){var AFr1=AFarr[_i2].cellrange.row[0];var AFr2=AFarr[_i2].cellrange.row[1];var AFc1=AFarr[_i2].cellrange.column[0];var AFc2=AFarr[_i2].cellrange.column[1];var af=lodash.clone(AFarr[_i2]);if(type==="row"){if(AFr1<index){if(AFr2===index&&direction==="lefttop"){AFr2+=count;}else if(AFr2>index){AFr2+=count;}}else if(AFr1===index){if(direction==="lefttop"){AFr1+=count;AFr2+=count;}else if(direction==="rightbottom"&&AFr2>index){AFr2+=count;}}else {AFr1+=count;AFr2+=count;}}else if(type==="column"){if(AFc1<index){if(AFc2===index&&direction==="lefttop"){AFc2+=count;}else if(AFc2>index){AFc2+=count;}}else if(AFc1===index){if(direction==="lefttop"){AFc1+=count;AFc2+=count;}else if(direction==="rightbottom"&&AFc2>index){AFc2+=count;}}else {AFc1+=count;AFc2+=count;}}af.cellrange={row:[AFr1,AFr2],column:[AFc1,AFc2]};newAFarr.push(af);}}var frozen=file.frozen;if(frozen){var normalizedIndex=direction==="lefttop"?index-1:index;if(type==="row"&&(frozen.type==="rangeRow"||frozen.type==="rangeBoth")){var _frozen$range$row_foc,_frozen$range;if(((_frozen$range$row_foc=(_frozen$range=frozen.range)===null||_frozen$range===void 0?void 0:_frozen$range.row_focus)!==null&&_frozen$range$row_foc!==void 0?_frozen$range$row_foc:-1)>normalizedIndex){frozen.range.row_focus+=count;}}if(type==="column"&&(frozen.type==="rangeColumn"||frozen.type==="rangeBoth")){var _frozen$range$column_,_frozen$range2;if(((_frozen$range$column_=(_frozen$range2=frozen.range)===null||_frozen$range2===void 0?void 0:_frozen$range2.column_focus)!==null&&_frozen$range$column_!==void 0?_frozen$range$column_:-1)>normalizedIndex){frozen.range.column_focus+=count;}}}var dataVerification=file.dataVerification;var newDataVerification={};if(dataVerification!=null){lodash.forEach(dataVerification,function(v,key){var r=Number(key.split("_")[0]);var c=Number(key.split("_")[1]);var item=dataVerification[key];if(type==="row"){if(index<r){newDataVerification["".concat(r+count,"_").concat(c)]=item;}else if(index===r){if(direction==="lefttop"){newDataVerification["".concat(r+count,"_").concat(c)]=item;for(var _i3=0;_i3<count;_i3+=1){newDataVerification["".concat(r+_i3,"_").concat(c)]=item;}}else {newDataVerification["".concat(r,"_").concat(c)]=item;for(var _i4=0;_i4<count;_i4+=1){newDataVerification["".concat(r+_i4+1,"_").concat(c)]=item;}}}else {newDataVerification["".concat(r,"_").concat(c)]=item;}}else if(type==="column"){if(index<c){newDataVerification["".concat(r,"_").concat(c+count)]=item;}else if(index===c){if(direction==="lefttop"){newDataVerification["".concat(r,"_").concat(c+count)]=item;for(var _i5=0;_i5<count;_i5+=1){newDataVerification["".concat(r,"_").concat(c+_i5)]=item;}}else {newDataVerification["".concat(r,"_").concat(c)]=item;for(var _i6=0;_i6<count;_i6+=1){newDataVerification["".concat(r,"_").concat(c+_i6+1)]=item;}}}else {newDataVerification["".concat(r,"_").concat(c)]=item;}}});}var hyperlink=file.hyperlink;var newHyperlink={};if(hyperlink!=null){lodash.forEach(hyperlink,function(v,key){var r=Number(key.split("_")[0]);var c=Number(key.split("_")[1]);var item=hyperlink[key];if(type==="row"){if(index<r){newHyperlink["".concat(r+count,"_").concat(c)]=item;}else if(index===r){if(direction==="lefttop"){newHyperlink["".concat(r+count,"_").concat(c)]=item;}else {newHyperlink["".concat(r,"_").concat(c)]=item;}}else {newHyperlink["".concat(r,"_").concat(c)]=item;}}else if(type==="column"){if(index<c){newHyperlink["".concat(r,"_").concat(c+count)]=item;}else if(index===c){if(direction==="lefttop"){newHyperlink["".concat(r,"_").concat(c+count)]=item;}else {newHyperlink["".concat(r,"_").concat(c)]=item;}}else {newHyperlink["".concat(r,"_").concat(c)]=item;}}});}if(type==="row"){if(cfg.rowlen!=null){var rowlen_new={};lodash.forEach(cfg.rowlen,function(v,rstr){var r=parseFloat(rstr);if(r<index){rowlen_new[r]=cfg.rowlen[r];}else if(r===index){if(direction==="lefttop"){rowlen_new[r+count]=cfg.rowlen[r];}else if(direction==="rightbottom"){rowlen_new[r]=cfg.rowlen[r];}}else {rowlen_new[r+count]=cfg.rowlen[r];}});cfg.rowlen=rowlen_new;}if(cfg.rowhidden!=null){var rowhidden_new={};lodash.forEach(cfg.rowhidden,function(v,rstr){var r=parseFloat(rstr);if(r<index){rowhidden_new[r]=cfg.rowhidden[r];}else if(r===index){if(direction==="lefttop"){rowhidden_new[r+count]=cfg.rowhidden[r];}else if(direction==="rightbottom"){rowhidden_new[r]=cfg.rowhidden[r];}}else {rowhidden_new[r+count]=cfg.rowhidden[r];}});cfg.rowhidden=rowhidden_new;}var row=[];var curRow=_toConsumableArray$2(d)[index];for(var c=0;c<d[0].length;c+=1){var cell=curRow[c];var templateCell=cell?_objectSpread2$1(_objectSpread2$1({},cell),{},{v:"",m:""}):ctx.defaultCell;delete templateCell.ps;row.push(templateCell);}var cellBorderConfig=[];if(cfg.borderInfo&&cfg.borderInfo.length>0){var borderInfo=[];for(var _i7=0;_i7<cfg.borderInfo.length;_i7+=1){var rangeType=cfg.borderInfo[_i7].rangeType;if(rangeType==="range"){var borderRange=cfg.borderInfo[_i7].range;var emptyRange=[];for(var _j=0;_j<borderRange.length;_j+=1){var bd_r1=borderRange[_j].row[0];var bd_r2=borderRange[_j].row[1];if(direction==="lefttop"){if(index<=bd_r1){bd_r1+=count;bd_r2+=count;}else if(index<=bd_r2){bd_r2+=count;}}else {if(index<bd_r1){bd_r1+=count;bd_r2+=count;}else if(index<bd_r2){bd_r2+=count;}}if(bd_r2>=bd_r1){emptyRange.push({row:[bd_r1,bd_r2],column:borderRange[_j].column});}}if(emptyRange.length>0){var bd_obj={rangeType:"range",borderType:cfg.borderInfo[_i7].borderType,style:cfg.borderInfo[_i7].style,color:cfg.borderInfo[_i7].color,range:emptyRange};borderInfo.push(bd_obj);}}else if(rangeType==="cell"){var row_index=cfg.borderInfo[_i7].value.row_index;if(row_index===index){cellBorderConfig.push(JSON.parse(JSON.stringify(cfg.borderInfo[_i7])));}if(direction==="lefttop"){if(index<=row_index){row_index+=count;}}else {if(index<row_index){row_index+=count;}}cfg.borderInfo[_i7].value.row_index=row_index;borderInfo.push(cfg.borderInfo[_i7]);}}cfg.borderInfo=borderInfo;}var arr=[];var _loop=function _loop(r){arr.push(JSON.stringify(row));if(cellBorderConfig.length){var _cfg$borderInfo;var cellBorderConfigCopy=lodash.cloneDeep(cellBorderConfig);cellBorderConfigCopy.forEach(function(item){if(direction==="rightbottom"){item.value.row_index+=r+1;}else if(direction==="lefttop"){item.value.row_index+=r;}});(_cfg$borderInfo=cfg.borderInfo)===null||_cfg$borderInfo===void 0?void 0:_cfg$borderInfo.push.apply(_cfg$borderInfo,_toConsumableArray$2(cellBorderConfigCopy));}};for(var r=0;r<count;r+=1){_loop(r);}if(direction==="lefttop"){if(index===0){new Function("d","return d.unshift(".concat(arr.join(","),")"))(d);}else {new Function("d","return d.splice(".concat(index,", 0, ").concat(arr.join(","),")"))(d);}}else {new Function("d","return d.splice(".concat(index+1,", 0, ").concat(arr.join(","),")"))(d);}}else {if(cfg.columnlen!=null){var columnlen_new={};lodash.forEach(cfg.columnlen,function(v,cstr){var c=parseFloat(cstr);if(c<index){columnlen_new[c]=cfg.columnlen[c];}else if(c===index){if(direction==="lefttop"){columnlen_new[c+count]=cfg.columnlen[c];}else if(direction==="rightbottom"){columnlen_new[c]=cfg.columnlen[c];}}else {columnlen_new[c+count]=cfg.columnlen[c];}});cfg.columnlen=columnlen_new;}if(cfg.colhidden!=null){var colhidden_new={};lodash.forEach(cfg.colhidden,function(v,cstr){var c=parseFloat(cstr);if(c<index){colhidden_new[c]=cfg.colhidden[c];}else if(c===index){if(direction==="lefttop"){colhidden_new[c+count]=cfg.colhidden[c];}else if(direction==="rightbottom"){colhidden_new[c]=cfg.colhidden[c];}}else {colhidden_new[c+count]=cfg.colhidden[c];}});cfg.colhidden=colhidden_new;}var col=[];var curd=_toConsumableArray$2(d);for(var _r=0;_r<d.length;_r+=1){var _cell=curd[_r][index];var _templateCell=_cell?_objectSpread2$1(_objectSpread2$1({},_cell),{},{v:"",m:""}):ctx.defaultCell;delete _templateCell.ps;col.push(_templateCell);}var _cellBorderConfig=[];if(cfg.borderInfo&&cfg.borderInfo.length>0){var _borderInfo=[];for(var _i8=0;_i8<cfg.borderInfo.length;_i8+=1){var _rangeType=cfg.borderInfo[_i8].rangeType;if(_rangeType==="range"){var _borderRange=cfg.borderInfo[_i8].range;var _emptyRange=[];for(var _j2=0;_j2<_borderRange.length;_j2+=1){var bd_c1=_borderRange[_j2].column[0];var bd_c2=_borderRange[_j2].column[1];if(direction==="lefttop"){if(index<=bd_c1){bd_c1+=count;bd_c2+=count;}else if(index<=bd_c2){bd_c2+=count;}}else {if(index<bd_c1){bd_c1+=count;bd_c2+=count;}else if(index<bd_c2){bd_c2+=count;}}if(bd_c2>=bd_c1){_emptyRange.push({row:_borderRange[_j2].row,column:[bd_c1,bd_c2]});}}if(_emptyRange.length>0){var _bd_obj={rangeType:"range",borderType:cfg.borderInfo[_i8].borderType,style:cfg.borderInfo[_i8].style,color:cfg.borderInfo[_i8].color,range:_emptyRange};_borderInfo.push(_bd_obj);}}else if(_rangeType==="cell"){var col_index=cfg.borderInfo[_i8].value.col_index;if(col_index===index){_cellBorderConfig.push(JSON.parse(JSON.stringify(cfg.borderInfo[_i8])));}if(direction==="lefttop"){if(index<=col_index){col_index+=count;}}else {if(index<col_index){col_index+=count;}}cfg.borderInfo[_i8].value.col_index=col_index;_borderInfo.push(cfg.borderInfo[_i8]);}}cfg.borderInfo=_borderInfo;}if(_cellBorderConfig.length){var _loop2=function _loop2(_i9){var _cfg$borderInfo2;var cellBorderConfigCopy=lodash.cloneDeep(_cellBorderConfig);cellBorderConfigCopy.forEach(function(item){if(direction==="rightbottom"){item.value.col_index+=_i9+1;}else if(direction==="lefttop"){item.value.col_index+=_i9;}});(_cfg$borderInfo2=cfg.borderInfo)===null||_cfg$borderInfo2===void 0?void 0:_cfg$borderInfo2.push.apply(_cfg$borderInfo2,_toConsumableArray$2(cellBorderConfigCopy));};for(var _i9=0;_i9<count;_i9+=1){_loop2(_i9);}}for(var _r2=0;_r2<d.length;_r2+=1){var _row=d[_r2];for(var _i10=0;_i10<count;_i10+=1){if(direction==="lefttop"){if(index===0){_row.unshift(col[_r2]);}else {_row.splice(index,0,col[_r2]);}}else {_row.splice(index+1,0,col[_r2]);}}}}file.data=d;file.config=cfg;file.calcChain=newCalcChain;if(newFilterObj!=null){file.filter=newFilterObj.filter;file.filter_select=newFilterObj.filter_select;}file.luckysheet_conditionformat_save=newCFarr;file.luckysheet_alternateformat_save=newAFarr;file.dataVerification=newDataVerification;file.hyperlink=newHyperlink;if(file.id===ctx.currentSheetId){ctx.config=cfg;}var range=null;if(type==="row"){if(direction==="lefttop"){range=[{row:[index,index+count-1],column:[0,d[0].length-1]}];}else {range=[{row:[index+1,index+count],column:[0,d[0].length-1]}];}}else {if(direction==="lefttop"){range=[{row:[0,d.length-1],column:[index,index+count-1]}];}else {range=[{row:[0,d.length-1],column:[index+1,index+count]}];}}file.luckysheet_select_save=range;if(file.id===ctx.currentSheetId){ctx.luckysheet_select_save=range;}}function deleteRowCol(ctx,op){var type=op.type;var start=op.start,end=op.end,id=op.id;id=id||ctx.currentSheetId;var curOrder=getSheetIndex(ctx,id);if(curOrder==null)return;var file=ctx.luckysheetfile[curOrder];if(!file)return;var d=file.data;if(!d)return;if(start<0){start=0;}if(end<0){end=0;}if(type==="row"){if(start>d.length-1){start=d.length-1;}if(end>d.length-1){end=d.length-1;}}else {if(start>d[0].length-1){start=d[0].length-1;}if(end>d[0].length-1){end=d[0].length-1;}}if(start>end){return;}var slen=end-start+1;var cfg=file.config||{};if(cfg.merge==null){cfg.merge={};}var merge_new={};lodash.forEach(cfg.merge,function(mc){var r=mc.r;var c=mc.c;var rs=mc.rs;var cs=mc.cs;if(type==="row"){if(r<start){if(r+rs-1<start){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}else if(r+rs-1>=start&&r+rs-1<end){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:start-r,cs:cs};}else if(r+rs-1>=end){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs-slen,cs:cs};}}else if(r>=start&&r<=end){if(r+rs-1>end){merge_new["".concat(start,"_").concat(c)]={r:start,c:c,rs:r+rs-1-end,cs:cs};}}else if(r>end){merge_new["".concat(r-slen,"_").concat(c)]={r:r-slen,c:c,rs:rs,cs:cs};}}else if(type==="column"){if(c<start){if(c+cs-1<start){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs};}else if(c+cs-1>=start&&c+cs-1<end){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:start-c};}else if(c+cs-1>=end){merge_new["".concat(r,"_").concat(c)]={r:r,c:c,rs:rs,cs:cs-slen};}}else if(c>=start&&c<=end){if(c+cs-1>end){merge_new["".concat(r,"_").concat(start)]={r:r,c:start,rs:rs,cs:c+cs-1-end};}}else if(c>end){merge_new["".concat(r,"_").concat(c-slen)]={r:r,c:c-slen,rs:rs,cs:cs};}}});cfg.merge=merge_new;var calcChain=file.calcChain;var newCalcChain=[];if(calcChain!=null&&calcChain.length>0){for(var i=0;i<calcChain.length;i+=1){var calc=lodash.cloneDeep(calcChain[i]);var calc_r=calc.r;var calc_c=calc.c;var calc_i=calc.id;var calc_funcStr=getcellFormula(ctx,calc_r,calc_c,calc_i);if(type==="row"){if(calc_r<start||calc_r>end){var _d$calc_r3,_d$calc_r3$calc_c;var functionStr="=".concat(functionStrChange(calc_funcStr,"del","row",null,start,slen));if(((_d$calc_r3=d[calc_r])===null||_d$calc_r3===void 0?void 0:(_d$calc_r3$calc_c=_d$calc_r3[calc_c])===null||_d$calc_r3$calc_c===void 0?void 0:_d$calc_r3$calc_c.f)===calc_funcStr){d[calc_r][calc_c].f=functionStr;}if(calc_r>end){calc.r=calc_r-slen;}newCalcChain.push(calc);}}else if(type==="column"){if(calc_c<start||calc_c>end){var _d$calc_r4,_d$calc_r4$calc_c;var _functionStr2="=".concat(functionStrChange(calc_funcStr,"del","col",null,start,slen));if(((_d$calc_r4=d[calc_r])===null||_d$calc_r4===void 0?void 0:(_d$calc_r4$calc_c=_d$calc_r4[calc_c])===null||_d$calc_r4$calc_c===void 0?void 0:_d$calc_r4$calc_c.f)===calc_funcStr){d[calc_r][calc_c].f=_functionStr2;}if(calc_c>end){calc.c=calc_c-slen;}newCalcChain.push(calc);}}}}var filter_select=file.filter_select;var filter=file.filter;var newFilterObj=null;if(!lodash.isEmpty(filter_select)){newFilterObj={filter_select:null,filter:null};var f_r1=filter_select.row[0];var f_r2=filter_select.row[1];var f_c1=filter_select.column[0];var f_c2=filter_select.column[1];if(type==="row"){if(f_r1>end){f_r1-=slen;f_r2-=slen;newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}else if(f_r1<start){if(f_r2<start);else if(f_r2<=end){f_r2=start-1;}else {f_r2-=slen;}newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}if(newFilterObj.filter_select!=null&&filter!=null){lodash.forEach(filter,function(v,k){var f_rowhidden=filter[k].rowhidden;var f_rowhidden_new={};lodash.forEach(f_rowhidden,function(v1,nstr){var n=parseFloat(nstr);if(n<start){f_rowhidden_new[n]=0;}else if(n>end){f_rowhidden_new[n-slen]=0;}});if(!lodash.isEmpty(f_rowhidden_new)){if(newFilterObj.filter==null){newFilterObj.filter={};}newFilterObj.filter[k]=lodash.cloneDeep(filter[k]);newFilterObj.filter[k].rowhidden=f_rowhidden_new;newFilterObj.filter[k].str=f_r1;newFilterObj.filter[k].edr=f_r2;}});}}else if(type==="column"){if(f_c1>end){f_c1-=slen;f_c2-=slen;newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}else if(f_c1<start){if(f_c2<start);else if(f_c2<=end){f_c2=start-1;}else {f_c2-=slen;}newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}else {if(f_c2>end){f_c1=start;f_c2-=slen;newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]};}}if(newFilterObj.filter_select!=null&&filter!=null){lodash.forEach(filter,function(v,k){var f_cindex=filter[k].cindex;if(f_cindex<start){if(newFilterObj.filter==null){newFilterObj.filter={};}newFilterObj.filter[f_cindex-f_c1]=lodash.cloneDeep(filter[k]);newFilterObj.filter[f_cindex-f_c1].edc=f_c2;}else if(f_cindex>end){f_cindex-=slen;if(newFilterObj.filter==null){newFilterObj.filter={};}newFilterObj.filter[f_cindex-f_c1]=lodash.cloneDeep(filter[k]);newFilterObj.filter[f_cindex-f_c1].cindex=f_cindex;newFilterObj.filter[f_cindex-f_c1].stc=f_c1;newFilterObj.filter[f_cindex-f_c1].edc=f_c2;}});}}}if(newFilterObj!=null&&newFilterObj.filter!=null){if(cfg.rowhidden==null){cfg.rowhidden={};}lodash.forEach(newFilterObj.filter,function(v,k){var f_rowhidden=newFilterObj.filter[k].rowhidden;lodash.forEach(f_rowhidden,function(v1,n){cfg.rowhidden[n]=0;});});}var CFarr=file.luckysheet_conditionformat_save;var newCFarr=[];if(CFarr!=null&&CFarr.length>0){for(var _i11=0;_i11<CFarr.length;_i11+=1){var cf_range=CFarr[_i11].cellrange;var cf_new_range=[];for(var j=0;j<cf_range.length;j+=1){var CFr1=cf_range[j].row[0];var CFr2=cf_range[j].row[1];var CFc1=cf_range[j].column[0];var CFc2=cf_range[j].column[1];if(type==="row"){if(!(CFr1>=start&&CFr2<=end)){if(CFr1>end){CFr1-=slen;CFr2-=slen;}else if(CFr1<start){if(CFr2<start);else if(CFr2<=end){CFr2=start-1;}else {CFr2-=slen;}}else {if(CFr2>end){CFr1=start;CFr2-=slen;}}cf_new_range.push({row:[CFr1,CFr2],column:[CFc1,CFc2]});}}else if(type==="column"){if(!(CFc1>=start&&CFc2<=end)){if(CFc1>end){CFc1-=slen;CFc2-=slen;}else if(CFc1<start){if(CFc2<start);else if(CFc2<=end){CFc2=start-1;}else {CFc2-=slen;}}else {if(CFc2>end){CFc1=start;CFc2-=slen;}}cf_new_range.push({row:[CFr1,CFr2],column:[CFc1,CFc2]});}}}if(cf_new_range.length>0){var cf=lodash.clone(CFarr[_i11]);cf.cellrange=cf_new_range;newCFarr.push(cf);}}}var AFarr=file.luckysheet_alternateformat_save;var newAFarr=[];if(AFarr!=null&&AFarr.length>0){for(var _i12=0;_i12<AFarr.length;_i12+=1){var AFr1=AFarr[_i12].cellrange.row[0];var AFr2=AFarr[_i12].cellrange.row[1];var AFc1=AFarr[_i12].cellrange.column[0];var AFc2=AFarr[_i12].cellrange.column[1];if(type==="row"){if(!(AFr1>=start&&AFr2<=end)){var af=lodash.clone(AFarr[_i12]);if(AFr1>end){AFr1-=slen;AFr2-=slen;}else if(AFr1<start){if(AFr2<start);else if(AFr2<=end){AFr2=start-1;}else {AFr2-=slen;}}else {if(AFr2>end){AFr1=start;AFr2-=slen;}}af.cellrange={row:[AFr1,AFr2],column:[AFc1,AFc2]};newAFarr.push(af);}}else if(type==="column"){if(!(AFc1>=start&&AFc2<=end)){var _af=lodash.clone(AFarr[_i12]);if(AFc1>end){AFc1-=slen;AFc2-=slen;}else if(AFc1<start){if(AFc2<start);else if(AFc2<=end){AFc2=start-1;}else {AFc2-=slen;}}else {if(AFc2>end){AFc1=start;AFc2-=slen;}}_af.cellrange={row:[AFr1,AFr2],column:[AFc1,AFc2]};newAFarr.push(_af);}}}}var frozen=file.frozen;if(frozen){if(type==="row"&&(frozen.type==="rangeRow"||frozen.type==="rangeBoth")){var _frozen$range$row_foc2,_frozen$range3;if(((_frozen$range$row_foc2=(_frozen$range3=frozen.range)===null||_frozen$range3===void 0?void 0:_frozen$range3.row_focus)!==null&&_frozen$range$row_foc2!==void 0?_frozen$range$row_foc2:-1)>=start){frozen.range.row_focus-=Math.min(end,frozen.range.row_focus)-start+1;}}if(type==="column"&&(frozen.type==="rangeColumn"||frozen.type==="rangeBoth")){var _frozen$range$column_2,_frozen$range4;if(((_frozen$range$column_2=(_frozen$range4=frozen.range)===null||_frozen$range4===void 0?void 0:_frozen$range4.column_focus)!==null&&_frozen$range$column_2!==void 0?_frozen$range$column_2:-1)>=start){frozen.range.column_focus-=Math.min(end,frozen.range.column_focus)-start+1;}}}var dataVerification=file.dataVerification;var newDataVerification={};if(dataVerification!=null){lodash.forEach(dataVerification,function(v,key){var r=Number(key.split("_")[0]);var c=Number(key.split("_")[1]);var item=dataVerification[key];if(type==="row"){if(r<start){newDataVerification["".concat(r,"_").concat(c)]=item;}else if(r>end){newDataVerification["".concat(r-slen,"_").concat(c)]=item;}}else if(type==="column"){if(c<start){newDataVerification["".concat(r,"_").concat(c)]=item;}else if(c>end){newDataVerification["".concat(r,"_").concat(c-slen)]=item;}}});}var hyperlink=file.hyperlink;var newHyperlink={};if(hyperlink!=null){lodash.forEach(hyperlink,function(v,key){var r=Number(key.split("_")[0]);var c=Number(key.split("_")[1]);var item=hyperlink[key];if(type==="row"){if(r<start){newHyperlink["".concat(r,"_").concat(c)]=item;}else if(r>end){newHyperlink["".concat(r-slen,"_").concat(c)]=item;}}else if(type==="column"){if(c<start){newHyperlink["".concat(r,"_").concat(c)]=item;}else if(c>end){newHyperlink["".concat(r,"_").concat(c-slen)]=item;}}});}if(type==="row"){if(cfg.rowlen==null){cfg.rowlen={};}var rowlen_new={};lodash.forEach(cfg.rowlen,function(v,rstr){var r=parseFloat(rstr);if(r<start){rowlen_new[r]=cfg.rowlen[r];}else if(r>end){rowlen_new[r-slen]=cfg.rowlen[r];}});cfg.rowlen=rowlen_new;if(cfg.rowhidden==null){cfg.rowhidden={};}var rowhidden_new={};lodash.forEach(cfg.rowhidden,function(v,rstr){var r=parseFloat(rstr);if(r<start){rowhidden_new[r]=cfg.rowhidden[r];}else if(r>end){rowhidden_new[r-slen]=cfg.rowhidden[r];}});cfg.rowhidden=rowhidden_new;if(cfg.borderInfo&&cfg.borderInfo.length>0){var borderInfo=[];for(var _i13=0;_i13<cfg.borderInfo.length;_i13+=1){var rangeType=cfg.borderInfo[_i13].rangeType;if(rangeType==="range"){var borderRange=cfg.borderInfo[_i13].range;var emptyRange=[];for(var _j3=0;_j3<borderRange.length;_j3+=1){var bd_r1=borderRange[_j3].row[0];var bd_r2=borderRange[_j3].row[1];for(var r=start;r<=end;r+=1){if(r<borderRange[_j3].row[0]){bd_r1-=1;bd_r2-=1;}else if(r<=borderRange[_j3].row[1]){bd_r2-=1;}}if(bd_r2>=bd_r1){emptyRange.push({row:[bd_r1,bd_r2],column:borderRange[_j3].column});}}if(emptyRange.length>0){var bd_obj={rangeType:"range",borderType:cfg.borderInfo[_i13].borderType,style:cfg.borderInfo[_i13].style,color:cfg.borderInfo[_i13].color,range:emptyRange};borderInfo.push(bd_obj);}}else if(rangeType==="cell"){var row_index=cfg.borderInfo[_i13].value.row_index;if(row_index<start){borderInfo.push(cfg.borderInfo[_i13]);}else if(row_index>end){cfg.borderInfo[_i13].value.row_index=row_index-(end-start+1);borderInfo.push(cfg.borderInfo[_i13]);}}}cfg.borderInfo=borderInfo;}d.splice(start,slen);for(var _r3=0;_r3<slen;_r3+=1){var row=[];for(var c=0;c<d[0].length;c+=1){row.push(null);}d.push(row);}}else {if(cfg.columnlen==null){cfg.columnlen={};}var columnlen_new={};lodash.forEach(cfg.columnlen,function(v,cstr){var c=parseFloat(cstr);if(c<start){columnlen_new[c]=cfg.columnlen[c];}else if(c>end){columnlen_new[c-slen]=cfg.columnlen[c];}});cfg.columnlen=columnlen_new;if(cfg.colhidden==null){cfg.colhidden={};}var colhidden_new={};lodash.forEach(cfg.colhidden,function(v,cstr){var c=parseFloat(cstr);if(c<start){colhidden_new[c]=cfg.colhidden[c];}else if(c>end){colhidden_new[c-slen]=cfg.colhidden[c];}});cfg.colhidden=colhidden_new;if(cfg.borderInfo&&cfg.borderInfo.length>0){var _borderInfo2=[];for(var _i14=0;_i14<cfg.borderInfo.length;_i14+=1){var _rangeType2=cfg.borderInfo[_i14].rangeType;if(_rangeType2==="range"){var _borderRange2=cfg.borderInfo[_i14].range;var _emptyRange2=[];for(var _j4=0;_j4<_borderRange2.length;_j4+=1){var bd_c1=_borderRange2[_j4].column[0];var bd_c2=_borderRange2[_j4].column[1];for(var _c=start;_c<=end;_c+=1){if(_c<_borderRange2[_j4].column[0]){bd_c1-=1;bd_c2-=1;}else if(_c<=_borderRange2[_j4].column[1]){bd_c2-=1;}}if(bd_c2>=bd_c1){_emptyRange2.push({row:_borderRange2[_j4].row,column:[bd_c1,bd_c2]});}}if(_emptyRange2.length>0){var _bd_obj2={rangeType:"range",borderType:cfg.borderInfo[_i14].borderType,style:cfg.borderInfo[_i14].style,color:cfg.borderInfo[_i14].color,range:_emptyRange2};_borderInfo2.push(_bd_obj2);}}else if(_rangeType2==="cell"){var col_index=cfg.borderInfo[_i14].value.col_index;if(col_index<start){_borderInfo2.push(cfg.borderInfo[_i14]);}else if(col_index>end){cfg.borderInfo[_i14].value.col_index=col_index-(end-start+1);_borderInfo2.push(cfg.borderInfo[_i14]);}}}cfg.borderInfo=_borderInfo2;}var addcol=[];for(var _r4=0;_r4<slen;_r4+=1){addcol.push(null);}for(var _r5=0;_r5<d.length;_r5+=1){var _row2=lodash.clone(d[_r5]);_row2.splice(start,slen);d[_r5]=_row2.concat(addcol);}}file.data=d;file.config=cfg;file.calcChain=newCalcChain;if(newFilterObj!=null){file.filter=newFilterObj.filter;file.filter_select=newFilterObj.filter_select;}file.luckysheet_conditionformat_save=newCFarr;file.luckysheet_alternateformat_save=newAFarr;file.dataVerification=newDataVerification;file.hyperlink=newHyperlink;if(file.id===ctx.currentSheetId){ctx.config=cfg;}}function storeSheetParam(ctx){var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;var file=ctx.luckysheetfile[index];file.config=ctx.config;file.luckysheet_select_save=ctx.luckysheet_select_save;file.luckysheet_selection_range=ctx.luckysheet_selection_range;file.zoomRatio=ctx.zoomRatio;}function storeSheetParamALL(ctx){storeSheetParam(ctx);var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;ctx.luckysheetfile[index].config=ctx.config;}function changeSheet(ctx,id,isPivotInitial,isNewSheet,isCopySheet){var _ctx$hooks$beforeActi,_ctx$hooks;if(id===ctx.currentSheetId){return;}var file=ctx.luckysheetfile[getSheetIndex(ctx,id)];if(((_ctx$hooks$beforeActi=(_ctx$hooks=ctx.hooks).beforeActivateSheet)===null||_ctx$hooks$beforeActi===void 0?void 0:_ctx$hooks$beforeActi.call(_ctx$hooks,id))===false){return;}storeSheetParamALL(ctx);for(var i=0;i<ctx.luckysheetfile.length;i+=1){if(ctx.luckysheetfile[i].id===id){ctx.luckysheetfile[i].status=1;}else {ctx.luckysheetfile[i].status=0;}}ctx.currentSheetId=id;if(file.isPivotTable){ctx.luckysheetcurrentisPivotTable=true;}else {ctx.luckysheetcurrentisPivotTable=false;}if(ctx.hooks.afterActivateSheet){setTimeout(function(){var _ctx$hooks$afterActiv,_ctx$hooks2;(_ctx$hooks$afterActiv=(_ctx$hooks2=ctx.hooks).afterActivateSheet)===null||_ctx$hooks$afterActiv===void 0?void 0:_ctx$hooks$afterActiv.call(_ctx$hooks2,id);});}}function addSheet(ctx,settings){var _ctx$hooks$beforeAddS,_ctx$hooks3;var isPivotTable=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(ctx.allowEdit===false){return;}var order=ctx.luckysheetfile.length;var id=settings.generateSheetId();var sheetname=generateRandomSheetName(ctx.luckysheetfile,isPivotTable,ctx);var sheetconfig={name:sheetname,status:0,order:order,id:id,row:ctx.defaultrowNum,column:ctx.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!isPivotTable};if(((_ctx$hooks$beforeAddS=(_ctx$hooks3=ctx.hooks).beforeAddSheet)===null||_ctx$hooks$beforeAddS===void 0?void 0:_ctx$hooks$beforeAddS.call(_ctx$hooks3,sheetconfig))===false){return;}ctx.luckysheetfile.push(sheetconfig);changeSheet(ctx,id);if(ctx.hooks.afterAddSheet){setTimeout(function(){var _ctx$hooks$afterAddSh,_ctx$hooks4;(_ctx$hooks$afterAddSh=(_ctx$hooks4=ctx.hooks).afterAddSheet)===null||_ctx$hooks$afterAddSh===void 0?void 0:_ctx$hooks$afterAddSh.call(_ctx$hooks4,sheetconfig);});}}function deleteSheet(ctx,id){var _ctx$hooks$beforeDele,_ctx$hooks5;if(ctx.allowEdit===false){return;}var arrIndex=getSheetIndex(ctx,id);if(arrIndex==null)return;if(((_ctx$hooks$beforeDele=(_ctx$hooks5=ctx.hooks).beforeDeleteSheet)===null||_ctx$hooks$beforeDele===void 0?void 0:_ctx$hooks$beforeDele.call(_ctx$hooks5,id))===false){return;}ctx.luckysheetfile.splice(arrIndex,1);if(ctx.hooks.afterDeleteSheet){setTimeout(function(){var _ctx$hooks$afterDelet,_ctx$hooks6;(_ctx$hooks$afterDelet=(_ctx$hooks6=ctx.hooks).afterDeleteSheet)===null||_ctx$hooks$afterDelet===void 0?void 0:_ctx$hooks$afterDelet.call(_ctx$hooks6,id);});}}function editSheetName(ctx,editable){var _ctx$hooks$beforeUpda,_ctx$hooks7;if(ctx.allowEdit===false){return;}var _locale=locale(ctx),sheetconfig=_locale.sheetconfig;var oldtxt=editable.dataset.oldText||"";var txt=editable.innerText;if(((_ctx$hooks$beforeUpda=(_ctx$hooks7=ctx.hooks).beforeUpdateSheetName)===null||_ctx$hooks$beforeUpda===void 0?void 0:_ctx$hooks$beforeUpda.call(_ctx$hooks7,ctx.currentSheetId,oldtxt,txt))===false){return;}if(txt.length===0){editable.innerText=oldtxt;throw new Error(sheetconfig.sheetNamecannotIsEmptyError);}if(txt.length>31||txt.charAt(0)==="'"||txt.charAt(txt.length-1)==="'"||/[:\\/?*[\]]+/.test(txt)){editable.innerText=oldtxt;throw new Error(sheetconfig.sheetNameSpecCharError);}var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;for(var i=0;i<ctx.luckysheetfile.length;i+=1){if(index!==i&&ctx.luckysheetfile[i].name===txt){editable.innerText=oldtxt;return;}}ctx.luckysheetfile[index].name=txt;if(ctx.hooks.afterUpdateSheetName){setTimeout(function(){var _ctx$hooks$afterUpdat,_ctx$hooks8;(_ctx$hooks$afterUpdat=(_ctx$hooks8=ctx.hooks).afterUpdateSheetName)===null||_ctx$hooks$afterUpdat===void 0?void 0:_ctx$hooks$afterUpdat.call(_ctx$hooks8,ctx.currentSheetId,oldtxt,txt);});}}function expandRowsAndColumns(data,rowsToAdd,columnsToAdd){if(rowsToAdd<=0&&columnsToAdd<=0){return data;}if(rowsToAdd<=0){rowsToAdd=0;}if(columnsToAdd<=0){columnsToAdd=0;}var currentColLen=0;if(data.length>0){currentColLen=data[0].length;}for(var r=0;r<data.length;r+=1){for(var i=0;i<columnsToAdd;i+=1){data[r].push(null);}}for(var _r=0;_r<rowsToAdd;_r+=1){data.push(lodash.times(currentColLen+columnsToAdd,function(){return null;}));}return data;}function mergeCells(ctx,sheetId,ranges,type){var idx=getSheetIndex(ctx,sheetId);if(idx==null)return;var sheet=ctx.luckysheetfile[idx];var cfg=sheet.config||{};if(cfg.merge==null){cfg.merge={};}var d=sheet.data;if(type==="merge-cancel"){for(var i=0;i<ranges.length;i+=1){var range=ranges[i];var r1=range.row[0];var r2=range.row[1];var c1=range.column[0];var c2=range.column[1];if(r1===r2&&c1===c2){continue;}var fv={};for(var r=r1;r<=r2;r+=1){for(var c=c1;c<=c2;c+=1){var cell=d[r][c];if(cell!=null&&cell.mc!=null){var mc_r=cell.mc.r;var mc_c=cell.mc.c;if("rs"in cell.mc){delete cell.mc;delete cfg.merge["".concat(mc_r,"_").concat(mc_c)];fv["".concat(mc_r,"_").concat(mc_c)]=lodash.cloneDeep(cell)||{};}else {var cell_clone=lodash.cloneDeep(fv["".concat(mc_r,"_").concat(mc_c)]);delete cell_clone.v;delete cell_clone.m;delete cell_clone.ct;delete cell_clone.f;delete cell_clone.spl;d[r][c]=cell_clone;}}}}}}else {var isHasMc=false;for(var _i=0;_i<ranges.length;_i+=1){var _range=ranges[_i];var _r=_range.row[0];var _r2=_range.row[1];var _c=_range.column[0];var _c2=_range.column[1];for(var _r3=_r;_r3<=_r2;_r3+=1){for(var _c3=_c;_c3<=_c2;_c3+=1){var _cell=d[_r3][_c3];if(_cell===null||_cell===void 0?void 0:_cell.mc){isHasMc=true;break;}}}}if(isHasMc){for(var _i2=0;_i2<ranges.length;_i2+=1){var _range2=ranges[_i2];var _r4=_range2.row[0];var _r5=_range2.row[1];var _c4=_range2.column[0];var _c5=_range2.column[1];if(_r4===_r5&&_c4===_c5){continue;}var _fv={};for(var _r6=_r4;_r6<=_r5;_r6+=1){for(var _c6=_c4;_c6<=_c5;_c6+=1){var _cell2=d[_r6][_c6];if(_cell2!=null&&_cell2.mc!=null){var _mc_r=_cell2.mc.r;var _mc_c=_cell2.mc.c;if("rs"in _cell2.mc){delete _cell2.mc;delete cfg.merge["".concat(_mc_r,"_").concat(_mc_c)];_fv["".concat(_mc_r,"_").concat(_mc_c)]=lodash.cloneDeep(_cell2)||{};}else {var _cell_clone=lodash.cloneDeep(_fv["".concat(_mc_r,"_").concat(_mc_c)]);delete _cell_clone.v;delete _cell_clone.m;delete _cell_clone.ct;delete _cell_clone.f;delete _cell_clone.spl;d[_r6][_c6]=_cell_clone;}}}}}}else {for(var _i3=0;_i3<ranges.length;_i3+=1){var _range3=ranges[_i3];var _r7=_range3.row[0];var _r8=_range3.row[1];var _c7=_range3.column[0];var _c8=_range3.column[1];if(_r7===_r8&&_c7===_c8){continue;}if(type==="merge-all"){var _fv2={};var isfirst=false;for(var _r9=_r7;_r9<=_r8;_r9+=1){for(var _c9=_c7;_c9<=_c8;_c9+=1){var _cell3=d[_r9][_c9];if(_cell3!=null&&(isInlineStringCT(_cell3.ct)||!lodash.isEmpty(_cell3.v)||_cell3.f!=null)&&!isfirst){_fv2=lodash.cloneDeep(_cell3)||{};isfirst=true;}d[_r9][_c9]={mc:{r:_r7,c:_c7}};}}d[_r7][_c7]=_fv2;var a=d[_r7][_c7];if(!a)return;a.mc={r:_r7,c:_c7,rs:_r8-_r7+1,cs:_c8-_c7+1};cfg.merge["".concat(_r7,"_").concat(_c7)]={r:_r7,c:_c7,rs:_r8-_r7+1,cs:_c8-_c7+1};}else if(type==="merge-vertical"){for(var _c10=_c7;_c10<=_c8;_c10+=1){var _fv3={};var _isfirst=false;for(var _r10=_r7;_r10<=_r8;_r10+=1){var _cell4=d[_r10][_c10];if(_cell4!=null&&(!lodash.isEmpty(_cell4.v)||_cell4.f!=null)&&!_isfirst){_fv3=lodash.cloneDeep(_cell4)||{};_isfirst=true;}d[_r10][_c10]={mc:{r:_r7,c:_c10}};}d[_r7][_c10]=_fv3;var _a=d[_r7][_c10];if(!_a)return;_a.mc={r:_r7,c:_c10,rs:_r8-_r7+1,cs:1};cfg.merge["".concat(_r7,"_").concat(_c10)]={r:_r7,c:_c10,rs:_r8-_r7+1,cs:1};}}else if(type==="merge-horizontal"){for(var _r11=_r7;_r11<=_r8;_r11+=1){var _fv4={};var _isfirst2=false;for(var _c11=_c7;_c11<=_c8;_c11+=1){var _cell5=d[_r11][_c11];if(_cell5!=null&&(!lodash.isEmpty(_cell5.v)||_cell5.f!=null)&&!_isfirst2){_fv4=lodash.cloneDeep(_cell5)||{};_isfirst2=true;}d[_r11][_c11]={mc:{r:_r11,c:_c7}};}d[_r11][_c7]=_fv4;var _a2=d[_r11][_c7];if(!_a2)return;_a2.mc={r:_r11,c:_c7,rs:1,cs:_c8-_c7+1};cfg.merge["".concat(_r11,"_").concat(_c7)]={r:_r11,c:_c7,rs:1,cs:_c8-_c7+1};}}}}}sheet.config=cfg;if(sheet.id===ctx.currentSheetId){ctx.config=cfg;}}function orderbydata(isAsc,index,data){if(isAsc==null){isAsc=true;}var a=function a(x,y){var x1=x[index];var y1=y[index];if(x[index].v!=null){x1=x[index].v;}if(y[index].v!=null){y1=y[index].v;}if(isRealNull(x1)){return 1;}if(isRealNull(y1)){return -1;}if(isdatetime(x1)&&isdatetime(y1)){return diff(x1,y1);}if(isRealNum(x1)&&isRealNum(y1)){var y1Value=numeral(y1).value();var x1Value=numeral(x1).value();if(y1Value==null||x1Value==null)return null;return x1Value-y1Value;}if(!isRealNum(x1)&&!isRealNum(y1)){return x1.localeCompare(y1,"zh");}if(!isRealNum(x1)){return 1;}if(!isRealNum(y1)){return -1;}return 0;};var d=function d(x,y){return a(y,x);};if(isAsc){return data.sort(a);}return data.sort(d);}function sortSelection(ctx,isAsc){if(ctx.luckysheet_select_save==null)return;if(ctx.luckysheet_select_save.length>1){return;}if(isAsc==null){isAsc=true;}var flowdata=getFlowdata(ctx);var d=flowdata;if(d==null)return;var r1=ctx.luckysheet_select_save[0].row[0];var r2=ctx.luckysheet_select_save[0].row[1];var c1=ctx.luckysheet_select_save[0].column[0];var c2=ctx.luckysheet_select_save[0].column[1];var str;var edr;for(var r=r1;r<=r2;r+=1){if(d[r]!=null&&d[r][c1]!=null){var cell=d[r][c1];if(cell==null)return;if(cell.mc!=null||isRealNull(cell.v)){continue;}if(str==null&&/[\u4e00-\u9fa5]+/g.test("".concat(cell.v))){str=r+1;edr=r+1;continue;}if(str==null){str=r;}edr=r;}}if(str==null||str>r2){return;}var hasMc=false;var data=[];if(edr==null)return;for(var _r=str;_r<=edr;_r+=1){var data_row=[];for(var c=c1;c<=c2;c+=1){var _d$_r$c;if(d[_r][c]!=null&&((_d$_r$c=d[_r][c])===null||_d$_r$c===void 0?void 0:_d$_r$c.mc)!=null){hasMc=true;break;}data_row.push(d[_r][c]);}data.push(data_row);}if(hasMc){return;}data=orderbydata(isAsc,0,data);for(var _r2=str;_r2<=edr;_r2+=1){for(var _c=c1;_c<=c2;_c+=1){d[_r2][_c]=data[_r2-str][_c-c1];setCellValue(ctx,_r2,_c,d,data[_r2-str][_c-c1]);}}}function updateFormatCell(ctx,d,attr,foucsStatus,row_st,row_ed,col_st,col_ed){if(lodash.isNil(d)||lodash.isNil(attr)){return;}if(attr==="ct"){for(var r=row_st;r<=row_ed;r+=1){if(!lodash.isNil(ctx.config.rowhidden)&&!lodash.isNil(ctx.config.rowhidden[r])){continue;}for(var c=col_st;c<=col_ed;c+=1){var cell=d[r][c];var value=void 0;if(lodash.isPlainObject(cell)){value=cell===null||cell===void 0?void 0:cell.v;}else {value=cell;}if(foucsStatus!=="@"&&isRealNum(value)){value=Number(value);}var mask=update(foucsStatus,value);var type="n";if(is_date(foucsStatus)||foucsStatus===14||foucsStatus===15||foucsStatus===16||foucsStatus===17||foucsStatus===18||foucsStatus===19||foucsStatus===20||foucsStatus===21||foucsStatus===22||foucsStatus===45||foucsStatus===46||foucsStatus===47){type="d";}else if(foucsStatus==="@"||foucsStatus===49){type="s";}else if(foucsStatus==="General"||foucsStatus===0){type=isRealNum(value)?"n":"g";}if(cell&&lodash.isPlainObject(cell)){cell.m="".concat(mask);if(lodash.isNil(cell.ct)){cell.ct={};}cell.ct.fa=foucsStatus;cell.ct.t=type;}else {d[r][c]={ct:{fa:foucsStatus,t:type},v:value,m:mask};}}}}else {if(attr==="ht"){if(foucsStatus==="left"){foucsStatus="1";}else if(foucsStatus==="center"){foucsStatus="0";}else if(foucsStatus==="right"){foucsStatus="2";}}else if(attr==="vt"){if(foucsStatus==="top"){foucsStatus="1";}else if(foucsStatus==="middle"){foucsStatus="0";}else if(foucsStatus==="bottom"){foucsStatus="2";}}else if(attr==="tb"){if(foucsStatus==="overflow"){foucsStatus="1";}else if(foucsStatus==="clip"){foucsStatus="0";}else if(foucsStatus==="wrap"){foucsStatus="2";}}else if(attr==="tr"){if(foucsStatus==="none"){foucsStatus="0";}else if(foucsStatus==="angleup"){foucsStatus="1";}else if(foucsStatus==="angledown"){foucsStatus="2";}else if(foucsStatus==="vertical"){foucsStatus="3";}else if(foucsStatus==="rotation-up"){foucsStatus="4";}else if(foucsStatus==="rotation-down"){foucsStatus="5";}}for(var _r=row_st;_r<=row_ed;_r+=1){if(!lodash.isNil(ctx.config.rowhidden)&&!lodash.isNil(ctx.config.rowhidden[_r])){continue;}for(var _c=col_st;_c<=col_ed;_c+=1){var _value=d[_r][_c];if(_value&&lodash.isPlainObject(_value)){updateInlineStringFormatOutside(_value,attr,foucsStatus);_value[attr]=foucsStatus;}else {d[_r][_c]={v:_value};d[_r][_c][attr]=foucsStatus;}}}}}function updateFormat(ctx,$input,d,attr,foucsStatus){if(!ctx.allowEdit){return;}if(attr in inlineStyleAffectAttribute){if(ctx.luckysheetCellUpdate.length>0){var value=$input.innerText;if(value.substring(0,1)!=="="){var cell=d[ctx.luckysheetCellUpdate[0]][ctx.luckysheetCellUpdate[1]];if(cell){updateInlineStringFormat(ctx,cell,attr,foucsStatus,$input);}return;}}}var cfg=lodash.cloneDeep(ctx.config);if(lodash.isNil(cfg.rowlen)){cfg.rowlen={};}lodash.forEach(ctx.luckysheet_select_save,function(selection){var _selection$row=_slicedToArray$3(selection.row,2),row_st=_selection$row[0],row_ed=_selection$row[1];var _selection$column=_slicedToArray$3(selection.column,2),col_st=_selection$column[0],col_ed=_selection$column[1];updateFormatCell(ctx,d,attr,foucsStatus,row_st,row_ed,col_st,col_ed);});}function toggleAttr(ctx,cellInput,attr){var flowdata=getFlowdata(ctx);if(!flowdata)return;var flag=isAllSelectedCellsInStatus(ctx,attr,1);var foucsStatus=flag?0:1;updateFormat(ctx,cellInput,flowdata,attr,foucsStatus);}function setAttr(ctx,cellInput,attr,value){var flowdata=getFlowdata(ctx);if(!flowdata)return;updateFormat(ctx,cellInput,flowdata,attr,value);}function checkNoNullValue(cell){var v=cell;if(lodash.isPlainObject(v)){v=v.v;}if(!isRealNull(v)&&isdatatypemulti(v).num&&(cell.ct==null||cell.ct.t==null||cell.ct.t==="n"||cell.ct.t==="g")){return true;}return false;}function checkNoNullValueAll(cell){var v=cell;if(lodash.isPlainObject(v)){v=v.v;}if(!isRealNull(v)){return true;}return false;}function getNoNullValue(d,st_x,ed,type){var hasValueStart=null;var nullNum=0;var nullTime=0;for(var r=ed-1;r>=0;r-=1){var cell=void 0;if(type==="c"){cell=d[st_x][r];}else {cell=d[r][st_x];}if(checkNoNullValue(cell)){hasValueStart=r;}else if(cell==null||cell.v==null||cell.v===""){nullNum+=1;if(nullNum>=40){if(nullTime<=0){nullTime=1;}else {break;}}}else {break;}}return hasValueStart;}function activeFormulaInput(cellInput,ctx,row_index,col_index,rowh,columnh,formula,cache,isnull){if(isnull==null){isnull=false;}ctx.luckysheetCellUpdate=[row_index,col_index];cache.doNotUpdateCell=true;if(isnull){var _formulaTxt="<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(formula.toUpperCase(),"</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">(</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">)</span>");cellInput.innerHTML=_formulaTxt;var spanList=cellInput.querySelectorAll("span");setCaretPosition(ctx,spanList[spanList.length-2],0,1);return;}var row_pre=rowLocationByIndex(rowh[0],ctx.visibledatarow)[0];var row=rowLocationByIndex(rowh[1],ctx.visibledatarow)[1];var col_pre=colLocationByIndex(columnh[0],ctx.visibledatacolumn)[0];var col=colLocationByIndex(columnh[1],ctx.visibledatacolumn)[1];var formulaTxt="<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(formula.toUpperCase(),"</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">(</span><span class=\"fortune-formula-functionrange-cell\" rangeindex=\"0\" dir=\"auto\" style=\"color:").concat(colors[0],";\">").concat(getRangetxt(ctx,ctx.currentSheetId,{row:rowh,column:columnh},ctx.currentSheetId),"</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">)</span>");cellInput.innerHTML=formulaTxt;israngeseleciton(ctx);ctx.formulaCache.rangestart=true;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;ctx.formulaCache.rangechangeindex=0;rangeSetValue(ctx,cellInput,{row:rowh,column:columnh});ctx.formulaCache.func_selectedrange={left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1,left_move:col_pre,width_move:col-col_pre-1,top_move:row_pre,height_move:row-row_pre-1,row:[row_index,row_index],column:[col_index,col_index]};createFormulaRangeSelect(ctx,{rangeIndex:ctx.formulaCache.rangeIndex||0,left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1});}function backFormulaInput(d,r,c,rowh,columnh,formula,ctx){var _ctx$formulaCache;var f="=".concat(formula.toUpperCase(),"(").concat(getRangetxt(ctx,ctx.currentSheetId,{row:rowh,column:columnh},ctx.currentSheetId),")");var v=execfunction(ctx,f,r,c);var value={v:v[1],f:v[2]};setCellValue(ctx,r,c,d,value);(_ctx$formulaCache=ctx.formulaCache).execFunctionExist||(_ctx$formulaCache.execFunctionExist=[]);ctx.formulaCache.execFunctionExist.push({r:r,c:c,i:ctx.currentSheetId});}function singleFormulaInput(cellInput,ctx,d,_index,fix,st_m,ed_m,formula,type,cache,noNum,noNull){if(type==null){type="r";}if(noNum==null){noNum=true;}if(noNull==null){noNull=true;}var isNull=true;var isNum=false;for(var c=st_m;c<=ed_m;c+=1){var cell=null;if(type==="c"){cell=d[c][fix];}else {cell=d[fix][c];}if(checkNoNullValue(cell)){isNull=false;isNum=true;}else if(checkNoNullValueAll(cell)){isNull=false;}}if(isNull&&noNull){var st_r_r=getNoNullValue(d,_index,fix,type);if(st_r_r==null){if(type==="c"){activeFormulaInput(cellInput,ctx,_index,fix,null,null,formula,cache,true);}else {activeFormulaInput(cellInput,ctx,fix,_index,null,null,formula,cache,true);}}else {if(_index===st_m){for(var _c2=st_m;_c2<=ed_m;_c2+=1){st_r_r=getNoNullValue(d,_c2,fix,type);if(st_r_r==null){break;}if(type==="c"){backFormulaInput(d,_c2,fix,[_c2,_c2],[st_r_r,fix-1],formula,ctx);}else {backFormulaInput(d,fix,_c2,[st_r_r,fix-1],[_c2,_c2],formula,ctx);}}}else {for(var _c3=ed_m;_c3>=st_m;_c3-=1){st_r_r=getNoNullValue(d,_c3,fix,type);if(st_r_r==null){break;}if(type==="c"){backFormulaInput(d,_c3,fix,[_c3,_c3],[st_r_r,fix-1],formula,ctx);}else {backFormulaInput(d,fix,_c3,[st_r_r,fix-1],[_c3,_c3],formula,ctx);}}}}return false;}if(isNum&&noNum){var _cell=null;if(type==="c"){_cell=d[ed_m+1][fix];}else {_cell=d[fix][ed_m+1];}if(_cell!=null&&_cell.v!=null&&_cell.v.toString().length>0){var _c4=ed_m+1;if(type==="c"){_cell=d[ed_m+1][fix];}else {_cell=d[fix][ed_m+1];}while(_cell!=null&&_cell.v!=null&&_cell.v.toString().length>0){_c4+=1;var len=null;if(type==="c"){len=d.length;}else {len=d[0].length;}if(_c4>=len){return false;}if(type==="c"){_cell=d[_c4][fix];}else {_cell=d[fix][_c4];}}if(type==="c"){backFormulaInput(d,_c4,fix,[st_m,ed_m],[fix,fix],formula,ctx);}else {backFormulaInput(d,fix,_c4,[fix,fix],[st_m,ed_m],formula,ctx);}}else {if(type==="c"){backFormulaInput(d,ed_m+1,fix,[st_m,ed_m],[fix,fix],formula,ctx);}else {backFormulaInput(d,fix,ed_m+1,[fix,fix],[st_m,ed_m],formula,ctx);}}return false;}return true;}function autoSelectionFormula(ctx,cellInput,formula,cache){var flowdata=getFlowdata(ctx);if(flowdata==null)return;var isfalse=true;ctx.formulaCache.execFunctionExist=[];function execFormulaInput_c(d,st_r,ed_r,st_c,ed_c,_formula){var st_c_c=getNoNullValue(d,st_r,ed_c,"c");if(st_c_c==null){activeFormulaInput(cellInput,ctx,st_r,st_c,null,null,_formula,cache,true);}else {activeFormulaInput(cellInput,ctx,st_r,st_c,[st_r,ed_r],[st_c_c,ed_c-1],_formula,cache);}}function execFormulaInput(d,st_r,ed_r,st_c,ed_c,_formula){var st_r_c=getNoNullValue(d,st_c,ed_r,"r");if(st_r_c==null){execFormulaInput_c(d,st_r,ed_r,st_c,ed_c,_formula);}else {activeFormulaInput(cellInput,ctx,st_r,st_c,[st_r_c,ed_r-1],[st_c,ed_c],_formula,cache);}}if(!ctx.luckysheet_select_save)return;lodash.forEach(ctx.luckysheet_select_save,function(selection){var _selection$row2=_slicedToArray$3(selection.row,2),st_r=_selection$row2[0],ed_r=_selection$row2[1];var _selection$column2=_slicedToArray$3(selection.column,2),st_c=_selection$column2[0],ed_c=_selection$column2[1];var row_index=selection.row_focus;var col_index=selection.column_focus;if(st_r===ed_r&&st_c===ed_c){if(ed_r-1<0&&ed_c-1<0){activeFormulaInput(cellInput,ctx,st_r,st_c,null,null,formula,cache,true);return;}if(ed_r-1>=0&&checkNoNullValue(flowdata[ed_r-1][st_c])){execFormulaInput(flowdata,st_r,ed_r,st_c,ed_c,formula);}else if(ed_c-1>=0&&checkNoNullValue(flowdata[st_r][ed_c-1])){execFormulaInput_c(flowdata,st_r,ed_r,st_c,ed_c,formula);}else {execFormulaInput(flowdata,st_r,ed_r,st_c,ed_c,formula);}}else if(st_r===ed_r){isfalse=singleFormulaInput(cellInput,ctx,flowdata,col_index,st_r,st_c,ed_c,formula,"r",cache);}else if(st_c===ed_c){isfalse=singleFormulaInput(cellInput,ctx,flowdata,row_index,st_c,st_r,ed_r,formula,"c",cache);}else {var r_false=true;for(var r=st_r;r<=ed_r;r+=1){r_false=singleFormulaInput(cellInput,ctx,flowdata,col_index,r,st_c,ed_c,formula,"r",cache,true,false)&&r_false;}var c_false=true;for(var c=st_c;c<=ed_c;c+=1){c_false=singleFormulaInput(cellInput,ctx,flowdata,row_index,c,st_r,ed_r,formula,"c",cache,true,false)&&c_false;}isfalse=!!r_false&&!!c_false;}isfalse=isfalse&&isfalse;});if(!isfalse){ctx.formulaCache.execFunctionExist.reverse();execFunctionGroup(ctx,null,null,null,null,flowdata);ctx.formulaCache.execFunctionGlobalData=null;}}function cancelPaintModel(ctx){var _ctx$luckysheet_copy_;if(ctx.luckysheet_copy_save===null)return;if(((_ctx$luckysheet_copy_=ctx.luckysheet_copy_save)===null||_ctx$luckysheet_copy_===void 0?void 0:_ctx$luckysheet_copy_.dataSheetId)===ctx.currentSheetId){ctx.luckysheet_selection_range=[];selectionCopyShow(ctx.luckysheet_selection_range,ctx);}else {if(!ctx.luckysheet_copy_save)return;var index=getSheetIndex(ctx,ctx.luckysheet_copy_save.dataSheetId);if(!index)return;ctx.luckysheetfile[index].luckysheet_selection_range=[];}ctx.luckysheet_copy_save={dataSheetId:"",copyRange:[{row:[0],column:[0]}],RowlChange:false,HasMC:false};ctx.luckysheetPaintModelOn=false;}function handleCurrencyFormat(ctx,cellInput){var flowdata=getFlowdata(ctx);if(!flowdata)return;updateFormat(ctx,cellInput,flowdata,"ct"," #.00");}function handlePercentageFormat(ctx,cellInput){var flowdata=getFlowdata(ctx);if(!flowdata)return;updateFormat(ctx,cellInput,flowdata,"ct","0.00%");}function handleNumberDecrease(ctx,cellInput){var flowdata=getFlowdata(ctx);if(!flowdata||!ctx.luckysheet_select_save)return;var row_index=ctx.luckysheet_select_save[0].row_focus;var col_index=ctx.luckysheet_select_save[0].column_focus;if(!row_index||!col_index)return;var foucsStatus=normalizedAttr(flowdata,row_index,col_index,"ct");var cell=flowdata[row_index][col_index];if(foucsStatus==null||foucsStatus.t!=="n"){return;}if(foucsStatus.fa==="General"){if(!cell||!cell.v)return;var mask=genarate(cell.v);if(!mask||mask.length<2)return;var _mask=_slicedToArray$3(mask,2);foucsStatus=_mask[1];}var reg=/^(w|W)((0?)|(0\.0+))$/;if(reg.test(foucsStatus.fa)){if(foucsStatus.fa.indexOf(".")>-1){if(foucsStatus.fa.substr(-2)===".0"){updateFormat(ctx,cellInput,flowdata,"ct",foucsStatus.fa.split(".")[0]);}else {updateFormat(ctx,cellInput,flowdata,"ct",foucsStatus.fa.substr(0,foucsStatus.fa.length-1));}}else {updateFormat(ctx,cellInput,flowdata,"ct",foucsStatus.fa);}return;}var prefix="";var main="";var fa=[];if(foucsStatus.fa.indexOf(".")>-1){fa=foucsStatus.fa.split(".");var _fa=fa;var _fa2=_slicedToArray$3(_fa,2);prefix=_fa2[0];main=_fa2[1];}else {return;}fa=main.split("");var tail="";for(var i=fa.length-1;i>=0;i-=1){var c=fa[i];if(c!=="#"&&c!=="0"&&c!==","&&Number.isNaN(parseInt(c,10))){tail=c+tail;}else {break;}}var fmt="";if(foucsStatus.fa.indexOf(".")>-1){var suffix=main;if(tail.length>0){suffix=main.replace(tail,"");}var pos=suffix.replace(/#/g,"0");pos=pos.substr(0,pos.length-1);if(pos===""){fmt=prefix+tail;}else {fmt="".concat(prefix,".").concat(pos).concat(tail);}}updateFormat(ctx,cellInput,flowdata,"ct",fmt);}function handleNumberIncrease(ctx,cellInput){var flowdata=getFlowdata(ctx);if(!flowdata)return;if(!ctx.luckysheet_select_save)return;var row_index=ctx.luckysheet_select_save[0].row_focus;var col_index=ctx.luckysheet_select_save[0].column_focus;if(!row_index||!col_index)return;var foucsStatus=normalizedAttr(flowdata,row_index,col_index,"ct");var cell=flowdata[row_index][col_index];if(foucsStatus==null||foucsStatus.t!=="n"){return;}if(foucsStatus.fa==="General"){if(!cell||!cell.v)return;var mask=genarate(cell.v);if(!mask||mask.length<2)return;var _mask2=_slicedToArray$3(mask,2);foucsStatus=_mask2[1];}if(foucsStatus.fa==="General"){updateFormat(ctx,cellInput,flowdata,"ct","#.0");return;}var reg=/^(w|W)((0?)|(0\.0+))$/;if(reg.test(foucsStatus.fa)){if(foucsStatus.fa.indexOf(".")>-1){updateFormat(ctx,cellInput,flowdata,"ct","".concat(foucsStatus.fa,"0"));}else {if(foucsStatus.fa.substr(-1)==="0"){updateFormat(ctx,cellInput,flowdata,"ct","".concat(foucsStatus.fa,".0"));}else {updateFormat(ctx,cellInput,flowdata,"ct","".concat(foucsStatus.fa,"0.0"));}}return;}var prefix="";var main="";var fa=[];if(foucsStatus.fa.indexOf(".")>-1){fa=foucsStatus.fa.split(".");var _fa3=fa;var _fa4=_slicedToArray$3(_fa3,2);prefix=_fa4[0];main=_fa4[1];}else {main=foucsStatus.fa;}fa=main.split("");var tail="";for(var i=fa.length-1;i>=0;i-=1){var c=fa[i];if(c!=="#"&&c!=="0"&&c!==","&&Number.isNaN(parseInt(c,10))){tail=c+tail;}else {break;}}var fmt="";if(foucsStatus.fa.indexOf(".")>-1){var suffix=main;if(tail.length>0){suffix=main.replace(tail,"");}var pos=suffix.replace(/#/g,"0");pos+="0";fmt="".concat(prefix,".").concat(pos).concat(tail);}else {if(tail.length>0){fmt="".concat(main.replace(tail,""),".0").concat(tail);}else {fmt="".concat(main,".0").concat(tail);}}updateFormat(ctx,cellInput,flowdata,"ct",fmt);}function handleBold(ctx,cellInput){toggleAttr(ctx,cellInput,"bl");}function handleItalic(ctx,cellInput){toggleAttr(ctx,cellInput,"it");}function handleStrikeThrough(ctx,cellInput){toggleAttr(ctx,cellInput,"cl");}function handleUnderline(ctx,cellInput){toggleAttr(ctx,cellInput,"un");}function handleHorizontalAlign(ctx,cellInput,value){setAttr(ctx,cellInput,"ht",value);}function handleVerticalAlign(ctx,cellInput,value){setAttr(ctx,cellInput,"vt",value);}function handleFormatPainter(ctx){if(ctx.luckysheet_select_save==null||ctx.luckysheet_select_save.length===0){return;}if(ctx.luckysheet_select_save.length>1){return;}var has_PartMC=false;var r1=ctx.luckysheet_select_save[0].row[0];var r2=ctx.luckysheet_select_save[0].row[1];var c1=ctx.luckysheet_select_save[0].column[0];var c2=ctx.luckysheet_select_save[0].column[1];has_PartMC=hasPartMC(ctx,ctx.config,r1,r2,c1,c2);if(has_PartMC){return;}cancelPaintModel(ctx);ctx.luckysheet_selection_range=[{row:ctx.luckysheet_select_save[0].row,column:ctx.luckysheet_select_save[0].column}];selectionCopyShow(ctx.luckysheet_selection_range,ctx);var RowlChange=false;var HasMC=false;for(var r=ctx.luckysheet_select_save[0].row[0];r<=ctx.luckysheet_select_save[0].row[1];r+=1){if(ctx.config.rowhidden!=null&&ctx.config.rowhidden[r]!=null){continue;}if(ctx.config.rowlen!=null&&r in ctx.config.rowlen){RowlChange=true;}for(var c=ctx.luckysheet_select_save[0].column[0];c<=ctx.luckysheet_select_save[0].column[1];c+=1){var flowdata=getFlowdata(ctx);if(!flowdata)return;var cell=flowdata[r][c];if(cell!=null&&cell.mc!=null&&cell.mc.rs!=null){HasMC=true;}}}ctx.luckysheet_copy_save={dataSheetId:ctx.currentSheetId,copyRange:[{row:ctx.luckysheet_select_save[0].row,column:ctx.luckysheet_select_save[0].column}],RowlChange:RowlChange,HasMC:HasMC};ctx.luckysheetPaintModelOn=true;ctx.luckysheetPaintSingle=true;}function handleClearFormat(ctx){var flowdata=getFlowdata(ctx);if(!flowdata)return;lodash.forEach(ctx.luckysheet_select_save,function(selection){var _selection$row3=_slicedToArray$3(selection.row,2),row_st=_selection$row3[0],row_ed=_selection$row3[1];var _selection$column3=_slicedToArray$3(selection.column,2),col_st=_selection$column3[0],col_ed=_selection$column3[1];for(var r=row_st;r<=row_ed;r+=1){if(!lodash.isNil(ctx.config.rowhidden)&&!lodash.isNil(ctx.config.rowhidden[r])){continue;}for(var c=col_st;c<=col_ed;c+=1){var cell=flowdata[r][c];if(!cell)continue;flowdata[r][c]=lodash.pick(cell,"v","m","mc","f","ct");}}});}function handleTextColor(ctx,cellInput,color){setAttr(ctx,cellInput,"fc",color);}function handleTextBackground(ctx,cellInput,color){setAttr(ctx,cellInput,"bg",color);}function handleBorder(ctx,type){if(type==null){type="border-all";}var color="#000000";var style="1";var cfg=ctx.config;if(cfg.borderInfo==null){cfg.borderInfo=[];}var borderInfo={rangeType:"range",borderType:type,color:color,style:style,range:lodash.cloneDeep(ctx.luckysheet_select_save)||[]};cfg.borderInfo.push(borderInfo);var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;ctx.luckysheetfile[index].config=ctx.config;}function handleMerge(ctx,type){if(selectIsOverlap(ctx)){return;}if(ctx.config.merge!=null){var has_PartMC=false;if(!ctx.luckysheet_select_save)return;for(var s=0;s<ctx.luckysheet_select_save.length;s+=1){var r1=ctx.luckysheet_select_save[s].row[0];var r2=ctx.luckysheet_select_save[s].row[1];var c1=ctx.luckysheet_select_save[s].column[0];var c2=ctx.luckysheet_select_save[s].column[1];has_PartMC=hasPartMC(ctx,ctx.config,r1,r2,c1,c2);if(has_PartMC){break;}}if(has_PartMC){return;}}var flowdata=getFlowdata(ctx);if(!flowdata)return;if(!ctx.luckysheet_select_save)return;mergeCells(ctx,ctx.currentSheetId,ctx.luckysheet_select_save,type);}function handleSort(ctx,isAsc){sortSelection(ctx,isAsc);}function handleFreeze(ctx,type){var _ctx$luckysheet_selec;if(!ctx.allowEdit)return;var file=ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)];if(!file)return;if(type==="freeze-cancel"){delete file.frozen;return;}var firstSelection=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[0];if(!firstSelection)return;var row_focus=firstSelection.row_focus,column_focus=firstSelection.column_focus;if(!row_focus||!column_focus)return;file.frozen={type:"both",range:{row_focus:row_focus,column_focus:column_focus}};if(type==="freeze-row"){file.frozen.type="rangeRow";}else if(type==="freeze-col"){file.frozen.type="rangeColumn";}}function handleTextSize(ctx,cellInput,size){setAttr(ctx,cellInput,"fs",size);}function handleSum(ctx,cellInput,cache){autoSelectionFormula(ctx,cellInput,"SUM",cache);}var handlerMap={"currency-format":handleCurrencyFormat,"percentage-format":handlePercentageFormat,"number-decrease":handleNumberDecrease,"number-increase":handleNumberIncrease,"sort-cell":function sortCell(ctx){return handleSort(ctx,true);},"merge-all":function mergeAll(ctx){return handleMerge(ctx,"mergeAll");},"border-all":function borderAll(ctx){return handleBorder(ctx,"border-all");},bold:handleBold,italic:handleItalic,"strike-through":handleStrikeThrough,underline:handleUnderline,"clear-format":handleClearFormat,"format-painter":handleFormatPainter};var selectedMap={bold:function bold(cell){return (cell===null||cell===void 0?void 0:cell.bl)===1;},italic:function italic(cell){return (cell===null||cell===void 0?void 0:cell.it)===1;},"strike-through":function strikeThrough(cell){return (cell===null||cell===void 0?void 0:cell.cl)===1;},underline:function underline(cell){return (cell===null||cell===void 0?void 0:cell.un)===1;}};function toolbarItemClickHandler(name){return handlerMap[name];}function toolbarItemSelectedFunc(name){return selectedMap[name];}function getArrowCanvasSize(fromX,fromY,toX,toY){var left=toX-5;if(fromX<toX){left=fromX-5;}var top=toY-5;if(fromY<toY){top=fromY-5;}var width=Math.abs(fromX-toX)+10;var height=Math.abs(fromY-toY)+10;var x1=width-5;var x2=5;if(fromX<toX){x1=5;x2=width-5;}var y1=height-5;var y2=5;if(fromY<toY){y1=5;y2=height-5;}return {left:left,top:top,width:width,height:height,fromX:x1,fromY:y1,toX:x2,toY:y2};}function drawArrow(rc,_ref,color,theta,headlen){var left=_ref.left,top=_ref.top,width=_ref.width,height=_ref.height,fromX=_ref.fromX,fromY=_ref.fromY,toX=_ref.toX,toY=_ref.toY;var canvas=document.getElementById("arrowCanvas-".concat(rc));var ctx=canvas.getContext("2d");if(!canvas||!ctx)return;canvas.style.width="".concat(width,"px");canvas.style.height="".concat(height,"px");canvas.width=width;canvas.height=height;canvas.style.left="".concat(left,"px");canvas.style.top="".concat(top,"px");var _canvas$getBoundingCl=canvas.getBoundingClientRect(),canvasWidth=_canvas$getBoundingCl.width,canvasHeight=_canvas$getBoundingCl.height;ctx.clearRect(0,0,canvasWidth,canvasHeight);theta=theta||30;headlen=headlen||6;var arrowWidth=1;color=color||"#000";var angle=Math.atan2(fromY-toY,fromX-toX)*180/Math.PI;var angle1=(angle+theta)*Math.PI/180;var angle2=(angle-theta)*Math.PI/180;var topX=headlen*Math.cos(angle1);var topY=headlen*Math.sin(angle1);var botX=headlen*Math.cos(angle2);var botY=headlen*Math.sin(angle2);ctx.save();ctx.beginPath();var arrowX=fromX-topX;var arrowY=fromY-topY;ctx.moveTo(arrowX,arrowY);ctx.moveTo(fromX,fromY);ctx.lineTo(toX,toY);ctx.lineWidth=arrowWidth;ctx.strokeStyle=color;ctx.stroke();arrowX=toX+topX;arrowY=toY+topY;ctx.moveTo(arrowX,arrowY);ctx.lineTo(toX,toY);arrowX=toX+botX;arrowY=toY+botY;ctx.lineTo(arrowX,arrowY);ctx.fillStyle=color;ctx.fill();ctx.restore();}var commentBoxProps={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:false,moveXY:null,cursorStartPosition:null};function getCellTopRightPostion(ctx,flowdata,r,c){var row_pre=r-1===-1?0:ctx.visibledatarow[r-1];var col=ctx.visibledatacolumn[c];var margeset=mergeBorder(ctx,flowdata,r,c);if(margeset){var _margeset$row=_slicedToArray$3(margeset.row,1);row_pre=_margeset$row[0];var _margeset$column=_slicedToArray$3(margeset.column,2);col=_margeset$column[1];}var toX=col;var toY=row_pre;return {toX:toX,toY:toY};}function getCommentBoxByRC(ctx,flowdata,r,c){var _flowdata$r$c;var comment=(_flowdata$r$c=flowdata[r][c])===null||_flowdata$r$c===void 0?void 0:_flowdata$r$c.ps;var _getCellTopRightPosti=getCellTopRightPostion(ctx,flowdata,r,c),toX=_getCellTopRightPosti.toX,toY=_getCellTopRightPosti.toY;var left=(comment===null||comment===void 0?void 0:comment.left)==null?toX+18*ctx.zoomRatio:comment.left*ctx.zoomRatio;var top=(comment===null||comment===void 0?void 0:comment.top)==null?toY-18*ctx.zoomRatio:comment.top*ctx.zoomRatio;var width=(comment===null||comment===void 0?void 0:comment.width)==null?commentBoxProps.defaultWidth*ctx.zoomRatio:comment.width*ctx.zoomRatio;var height=(comment===null||comment===void 0?void 0:comment.height)==null?commentBoxProps.defaultHeight*ctx.zoomRatio:comment.height*ctx.zoomRatio;var value=(comment===null||comment===void 0?void 0:comment.value)==null?"":comment.value;if(top<0){top=2;}var size=getArrowCanvasSize(left,top,toX,toY);var rc="".concat(r,"_").concat(c);return {r:r,c:c,rc:rc,left:left,top:top,width:width,height:height,value:value,size:size,autoFocus:false};}function setEditingComment(ctx,flowdata,r,c){ctx.editingCommentBox=getCommentBoxByRC(ctx,flowdata,r,c);}function removeEditingComment(ctx,globalCache){var _ctx$hooks$beforeUpda,_ctx$hooks;var editingCommentBoxEle=globalCache.editingCommentBoxEle;ctx.editingCommentBox=undefined;var r=editingCommentBoxEle===null||editingCommentBoxEle===void 0?void 0:editingCommentBoxEle.dataset.r;var c=editingCommentBoxEle===null||editingCommentBoxEle===void 0?void 0:editingCommentBoxEle.dataset.c;if(!r||!c||!editingCommentBoxEle)return;r=parseInt(r,10);c=parseInt(c,10);var value=editingCommentBoxEle.innerHTML||"";var flowdata=getFlowdata(ctx);globalCache.editingCommentBoxEle=undefined;if(!flowdata)return;if(((_ctx$hooks$beforeUpda=(_ctx$hooks=ctx.hooks).beforeUpdateComment)===null||_ctx$hooks$beforeUpda===void 0?void 0:_ctx$hooks$beforeUpda.call(_ctx$hooks,r,c,value))===false){return;}var cell=flowdata===null||flowdata===void 0?void 0:flowdata[r][c];if(!(cell===null||cell===void 0?void 0:cell.ps))return;var oldValue=cell.ps.value;cell.ps.value=value;if(!cell.ps.isShow){ctx.commentBoxes=lodash.filter(ctx.commentBoxes,function(v){return v.rc!=="".concat(r,"_").concat(c);});}if(ctx.hooks.afterUpdateComment){setTimeout(function(){var _ctx$hooks$afterUpdat,_ctx$hooks2;(_ctx$hooks$afterUpdat=(_ctx$hooks2=ctx.hooks).afterUpdateComment)===null||_ctx$hooks$afterUpdat===void 0?void 0:_ctx$hooks$afterUpdat.call(_ctx$hooks2,r,c,oldValue,value);});}}function newComment(ctx,globalCache,r,c){var _ctx$hooks$beforeInse,_ctx$hooks3;if(((_ctx$hooks$beforeInse=(_ctx$hooks3=ctx.hooks).beforeInsertComment)===null||_ctx$hooks$beforeInse===void 0?void 0:_ctx$hooks$beforeInse.call(_ctx$hooks3,r,c))===false){return;}removeEditingComment(ctx,globalCache);var flowdata=getFlowdata(ctx);if(!flowdata)return;var cell=flowdata[r][c];if(cell==null){cell={};flowdata[r][c]=cell;}cell.ps={left:null,top:null,width:null,height:null,value:"",isShow:false};ctx.editingCommentBox=_objectSpread2$1(_objectSpread2$1({},getCommentBoxByRC(ctx,flowdata,r,c)),{},{autoFocus:true});if(ctx.hooks.afterInsertComment){setTimeout(function(){var _ctx$hooks$afterInser,_ctx$hooks4;(_ctx$hooks$afterInser=(_ctx$hooks4=ctx.hooks).afterInsertComment)===null||_ctx$hooks$afterInser===void 0?void 0:_ctx$hooks$afterInser.call(_ctx$hooks4,r,c);});}}function editComment(ctx,globalCache,r,c){var _flowdata$r$c2;var flowdata=getFlowdata(ctx);removeEditingComment(ctx,globalCache);var comment=flowdata===null||flowdata===void 0?void 0:(_flowdata$r$c2=flowdata[r][c])===null||_flowdata$r$c2===void 0?void 0:_flowdata$r$c2.ps;var commentBoxes=lodash.concat(ctx.commentBoxes,ctx.editingCommentBox);if(lodash.findIndex(commentBoxes,function(v){return (v===null||v===void 0?void 0:v.rc)==="".concat(r,"_").concat(c);})!==-1){var editCommentBox=document.getElementById("comment-editor-".concat(r,"_").concat(c));editCommentBox===null||editCommentBox===void 0?void 0:editCommentBox.focus();}if(comment){ctx.editingCommentBox=_objectSpread2$1(_objectSpread2$1({},getCommentBoxByRC(ctx,flowdata,r,c)),{},{autoFocus:true});}}function deleteComment(ctx,globalCache,r,c){var _ctx$hooks$beforeDele,_ctx$hooks5;if(((_ctx$hooks$beforeDele=(_ctx$hooks5=ctx.hooks).beforeDeleteComment)===null||_ctx$hooks$beforeDele===void 0?void 0:_ctx$hooks$beforeDele.call(_ctx$hooks5,r,c))===false){return;}var flowdata=getFlowdata(ctx);if(!flowdata)return;var cell=flowdata[r][c];if(!cell)return;cell.ps=undefined;if(ctx.hooks.afterDeleteComment){setTimeout(function(){var _ctx$hooks$afterDelet,_ctx$hooks6;(_ctx$hooks$afterDelet=(_ctx$hooks6=ctx.hooks).afterDeleteComment)===null||_ctx$hooks$afterDelet===void 0?void 0:_ctx$hooks$afterDelet.call(_ctx$hooks6,r,c);});}}function showComments(ctx,commentShowCells){var flowdata=getFlowdata(ctx);if(flowdata){var commentBoxes=commentShowCells.map(function(_ref2){var r=_ref2.r,c=_ref2.c;return getCommentBoxByRC(ctx,flowdata,r,c);});ctx.commentBoxes=commentBoxes;}}function showHideComment(ctx,globalCache,r,c){var _flowdata$r$c3;var flowdata=getFlowdata(ctx);var comment=flowdata===null||flowdata===void 0?void 0:(_flowdata$r$c3=flowdata[r][c])===null||_flowdata$r$c3===void 0?void 0:_flowdata$r$c3.ps;if(!comment)return;var isShow=comment.isShow;var rc="".concat(r,"_").concat(c);if(isShow){comment.isShow=false;ctx.commentBoxes=lodash.filter(ctx.commentBoxes,function(v){return v.rc!==rc;});}else {comment.isShow=true;}}function showHideAllComments(ctx){var flowdata=getFlowdata(ctx);if(!flowdata)return;var isAllShow=true;var allComments=[];for(var r=0;r<flowdata.length;r+=1){for(var c=0;c<flowdata[0].length;c+=1){var cell=flowdata[r][c];if(cell===null||cell===void 0?void 0:cell.ps){allComments.push({r:r,c:c});if(!cell.ps.isShow){isAllShow=false;}}}}if(allComments.length>0){if(isAllShow){for(var i=0;i<allComments.length;i+=1){var _flowdata$_r$_c;var _allComments$i=allComments[i],_r=_allComments$i.r,_c=_allComments$i.c;var comment=(_flowdata$_r$_c=flowdata[_r][_c])===null||_flowdata$_r$_c===void 0?void 0:_flowdata$_r$_c.ps;if(comment===null||comment===void 0?void 0:comment.isShow){comment.isShow=false;}}ctx.commentBoxes=[];}else {for(var _i=0;_i<allComments.length;_i+=1){var _flowdata$_r2$_c;var _allComments$_i=allComments[_i],_r2=_allComments$_i.r,_c2=_allComments$_i.c;var _comment=(_flowdata$_r2$_c=flowdata[_r2][_c2])===null||_flowdata$_r2$_c===void 0?void 0:_flowdata$_r2$_c.ps;if(_comment&&!_comment.isShow){_comment.isShow=true;}}}}}function overShowComment(ctx,e,scrollX,scrollY,container){var _flowdata$r,_flowdata$r$c4,_ctx$editingCommentBo,_ctx$hoveredCommentBo;var flowdata=getFlowdata(ctx);if(!flowdata)return;var scrollLeft=scrollX.scrollLeft;var scrollTop=scrollY.scrollTop;var rect=container.getBoundingClientRect();var x=e.pageX-rect.left-ctx.rowHeaderWidth;var y=e.pageY-rect.top-ctx.columnHeaderHeight;var offsetX=0;var offsetY=0;x+=scrollLeft;y+=scrollTop;var r=rowLocation(y,ctx.visibledatarow)[2];var c=colLocation(x,ctx.visibledatacolumn)[2];var margeset=mergeBorder(ctx,flowdata,r,c);if(margeset){var _margeset$row2=_slicedToArray$3(margeset.row,3);r=_margeset$row2[2];var _margeset$column2=_slicedToArray$3(margeset.column,3);c=_margeset$column2[2];}var rc="".concat(r,"_").concat(c);var comment=(_flowdata$r=flowdata[r])===null||_flowdata$r===void 0?void 0:(_flowdata$r$c4=_flowdata$r[c])===null||_flowdata$r$c4===void 0?void 0:_flowdata$r$c4.ps;if(comment==null||comment.isShow||lodash.findIndex(ctx.commentBoxes,function(v){return v.rc===rc;})!==-1||((_ctx$editingCommentBo=ctx.editingCommentBox)===null||_ctx$editingCommentBo===void 0?void 0:_ctx$editingCommentBo.rc)===rc){ctx.hoveredCommentBox=undefined;return;}if(((_ctx$hoveredCommentBo=ctx.hoveredCommentBox)===null||_ctx$hoveredCommentBo===void 0?void 0:_ctx$hoveredCommentBo.rc)===rc)return;var row_pre=r-1===-1?0:ctx.visibledatarow[r-1];var col=ctx.visibledatacolumn[c];if(margeset){var _margeset$row3=_slicedToArray$3(margeset.row,1);row_pre=_margeset$row3[0];var _margeset$column3=_slicedToArray$3(margeset.column,2);col=_margeset$column3[1];}var toX=col+offsetX;var toY=row_pre+offsetY;var left=comment.left==null?toX+18*ctx.zoomRatio:comment.left*ctx.zoomRatio;var top=comment.top==null?toY-18*ctx.zoomRatio:comment.top*ctx.zoomRatio;if(top<0){top=2;}var width=comment.width==null?commentBoxProps.defaultWidth*ctx.zoomRatio:comment.width*ctx.zoomRatio;var height=comment.height==null?commentBoxProps.defaultHeight*ctx.zoomRatio:comment.height*ctx.zoomRatio;var size=getArrowCanvasSize(left,top,toX,toY);var value=comment.value==null?"":comment.value;ctx.hoveredCommentBox={r:r,c:c,rc:rc,left:left,top:top,width:width,height:height,size:size,value:value,autoFocus:false};}function getCommentBoxPosition(ctx,commentId,container){var box=document.getElementById(commentId);if(!box)return undefined;var _box$getBoundingClien=box.getBoundingClientRect(),top=_box$getBoundingClien.top,left=_box$getBoundingClien.left,width=_box$getBoundingClien.width,height=_box$getBoundingClien.height;var rect=container.getBoundingClientRect();left-=ctx.rowHeaderWidth+rect.left;top-=ctx.columnHeaderHeight+rect.top;return {left:left,top:top,width:width,height:height};}function onCommentBoxResizeStart(ctx,globalCache,e,container,_ref3,resizingId,resizingSide){var r=_ref3.r,c=_ref3.c,rc=_ref3.rc;var position=getCommentBoxPosition(ctx,resizingId,container);if(position){lodash.set(globalCache,"commentBox",{cursorMoveStartPosition:{x:e.pageX,y:e.pageY},resizingId:resizingId,resizingSide:resizingSide,commentRC:{r:r,c:c,rc:rc},boxInitialPosition:position});}}function onCommentBoxResize(ctx,globalCache,e){var commentBox=globalCache===null||globalCache===void 0?void 0:globalCache.commentBox;if((commentBox===null||commentBox===void 0?void 0:commentBox.resizingId)&&commentBox.resizingSide){var box=document.getElementById(commentBox.resizingId);var _commentBox$cursorMov=commentBox.cursorMoveStartPosition,startX=_commentBox$cursorMov.x,startY=_commentBox$cursorMov.y;var _commentBox$boxInitia=commentBox.boxInitialPosition,top=_commentBox$boxInitia.top,left=_commentBox$boxInitia.left,width=_commentBox$boxInitia.width,height=_commentBox$boxInitia.height;var dx=e.pageX-startX;var dy=e.pageY-startY;var minHeight=60*ctx.zoomRatio;var minWidth=1.5*60*ctx.zoomRatio;if(["lm","lt","lb"].includes(commentBox.resizingSide)){if(width-dx<minWidth){left+=width-minWidth;width=minWidth;}else {left+=dx;width-=dx;}if(left<0)left=0;box.style.left="".concat(left,"px");}if(["rm","rt","rb"].includes(commentBox.resizingSide)){width=width+dx<minWidth?minWidth:width+dx;}if(["mt","lt","rt"].includes(commentBox.resizingSide)){if(height-dy<minHeight){top+=height-minHeight;height=minHeight;}else {top+=dy;height-=dy;}if(top<0)top=0;box.style.top="".concat(top,"px");}if(["mb","lb","rb"].includes(commentBox.resizingSide)){height=height+dy<minHeight?minHeight:height+dy;}box.style.width="".concat(width,"px");box.style.height="".concat(height,"px");return true;}return false;}function onCommentBoxResizeEnd(ctx,globalCache,container){var _globalCache$commentB;if((_globalCache$commentB=globalCache.commentBox)===null||_globalCache$commentB===void 0?void 0:_globalCache$commentB.resizingId){var _globalCache$commentB2=globalCache.commentBox,resizingId=_globalCache$commentB2.resizingId,_globalCache$commentB3=_globalCache$commentB2.commentRC,r=_globalCache$commentB3.r,c=_globalCache$commentB3.c;globalCache.commentBox.resizingId=undefined;var position=getCommentBoxPosition(ctx,resizingId,container);if(position){var top=position.top,left=position.left,width=position.width,height=position.height;var flowdata=getFlowdata(ctx);var cell=flowdata===null||flowdata===void 0?void 0:flowdata[r][c];if(!flowdata||!(cell===null||cell===void 0?void 0:cell.ps))return;cell.ps.left=left/ctx.zoomRatio;cell.ps.top=top/ctx.zoomRatio;cell.ps.width=width/ctx.zoomRatio;cell.ps.height=height/ctx.zoomRatio;setEditingComment(ctx,flowdata,r,c);}}}function onCommentBoxMoveStart(ctx,globalCache,e,container,_ref4,movingId){var r=_ref4.r,c=_ref4.c,rc=_ref4.rc;var position=getCommentBoxPosition(ctx,movingId,container);if(position){var top=position.top,left=position.left;lodash.set(globalCache,"commentBox",{cursorMoveStartPosition:{x:e.pageX,y:e.pageY},movingId:movingId,commentRC:{r:r,c:c,rc:rc},boxInitialPosition:{left:left,top:top}});}}function onCommentBoxMove(ctx,globalCache,e){var commentBox=globalCache===null||globalCache===void 0?void 0:globalCache.commentBox;if(commentBox===null||commentBox===void 0?void 0:commentBox.movingId){var box=document.getElementById(commentBox.movingId);var _commentBox$cursorMov2=commentBox.cursorMoveStartPosition,startX=_commentBox$cursorMov2.x,startY=_commentBox$cursorMov2.y;var _commentBox$boxInitia2=commentBox.boxInitialPosition,top=_commentBox$boxInitia2.top,left=_commentBox$boxInitia2.left;left+=e.pageX-startX;top+=e.pageY-startY;if(top<0)top=0;box.style.left="".concat(left,"px");box.style.top="".concat(top,"px");return true;}return false;}function onCommentBoxMoveEnd(ctx,globalCache,container){var _globalCache$commentB4;if((_globalCache$commentB4=globalCache.commentBox)===null||_globalCache$commentB4===void 0?void 0:_globalCache$commentB4.movingId){var _globalCache$commentB5=globalCache.commentBox,movingId=_globalCache$commentB5.movingId,_globalCache$commentB6=_globalCache$commentB5.commentRC,r=_globalCache$commentB6.r,c=_globalCache$commentB6.c;globalCache.commentBox.movingId=undefined;var position=getCommentBoxPosition(ctx,movingId,container);if(position){var top=position.top,left=position.left;var flowdata=getFlowdata(ctx);var cell=flowdata===null||flowdata===void 0?void 0:flowdata[r][c];if(!flowdata||!(cell===null||cell===void 0?void 0:cell.ps))return;cell.ps.left=left/ctx.zoomRatio;cell.ps.top=top/ctx.zoomRatio;setEditingComment(ctx,flowdata,r,c);}}}function generateRandomId(prefix){if(prefix==null){prefix="img";}var userAgent=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split("");var mid="";for(var i=0;i<12;i+=1){mid+=userAgent[Math.round(Math.random()*(userAgent.length-1))];}var time=new Date().getTime();return "".concat(prefix,"_").concat(mid,"_").concat(time);}function showImgChooser(){var chooser=document.getElementById("fortune-img-upload");if(chooser)chooser.click();}function saveImage(ctx){var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;var file=ctx.luckysheetfile[index];file.images=ctx.insertedImgs;}function removeActiveImage(ctx){ctx.insertedImgs=lodash.filter(ctx.insertedImgs,function(image){var _ctx$activeImg;return image.id!==((_ctx$activeImg=ctx.activeImg)===null||_ctx$activeImg===void 0?void 0:_ctx$activeImg.id);});ctx.activeImg=undefined;saveImage(ctx);}function insertImage(ctx,image){try{var _ctx$luckysheet_selec;var last=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[ctx.luckysheet_select_save.length-1];var rowIndex=last===null||last===void 0?void 0:last.row_focus;var colIndex=last===null||last===void 0?void 0:last.column_focus;if(!last){rowIndex=0;colIndex=0;}else {if(rowIndex==null){var _last$row=_slicedToArray$3(last.row,1);rowIndex=_last$row[0];}if(colIndex==null){var _last$column=_slicedToArray$3(last.column,1);colIndex=_last$column[0];}}var flowdata=getFlowdata(ctx);var left=colIndex===0?0:ctx.visibledatacolumn[colIndex-1];var top=rowIndex===0?0:ctx.visibledatarow[rowIndex-1];if(flowdata){var margeset=mergeBorder(ctx,flowdata,rowIndex,colIndex);if(margeset){var _margeset$row=_slicedToArray$3(margeset.row,1);top=_margeset$row[0];var _margeset$column=_slicedToArray$3(margeset.column,1);left=_margeset$column[0];}}var width=image.width;var height=image.height;var img={id:generateRandomId("img"),src:image.src,left:left,top:top,width:width*0.5,height:height*0.5,originWidth:width,originHeight:height};ctx.insertedImgs=(ctx.insertedImgs||[]).concat(img);saveImage(ctx);}catch(err){console.info(err);}}function getImagePosition(ctx,container){var box=document.getElementById("luckysheet-modal-dialog-activeImage");if(!box)return undefined;var _box$getBoundingClien=box.getBoundingClientRect(),top=_box$getBoundingClien.top,left=_box$getBoundingClien.left,width=_box$getBoundingClien.width,height=_box$getBoundingClien.height;var rect=container.getBoundingClientRect();left-=ctx.rowHeaderWidth+rect.left;top-=ctx.columnHeaderHeight+rect.top;return {left:left,top:top,width:width,height:height};}function cancelActiveImgItem(ctx,globalCache){ctx.activeImg=undefined;globalCache.image=undefined;}function onImageMoveStart(ctx,globalCache,e,container){var position=getImagePosition(ctx,container);if(position){var top=position.top,left=position.left;lodash.set(globalCache,"image",{cursorMoveStartPosition:{x:e.pageX,y:e.pageY},imgInitialPosition:{left:left,top:top}});}}function onImageMove(ctx,globalCache,e){var image=globalCache===null||globalCache===void 0?void 0:globalCache.image;var img=document.getElementById("luckysheet-modal-dialog-activeImage");if(img&&image&&!image.resizingSide){var _image$cursorMoveStar=image.cursorMoveStartPosition,startX=_image$cursorMoveStar.x,startY=_image$cursorMoveStar.y;var _image$imgInitialPosi=image.imgInitialPosition,top=_image$imgInitialPosi.top,left=_image$imgInitialPosi.left;left+=e.pageX-startX;top+=e.pageY-startY;if(top<0)top=0;img.style.left="".concat(left,"px");img.style.top="".concat(top,"px");return true;}return false;}function onImageMoveEnd(ctx,globalCache,container){var _globalCache$image;var position=getImagePosition(ctx,container);if(!((_globalCache$image=globalCache.image)===null||_globalCache$image===void 0?void 0:_globalCache$image.resizingSide)){globalCache.image=undefined;if(position){var img=lodash.find(ctx.insertedImgs,function(v){var _ctx$activeImg2;return v.id===((_ctx$activeImg2=ctx.activeImg)===null||_ctx$activeImg2===void 0?void 0:_ctx$activeImg2.id);});if(img){img.left=position.left;img.top=position.top;saveImage(ctx);}}}}function onImageResizeStart(ctx,globalCache,e,container,resizingSide){var position=getImagePosition(ctx,container);if(position){lodash.set(globalCache,"image",{cursorMoveStartPosition:{x:e.pageX,y:e.pageY},resizingSide:resizingSide,imgInitialPosition:position});}}function onImageResize(ctx,globalCache,e){var image=globalCache===null||globalCache===void 0?void 0:globalCache.image;if(image===null||image===void 0?void 0:image.resizingSide){var imgContainer=document.getElementById("luckysheet-modal-dialog-activeImage");var img=imgContainer===null||imgContainer===void 0?void 0:imgContainer.querySelector(".luckysheet-modal-dialog-content");if(img==null)return false;var _image$cursorMoveStar2=image.cursorMoveStartPosition,startX=_image$cursorMoveStar2.x,startY=_image$cursorMoveStar2.y;var _image$imgInitialPosi2=image.imgInitialPosition,top=_image$imgInitialPosi2.top,left=_image$imgInitialPosi2.left,width=_image$imgInitialPosi2.width,height=_image$imgInitialPosi2.height;var dx=e.pageX-startX;var dy=e.pageY-startY;var minHeight=60*ctx.zoomRatio;var minWidth=1.5*60*ctx.zoomRatio;if(["lm","lt","lb"].includes(image.resizingSide)){if(width-dx<minWidth){left+=width-minWidth;width=minWidth;}else {left+=dx;width-=dx;}if(left<0)left=0;img.style.left="".concat(left,"px");imgContainer.style.left="".concat(left,"px");}if(["rm","rt","rb"].includes(image.resizingSide)){width=width+dx<minWidth?minWidth:width+dx;}if(["mt","lt","rt"].includes(image.resizingSide)){if(height-dy<minHeight){top+=height-minHeight;height=minHeight;}else {top+=dy;height-=dy;}if(top<0)top=0;img.style.top="".concat(top,"px");imgContainer.style.top="".concat(top,"px");}if(["mb","lb","rb"].includes(image.resizingSide)){height=height+dy<minHeight?minHeight:height+dy;}img.style.width="".concat(width,"px");imgContainer.style.width="".concat(width,"px");img.style.height="".concat(height,"px");imgContainer.style.height="".concat(height,"px");img.style.backgroundSize="".concat(width,"px ").concat(height,"px");return true;}return false;}function onImageResizeEnd(ctx,globalCache,container){var _globalCache$image2;if((_globalCache$image2=globalCache.image)===null||_globalCache$image2===void 0?void 0:_globalCache$image2.resizingSide){globalCache.image=undefined;var position=getImagePosition(ctx,container);if(position){var img=lodash.find(ctx.insertedImgs,function(v){var _ctx$activeImg3;return v.id===((_ctx$activeImg3=ctx.activeImg)===null||_ctx$activeImg3===void 0?void 0:_ctx$activeImg3.id);});if(img){img.left=position.left;img.top=position.top;img.width=position.width;img.height=position.height;saveImage(ctx);}}}}function handleOverlayTouchStart(ctx,e,globalCache){globalCache.touchMoveStatus=true;var touch=e.targetTouches[0];globalCache.touchMoveStartPos={x:touch.pageX,y:touch.pageY,vy:0,moveType:"y"};}function handleOverlayTouchMove(ctx,e,globalCache,scrollbarX,scrollbarY){if(e.targetTouches.length>1)return;var touch=e.targetTouches[0];if(globalCache.touchMoveStatus){if(!globalCache.touchMoveStartPos)return;var slideX=touch.pageX-globalCache.touchMoveStartPos.x;var slideY=touch.pageY-globalCache.touchMoveStartPos.y;var scrollLeft=ctx.scrollLeft;var scrollTop=ctx.scrollTop;scrollLeft-=slideX;scrollTop-=slideY;scrollbarY.scrollTop=scrollTop;globalCache.touchMoveStartPos.vy_y=slideY;globalCache.touchMoveStartPos.scrollTop=scrollTop;scrollbarX.scrollLeft=scrollLeft;globalCache.touchMoveStartPos.vy_x=slideX;globalCache.touchMoveStartPos.scrollLeft=scrollLeft;}}function handleOverlayTouchEnd(globalCache){globalCache.touchMoveStatus=false;globalCache.touchHandleStatus=false;}function toPx(v){return "".concat(v,"px");}var dropCellCache={copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{:0,:1,:2,:3,:4,:5,:6,:7,:8,:9},chnNameValue:{:{value:10,secUnit:false},:{value:100,secUnit:false},:{value:1000,secUnit:false},:{value:10000,secUnit:true},:{value:100000000,secUnit:true}},chnNumChar2:["","","","","","","","","",""],chnUnitSection:["","","","",""],chnUnitChar:["","","",""]};function chineseToNumber(chnStr){var rtn=0;var section=0;var number=0;var secUnit=false;var str=chnStr.split("");for(var i=0;i<str.length;i+=1){var num=dropCellCache.chnNumChar[str[i]];if(typeof num!=="undefined"){number=num;if(i===str.length-1){section+=number;}}else {var unit=dropCellCache.chnNameValue[str[i]].value;secUnit=dropCellCache.chnNameValue[str[i]].secUnit;if(secUnit){section=(section+number)*unit;rtn+=section;section=0;}else {section+=number*unit;}number=0;}}return rtn+section;}function sectionToChinese(section){var strIns="";var chnStr="";var unitPos=0;var zero=true;while(section>0){var v=section%10;if(v===0){if(!zero){zero=true;chnStr=dropCellCache.chnNumChar2[v]+chnStr;}}else {zero=false;strIns=dropCellCache.chnNumChar2[v];strIns+=dropCellCache.chnUnitChar[unitPos];chnStr=strIns+chnStr;}unitPos+=1;section=Math.floor(section/10);}return chnStr;}function numberToChinese(num){var strIns="";var chnStr="";var unitPos=0;var needZero=false;if(num===0){return dropCellCache.chnNumChar2[0];}while(num>0){var section=num%10000;if(needZero){chnStr=dropCellCache.chnNumChar2[0]+chnStr;}strIns=sectionToChinese(section);strIns+=section!==0?dropCellCache.chnUnitSection[unitPos]:dropCellCache.chnUnitSection[0];chnStr=strIns+chnStr;needZero=section<1000&&section>0;num=Math.floor(num/10000);unitPos+=1;}return chnStr;}function isChnNumber(txt){if(typeof txt==="number"){txt="".concat(txt);}var result=true;if(txt==null){result=false;}else if(txt.length===1){if(txt===""||txt in dropCellCache.chnNumChar){result=true;}else {result=false;}}else {var str=txt.split("");for(var i=0;i<str.length;i+=1){if(!(str[i]in dropCellCache.chnNumChar||str[i]in dropCellCache.chnNameValue)){result=false;break;}}}return result;}function isExtendNumber(txt){if(txt==null)return [false];if(typeof txt==="number"){txt="".concat(txt);}var reg=/0|([1-9]+[0-9]*)/g;var result=reg.test(txt);if(result){var match=txt.match(reg);if(match){var matchTxt=match[match.length-1];var matchIndex=txt.lastIndexOf(matchTxt);var beforeTxt=txt.slice(0,matchIndex);var afterTxt=txt.slice(matchIndex+matchTxt.length);return [result,Number(matchTxt),beforeTxt,afterTxt];}}return [result];}function isChnWeek2(txt){var result=false;if(typeof txt==="number"){txt="".concat(txt);}if(txt!==undefined&&txt.length===2){if(txt===""||txt===""||txt===""||txt===""||txt===""||txt===""||txt===""){result=true;}}return result;}function isChnWeek3(txt){if(typeof txt==="number"){txt="".concat(txt);}var result=false;if(txt!==undefined&&txt.length===3){if(txt===""||txt===""||txt===""||txt===""||txt===""||txt===""||txt===""){result=true;}}return result;}function isEqualDiff(arr){var diff=true;var step=arr[1]-arr[0];for(var i=1;i<arr.length;i+=1){if(arr[i]-arr[i-1]!==step){diff=false;break;}}return diff;}function isEqualRatio(arr){var ratio=true;var step=arr[1]/arr[0];for(var i=1;i<arr.length;i+=1){if(arr[i]/arr[i-1]!==step){ratio=false;break;}}return ratio;}function getXArr(len){var xArr=[];for(var i=1;i<=len;i+=1){xArr.push(i);}return xArr;}function forecast(x,yArr,xArr){function getAverage(arr){var sum=0;for(var i=0;i<arr.length;i+=1){sum+=arr[i];}return sum/arr.length;}var ax=getAverage(xArr);var ay=getAverage(yArr);var sum_d=0;var sum_n=0;for(var j=0;j<xArr.length;j+=1){sum_d+=(xArr[j]-ax)*(yArr[j]-ay);sum_n+=(xArr[j]-ax)*(xArr[j]-ax);}var b;if(sum_n===0){b=1;}else {b=sum_d/sum_n;}var a=ay-b*ax;return Math.round((a+b*x)*100000)/100000;}function judgeDate(data){var isSameDay=true;var isSameMonth=true;var isEqualDiffDays=true;var isEqualDiffMonths=true;var isEqualDiffYears=true;if(data[0]==null||data[1]==null)return [false,false,false,false,false];var sameDay=dayjs_min(data[0].m).date();var sameMonth=dayjs_min(data[0].m).month();var equalDiffDays=dayjs_min(data[1].m).diff(dayjs_min(data[0].m),"days");var equalDiffMonths=dayjs_min(data[1].m).diff(dayjs_min(data[0].m),"months");var equalDiffYears=dayjs_min(data[1].m).diff(dayjs_min(data[0].m),"years");for(var i=1;i<data.length;i+=1){var _data$i,_data$i2,_data$i3,_data,_data$i4,_data2,_data$i5,_data3;if(dayjs_min((_data$i=data[i])===null||_data$i===void 0?void 0:_data$i.m).date()!==sameDay){isSameDay=false;}if(dayjs_min((_data$i2=data[i])===null||_data$i2===void 0?void 0:_data$i2.m).month()!==sameMonth){isSameMonth=false;}if(dayjs_min((_data$i3=data[i])===null||_data$i3===void 0?void 0:_data$i3.m).diff(dayjs_min((_data=data[i-1])===null||_data===void 0?void 0:_data.m),"days")!==equalDiffDays){isEqualDiffDays=false;}if(dayjs_min((_data$i4=data[i])===null||_data$i4===void 0?void 0:_data$i4.m).diff(dayjs_min((_data2=data[i-1])===null||_data2===void 0?void 0:_data2.m),"months")!==equalDiffMonths){isEqualDiffMonths=false;}if(dayjs_min((_data$i5=data[i])===null||_data$i5===void 0?void 0:_data$i5.m).diff(dayjs_min((_data3=data[i-1])===null||_data3===void 0?void 0:_data3.m),"years")!==equalDiffYears){isEqualDiffYears=false;}}if(equalDiffDays===0){isEqualDiffDays=false;}if(equalDiffMonths===0){isEqualDiffMonths=false;}if(equalDiffYears===0){isEqualDiffYears=false;}return [isSameDay,isSameMonth,isEqualDiffDays,isEqualDiffMonths,isEqualDiffYears];}function showDropCellSelection(_ref,container){var width=_ref.width,height=_ref.height,top=_ref.top,left=_ref.left;var selectedExtend=container.querySelector(".fortune-cell-selected-extend");if(selectedExtend){selectedExtend.style.left=toPx(left);selectedExtend.style.width=toPx(width);selectedExtend.style.top=toPx(top);selectedExtend.style.height=toPx(height);selectedExtend.style.display="block";}}function hideDropCellSelection(container){var selectedExtend=container.querySelector(".fortune-cell-selected-extend");if(selectedExtend){selectedExtend.style.display="none";}}function createDropCellRange(ctx,e,container){ctx.luckysheet_cell_selected_extend=true;ctx.luckysheet_scroll_status=true;var scrollLeft=ctx.scrollLeft,scrollTop=ctx.scrollTop;var rect=container.getBoundingClientRect();var x=e.pageX-rect.left-ctx.rowHeaderWidth+scrollLeft;var y=e.pageY-rect.top-ctx.columnHeaderHeight+scrollTop;var row_location=rowLocation(y,ctx.visibledatarow);var row_pre=row_location[0];var row=row_location[1];var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col_pre=col_location[0];var col=col_location[1];var col_index=col_location[2];ctx.luckysheet_cell_selected_extend_index=[row_index,col_index];showDropCellSelection({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1},container);}function onDropCellSelect(ctx,e,scrollX,scrollY,container){var scrollLeft=scrollX.scrollLeft;var scrollTop=scrollY.scrollTop;var rect=container.getBoundingClientRect();var x=e.pageX-rect.left-ctx.rowHeaderWidth+scrollLeft;var y=e.pageY-rect.top-ctx.columnHeaderHeight+scrollTop;var winH=rect.height-20*ctx.zoomRatio;var winW=rect.width-60*ctx.zoomRatio;var row_location=rowLocation(y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];var row_index_original=ctx.luckysheet_cell_selected_extend_index[0];var col_index_original=ctx.luckysheet_cell_selected_extend_index[1];if(!ctx.luckysheet_select_save)return;var row_s=ctx.luckysheet_select_save[0].row[0];var row_e=ctx.luckysheet_select_save[0].row[1];var col_s=ctx.luckysheet_select_save[0].column[0];var col_e=ctx.luckysheet_select_save[0].column[1];if(row_s<0||y<0){row_s=0;row_e=ctx.luckysheet_select_save[0].row[1]-ctx.luckysheet_select_save[0].row[0];}if(col_s<0||x<0){col_s=0;col_e=ctx.luckysheet_select_save[0].column[1]-ctx.luckysheet_select_save[0].column[0];}if(row_e>=ctx.visibledatarow[ctx.visibledatarow.length-1]||y>winH){row_s=ctx.visibledatarow.length-1-ctx.luckysheet_select_save[0].row[1]+ctx.luckysheet_select_save[0].row[0];row_e=ctx.visibledatarow.length-1;}if(col_e>=ctx.visibledatacolumn[ctx.visibledatacolumn.length-1]||x>winW){col_s=ctx.visibledatacolumn.length-1-ctx.luckysheet_select_save[0].column[1]+ctx.luckysheet_select_save[0].column[0];col_e=ctx.visibledatacolumn.length-1;}var top=ctx.luckysheet_select_save[0].top_move;var height=ctx.luckysheet_select_save[0].height_move;var left=ctx.luckysheet_select_save[0].left_move;var width=ctx.luckysheet_select_save[0].width_move;if(top==null||height==null||left==null||width==null)return;if(Math.abs(row_index_original-row_index)>Math.abs(col_index_original-col_index)){if(!(row_index>=row_s&&row_index<=row_e)){if(top>=row_pre){height+=top-row_pre;top=row_pre;}else {height=row-top-1;}}}else {if(!(col_index>=col_s&&col_index<=col_e)){if(left>=col_pre){width+=left-col_pre;left=col_pre;}else {width=col-left-1;}}}showDropCellSelection({left:left,width:width,top:top,height:height},container);}function fillCopy(data,len){var applyData=[];for(var i=1;i<=len;i+=1){var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);if(d!=null){applyData.push(d);}}return applyData;}function fillSeries(data,len,direction){var applyData=[];var dataNumArr=[];for(var j=0;j<data.length;j+=1){var d=lodash.cloneDeep(data[j]);if(d!=null){dataNumArr.push(Number(d.v));}}if(data.length>2&&isEqualRatio(dataNumArr)&&data[0]!=null&&data[1]!=null){for(var i=1;i<=len;i+=1){var index=(i-1)%data.length;var _d=lodash.cloneDeep(data[index]);if(_d!=null){var num=void 0;if(direction==="down"||direction==="right"){num=Number(data[data.length-1].v)*Math.pow(Number(data[1].v)/Number(data[0].v),i);}else {num=Number(data[0].v)/Math.pow(Number(data[1].v)/Number(data[0].v),i);}_d.v=num;if(_d.ct!=null&&_d.ct.fa!=null){_d.m=update(_d.ct.fa,num);}applyData.push(_d);}}}else {var xArr=getXArr(data.length);for(var _i=1;_i<=len;_i+=1){var _index=(_i-1)%data.length;var _d2=lodash.cloneDeep(data[_index]);if(_d2!=null){var y=void 0;if(direction==="down"||direction==="right"){y=forecast(data.length+_i,dataNumArr,xArr);}else if(direction==="up"||direction==="left"){y=forecast(1-_i,dataNumArr,xArr);}_d2.v=y;if(_d2.ct!=null&&_d2.ct.fa!=null){_d2.m=update(_d2.ct.fa,y);}applyData.push(_d2);}}}return applyData;}function fillExtendNumber(data,len,step){var applyData=[];var reg=/0|([1-9]+[0-9]*)/g;for(var i=1;i<=len;i+=1){var _data4;var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);var last=(_data4=data[data.length-1])===null||_data4===void 0?void 0:_data4.m;if(d!=null&&last!=null){last="".concat(last);var match=last.match(reg)||"";var lastTxt=match[match.length-1];var num=Math.abs(Number(lastTxt)+step*i);var lastIndex=last.lastIndexOf(lastTxt);var valueTxt=last.slice(0,lastIndex)+num.toString()+last.slice(lastIndex+lastTxt.length);d.v=valueTxt;d.m=valueTxt;applyData.push(d);}}return applyData;}function fillDays(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var d=lodash.cloneDeep(data[data.length-1]);if(d!=null){var _genarate;var date=update("yyyy-MM-dd",d.v);date=dayjs_min(date).add(step*i,"days").format("YYYY-MM-DD");d.v=(_genarate=genarate(date))===null||_genarate===void 0?void 0:_genarate[2];if(d.ct!=null&&d.ct.fa!=null){d.m=update(d.ct.fa,d.v);}applyData.push(d);}}return applyData;}function fillMonths(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var d=lodash.cloneDeep(data[data.length-1]);if(d!=null){var _genarate2;var date=update("yyyy-MM-dd",d.v);date=dayjs_min(date).add(step*i,"months").format("YYYY-MM-DD");d.v=(_genarate2=genarate(date))===null||_genarate2===void 0?void 0:_genarate2[2];if(d.ct!=null&&d.ct.fa!=null){d.m=update(d.ct.fa,d.v);}applyData.push(d);}}return applyData;}function fillYears(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var d=lodash.cloneDeep(data[data.length-1]);if(d!=null){var _genarate3;var date=update("yyyy-MM-dd",d.v);date=dayjs_min(date).add(step*i,"years").format("YYYY-MM-DD");d.v=(_genarate3=genarate(date))===null||_genarate3===void 0?void 0:_genarate3[2];if(d.ct!=null&&d.ct.fa!=null){d.m=update(d.ct.fa,d.v);}}applyData.push(d);}return applyData;}function fillChnWeek(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var _data5;var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);var num=void 0;var m=(_data5=data[data.length-1])===null||_data5===void 0?void 0:_data5.m;if(m!=null&&d!=null){if(m===""){num=7+step*i;}else {num=chineseToNumber("".concat(m))+step*i;}if(num<0){num=Math.ceil(Math.abs(num)/7)*7+num;}var rsd=num%7;if(rsd===0){d.m="";d.v="";}else if(rsd===1){d.m="";d.v="";}else if(rsd===2){d.m="";d.v="";}else if(rsd===3){d.m="";d.v="";}else if(rsd===4){d.m="";d.v="";}else if(rsd===5){d.m="";d.v="";}else if(rsd===6){d.m="";d.v="";}applyData.push(d);}}return applyData;}function fillChnWeek2(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var _data6;var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);var num=void 0;var m=(_data6=data[data.length-1])===null||_data6===void 0?void 0:_data6.m;if(m!=null&&d!=null){if(m===""){num=7+step*i;}else {var last="".concat(m);var txt=last.slice(last.length-1,1);num=chineseToNumber(txt)+step*i;}if(num<0){num=Math.ceil(Math.abs(num)/7)*7+num;}var rsd=num%7;if(rsd===0){d.m="";d.v="";}else if(rsd===1){d.m="";d.v="";}else if(rsd===2){d.m="";d.v="";}else if(rsd===3){d.m="";d.v="";}else if(rsd===4){d.m="";d.v="";}else if(rsd===5){d.m="";d.v="";}else if(rsd===6){d.m="";d.v="";}}applyData.push(d);}return applyData;}function fillChnWeek3(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var _data7;var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);var num=void 0;var m=(_data7=data[data.length-1])===null||_data7===void 0?void 0:_data7.m;if(m!=null&&d!=null){if(m===""){num=7+step*i;}else {var last="".concat(m);var txt=last.slice(last.length-1,1);num=chineseToNumber(txt)+step*i;}if(num<0){num=Math.ceil(Math.abs(num)/7)*7+num;}var rsd=num%7;if(rsd===0){d.m="";d.v="";}else if(rsd===1){d.m="";d.v="";}else if(rsd===2){d.m="";d.v="";}else if(rsd===3){d.m="";d.v="";}else if(rsd===4){d.m="";d.v="";}else if(rsd===5){d.m="";d.v="";}else if(rsd===6){d.m="";d.v="";}}applyData.push(d);}return applyData;}function fillChnNumber(data,len,step){var applyData=[];for(var i=1;i<=len;i+=1){var _data8;var index=(i-1)%data.length;var d=lodash.cloneDeep(data[index]);var m=(_data8=data[data.length-1])===null||_data8===void 0?void 0:_data8.m;if(m!=null&&d!=null){var num=chineseToNumber("".concat(m))+step*i;var txt=void 0;if(num<=0){txt="";}else {txt=numberToChinese(num);}d.v=txt;d.m=txt.toString();applyData.push(d);}}return applyData;}function getTypeItemHide(ctx){var copyRange=dropCellCache.copyRange;var str_r=copyRange.row[0];var end_r=copyRange.row[1];var str_c=copyRange.column[0];var end_c=copyRange.column[1];var hasNumber=false;var hasExtendNumber=false;var hasDate=false;var hasChn=false;var hasChnWeek1=false;var hasChnWeek2=false;var hasChnWeek3=false;var flowdata=getFlowdata(ctx);if(flowdata==null)return [];for(var r=str_r;r<=end_r;r+=1){for(var c=str_c;c<=end_c;c+=1){if(flowdata[r][c]){var cell=flowdata[r][c];if(cell!==null&&cell.v!=null&&cell.f==null){if(cell.ct!=null&&cell.ct.t==="n"){hasNumber=true;}else if(cell.ct!=null&&cell.ct.t==="d"){hasDate=true;}else if(isExtendNumber(cell.m)[0]){hasExtendNumber=true;}else if(isChnNumber(cell.m)&&cell.m!==""){hasChn=true;}else if(cell.m!=null&&cell.m===""){hasChnWeek1=true;}else if(isChnWeek2(cell.m)){hasChnWeek2=true;}else if(isChnWeek3(cell.m)){hasChnWeek3=true;}}}}}return [hasNumber,hasExtendNumber,hasDate,hasChn,hasChnWeek1,hasChnWeek2,hasChnWeek3];}function getLenS(indexArr,rsd){var s=0;for(var j=0;j<indexArr.length;j+=1){if(indexArr[j]<=rsd){s+=1;}else {break;}}return s;}function getDataIndex(csLen,asLen,indexArr){var obj={};var num=Math.floor(asLen/csLen);var rsd=asLen%csLen;var sum=0;if(num>0){for(var i=1;i<=num;i+=1){for(var j=0;j<indexArr.length;j+=1){obj[indexArr[j]+(i-1)*csLen]=sum;sum+=1;}}for(var a=0;a<indexArr.length;a+=1){if(indexArr[a]<=rsd){obj[indexArr[a]+csLen*num]=sum;sum+=1;}else {break;}}}else {for(var _a=0;_a<indexArr.length;_a+=1){if(indexArr[_a]<=rsd){obj[indexArr[_a]]=sum;sum+=1;}else {break;}}}return obj;}function getDataByType(data,len,direction,type,dataType){data=lodash.cloneDeep(data);var applyData=[];if(type==="0"||data.length===1){if(direction==="up"||direction==="left"){data.reverse();}applyData=fillCopy(data,len);}else if(type==="1"){var _data$5;if(dataType==="number"){applyData=fillSeries(data,len,direction);}else if(dataType==="extendNumber"){var dataNumArr=[];for(var i=0;i<data.length;i+=1){var _data$i6;var txt=(_data$i6=data[i])===null||_data$i6===void 0?void 0:_data$i6.m;var _isExtendNumber=isExtendNumber(txt);if(_isExtendNumber[0]){dataNumArr.push(_isExtendNumber[1]);}}if(direction==="up"||direction==="left"){data.reverse();dataNumArr.reverse();}if(isEqualDiff(dataNumArr)){var step=dataNumArr[1]-dataNumArr[0];applyData=fillExtendNumber(data,len,step);}else {applyData=fillCopy(data,len);}}else if(dataType==="date"){if(direction==="up"||direction==="left"){data.reverse();}var _judgeDate=judgeDate(data);if(_judgeDate[0]&&_judgeDate[3]){var _data$,_data$2;var _step=dayjs_min((_data$=data[1])===null||_data$===void 0?void 0:_data$.m).diff(dayjs_min((_data$2=data[0])===null||_data$2===void 0?void 0:_data$2.m),"months");applyData=fillMonths(data,len,_step);}else if(!_judgeDate[0]&&_judgeDate[2]){var _data$3,_data$4;var _step2=dayjs_min((_data$3=data[1])===null||_data$3===void 0?void 0:_data$3.m).diff(dayjs_min((_data$4=data[0])===null||_data$4===void 0?void 0:_data$4.m),"days");applyData=fillDays(data,len,_step2);}else {applyData=fillCopy(data,len);}}else if(dataType==="chnNumber"&&((_data$5=data[0])===null||_data$5===void 0?void 0:_data$5.m)!=null){var hasweek=false;for(var _i2=0;_i2<data.length;_i2+=1){var _data$_i;if(((_data$_i=data[_i2])===null||_data$_i===void 0?void 0:_data$_i.m)===""){hasweek=true;break;}}var _dataNumArr=[];var weekIndex=0;for(var _i3=0;_i3<data.length;_i3+=1){var _data$_i2;var m=(_data$_i2=data[_i3])===null||_data$_i2===void 0?void 0:_data$_i2.m;if(m!=null){m="".concat(m);if(m===""){if(_i3===0){_dataNumArr.push(0);}else {weekIndex+=1;_dataNumArr.push(weekIndex*7);}}else if(hasweek&&chineseToNumber(m)>0&&chineseToNumber(m)<7){_dataNumArr.push(chineseToNumber(m)+weekIndex*7);}else {_dataNumArr.push(chineseToNumber(m));}}}if(direction==="up"||direction==="left"){data.reverse();_dataNumArr.reverse();}if(isEqualDiff(_dataNumArr)){if(hasweek||_dataNumArr[_dataNumArr.length-1]<6&&_dataNumArr[0]>0||_dataNumArr[0]<6&&_dataNumArr[_dataNumArr.length-1]>0){var _step3=_dataNumArr[1]-_dataNumArr[0];applyData=fillChnWeek(data,len,_step3);}else {var _step4=_dataNumArr[1]-_dataNumArr[0];applyData=fillChnNumber(data,len,_step4);}}else {applyData=fillCopy(data,len);}}else if(dataType==="chnWeek2"){var _dataNumArr2=[];var _weekIndex=0;for(var _i4=0;_i4<data.length;_i4+=1){var _data$_i3;var _m=(_data$_i3=data[_i4])===null||_data$_i3===void 0?void 0:_data$_i3.m;if(_m!=null){_m="".concat(_m);var lastTxt=_m.slice(_m.length-1,1);if(_m===""){if(_i4===0){_dataNumArr2.push(0);}else {_weekIndex+=1;_dataNumArr2.push(_weekIndex*7);}}else {_dataNumArr2.push(chineseToNumber(lastTxt)+_weekIndex*7);}}}if(direction==="up"||direction==="left"){data.reverse();_dataNumArr2.reverse();}if(isEqualDiff(_dataNumArr2)){var _step5=_dataNumArr2[1]-_dataNumArr2[0];applyData=fillChnWeek2(data,len,_step5);}else {applyData=fillCopy(data,len);}}else if(dataType==="chnWeek3"){var _dataNumArr3=[];var _weekIndex2=0;for(var _i5=0;_i5<data.length;_i5+=1){var _data$_i4;var _m2=(_data$_i4=data[_i5])===null||_data$_i4===void 0?void 0:_data$_i4.m;if(_m2!=null){_m2="".concat(_m2);var _lastTxt=_m2.slice(_m2.length-1,1);if(_m2===""){if(_i5===0){_dataNumArr3.push(0);}else {_weekIndex2+=1;_dataNumArr3.push(_weekIndex2*7);}}else {_dataNumArr3.push(chineseToNumber(_lastTxt)+_weekIndex2*7);}}}if(direction==="up"||direction==="left"){data.reverse();_dataNumArr3.reverse();}if(isEqualDiff(_dataNumArr3)){var _step6=_dataNumArr3[1]-_dataNumArr3[0];applyData=fillChnWeek3(data,len,_step6);}else {applyData=fillCopy(data,len);}}else {if(direction==="up"||direction==="left"){data.reverse();}applyData=fillCopy(data,len);}}else if(type==="4"){if(data.length===2){var _data$6,_data$7;if(direction==="up"||direction==="left"){data.reverse();}var _step7=dayjs_min((_data$6=data[1])===null||_data$6===void 0?void 0:_data$6.m).diff(dayjs_min((_data$7=data[0])===null||_data$7===void 0?void 0:_data$7.m),"days");applyData=fillDays(data,len,_step7);}else {if(direction==="up"||direction==="left"){data.reverse();}var _judgeDate2=judgeDate(data);if(_judgeDate2[0]&&_judgeDate2[3]){var _data$8,_data$9;var _step8=dayjs_min((_data$8=data[1])===null||_data$8===void 0?void 0:_data$8.m).diff(dayjs_min((_data$9=data[0])===null||_data$9===void 0?void 0:_data$9.m),"months");applyData=fillMonths(data,len,_step8);}else if(!_judgeDate2[0]&&_judgeDate2[2]){var _data$10,_data$11;var _step9=dayjs_min((_data$10=data[1])===null||_data$10===void 0?void 0:_data$10.m).diff(dayjs_min((_data$11=data[0])===null||_data$11===void 0?void 0:_data$11.m),"days");applyData=fillDays(data,len,_step9);}else {applyData=fillCopy(data,len);}}}else if(type==="5"){if(data.length===2){var _data$12,_data$13,_data$14,_data$15;if(dayjs_min((_data$12=data[1])===null||_data$12===void 0?void 0:_data$12.m).date()===dayjs_min((_data$13=data[0])===null||_data$13===void 0?void 0:_data$13.m).date()&&dayjs_min((_data$14=data[1])===null||_data$14===void 0?void 0:_data$14.m).diff(dayjs_min((_data$15=data[0])===null||_data$15===void 0?void 0:_data$15.m),"months")!==0){var _data$16,_data$17;if(direction==="up"||direction==="left"){data.reverse();}var _step10=dayjs_min((_data$16=data[1])===null||_data$16===void 0?void 0:_data$16.m).diff(dayjs_min((_data$17=data[0])===null||_data$17===void 0?void 0:_data$17.m),"months");for(var _i6=1;_i6<=len;_i6+=1){var _data9;var index=(_i6-1)%data.length;var d=lodash.cloneDeep(data[index]);var last=(_data9=data[data.length-1])===null||_data9===void 0?void 0:_data9.m;if(d!=null&&last!=null){var _genarate4;var day=dayjs_min(last).add(_step10*_i6,"months").day();var date=void 0;if(day===0){date=dayjs_min(last).add(_step10*_i6,"months").subtract(2,"days").format("YYYY-MM-DD");}else if(day===6){date=dayjs_min(last).add(_step10*_i6,"months").subtract(1,"days").format("YYYY-MM-DD");}else {date=dayjs_min(last).add(_step10*_i6,"months").format("YYYY-MM-DD");}d.m=date;d.v=(_genarate4=genarate(date))===null||_genarate4===void 0?void 0:_genarate4[2];applyData.push(d);}}}else {var _data$18,_data$19;if(Math.abs(dayjs_min((_data$18=data[1])===null||_data$18===void 0?void 0:_data$18.m).diff(dayjs_min((_data$19=data[0])===null||_data$19===void 0?void 0:_data$19.m)))>7){var step_month;if(direction==="down"||direction==="right"){step_month=1;}else {step_month=-1;data.reverse();}var _step11;for(var _i7=1;_i7<=len;_i7+=1){var _index2=(_i7-1)%data.length;var _d3=lodash.cloneDeep(data[_index2]);if(_d3!=null){var _genarate5;var num=Math.ceil(_i7/data.length);if(_index2===0){_step11=dayjs_min(_d3.m).add(step_month*num,"months").diff(dayjs_min(_d3.m),"days");}var _day=dayjs_min(_d3.m).add(_step11,"days").day();var _date=void 0;if(_day===0){_date=dayjs_min(_d3.m).add(_step11,"days").subtract(2,"days").format("YYYY-MM-DD");}else if(_day===6){_date=dayjs_min(_d3.m).add(_step11,"days").subtract(1,"days").format("YYYY-MM-DD");}else {_date=dayjs_min(_d3.m).add(_step11,"days").format("YYYY-MM-DD");}_d3.m=_date;_d3.v=(_genarate5=genarate(_date))===null||_genarate5===void 0?void 0:_genarate5[2];applyData.push(_d3);}}}else {var step_day;if(direction==="down"||direction==="right"){step_day=7;}else {step_day=-7;data.reverse();}var _step12;for(var _i8=1;_i8<=len;_i8+=1){var _index3=(_i8-1)%data.length;var _d4=lodash.cloneDeep(data[_index3]);if(_d4!=null){var _genarate6;var _num=Math.ceil(_i8/data.length);if(_index3===0){_step12=dayjs_min(_d4.m).add(step_day*_num,"days").diff(dayjs_min(_d4.m),"days");}var _day2=dayjs_min(_d4.m).add(_step12,"days").day();var _date2=void 0;if(_day2===0){_date2=dayjs_min(_d4.m).add(_step12,"days").subtract(2,"days").format("YYYY-MM-DD");}else if(_day2===6){_date2=dayjs_min(_d4.m).add(_step12,"days").subtract(1,"days").format("YYYY-MM-DD");}else {_date2=dayjs_min(_d4.m).add(_step12,"days").format("YYYY-MM-DD");}_d4.m=_date2;_d4.v=(_genarate6=genarate(_date2))===null||_genarate6===void 0?void 0:_genarate6[2];applyData.push(_d4);}}}}}else {var _judgeDate3=judgeDate(data);if(_judgeDate3[0]&&_judgeDate3[3]){var _data$20,_data$21;if(direction==="up"||direction==="left"){data.reverse();}var _step13=dayjs_min((_data$20=data[1])===null||_data$20===void 0?void 0:_data$20.m).diff(dayjs_min((_data$21=data[0])===null||_data$21===void 0?void 0:_data$21.m),"months");for(var _i9=1;_i9<=len;_i9+=1){var _data10;var _index4=(_i9-1)%data.length;var _d5=lodash.cloneDeep(data[_index4]);var _last=(_data10=data[data.length-1])===null||_data10===void 0?void 0:_data10.m;if(_d5!=null){var _genarate7;var _day3=dayjs_min(_last).add(_step13*_i9,"months").day();var _date3=void 0;if(_day3===0){_date3=dayjs_min(_last).add(_step13*_i9,"months").subtract(2,"days").format("YYYY-MM-DD");}else if(_day3===6){_date3=dayjs_min(_last).add(_step13*_i9,"months").subtract(1,"days").format("YYYY-MM-DD");}else {_date3=dayjs_min(_last).add(_step13*_i9,"months").format("YYYY-MM-DD");}_d5.m=_date3;_d5.v=(_genarate7=genarate(_date3))===null||_genarate7===void 0?void 0:_genarate7[2];applyData.push(_d5);}}}else if(!_judgeDate3[0]&&_judgeDate3[2]){var _data$22,_data$23;if(Math.abs(dayjs_min((_data$22=data[1])===null||_data$22===void 0?void 0:_data$22.m).diff(dayjs_min((_data$23=data[0])===null||_data$23===void 0?void 0:_data$23.m)))>7){var _step_month;if(direction==="down"||direction==="right"){_step_month=1;}else {_step_month=-1;data.reverse();}var _step14;for(var _i10=1;_i10<=len;_i10+=1){var _index5=(_i10-1)%data.length;var _d6=lodash.cloneDeep(data[_index5]);if(_d6!=null){var _genarate8;var _num2=Math.ceil(_i10/data.length);if(_index5===0){_step14=dayjs_min(_d6.m).add(_step_month*_num2,"months").diff(dayjs_min(_d6.m),"days");}var _day4=dayjs_min(_d6.m).add(_step14,"days").day();var _date4=void 0;if(_day4===0){_date4=dayjs_min(_d6.m).add(_step14,"days").subtract(2,"days").format("YYYY-MM-DD");}else if(_day4===6){_date4=dayjs_min(_d6.m).add(_step14,"days").subtract(1,"days").format("YYYY-MM-DD");}else {_date4=dayjs_min(_d6.m).add(_step14,"days").format("YYYY-MM-DD");}_d6.m=_date4;_d6.v=(_genarate8=genarate(_date4))===null||_genarate8===void 0?void 0:_genarate8[2];applyData.push(_d6);}}}else {var _step_day;if(direction==="down"||direction==="right"){_step_day=7;}else {_step_day=-7;data.reverse();}var _step15;for(var _i11=1;_i11<=len;_i11+=1){var _index6=(_i11-1)%data.length;var _d7=lodash.cloneDeep(data[_index6]);if(_d7!=null){var _genarate9;var _num3=Math.ceil(_i11/data.length);if(_index6===0){_step15=dayjs_min(_d7.m).add(_step_day*_num3,"days").diff(dayjs_min(_d7.m),"days");}var _day5=dayjs_min(_d7.m).add(_step15,"days").day();var _date5=void 0;if(_day5===0){_date5=dayjs_min(_d7.m).add(_step15,"days").subtract(2,"days").format("YYYY-MM-DD");}else if(_day5===6){_date5=dayjs_min(_d7.m).add(_step15,"days").subtract(1,"days").format("YYYY-MM-DD");}else {_date5=dayjs_min(_d7.m).add(_step15,"days").format("YYYY-MM-DD");}_d7.m=_date5;_d7.v=(_genarate9=genarate(_date5))===null||_genarate9===void 0?void 0:_genarate9[2];applyData.push(_d7);}}}}else {if(direction==="up"||direction==="left"){data.reverse();}applyData=fillCopy(data,len);}}}else if(type==="6"){if(data.length===2){var _data$24,_data$25,_data$26,_data$27;if(dayjs_min((_data$24=data[1])===null||_data$24===void 0?void 0:_data$24.m).date()===dayjs_min((_data$25=data[0])===null||_data$25===void 0?void 0:_data$25.m).date()&&dayjs_min((_data$26=data[1])===null||_data$26===void 0?void 0:_data$26.m).diff(dayjs_min((_data$27=data[0])===null||_data$27===void 0?void 0:_data$27.m),"months")!==0){var _data$28,_data$29;if(direction==="up"||direction==="left"){data.reverse();}var _step16=dayjs_min((_data$28=data[1])===null||_data$28===void 0?void 0:_data$28.m).diff(dayjs_min((_data$29=data[0])===null||_data$29===void 0?void 0:_data$29.m),"months");applyData=fillMonths(data,len,_step16);}else {var _step_month2;if(direction==="down"||direction==="right"){_step_month2=1;}else {_step_month2=-1;data.reverse();}var _step17;for(var _i12=1;_i12<=len;_i12+=1){var _index7=(_i12-1)%data.length;var _d8=lodash.cloneDeep(data[_index7]);if(_d8!=null){var _genarate10;var _num4=Math.ceil(_i12/data.length);if(_index7===0){_step17=dayjs_min(_d8.m).add(_step_month2*_num4,"months").diff(dayjs_min(_d8.m),"days");}var _date6=dayjs_min(_d8.m).add(_step17,"days").format("YYYY-MM-DD");_d8.m=_date6;_d8.v=(_genarate10=genarate(_date6))===null||_genarate10===void 0?void 0:_genarate10[2];applyData.push(_d8);}}}}else {var _judgeDate4=judgeDate(data);if(_judgeDate4[0]&&_judgeDate4[3]){var _data$30,_data$31;if(direction==="up"||direction==="left"){data.reverse();}var _step18=dayjs_min((_data$30=data[1])===null||_data$30===void 0?void 0:_data$30.m).diff(dayjs_min((_data$31=data[0])===null||_data$31===void 0?void 0:_data$31.m),"months");applyData=fillMonths(data,len,_step18);}else if(!_judgeDate4[0]&&_judgeDate4[2]){var _step_month3;if(direction==="down"||direction==="right"){_step_month3=1;}else {_step_month3=-1;data.reverse();}var _step19;for(var _i13=1;_i13<=len;_i13+=1){var _index8=(_i13-1)%data.length;var _d9=lodash.cloneDeep(data[_index8]);if(_d9!=null){var _genarate11;var _num5=Math.ceil(_i13/data.length);if(_index8===0){_step19=dayjs_min(_d9.m).add(_step_month3*_num5,"months").diff(dayjs_min(_d9.m),"days");}var _date7=dayjs_min(_d9.m).add(_step19,"days").format("YYYY-MM-DD");_d9.m=_date7;_d9.v=(_genarate11=genarate(_date7))===null||_genarate11===void 0?void 0:_genarate11[2];applyData.push(_d9);}}}else {if(direction==="up"||direction==="left"){data.reverse();}applyData=fillCopy(data,len);}}}else if(type==="7"){if(data.length===2){var _data$32,_data$33,_data$34,_data$35,_data$36,_data$37;if(dayjs_min((_data$32=data[1])===null||_data$32===void 0?void 0:_data$32.m).date()===dayjs_min((_data$33=data[0])===null||_data$33===void 0?void 0:_data$33.m).date()&&dayjs_min((_data$34=data[1])===null||_data$34===void 0?void 0:_data$34.m).month()===dayjs_min((_data$35=data[0])===null||_data$35===void 0?void 0:_data$35.m).month()&&dayjs_min((_data$36=data[1])===null||_data$36===void 0?void 0:_data$36.m).diff(dayjs_min((_data$37=data[0])===null||_data$37===void 0?void 0:_data$37.m),"years")!==0){var _data$38,_data$39;if(direction==="up"||direction==="left"){data.reverse();}var _step20=dayjs_min((_data$38=data[1])===null||_data$38===void 0?void 0:_data$38.m).diff(dayjs_min((_data$39=data[0])===null||_data$39===void 0?void 0:_data$39.m),"years");applyData=fillYears(data,len,_step20);}else {var step_year;if(direction==="down"||direction==="right"){step_year=1;}else {step_year=-1;data.reverse();}var _step21;for(var _i14=1;_i14<=len;_i14+=1){var _index9=(_i14-1)%data.length;var _d10=lodash.cloneDeep(data[_index9]);if(_d10!=null){var _genarate12;var _num6=Math.ceil(_i14/data.length);if(_index9===0){_step21=dayjs_min(_d10.m).add(step_year*_num6,"years").diff(dayjs_min(_d10.m),"days");}var _date8=dayjs_min(_d10.m).add(_step21,"days").format("YYYY-MM-DD");_d10.m=_date8;_d10.v=(_genarate12=genarate(_date8))===null||_genarate12===void 0?void 0:_genarate12[2];applyData.push(_d10);}}}}else {var _judgeDate5=judgeDate(data);if(_judgeDate5[0]&&_judgeDate5[1]&&_judgeDate5[4]){var _data$40,_data$41;if(direction==="up"||direction==="left"){data.reverse();}var _step22=dayjs_min((_data$40=data[1])===null||_data$40===void 0?void 0:_data$40.m).diff(dayjs_min((_data$41=data[0])===null||_data$41===void 0?void 0:_data$41.m),"years");applyData=fillYears(data,len,_step22);}else if(_judgeDate5[0]&&_judgeDate5[3]||_judgeDate5[2]){var _step_year;if(direction==="down"||direction==="right"){_step_year=1;}else {_step_year=-1;data.reverse();}var _step23;for(var _i15=1;_i15<=len;_i15+=1){var _index10=(_i15-1)%data.length;var _d11=lodash.cloneDeep(data[_index10]);var _num7=Math.ceil(_i15/data.length);if(_d11!=null){var _genarate13;if(_index10===0){_step23=dayjs_min(_d11.m).add(_step_year*_num7,"years").diff(dayjs_min(_d11.m),"days");}var _date9=dayjs_min(_d11.m).add(_step23,"days").format("YYYY-MM-DD");_d11.m=_date9;_d11.v=(_genarate13=genarate(_date9))===null||_genarate13===void 0?void 0:_genarate13[2];applyData.push(_d11);}}}else {if(direction==="up"||direction==="left"){data.reverse();}applyData=fillCopy(data,len);}}}else if(type==="8"){var _dataNumArr4=[];for(var _i16=0;_i16<data.length;_i16+=1){var _data$_i5;var _m3=(_data$_i5=data[_i16])===null||_data$_i5===void 0?void 0:_data$_i5.m;if(_m3!=null){_m3="".concat(_m3);_dataNumArr4.push(chineseToNumber(_m3));}}if(direction==="up"||direction==="left"){data.reverse();_dataNumArr4.reverse();}if(isEqualDiff(_dataNumArr4)){var _step24=_dataNumArr4[1]-_dataNumArr4[0];applyData=fillChnNumber(data,len,_step24);}else {applyData=fillCopy(data,len);}}return applyData;}function getCopyData(d,r1,r2,c1,c2,direction){var copyData=[];var a1;var a2;var b1;var b2;if(direction==="down"||direction==="up"){a1=c1;a2=c2;b1=r1;b2=r2;}else {a1=r1;a2=r2;b1=c1;b2=c2;}for(var a=a1;a<=a2;a+=1){var obj={};var arrData=[];var arrIndex=[];var text="";var extendNumberBeforeStr=null;var extendNumberAfterStr=null;var isSameStr=true;for(var b=b1;b<=b2;b+=1){var _data11;var data=void 0;if(direction==="down"||direction==="up"){data=d[b][a];}else if(direction==="right"||direction==="left"){data=d[a][b];}var str=void 0;if(((_data11=data)===null||_data11===void 0?void 0:_data11.v)!=null&&data.f==null){if(!!data.ct&&data.ct.t==="n"){str="number";extendNumberBeforeStr=null;extendNumberAfterStr=null;}else if(!!data.ct&&data.ct.t==="d"){str="date";extendNumberBeforeStr=null;extendNumberAfterStr=null;}else if(isExtendNumber(data.m)[0]){str="extendNumber";var _isExtendNumber=isExtendNumber(data.m);if(extendNumberBeforeStr==null||extendNumberAfterStr==null){isSameStr=true;var _isExtendNumber2=_slicedToArray$3(_isExtendNumber,4);extendNumberBeforeStr=_isExtendNumber2[2];extendNumberAfterStr=_isExtendNumber2[3];}else {if(_isExtendNumber[2]!==extendNumberBeforeStr||_isExtendNumber[3]!==extendNumberAfterStr){isSameStr=false;var _isExtendNumber3=_slicedToArray$3(_isExtendNumber,4);extendNumberBeforeStr=_isExtendNumber3[2];extendNumberAfterStr=_isExtendNumber3[3];}else {isSameStr=true;}}}else if(isChnNumber(data.m)){str="chnNumber";extendNumberBeforeStr=null;extendNumberAfterStr=null;}else if(isChnWeek2(data.m)){str="chnWeek2";extendNumberBeforeStr=null;extendNumberAfterStr=null;}else if(isChnWeek3(data.m)){str="chnWeek3";extendNumberBeforeStr=null;extendNumberAfterStr=null;}else {str="other";extendNumberBeforeStr=null;extendNumberAfterStr=null;}}else {str="other";extendNumberBeforeStr=null;extendNumberAfterStr=null;}if(str==="extendNumber"){if(b===b1){if(b1===b2){text=str;arrData.push(data);arrIndex.push(b-b1+1);obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}else {text=str;arrData.push(data);arrIndex.push(b-b1+1);}}else if(b===b2){if(text===str&&isSameStr){arrData.push(data);arrIndex.push(b-b1+1);if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}}else {if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}text=str;arrData=[];arrData.push(data);arrIndex=[];arrIndex.push(b-b1+1);if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}}}else {if(text===str&&isSameStr){arrData.push(data);arrIndex.push(b-b1+1);}else {if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}text=str;arrData=[];arrData.push(data);arrIndex=[];arrIndex.push(b-b1+1);}}}else {if(b===b1){if(b1===b2){text=str;arrData.push(data);arrIndex.push(b-b1+1);obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}else {text=str;arrData.push(data);arrIndex.push(b-b1+1);}}else if(b===b2){if(text===str){arrData.push(data);arrIndex.push(b-b1+1);if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}}else {if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}text=str;arrData=[];arrData.push(data);arrIndex=[];arrIndex.push(b-b1+1);if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}}}else {if(text===str){arrData.push(data);arrIndex.push(b-b1+1);}else {if(text in obj){obj[text].push({data:arrData,index:arrIndex});}else {obj[text]=[];obj[text].push({data:arrData,index:arrIndex});}text=str;arrData=[];arrData.push(data);arrIndex=[];arrIndex.push(b-b1+1);}}}}copyData.push(obj);}return copyData;}function getApplyData(copyD,csLen,asLen){var applyData=[];var direction=dropCellCache.direction;var type=dropCellCache.applyType;var num=Math.floor(asLen/csLen);var rsd=asLen%csLen;var copyD_number=copyD.number;var applyD_number=[];if(copyD_number){for(var i=0;i<copyD_number.length;i+=1){var s=getLenS(copyD_number[i].index,rsd);var len=copyD_number[i].index.length*num+s;var arrData=void 0;if(type==="1"||type==="3"){arrData=getDataByType(copyD_number[i].data,len,direction,type,"number");}else if(type==="2"){arrData=getDataByType(copyD_number[i].data,len,direction,type);}else {arrData=getDataByType(copyD_number[i].data,len,direction,"0");}var arrIndex=getDataIndex(csLen,asLen,copyD_number[i].index);applyD_number.push({data:arrData,index:arrIndex});}}var copyD_extendNumber=copyD.extendNumber;var applyD_extendNumber=[];if(copyD_extendNumber){for(var _i17=0;_i17<copyD_extendNumber.length;_i17+=1){var _s=getLenS(copyD_extendNumber[_i17].index,rsd);var _len=copyD_extendNumber[_i17].index.length*num+_s;var _arrData=void 0;if(type==="1"||type==="3"){_arrData=getDataByType(copyD_extendNumber[_i17].data,_len,direction,type,"extendNumber");}else if(type==="2"){_arrData=getDataByType(copyD_extendNumber[_i17].data,_len,direction,type);}else {_arrData=getDataByType(copyD_extendNumber[_i17].data,_len,direction,"0");}var _arrIndex=getDataIndex(csLen,asLen,copyD_extendNumber[_i17].index);applyD_extendNumber.push({data:_arrData,index:_arrIndex});}}var copyD_date=copyD.date;var applyD_date=[];if(copyD_date){for(var _i18=0;_i18<copyD_date.length;_i18+=1){var _s2=getLenS(copyD_date[_i18].index,rsd);var _len2=copyD_date[_i18].index.length*num+_s2;var _arrData2=void 0;if(type==="1"||type==="3"){_arrData2=getDataByType(copyD_date[_i18].data,_len2,direction,type,"date");}else if(type==="8"){_arrData2=getDataByType(copyD_date[_i18].data,_len2,direction,"0");}else {_arrData2=getDataByType(copyD_date[_i18].data,_len2,direction,type);}var _arrIndex2=getDataIndex(csLen,asLen,copyD_date[_i18].index);applyD_date.push({data:_arrData2,index:_arrIndex2});}}var copyD_chnNumber=copyD.chnNumber;var applyD_chnNumber=[];if(copyD_chnNumber){for(var _i19=0;_i19<copyD_chnNumber.length;_i19+=1){var _s3=getLenS(copyD_chnNumber[_i19].index,rsd);var _len3=copyD_chnNumber[_i19].index.length*num+_s3;var _arrData3=void 0;if(type==="1"||type==="3"){_arrData3=getDataByType(copyD_chnNumber[_i19].data,_len3,direction,type,"chnNumber");}else if(type==="2"||type==="8"){_arrData3=getDataByType(copyD_chnNumber[_i19].data,_len3,direction,type);}else {_arrData3=getDataByType(copyD_chnNumber[_i19].data,_len3,direction,"0");}var _arrIndex3=getDataIndex(csLen,asLen,copyD_chnNumber[_i19].index);applyD_chnNumber.push({data:_arrData3,index:_arrIndex3});}}var copyD_chnWeek2=copyD.chnWeek2;var applyD_chnWeek2=[];if(copyD_chnWeek2){for(var _i20=0;_i20<copyD_chnWeek2.length;_i20+=1){var _s4=getLenS(copyD_chnWeek2[_i20].index,rsd);var _len4=copyD_chnWeek2[_i20].index.length*num+_s4;var _arrData4=void 0;if(type==="1"||type==="3"){_arrData4=getDataByType(copyD_chnWeek2[_i20].data,_len4,direction,type,"chnWeek2");}else if(type==="2"){_arrData4=getDataByType(copyD_chnWeek2[_i20].data,_len4,direction,type);}else {_arrData4=getDataByType(copyD_chnWeek2[_i20].data,_len4,direction,"0");}var _arrIndex4=getDataIndex(csLen,asLen,copyD_chnWeek2[_i20].index);applyD_chnWeek2.push({data:_arrData4,index:_arrIndex4});}}var copyD_chnWeek3=copyD.chnWeek3;var applyD_chnWeek3=[];if(copyD_chnWeek3){for(var _i21=0;_i21<copyD_chnWeek3.length;_i21+=1){var _s5=getLenS(copyD_chnWeek3[_i21].index,rsd);var _len5=copyD_chnWeek3[_i21].index.length*num+_s5;var _arrData5=void 0;if(type==="1"||type==="3"){_arrData5=getDataByType(copyD_chnWeek3[_i21].data,_len5,direction,type,"chnWeek3");}else if(type==="2"){_arrData5=getDataByType(copyD_chnWeek3[_i21].data,_len5,direction,type);}else {_arrData5=getDataByType(copyD_chnWeek3[_i21].data,_len5,direction,"0");}var _arrIndex5=getDataIndex(csLen,asLen,copyD_chnWeek3[_i21].index);applyD_chnWeek3.push({data:_arrData5,index:_arrIndex5});}}var copyD_other=copyD.other;var applyD_other=[];if(copyD_other){for(var _i22=0;_i22<copyD_other.length;_i22+=1){var _s6=getLenS(copyD_other[_i22].index,rsd);var _len6=copyD_other[_i22].index.length*num+_s6;var _arrData6=void 0;if(type==="2"||type==="3"){_arrData6=getDataByType(copyD_other[_i22].data,_len6,direction,type);}else {_arrData6=getDataByType(copyD_other[_i22].data,_len6,direction,"0");}var _arrIndex6=getDataIndex(csLen,asLen,copyD_other[_i22].index);applyD_other.push({data:_arrData6,index:_arrIndex6});}}for(var x=1;x<=asLen;x+=1){if(applyD_number.length>0){for(var y=0;y<applyD_number.length;y+=1){if(x in applyD_number[y].index){applyData.push(applyD_number[y].data[applyD_number[y].index[x]]);}}}if(applyD_extendNumber.length>0){for(var _y=0;_y<applyD_extendNumber.length;_y+=1){if(x in applyD_extendNumber[_y].index){applyData.push(applyD_extendNumber[_y].data[applyD_extendNumber[_y].index[x]]);}}}if(applyD_date.length>0){for(var _y2=0;_y2<applyD_date.length;_y2+=1){if(x in applyD_date[_y2].index){applyData.push(applyD_date[_y2].data[applyD_date[_y2].index[x]]);}}}if(applyD_chnNumber.length>0){for(var _y3=0;_y3<applyD_chnNumber.length;_y3+=1){if(x in applyD_chnNumber[_y3].index){applyData.push(applyD_chnNumber[_y3].data[applyD_chnNumber[_y3].index[x]]);}}}if(applyD_chnWeek2.length>0){for(var _y4=0;_y4<applyD_chnWeek2.length;_y4+=1){if(x in applyD_chnWeek2[_y4].index){applyData.push(applyD_chnWeek2[_y4].data[applyD_chnWeek2[_y4].index[x]]);}}}if(applyD_chnWeek3.length>0){for(var _y5=0;_y5<applyD_chnWeek3.length;_y5+=1){if(x in applyD_chnWeek3[_y5].index){applyData.push(applyD_chnWeek3[_y5].data[applyD_chnWeek3[_y5].index[x]]);}}}if(applyD_other.length>0){for(var _y6=0;_y6<applyD_other.length;_y6+=1){if(x in applyD_other[_y6].index){applyData.push(applyD_other[_y6].data[applyD_other[_y6].index[x]]);}}}}return applyData;}function updateDropCell(ctx){var d=getFlowdata(ctx);if(ctx.allowEdit===false||d==null){return;}var index=getSheetIndex(ctx,ctx.currentSheetId);if(index==null)return;var file=ctx.luckysheetfile[index];var cfg=lodash.cloneDeep(ctx.config);if(cfg.borderInfo==null){cfg.borderInfo=[];}var borderInfoCompute=getBorderInfoCompute(ctx,ctx.currentSheetId);var dataVerification=lodash.cloneDeep(file.dataVerification);var direction=dropCellCache.direction;var copyRange=dropCellCache.copyRange;var copy_str_r=copyRange.row[0];var copy_end_r=copyRange.row[1];var copy_str_c=copyRange.column[0];var copy_end_c=copyRange.column[1];var copyData=getCopyData(d,copy_str_r,copy_end_r,copy_str_c,copy_end_c,direction);var csLen;if(direction==="down"||direction==="up"){csLen=copy_end_r-copy_str_r+1;}else {csLen=copy_end_c-copy_str_c+1;}var applyRange=dropCellCache.applyRange;var apply_str_r=applyRange.row[0];var apply_end_r=applyRange.row[1];var apply_str_c=applyRange.column[0];var apply_end_c=applyRange.column[1];if(direction==="down"||direction==="up"){var asLen=apply_end_r-apply_str_r+1;for(var i=apply_str_c;i<=apply_end_c;i+=1){var copyD=copyData[i-apply_str_c];var applyData=getApplyData(copyD,csLen,asLen);if(direction==="down"){for(var j=apply_str_r;j<=apply_end_r;j+=1){var cell=applyData[j-apply_str_r];if((cell===null||cell===void 0?void 0:cell.f)!=null){var f="=".concat(functionCopy(ctx,cell.f,"down",j-apply_str_r+1));var v=execfunction(ctx,f,j,i);execFunctionGroup(ctx,j,i,v[1],undefined,d);var _v=_slicedToArray$3(v,3);cell.v=_v[1];cell.f=_v[2];if(cell.spl!=null){cell.spl=v[3].data;}else if(cell.v!=null){if(isRealNum(cell.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test("".concat(cell.v))){if(cell.v===Infinity||cell.v===-Infinity){cell.m=cell.v.toString();}else {if(cell.v.toString().indexOf("e")>-1){var len=cell.v.toString().split(".")[1].split("e")[0].length;if(len>5){len=5;}cell.m=cell.v.toExponential(len).toString();}else {var _cell$ct;var mask=void 0;if(((_cell$ct=cell.ct)===null||_cell$ct===void 0?void 0:_cell$ct.fa)==="##0.00"){mask=genarate("".concat(Math.round(cell.v*1000000000)/1000000000,".00"));cell.m=mask[0].toString();}else {mask=genarate(Math.round(cell.v*1000000000)/1000000000);cell.m=mask[0].toString();}}}cell.ct=cell.ct||{fa:"General",t:"n"};}else {var _mask=genarate(cell.v);cell.m=_mask[0].toString();var _mask2=_slicedToArray$3(_mask,2);cell.ct=_mask2[1];}}}d[j][i]=cell||null;var bd_r=copy_str_r+(j-apply_str_r)%csLen;var bd_c=i;if(borderInfoCompute["".concat(bd_r,"_").concat(bd_c)]){var bd_obj={rangeType:"cell",value:{row_index:j,col_index:i,l:borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].l,r:borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].r,t:borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].t,b:borderInfoCompute["".concat(bd_r,"_").concat(bd_c)].b}};cfg.borderInfo.push(bd_obj);}else if(borderInfoCompute["".concat(j,"_").concat(i)]){var _bd_obj={rangeType:"cell",value:{row_index:j,col_index:i,l:null,r:null,t:null,b:null}};cfg.borderInfo.push(_bd_obj);}if(dataVerification!=null&&dataVerification["".concat(bd_r,"_").concat(bd_c)]){dataVerification["".concat(j,"_").concat(i)]=dataVerification["".concat(bd_r,"_").concat(bd_c)];}}}if(direction==="up"){for(var _j=apply_end_r;_j>=apply_str_r;_j-=1){var _cell=applyData[apply_end_r-_j];if((_cell===null||_cell===void 0?void 0:_cell.f)!=null){var _f="=".concat(functionCopy(ctx,_cell.f,"up",apply_end_r-_j+1));var _v2=execfunction(ctx,_f,_j,i);execFunctionGroup(ctx,_j,i,_v2[1],undefined,d);var _v3=_slicedToArray$3(_v2,3);_cell.v=_v3[1];_cell.f=_v3[2];if(_cell.spl!=null){_cell.spl=_v2[3].data;}else if(_cell.v!=null){if(isRealNum(_cell.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test("".concat(_cell.v))){if(_cell.v===Infinity||_cell.v===-Infinity){_cell.m=_cell.v.toString();}else {if(_cell.v.toString().indexOf("e")>-1){var _len7=_cell.v.toString().split(".")[1].split("e")[0].length;if(_len7>5){_len7=5;}_cell.m=_cell.v.toExponential(_len7).toString();}else {var _mask3=genarate(Math.round(_cell.v*1000000000)/1000000000);_cell.m=_mask3[0].toString();}}_cell.ct={fa:"General",t:"n"};}else {var _mask4=genarate(_cell.v);_cell.m=_mask4[0].toString();var _mask5=_slicedToArray$3(_mask4,2);_cell.ct=_mask5[1];}}}d[_j][i]=_cell||null;var _bd_r=copy_end_r-(apply_end_r-_j)%csLen;var _bd_c=i;if(borderInfoCompute["".concat(_bd_r,"_").concat(_bd_c)]){var _bd_obj2={rangeType:"cell",value:{row_index:_j,col_index:i,l:borderInfoCompute["".concat(_bd_r,"_").concat(_bd_c)].l,r:borderInfoCompute["".concat(_bd_r,"_").concat(_bd_c)].r,t:borderInfoCompute["".concat(_bd_r,"_").concat(_bd_c)].t,b:borderInfoCompute["".concat(_bd_r,"_").concat(_bd_c)].b}};cfg.borderInfo.push(_bd_obj2);}else if(borderInfoCompute["".concat(_j,"_").concat(i)]){var _bd_obj3={rangeType:"cell",value:{row_index:_j,col_index:i,l:null,r:null,t:null,b:null}};cfg.borderInfo.push(_bd_obj3);}if(dataVerification!=null&&dataVerification["".concat(_bd_r,"_").concat(_bd_c)]){dataVerification["".concat(_j,"_").concat(i)]=dataVerification["".concat(_bd_r,"_").concat(_bd_c)];}}}}}else if(direction==="right"||direction==="left"){var _asLen=apply_end_c-apply_str_c+1;for(var _i23=apply_str_r;_i23<=apply_end_r;_i23+=1){var _copyD=copyData[_i23-apply_str_r];var _applyData=getApplyData(_copyD,csLen,_asLen);if(direction==="right"){for(var _j2=apply_str_c;_j2<=apply_end_c;_j2+=1){var _cell2=_applyData[_j2-apply_str_c];if((_cell2===null||_cell2===void 0?void 0:_cell2.f)!=null){var _f2="=".concat(functionCopy(ctx,_cell2.f,"right",_j2-apply_str_c+1));var _v4=execfunction(ctx,_f2,_i23,_j2);execFunctionGroup(ctx,_j2,_i23,_v4[1],undefined,d);var _v5=_slicedToArray$3(_v4,3);_cell2.v=_v5[1];_cell2.f=_v5[2];if(_cell2.spl!=null){_cell2.spl=_v4[3].data;}else if(_cell2.v!=null){if(isRealNum(_cell2.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test("".concat(_cell2.v))){if(_cell2.v===Infinity||_cell2.v===-Infinity){_cell2.m=_cell2.v.toString();}else {if(_cell2.v.toString().indexOf("e")>-1){var _len8=_cell2.v.toString().split(".")[1].split("e")[0].length;if(_len8>5){_len8=5;}_cell2.m=_cell2.v.toExponential(_len8).toString();}else {var _mask6=genarate(Math.round(_cell2.v*1000000000)/1000000000);_cell2.m=_mask6[0].toString();}}_cell2.ct={fa:"General",t:"n"};}else {var _mask7=genarate(_cell2.v);_cell2.m=_mask7[0].toString();var _mask8=_slicedToArray$3(_mask7,2);_cell2.ct=_mask8[1];}}}d[_i23][_j2]=_cell2||null;var _bd_r2=_i23;var _bd_c2=copy_str_c+(_j2-apply_str_c)%csLen;if(borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)]){var _bd_obj4={rangeType:"cell",value:{row_index:_i23,col_index:_j2,l:borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].l,r:borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].r,t:borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].t,b:borderInfoCompute["".concat(_bd_r2,"_").concat(_bd_c2)].b}};cfg.borderInfo.push(_bd_obj4);}else if(borderInfoCompute["".concat(_i23,"_").concat(_j2)]){var _bd_obj5={rangeType:"cell",value:{row_index:_i23,col_index:_j2,l:null,r:null,t:null,b:null}};cfg.borderInfo.push(_bd_obj5);}if(dataVerification!=null&&dataVerification["".concat(_bd_r2,"_").concat(_bd_c2)]){dataVerification["".concat(_i23,"_").concat(_j2)]=dataVerification["".concat(_bd_r2,"_").concat(_bd_c2)];}}}if(direction==="left"){for(var _j3=apply_end_c;_j3>=apply_str_c;_j3-=1){var _cell3=_applyData[apply_end_c-_j3];if((_cell3===null||_cell3===void 0?void 0:_cell3.f)!=null){var _f3="=".concat(functionCopy(ctx,_cell3.f,"left",apply_end_c-_j3+1));var _v6=execfunction(ctx,_f3,_i23,_j3);execFunctionGroup(ctx,_j3,_i23,_v6[1],undefined,d);var _v7=_slicedToArray$3(_v6,3);_cell3.v=_v7[1];_cell3.f=_v7[2];if(_cell3.spl!=null){_cell3.spl=_v6[3].data;}else if(_cell3.v!=null){if(isRealNum(_cell3.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test("".concat(_cell3.v))){if(_cell3.v===Infinity||_cell3.v===-Infinity){_cell3.m=_cell3.v.toString();}else {if(_cell3.v.toString().indexOf("e")>-1){var _len9=_cell3.v.toString().split(".")[1].split("e")[0].length;if(_len9>5){_len9=5;}_cell3.m=_cell3.v.toExponential(_len9).toString();}else {var _mask9=genarate(Math.round(_cell3.v*1000000000)/1000000000);_cell3.m=_mask9[0].toString();}}_cell3.ct={fa:"General",t:"n"};}else {var _mask10=genarate(_cell3.v);_cell3.m=_mask10[0].toString();var _mask11=_slicedToArray$3(_mask10,2);_cell3.ct=_mask11[1];}}}d[_i23][_j3]=_cell3||null;var _bd_r3=_i23;var _bd_c3=copy_end_c-(apply_end_c-_j3)%csLen;if(borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)]){var _bd_obj6={rangeType:"cell",value:{row_index:_i23,col_index:_j3,l:borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].l,r:borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].r,t:borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].t,b:borderInfoCompute["".concat(_bd_r3,"_").concat(_bd_c3)].b}};cfg.borderInfo.push(_bd_obj6);}else if(borderInfoCompute["".concat(_i23,"_").concat(_j3)]){var _bd_obj7={rangeType:"cell",value:{row_index:_i23,col_index:_j3,l:null,r:null,t:null,b:null}};cfg.borderInfo.push(_bd_obj7);}if(dataVerification!=null&&dataVerification["".concat(_bd_r3,"_").concat(_bd_c3)]){dataVerification["".concat(_i23,"_").concat(_j3)]=dataVerification["".concat(_bd_r3,"_").concat(_bd_c3)];}}}}}}function onDropCellSelectEnd(ctx,e,container){var _ctx$luckysheet_selec;ctx.luckysheet_cell_selected_extend=false;hideDropCellSelection(container);var scrollLeft=ctx.scrollLeft,scrollTop=ctx.scrollTop;var rect=container.getBoundingClientRect();var x=e.pageX-rect.left-ctx.rowHeaderWidth+scrollLeft;var y=e.pageY-rect.top-ctx.columnHeaderHeight+scrollTop;var winH=rect.height-20*ctx.zoomRatio;var winW=rect.width-60*ctx.zoomRatio;var row_location=rowLocation(y,ctx.visibledatarow);var row_pre=row_location[0];var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col_pre=col_location[0];var col_index=col_location[2];var row_index_original=ctx.luckysheet_cell_selected_extend_index[0];var col_index_original=ctx.luckysheet_cell_selected_extend_index[1];var last=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[ctx.luckysheet_select_save.length-1];if(last&&last.top!=null&&last.left!=null&&last.height!=null&&last.width!=null&&last.row_focus!=null&&last.column_focus!=null){var row_s=last.row[0];var row_e=last.row[1];var col_s=last.column[0];var col_e=last.column[1];if(row_s<0||y<0){row_s=0;row_e=last.row[1]-last.row[0];}if(col_s<0||x<0){col_s=0;col_e=last.column[1]-last.column[0];}if(row_e>=ctx.visibledatarow[ctx.visibledatarow.length-1]||y>winH){row_s=ctx.visibledatarow.length-1-last.row[1]+last.row[0];row_e=ctx.visibledatarow.length-1;}if(col_e>=ctx.visibledatacolumn[ctx.visibledatacolumn.length-1]||x>winW){col_s=ctx.visibledatacolumn.length-1-last.column[1]+last.column[0];col_e=ctx.visibledatacolumn.length-1;}dropCellCache.copyRange=lodash.cloneDeep(lodash.pick(last,["row","column"]));var typeItemHide=getTypeItemHide(ctx);if(!typeItemHide[0]&&!typeItemHide[1]&&!typeItemHide[2]&&!typeItemHide[3]&&!typeItemHide[4]&&!typeItemHide[5]&&!typeItemHide[6]){dropCellCache.applyType="0";}else {dropCellCache.applyType="1";}if(ctx.luckysheet_select_save==null)return;var _ctx$luckysheet_selec2=ctx.luckysheet_select_save[0],top_move=_ctx$luckysheet_selec2.top_move,left_move=_ctx$luckysheet_selec2.left_move;if(Math.abs(row_index_original-row_index)>Math.abs(col_index_original-col_index)){if(!(row_index>=row_s&&row_index<=row_e)){if(top_move!=null&&top_move>=row_pre){dropCellCache.applyRange={row:[row_index,last.row[0]-1],column:last.column};dropCellCache.direction="up";row_s-=last.row[0]-row_index;}else {dropCellCache.applyRange={row:[last.row[1]+1,row_index],column:last.column};dropCellCache.direction="down";row_e+=row_index-last.row[1];}}else {return;}}else {if(!(col_index>=col_s&&col_index<=col_e)){if(left_move!=null&&left_move>=col_pre){dropCellCache.applyRange={row:last.row,column:[col_index,last.column[0]-1]};dropCellCache.direction="left";col_s-=last.column[0]-col_index;}else {dropCellCache.applyRange={row:last.row,column:[last.column[1]+1,col_index]};dropCellCache.direction="right";col_e+=col_index-last.column[1];}}else {return;}}var flowdata=getFlowdata(ctx);if(flowdata==null)return;if(ctx.config.merge!=null){var HasMC=false;for(var r=last.row[0];r<=last.row[1];r+=1){for(var c=last.column[0];c<=last.column[1];c+=1){var _flowdata$r;var cell=(_flowdata$r=flowdata[r])===null||_flowdata$r===void 0?void 0:_flowdata$r[c];if(cell!=null&&cell.mc!=null){HasMC=true;break;}}}if(HasMC){return;}for(var _r=row_s;_r<=row_e;_r+=1){for(var _c=col_s;_c<=col_e;_c+=1){var _flowdata$_r;var _cell4=(_flowdata$_r=flowdata[_r])===null||_flowdata$_r===void 0?void 0:_flowdata$_r[_c];if(_cell4!=null&&_cell4.mc!=null){HasMC=true;break;}}}if(HasMC){return;}}last.row=[row_s,row_e];last.column=[col_s,col_e];try{updateDropCell(ctx);}catch(err){console.error(err);}var selectedMoveEle=container.querySelector(".fortune-cell-selected-move");if(selectedMoveEle){selectedMoveEle.style.display="none";}}}var defaultStyle={fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"};function isRealNum$1(val){return !Number.isNaN(Number(val));}var cfIconsImg;function getCfIconsImg(){if(cfIconsImg)return cfIconsImg;cfIconsImg=new Image();cfIconsImg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==";return cfIconsImg;}function getBorderFix(d,r,c){var _d$r$c;if(lodash.isEmpty((_d$r$c=d[r][c])===null||_d$r$c===void 0?void 0:_d$r$c.bg)){return [-1,0,0,-1];}return [-2,-1,1,0];}function setLineDash(canvasborder,type,hv,moveStart,moveEnd,lineStart,lineEnd){var borderType={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"};type=borderType[type.toString()];try{if(type==="Hair"){canvasborder.setLineDash([1,2]);}else if(type.indexOf("DashDotDot")>-1){canvasborder.setLineDash([2,2,5,2,2]);}else if(type.indexOf("DashDot")>-1){canvasborder.setLineDash([2,5,2]);}else if(type.indexOf("Dotted")>-1){canvasborder.setLineDash([2]);}else if(type.indexOf("Dashed")>-1){canvasborder.setLineDash([3]);}else {canvasborder.setLineDash([0]);}}catch(e){console.error(e);}canvasborder.beginPath();if(type.indexOf("Medium")>-1){if(hv==="h"){canvasborder.moveTo(moveStart,moveEnd-0.5);canvasborder.lineTo(lineStart,lineEnd-0.5);}else {canvasborder.moveTo(moveStart-0.5,moveEnd);canvasborder.lineTo(lineStart-0.5,lineEnd);}canvasborder.lineWidth=2;}else if(type==="Thick"){canvasborder.moveTo(moveStart,moveEnd);canvasborder.lineTo(lineStart,lineEnd);canvasborder.lineWidth=3;}else {canvasborder.moveTo(moveStart,moveEnd);canvasborder.lineTo(lineStart,lineEnd);canvasborder.lineWidth=1;}}var Canvas=/*#__PURE__*/function(){function Canvas(canvasElement,ctx){_classCallCheck$2(this,Canvas);this.canvasElement=void 0;this.sheetCtx=void 0;this.measureTextCacheTimeOut=void 0;this.cellOverflowMapCache=void 0;this.canvasElement=canvasElement;this.sheetCtx=ctx;this.cellOverflowMapCache={};}_createClass$2(Canvas,[{key:"drawRowHeader",value:function drawRowHeader(scrollHeight,drawHeight,offsetTop){if(lodash.isNil(drawHeight)){var _this$sheetCtx$luckys=_slicedToArray$3(this.sheetCtx.luckysheetTableContentHW,2);drawHeight=_this$sheetCtx$luckys[1];}if(lodash.isNil(offsetTop)){offsetTop=this.sheetCtx.columnHeaderHeight;}var renderCtx=this.canvasElement.getContext("2d");if(!renderCtx)return;renderCtx.save();renderCtx.scale(this.sheetCtx.devicePixelRatio,this.sheetCtx.devicePixelRatio);renderCtx.clearRect(0,offsetTop,this.sheetCtx.rowHeaderWidth-1,drawHeight);renderCtx.font=defaultFont(this.sheetCtx.defaultFontSize);renderCtx.textBaseline=defaultStyle.textBaseline;renderCtx.fillStyle=defaultStyle.fillStyle;var dataset_row_st;var dataset_row_ed;dataset_row_st=lodash.sortedIndex(this.sheetCtx.visibledatarow,scrollHeight);dataset_row_ed=lodash.sortedIndex(this.sheetCtx.visibledatarow,scrollHeight+drawHeight);if(dataset_row_st===-1){dataset_row_st=0;}if(dataset_row_ed===-1){dataset_row_ed=this.sheetCtx.visibledatarow.length-1;}renderCtx.save();renderCtx.beginPath();renderCtx.rect(0,offsetTop-1,this.sheetCtx.rowHeaderWidth-1,drawHeight-2);renderCtx.clip();var end_r;var start_r;var bodrder05=0.5;var preEndR;for(var r=dataset_row_st;r<=dataset_row_ed;r+=1){var _this$sheetCtx$hooks$,_this$sheetCtx$hooks,_this$sheetCtx$config,_this$sheetCtx$config2,_this$sheetCtx$config3,_this$sheetCtx$config4,_this$sheetCtx$hooks$2,_this$sheetCtx$hooks2;if(r===0){start_r=-scrollHeight-1;}else {start_r=this.sheetCtx.visibledatarow[r-1]-scrollHeight-1;}end_r=this.sheetCtx.visibledatarow[r]-scrollHeight;var firstOffset=dataset_row_st===r?-2:0;var lastOffset=dataset_row_ed===r?-2:0;if(((_this$sheetCtx$hooks$=(_this$sheetCtx$hooks=this.sheetCtx.hooks).beforeRenderRowHeaderCell)===null||_this$sheetCtx$hooks$===void 0?void 0:_this$sheetCtx$hooks$.call(_this$sheetCtx$hooks,"".concat(r+1),r,start_r+offsetTop+firstOffset,this.sheetCtx.rowHeaderWidth-1,end_r-start_r+1+lastOffset-firstOffset,renderCtx))===false){continue;}if(((_this$sheetCtx$config=this.sheetCtx.config)===null||_this$sheetCtx$config===void 0?void 0:(_this$sheetCtx$config2=_this$sheetCtx$config.rowhidden)===null||_this$sheetCtx$config2===void 0?void 0:_this$sheetCtx$config2[r])==null){renderCtx.fillStyle=this.sheetCtx.config.rowHeaderBgColor||"#ffffff";renderCtx.fillRect(0,start_r+offsetTop+firstOffset,this.sheetCtx.rowHeaderWidth-1,end_r-start_r+1+lastOffset-firstOffset);renderCtx.fillStyle=this.sheetCtx.config.rowHeaderTextColor||"#000000";renderCtx.save();renderCtx.scale(this.sheetCtx.zoomRatio,this.sheetCtx.zoomRatio);var textMetrics=getMeasureText(r+1,renderCtx,this.sheetCtx);var horizonAlignPos=(this.sheetCtx.rowHeaderWidth-textMetrics.width)/2;var verticalAlignPos=start_r+(end_r-start_r)/2+offsetTop;renderCtx.fillText("".concat(r+1),horizonAlignPos/this.sheetCtx.zoomRatio,verticalAlignPos/this.sheetCtx.zoomRatio);renderCtx.restore();}renderCtx.beginPath();renderCtx.moveTo(this.sheetCtx.rowHeaderWidth-2+bodrder05,start_r+offsetTop-2);renderCtx.lineTo(this.sheetCtx.rowHeaderWidth-2+bodrder05,end_r+offsetTop-2);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.stroke();renderCtx.closePath();if(this.sheetCtx.config.rowhidden&&this.sheetCtx.config.rowhidden[r]==null&&this.sheetCtx.config.rowhidden[r+1]!=null){renderCtx.beginPath();renderCtx.moveTo(-1,end_r+offsetTop-4+bodrder05);renderCtx.lineTo(this.sheetCtx.rowHeaderWidth-1,end_r+offsetTop-4+bodrder05);renderCtx.closePath();renderCtx.stroke();}else if(this.sheetCtx.config.rowhidden==null||this.sheetCtx.config.rowhidden[r]==null){renderCtx.beginPath();renderCtx.moveTo(-1,end_r+offsetTop-2+bodrder05);renderCtx.lineTo(this.sheetCtx.rowHeaderWidth-1,end_r+offsetTop-2+bodrder05);renderCtx.closePath();renderCtx.stroke();}if(((_this$sheetCtx$config3=this.sheetCtx.config)===null||_this$sheetCtx$config3===void 0?void 0:(_this$sheetCtx$config4=_this$sheetCtx$config3.rowhidden)===null||_this$sheetCtx$config4===void 0?void 0:_this$sheetCtx$config4[r-1])!=null&&preEndR!==undefined){renderCtx.beginPath();renderCtx.moveTo(-1,preEndR+offsetTop+bodrder05);renderCtx.lineTo(this.sheetCtx.rowHeaderWidth-1,preEndR+offsetTop+bodrder05);renderCtx.closePath();renderCtx.stroke();}preEndR=end_r;(_this$sheetCtx$hooks$2=(_this$sheetCtx$hooks2=this.sheetCtx.hooks).afterRenderRowHeaderCell)===null||_this$sheetCtx$hooks$2===void 0?void 0:_this$sheetCtx$hooks$2.call(_this$sheetCtx$hooks2,"".concat(r+1),r,start_r+offsetTop+firstOffset,this.sheetCtx.rowHeaderWidth-1,end_r-start_r+1+lastOffset-firstOffset,renderCtx);}renderCtx.restore();renderCtx.restore();}},{key:"drawColumnHeader",value:function drawColumnHeader(scrollWidth,drawWidth,offsetLeft){if(drawWidth===undefined){var _this$sheetCtx$luckys2=_slicedToArray$3(this.sheetCtx.luckysheetTableContentHW,1);drawWidth=_this$sheetCtx$luckys2[0];}if(offsetLeft===undefined){offsetLeft=this.sheetCtx.rowHeaderWidth;}var renderCtx=this.canvasElement.getContext("2d");if(!renderCtx)return;renderCtx.save();renderCtx.scale(this.sheetCtx.devicePixelRatio,this.sheetCtx.devicePixelRatio);renderCtx.clearRect(offsetLeft,0,drawWidth,this.sheetCtx.columnHeaderHeight-1);renderCtx.font=defaultFont(this.sheetCtx.defaultFontSize);renderCtx.textBaseline=defaultStyle.textBaseline;renderCtx.fillStyle=defaultStyle.fillStyle;var dataset_col_st;var dataset_col_ed;dataset_col_st=lodash.sortedIndex(this.sheetCtx.visibledatacolumn,scrollWidth);dataset_col_ed=lodash.sortedIndex(this.sheetCtx.visibledatacolumn,scrollWidth+drawWidth);if(dataset_col_st===-1){dataset_col_st=0;}if(dataset_col_ed===-1){dataset_col_ed=this.sheetCtx.visibledatacolumn.length-1;}renderCtx.save();renderCtx.beginPath();renderCtx.rect(offsetLeft-1,0,drawWidth,this.sheetCtx.columnHeaderHeight-1);renderCtx.clip();var end_c;var start_c;var bodrder05=0.5;var preEndC;for(var c=dataset_col_st;c<=dataset_col_ed;c+=1){var _this$sheetCtx$hooks$3,_this$sheetCtx$hooks3,_this$sheetCtx$config5,_this$sheetCtx$config6,_this$sheetCtx$config7,_this$sheetCtx$config8,_this$sheetCtx$hooks$4,_this$sheetCtx$hooks4;if(c===0){start_c=-scrollWidth;}else {start_c=this.sheetCtx.visibledatacolumn[c-1]-scrollWidth;}end_c=this.sheetCtx.visibledatacolumn[c]-scrollWidth;var abc=indexToColumnChar(c);if(((_this$sheetCtx$hooks$3=(_this$sheetCtx$hooks3=this.sheetCtx.hooks).beforeRenderColumnHeaderCell)===null||_this$sheetCtx$hooks$3===void 0?void 0:_this$sheetCtx$hooks$3.call(_this$sheetCtx$hooks3,abc,c,start_c+offsetLeft-1,end_c-start_c,this.sheetCtx.columnHeaderHeight-1,renderCtx))===false){continue;}if(((_this$sheetCtx$config5=this.sheetCtx.config)===null||_this$sheetCtx$config5===void 0?void 0:(_this$sheetCtx$config6=_this$sheetCtx$config5.colhidden)===null||_this$sheetCtx$config6===void 0?void 0:_this$sheetCtx$config6[c])==null){renderCtx.fillStyle=this.sheetCtx.config.colHeaderBgColor||"#ffffff";renderCtx.fillRect(start_c+offsetLeft-1,0,end_c-start_c,this.sheetCtx.columnHeaderHeight-1);renderCtx.fillStyle=this.sheetCtx.config.colHeaderTextColor||"#000000";renderCtx.save();renderCtx.scale(this.sheetCtx.zoomRatio,this.sheetCtx.zoomRatio);var textMetrics=getMeasureText(abc,renderCtx,this.sheetCtx);var horizonAlignPos=Math.round(start_c+(end_c-start_c)/2+offsetLeft-textMetrics.width/2);var verticalAlignPos=Math.round(this.sheetCtx.columnHeaderHeight/2);renderCtx.fillText(abc,horizonAlignPos/this.sheetCtx.zoomRatio,verticalAlignPos/this.sheetCtx.zoomRatio);renderCtx.restore();}if(this.sheetCtx.config.colhidden&&this.sheetCtx.config.colhidden[c]!=null&&this.sheetCtx.config.colhidden[c+1]!=null){renderCtx.beginPath();renderCtx.moveTo(end_c+offsetLeft-4+bodrder05,0);renderCtx.lineTo(end_c+offsetLeft-4+bodrder05,this.sheetCtx.columnHeaderHeight-2);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.closePath();renderCtx.stroke();}else if(this.sheetCtx.config.colhidden==null||this.sheetCtx.config.colhidden[c]==null){renderCtx.beginPath();renderCtx.moveTo(end_c+offsetLeft-2+bodrder05,0);renderCtx.lineTo(end_c+offsetLeft-2+bodrder05,this.sheetCtx.columnHeaderHeight-2);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.closePath();renderCtx.stroke();}if(((_this$sheetCtx$config7=this.sheetCtx.config)===null||_this$sheetCtx$config7===void 0?void 0:(_this$sheetCtx$config8=_this$sheetCtx$config7.colhidden)===null||_this$sheetCtx$config8===void 0?void 0:_this$sheetCtx$config8[c-1])!=null&&preEndC!==undefined){renderCtx.beginPath();renderCtx.moveTo(preEndC+offsetLeft+bodrder05,0);renderCtx.lineTo(preEndC+offsetLeft+bodrder05,this.sheetCtx.columnHeaderHeight-2);renderCtx.closePath();renderCtx.stroke();}renderCtx.beginPath();renderCtx.moveTo(start_c+offsetLeft-1,this.sheetCtx.columnHeaderHeight-2+bodrder05);renderCtx.lineTo(end_c+offsetLeft-1,this.sheetCtx.columnHeaderHeight-2+bodrder05);renderCtx.stroke();renderCtx.closePath();preEndC=end_c;(_this$sheetCtx$hooks$4=(_this$sheetCtx$hooks4=this.sheetCtx.hooks).afterRenderColumnHeaderCell)===null||_this$sheetCtx$hooks$4===void 0?void 0:_this$sheetCtx$hooks$4.call(_this$sheetCtx$hooks4,abc,c,start_c+offsetLeft-1,end_c-start_c,this.sheetCtx.columnHeaderHeight-1,renderCtx);}renderCtx.restore();renderCtx.restore();}},{key:"drawMain",value:function drawMain(_ref){var _this$sheetCtx$hooks$5,_this$sheetCtx$hooks5,_this$sheetCtx$config15,_this$sheetCtx$config16,_this$sheetCtx$config17,_this=this;var scrollWidth=_ref.scrollWidth,scrollHeight=_ref.scrollHeight,drawWidth=_ref.drawWidth,drawHeight=_ref.drawHeight,offsetLeft=_ref.offsetLeft,offsetTop=_ref.offsetTop,columnOffsetCell=_ref.columnOffsetCell,rowOffsetCell=_ref.rowOffsetCell,clear=_ref.clear;var flowdata=getFlowdata(this.sheetCtx);if(lodash.isNil(flowdata)){return;}clearTimeout(this.measureTextCacheTimeOut);if(drawWidth===undefined){var _this$sheetCtx$luckys3=_slicedToArray$3(this.sheetCtx.luckysheetTableContentHW,1);drawWidth=_this$sheetCtx$luckys3[0];}if(drawHeight===undefined){var _this$sheetCtx$luckys4=_slicedToArray$3(this.sheetCtx.luckysheetTableContentHW,2);drawHeight=_this$sheetCtx$luckys4[1];}if(offsetLeft===undefined){offsetLeft=this.sheetCtx.rowHeaderWidth;}if(offsetTop===undefined){offsetTop=this.sheetCtx.columnHeaderHeight;}if(columnOffsetCell===undefined){columnOffsetCell=0;}if(rowOffsetCell===undefined){rowOffsetCell=0;}var renderCtx=this.canvasElement.getContext("2d");if(!renderCtx)return;renderCtx.save();renderCtx.scale(this.sheetCtx.devicePixelRatio,this.sheetCtx.devicePixelRatio);if(clear){renderCtx.clearRect(0,0,this.sheetCtx.luckysheetTableContentHW[0],this.sheetCtx.luckysheetTableContentHW[1]);}var rowStart;var rowEnd;var colStart;var colEnd;rowStart=lodash.sortedIndex(this.sheetCtx.visibledatarow,scrollHeight);rowEnd=lodash.sortedIndex(this.sheetCtx.visibledatarow,scrollHeight+drawHeight);if(rowStart===-1){rowStart=0;}rowStart+=rowOffsetCell;if(rowEnd===-1){rowEnd=this.sheetCtx.visibledatarow.length-1;}rowEnd+=rowOffsetCell;if(rowEnd>=this.sheetCtx.visibledatarow.length){rowEnd=this.sheetCtx.visibledatarow.length-1;}colStart=lodash.sortedIndex(this.sheetCtx.visibledatacolumn,scrollWidth);colEnd=lodash.sortedIndex(this.sheetCtx.visibledatacolumn,scrollWidth+drawWidth);if(colStart===-1){colStart=0;}colStart+=columnOffsetCell;if(colEnd===-1){colEnd=this.sheetCtx.visibledatacolumn.length-1;}colEnd+=columnOffsetCell;if(colEnd>=this.sheetCtx.visibledatacolumn.length){colEnd=this.sheetCtx.visibledatacolumn.length-1;}var rowEndY=this.sheetCtx.visibledatarow[rowEnd];var colEndX=this.sheetCtx.visibledatacolumn[colEnd];renderCtx.fillStyle="#ffffff";renderCtx.fillRect(offsetLeft-1,offsetTop-1,colEndX-scrollWidth,rowEndY-scrollHeight);renderCtx.font=defaultFont(this.sheetCtx.defaultFontSize);renderCtx.fillStyle=defaultStyle.fillStyle;var cellupdate=[];var mergeCache={};var borderOffset={};var bodrder05=0.5;(_this$sheetCtx$hooks$5=(_this$sheetCtx$hooks5=this.sheetCtx.hooks).beforeRenderCellArea)===null||_this$sheetCtx$hooks$5===void 0?void 0:_this$sheetCtx$hooks$5.call(_this$sheetCtx$hooks5,flowdata,renderCtx);for(var r=rowStart;r<=rowEnd;r+=1){var _this$sheetCtx$config9,_this$sheetCtx$config10;var startY=void 0;if(r===0){startY=-scrollHeight-1;}else {startY=this.sheetCtx.visibledatarow[r-1]-scrollHeight-1;}var endY=this.sheetCtx.visibledatarow[r]-scrollHeight;if(((_this$sheetCtx$config9=this.sheetCtx.config)===null||_this$sheetCtx$config9===void 0?void 0:(_this$sheetCtx$config10=_this$sheetCtx$config9.rowhidden)===null||_this$sheetCtx$config10===void 0?void 0:_this$sheetCtx$config10[r])!=null){continue;}for(var c=colStart;c<=colEnd;c+=1){var _this$sheetCtx$config11,_this$sheetCtx$config12,_this$sheetCtx$config13,_this$sheetCtx$config14,_flowdata$r;var startX=void 0;if(c===0){startX=-scrollWidth;}else {startX=this.sheetCtx.visibledatacolumn[c-1]-scrollWidth;}var endX=this.sheetCtx.visibledatacolumn[c]-scrollWidth;if(((_this$sheetCtx$config11=this.sheetCtx.config)===null||_this$sheetCtx$config11===void 0?void 0:(_this$sheetCtx$config12=_this$sheetCtx$config11.colhidden)===null||_this$sheetCtx$config12===void 0?void 0:_this$sheetCtx$config12[c])!=null){continue;}var firstcolumnlen=this.sheetCtx.defaultcollen;if((_this$sheetCtx$config13=this.sheetCtx.config)===null||_this$sheetCtx$config13===void 0?void 0:(_this$sheetCtx$config14=_this$sheetCtx$config13.columnlen)===null||_this$sheetCtx$config14===void 0?void 0:_this$sheetCtx$config14[c]){firstcolumnlen=this.sheetCtx.config.columnlen[c];}if(flowdata===null||flowdata===void 0?void 0:(_flowdata$r=flowdata[r])===null||_flowdata$r===void 0?void 0:_flowdata$r[c]){var value=flowdata[r][c];if(value===null||value===void 0?void 0:value.mc){borderOffset["".concat(r,"_").concat(c)]={startY:startY,startX:startX,endY:endY,endX:endX};if("rs"in value.mc){var key="r".concat(r,"c").concat(c);mergeCache[key]=cellupdate.length;}else {var _key="r".concat(value.mc.r,"c").concat(value.mc.c);var margeMain=cellupdate[mergeCache[_key]];if(lodash.isNil(margeMain)){mergeCache[_key]=cellupdate.length;cellupdate.push({r:r,c:c,startX:startX,startY:startY,endY:endY,endX:endX,firstcolumnlen:firstcolumnlen});}else {if(margeMain.c===c){margeMain.endY+=endY-startY-1;}if(margeMain.r===r){margeMain.endX+=endX-startX;margeMain.firstcolumnlen+=firstcolumnlen;}}continue;}}}cellupdate.push({r:r,c:c,startY:startY,startX:startX,endY:endY,endX:endX,firstcolumnlen:firstcolumnlen});borderOffset["".concat(r,"_").concat(c)]={startY:startY,startX:startX,endY:endY,endX:endX};}}var dynamicArrayCompute={};var afCompute={};var cfCompute={};var cellOverflowMap=this.getCellOverflowMap(renderCtx,colStart,colEnd,rowStart,rowEnd);var mcArr=[];for(var cud=0;cud<cellupdate.length;cud+=1){var item=cellupdate[cud];var _r=item.r;var _c=item.c;var _startY=item.startY;var _startX=item.startX;var _endY=item.endY;var _endX=item.endX;if(lodash.isNil(flowdata[_r])){continue;}if(lodash.isNil(flowdata[_r][_c])){this.nullCellRender(_r,_c,_startY,_startX,_endY,_endX,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05);}else {var cell=flowdata[_r][_c];var _value2=null;if(cell===null||cell===void 0?void 0:cell.mc){mcArr.push(cellupdate[cud]);}else {_value2=getRealCellValue(_r,_c,flowdata);}if(lodash.isNil(_value2)||_value2.toString().length===0){this.nullCellRender(_r,_c,_startY,_startX,_endY,_endX,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05);}else {if("".concat(_r,"_").concat(_c)in dynamicArrayCompute){_value2=dynamicArrayCompute["".concat(_r,"_").concat(_c)].v;}this.cellRender(_r,_c,_startY,_startX,_endY,_endX,_value2,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05);}}}for(var m=0;m<mcArr.length;m+=1){var _mainCell$mc,_mainCell$mc2;var _item=mcArr[m];var _r2=_item.r;var _c2=_item.c;var _startY2=_item.startY;var _startX2=_item.startX;var _endY2=_item.endY-1;var _endX2=_item.endX-1;var _cell=flowdata[_r2][_c2];if(!_cell)continue;var _value3=null;var mergeMaindata=_cell.mc;if(!mergeMaindata)continue;_value3=getRealCellValue(mergeMaindata.r,mergeMaindata.c,flowdata);_r2=mergeMaindata.r;_c2=mergeMaindata.c;var mainCell=flowdata[_r2][_c2];if(!(mainCell===null||mainCell===void 0?void 0:(_mainCell$mc=mainCell.mc)===null||_mainCell$mc===void 0?void 0:_mainCell$mc.rs)||!((_mainCell$mc2=mainCell.mc)===null||_mainCell$mc2===void 0?void 0:_mainCell$mc2.cs)){continue;}if(_c2===0){_startX2=-scrollWidth;}else {_startX2=this.sheetCtx.visibledatacolumn[_c2-1]-scrollWidth;}if(_r2===0){_startY2=-scrollHeight-1;}else {_startY2=this.sheetCtx.visibledatarow[_r2-1]-scrollHeight-1;}_endY2=this.sheetCtx.visibledatarow[_r2+mainCell.mc.rs-1]-scrollHeight;_endX2=this.sheetCtx.visibledatacolumn[_c2+mainCell.mc.cs-1]-scrollWidth;if(lodash.isNil(_value3)||_value3.toString().length===0){this.nullCellRender(_r2,_c2,_startY2,_startX2,_endY2,_endX2,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05,true);}else {if("".concat(_r2,"_").concat(_c2)in dynamicArrayCompute){_value3=dynamicArrayCompute["".concat(_r2,"_").concat(_c2)].v;}this.cellRender(_r2,_c2,_startY2,_startX2,_endY2,_endX2,_value3,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05,true);}}if(((_this$sheetCtx$config15=(_this$sheetCtx$config16=this.sheetCtx.config)===null||_this$sheetCtx$config16===void 0?void 0:(_this$sheetCtx$config17=_this$sheetCtx$config16.borderInfo)===null||_this$sheetCtx$config17===void 0?void 0:_this$sheetCtx$config17.length)!==null&&_this$sheetCtx$config15!==void 0?_this$sheetCtx$config15:0)>0){var borderLeftRender=function borderLeftRender(style,color,startY,startX,endY,endX,_offsetLeft,_offsetTop,canvas){var linetype=style;var moveStart=startX-2+bodrder05+_offsetLeft;var moveEnd=startY+_offsetTop-1;var lineStart=startX-2+bodrder05+_offsetLeft;var lineEnd=endY-2+bodrder05+_offsetTop;canvas.save();setLineDash(canvas,linetype,"v",moveStart,moveEnd,lineStart,lineEnd);canvas.strokeStyle=color;canvas.stroke();canvas.closePath();canvas.restore();};var borderRightRender=function borderRightRender(style,color,startY,startX,endY,endX,_offsetLeft,_offsetTop,canvas){var linetype=style;var moveStart=endX-2+bodrder05+_offsetLeft;var moveEnd=startY+_offsetTop-1;var lineStart=endX-2+bodrder05+_offsetLeft;var lineEnd=endY-2+bodrder05+_offsetTop;canvas.save();setLineDash(canvas,linetype,"v",moveStart,moveEnd,lineStart,lineEnd);canvas.strokeStyle=color;canvas.stroke();canvas.closePath();canvas.restore();};var borderBottomRender=function borderBottomRender(style,color,startY,startX,endY,endX,_offsetLeft,_offsetTop,canvas){var linetype=style;var moveStart=startX-2+bodrder05+_offsetLeft;var moveEnd=endY-2+bodrder05+_offsetTop;var lineStart=endX-2+bodrder05+_offsetLeft;var lineEnd=endY-2+bodrder05+_offsetTop;canvas.save();setLineDash(canvas,linetype,"h",moveStart,moveEnd,lineStart,lineEnd);canvas.strokeStyle=color;canvas.stroke();canvas.closePath();canvas.restore();};var borderTopRender=function borderTopRender(style,color,startY,startX,endY,endX,_offsetLeft,_offsetTop,canvas){var linetype=style;var moveStart=startX-2+bodrder05+_offsetLeft;var moveEnd=startY-1+bodrder05+_offsetTop;var lineStart=endX-2+bodrder05+_offsetLeft;var lineEnd=startY-1+bodrder05+_offsetTop;canvas.save();setLineDash(canvas,linetype,"h",moveStart,moveEnd,lineStart,lineEnd);canvas.strokeStyle=color;canvas.stroke();canvas.closePath();canvas.restore();};var borderInfoCompute=getBorderInfoComputeRange(this.sheetCtx,rowStart,rowEnd,colStart,colEnd);Object.keys(borderInfoCompute).forEach(function(x){var bdRow=Number(x.substring(0,x.indexOf("_")));var bdCol=Number(x.substring(x.indexOf("_")+1));if(borderOffset["".concat(bdRow,"_").concat(bdCol)]){var _startY3=borderOffset["".concat(bdRow,"_").concat(bdCol)].startY;var _startX3=borderOffset["".concat(bdRow,"_").concat(bdCol)].startX;var _endY3=borderOffset["".concat(bdRow,"_").concat(bdCol)].endY;var _endX3=borderOffset["".concat(bdRow,"_").concat(bdCol)].endX;var cellOverflow_colInObj=_this.cellOverflow_colIn(cellOverflowMap,bdRow,bdCol,colStart,colEnd);var borderLeft=borderInfoCompute[x].l;if(borderLeft&&(!cellOverflow_colInObj.colIn||cellOverflow_colInObj.stc===bdCol)){borderLeftRender(borderLeft.style,borderLeft.color,_startY3,_startX3,_endY3,_endX3,offsetLeft,offsetTop,renderCtx);}var borderRight=borderInfoCompute[x].r;if(borderRight&&(!cellOverflow_colInObj.colIn||cellOverflow_colInObj.colLast)){borderRightRender(borderRight.style,borderRight.color,_startY3,_startX3,_endY3,_endX3,offsetLeft,offsetTop,renderCtx);}var borderTop=borderInfoCompute[x].t;if(borderTop){borderTopRender(borderTop.style,borderTop.color,_startY3,_startX3,_endY3,_endX3,offsetLeft,offsetTop,renderCtx);}var borderBottom=borderInfoCompute[x].b;if(borderBottom){borderBottomRender(borderBottom.style,borderBottom.color,_startY3,_startX3,_endY3,_endX3,offsetLeft,offsetTop,renderCtx);}}});}if(colEnd===this.sheetCtx.visibledatacolumn.length-1){renderCtx.clearRect(colEndX-scrollWidth+offsetLeft-1,offsetTop-1,this.sheetCtx.ch_width-this.sheetCtx.visibledatacolumn[colEnd],rowEndY-scrollHeight);}renderCtx.restore();this.measureTextCacheTimeOut=setTimeout(function(){clearMeasureTextCache();_this.cellOverflowMapCache={};},100);}},{key:"getCellOverflowMap",value:function getCellOverflowMap(canvas,colStart,colEnd,rowStart,rowEnd){var flowdata=getFlowdata(this.sheetCtx);var map={};var data=flowdata;if(!data){return map;}for(var r=rowStart;r<=rowEnd;r+=1){if(lodash.isNil(data[r])){continue;}if(this.cellOverflowMapCache[r]){map[r]=this.cellOverflowMapCache[r];continue;}var hasCellOver=false;for(var c=0;c<data[r].length;c+=1){var _this$sheetCtx$config18,_this$sheetCtx$config19;var cell=data[r][c];if(((_this$sheetCtx$config18=this.sheetCtx.config)===null||_this$sheetCtx$config18===void 0?void 0:(_this$sheetCtx$config19=_this$sheetCtx$config18.colhidden)===null||_this$sheetCtx$config19===void 0?void 0:_this$sheetCtx$config19[c])!=null){continue;}if(cell&&(!lodash.isEmpty(cell.v)||isInlineStringCell(cell))&&lodash.isNil(cell.mc)&&cell.tb==="1"){var horizonAlign=normalizedAttr(data,r,c,"ht");var textMetricsObj=getCellTextInfo(cell,canvas,this.sheetCtx,{r:r,c:c});var textMetrics=0;if(textMetricsObj){textMetrics=textMetricsObj.textWidthAll;}var startX=c-1<0?0:this.sheetCtx.visibledatacolumn[c-1];var endX=this.sheetCtx.visibledatacolumn[c];var stc=void 0;var edc=void 0;if(endX-startX<textMetrics){if(horizonAlign==="0"){var trace_forward=this.cellOverflow_trace(r,c,c-1,"forward",horizonAlign,textMetrics);var trace_backward=this.cellOverflow_trace(r,c,c+1,"backward",horizonAlign,textMetrics);if(trace_forward.success){stc=trace_forward.c;}else {stc=trace_forward.c+1;}if(trace_backward.success){edc=trace_backward.c;}else {edc=trace_backward.c-1;}}else if(horizonAlign==="1"){var trace=this.cellOverflow_trace(r,c,c+1,"backward",horizonAlign,textMetrics);stc=c;if(trace.success){edc=trace.c;}else {edc=trace.c-1;}}else if(horizonAlign==="2"){var _trace=this.cellOverflow_trace(r,c,c-1,"forward",horizonAlign,textMetrics);edc=c;if(_trace.success){stc=_trace.c;}else {stc=_trace.c+1;}}}else {stc=c;edc=c;}if((stc<=colEnd||edc>=colStart)&&stc<edc){var item={r:r,stc:stc,edc:edc};if(lodash.isNil(map[r])){map[r]={};}map[r][c]=item;hasCellOver=true;}}}if(hasCellOver){this.cellOverflowMapCache[r]=map[r];}}return map;}},{key:"nullCellRender",value:function nullCellRender(r,c,startY,startX,endY,endX,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05){var _this$sheetCtx$hooks$6,_this$sheetCtx$hooks6,_flowdata$r2,_flowdata$r2$c,_this$sheetCtx$hooks$7,_this$sheetCtx$hooks7;var isMerge=arguments.length>18&&arguments[18]!==undefined?arguments[18]:false;var flowdata=getFlowdata(this.sheetCtx);if(!flowdata)return;var borderfix=getBorderFix(flowdata,r,c);var fillStyle=normalizedAttr(flowdata,r,c,"bg");if(!fillStyle){renderCtx.fillStyle="#FFFFFF";}else {renderCtx.fillStyle=fillStyle;}var cellsize=[startX+offsetLeft+borderfix[0],startY+offsetTop+borderfix[1],endX-startX+borderfix[2]-(isMerge?1:0),endY-startY+borderfix[3]];if(((_this$sheetCtx$hooks$6=(_this$sheetCtx$hooks6=this.sheetCtx.hooks).beforeRenderCell)===null||_this$sheetCtx$hooks$6===void 0?void 0:_this$sheetCtx$hooks$6.call(_this$sheetCtx$hooks6,flowdata[r][c],{row:r,column:c,startX:cellsize[0],startY:cellsize[1],endX:cellsize[2]+cellsize[0],endY:cellsize[3]+cellsize[1]},renderCtx))===false){return;}renderCtx.fillRect(cellsize[0],cellsize[1],cellsize[2],cellsize[3]);if("".concat(r,"_").concat(c)in dynamicArrayCompute){var value=dynamicArrayCompute["".concat(r,"_").concat(c)].v;renderCtx.fillStyle="#000000";var fontset=defaultFont(this.sheetCtx.defaultFontSize);renderCtx.font=fontset;var horizonAlignPos=startX+4+offsetLeft;var verticalAlignPos=endY+offsetTop-2;renderCtx.textBaseline="bottom";renderCtx.fillText(lodash.isNil(value)?"":value,horizonAlignPos,verticalAlignPos);}if(flowdata===null||flowdata===void 0?void 0:(_flowdata$r2=flowdata[r])===null||_flowdata$r2===void 0?void 0:(_flowdata$r2$c=_flowdata$r2[c])===null||_flowdata$r2$c===void 0?void 0:_flowdata$r2$c.ps){var ps_w=8*this.sheetCtx.zoomRatio;var ps_h=8*this.sheetCtx.zoomRatio;renderCtx.beginPath();renderCtx.moveTo(endX+offsetLeft-1-ps_w,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft-1,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft-1,startY+offsetTop+ps_h);renderCtx.fillStyle="#FC6666";renderCtx.fill();renderCtx.closePath();}var cellOverflow_colInObj=this.cellOverflow_colIn(cellOverflowMap,r,c,colStart,colEnd);if(cellOverflow_colInObj.colLast&&!lodash.isNil(cellOverflow_colInObj.rowIndex)&&!lodash.isNil(cellOverflow_colInObj.colIndex)&&!lodash.isNil(cellOverflow_colInObj.stc)&&!lodash.isNil(cellOverflow_colInObj.edc)){this.cellOverflowRender(cellOverflow_colInObj.rowIndex,cellOverflow_colInObj.colIndex,cellOverflow_colInObj.stc,cellOverflow_colInObj.edc,renderCtx,scrollHeight,scrollWidth,offsetLeft,offsetTop,afCompute,cfCompute);}if(!cellOverflow_colInObj.colIn||cellOverflow_colInObj.colLast){if(!this.sheetCtx.luckysheetcurrentisPivotTable&&!fillStyle&&this.sheetCtx.showGridLines){renderCtx.beginPath();renderCtx.moveTo(endX+offsetLeft-2+bodrder05,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft-2+bodrder05,endY+offsetTop);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.stroke();renderCtx.closePath();}}if(!this.sheetCtx.luckysheetcurrentisPivotTable&&!fillStyle&&this.sheetCtx.showGridLines){renderCtx.beginPath();renderCtx.moveTo(startX+offsetLeft-1,endY+offsetTop-2+bodrder05);renderCtx.lineTo(endX+offsetLeft-1,endY+offsetTop-2+bodrder05);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.stroke();renderCtx.closePath();}(_this$sheetCtx$hooks$7=(_this$sheetCtx$hooks7=this.sheetCtx.hooks).afterRenderCell)===null||_this$sheetCtx$hooks$7===void 0?void 0:_this$sheetCtx$hooks$7.call(_this$sheetCtx$hooks7,flowdata[r][c],{row:r,column:c,startY:cellsize[1],startX:cellsize[0],endY:cellsize[3]+cellsize[1],endX:cellsize[2]+cellsize[0]},renderCtx);}},{key:"cellRender",value:function cellRender(r,c,startY,startX,endY,endX,value,renderCtx,afCompute,cfCompute,offsetLeft,offsetTop,dynamicArrayCompute,cellOverflowMap,colStart,colEnd,scrollHeight,scrollWidth,bodrder05){var _this$sheetCtx$hooks$8,_this$sheetCtx$hooks8,_dataVerification$,_this$sheetCtx$hooks$9,_this$sheetCtx$hooks9,_flowdata$r3;var isMerge=arguments.length>19&&arguments[19]!==undefined?arguments[19]:false;var flowdata=getFlowdata(this.sheetCtx);if(!flowdata){return;}var cell=flowdata[r][c];var cellWidth=endX-startX-2;var cellHeight=endY-startY-2;var space_width=2;var space_height=2;var horizonAlign=Number(normalizedAttr(flowdata,r,c,"ht"));var verticalAlign=Number(normalizedAttr(flowdata,r,c,"vt"));var checksAF={};var checksCF={};var fillStyle=normalizedAttr(flowdata,r,c,"bg");if(!fillStyle){renderCtx.fillStyle="#FFFFFF";}else {renderCtx.fillStyle=fillStyle;}var borderfix=getBorderFix(flowdata,r,c);var cellsize=[startX+offsetLeft+borderfix[0],startY+offsetTop+borderfix[1],endX-startX+borderfix[2]-(isMerge?1:0),endY-startY+borderfix[3]];if(((_this$sheetCtx$hooks$8=(_this$sheetCtx$hooks8=this.sheetCtx.hooks).beforeRenderCell)===null||_this$sheetCtx$hooks$8===void 0?void 0:_this$sheetCtx$hooks$8.call(_this$sheetCtx$hooks8,flowdata[r][c],{row:r,column:c,startY:cellsize[1],startX:cellsize[0],endY:cellsize[3]+cellsize[1],endX:cellsize[2]+cellsize[0]},renderCtx))===false){return;}renderCtx.fillRect(cellsize[0],cellsize[1],cellsize[2],cellsize[3]);var dataVerification={};if(cell===null||cell===void 0?void 0:cell.ps){var ps_w=8*this.sheetCtx.zoomRatio;var ps_h=8*this.sheetCtx.zoomRatio;renderCtx.beginPath();renderCtx.moveTo(endX+offsetLeft-ps_w,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft,startY+offsetTop+ps_h);renderCtx.fillStyle="#FC6666";renderCtx.fill();renderCtx.closePath();}if((cell===null||cell===void 0?void 0:cell.qp)===1&&isRealNum$1(cell===null||cell===void 0?void 0:cell.v)){var _ps_w=6*this.sheetCtx.zoomRatio;var _ps_h=6*this.sheetCtx.zoomRatio;renderCtx.beginPath();renderCtx.moveTo(startX+offsetLeft+_ps_w-1,startY+offsetTop);renderCtx.lineTo(startX+offsetLeft-1,startY+offsetTop);renderCtx.lineTo(startX+offsetLeft-1,startY+offsetTop+_ps_h);renderCtx.fillStyle="#487f1e";renderCtx.fill();renderCtx.closePath();}var cellOverflow_bd_r_render=true;var cellOverflow_colInObj=this.cellOverflow_colIn(cellOverflowMap,r,c,colStart,colEnd);if((cell===null||cell===void 0?void 0:cell.tb)==="1"&&cellOverflow_colInObj.colIn){if(cellOverflow_colInObj.colLast&&!lodash.isNil(cellOverflow_colInObj.rowIndex)&&!lodash.isNil(cellOverflow_colInObj.colIndex)&&!lodash.isNil(cellOverflow_colInObj.stc)&&!lodash.isNil(cellOverflow_colInObj.edc)){this.cellOverflowRender(cellOverflow_colInObj.rowIndex,cellOverflow_colInObj.colIndex,cellOverflow_colInObj.stc,cellOverflow_colInObj.edc,renderCtx,scrollHeight,scrollWidth,offsetLeft,offsetTop,afCompute,cfCompute);}else {cellOverflow_bd_r_render=false;}}else if((dataVerification===null||dataVerification===void 0?void 0:(_dataVerification$=dataVerification["".concat(r,"_").concat(c)])===null||_dataVerification$===void 0?void 0:_dataVerification$.type)==="checkbox"){var pos_x=startX+offsetLeft;var pos_y=startY+offsetTop+1;renderCtx.save();renderCtx.beginPath();renderCtx.rect(pos_x,pos_y,cellWidth,cellHeight);renderCtx.clip();renderCtx.scale(this.sheetCtx.zoomRatio,this.sheetCtx.zoomRatio);var measureText=getMeasureText(value,renderCtx,this.sheetCtx);var textMetrics=measureText.width+14;var oneLineTextHeight=measureText.actualBoundingBoxDescent+measureText.actualBoundingBoxAscent;var horizonAlignPos=pos_x+space_width;if(horizonAlign===0){horizonAlignPos=pos_x+cellWidth/2-textMetrics/2;}else if(horizonAlign===2){horizonAlignPos=pos_x+cellWidth-space_width-textMetrics;}var verticalCellHeight=cellHeight>oneLineTextHeight?cellHeight:oneLineTextHeight;var verticalAlignPos_text=pos_y+verticalCellHeight-space_height;renderCtx.textBaseline="bottom";var verticalAlignPos_checkbox=verticalAlignPos_text-13*this.sheetCtx.zoomRatio;if(verticalAlign===0){verticalAlignPos_text=pos_y+verticalCellHeight/2;renderCtx.textBaseline="middle";verticalAlignPos_checkbox=verticalAlignPos_text-6*this.sheetCtx.zoomRatio;}else if(verticalAlign===1){verticalAlignPos_text=pos_y+space_height;renderCtx.textBaseline="top";verticalAlignPos_checkbox=verticalAlignPos_text+1*this.sheetCtx.zoomRatio;}horizonAlignPos/=this.sheetCtx.zoomRatio;verticalAlignPos_text/=this.sheetCtx.zoomRatio;verticalAlignPos_checkbox/=this.sheetCtx.zoomRatio;renderCtx.lineWidth=1;renderCtx.strokeStyle="#000";renderCtx.strokeRect(horizonAlignPos,verticalAlignPos_checkbox,10,10);if(dataVerification["".concat(r,"_").concat(c)].checked){renderCtx.beginPath();renderCtx.lineTo(horizonAlignPos+1,verticalAlignPos_checkbox+6);renderCtx.lineTo(horizonAlignPos+4,verticalAlignPos_checkbox+9);renderCtx.lineTo(horizonAlignPos+9,verticalAlignPos_checkbox+2);renderCtx.stroke();renderCtx.closePath();}renderCtx.fillStyle=normalizedAttr(flowdata,r,c,"fc");renderCtx.fillText(lodash.isNil(value)?"":value,horizonAlignPos+14,verticalAlignPos_text);renderCtx.restore();}else {var _checksCF$dataBar,_checksCF$dataBar2,_checksCF$dataBar2$va,_cell$ct$fa$indexOf,_cell$ct,_cell$ct$fa,_cell$ct2;if((checksCF===null||checksCF===void 0?void 0:(_checksCF$dataBar=checksCF.dataBar)===null||_checksCF$dataBar===void 0?void 0:_checksCF$dataBar.valueLen)&&(checksCF===null||checksCF===void 0?void 0:(_checksCF$dataBar2=checksCF.dataBar)===null||_checksCF$dataBar2===void 0?void 0:(_checksCF$dataBar2$va=_checksCF$dataBar2.valueLen)===null||_checksCF$dataBar2$va===void 0?void 0:_checksCF$dataBar2$va.toString())!=="NaN"){var x=startX+offsetLeft+space_width;var y=startY+offsetTop+space_height;var w=cellWidth-space_width*2;var h=cellHeight-space_height*2;var valueType=checksCF.dataBar.valueType;var valueLen=checksCF.dataBar.valueLen;var format=checksCF.dataBar.format;if(valueType==="minus"){var minusLen=checksCF.dataBar.minusLen;if(format.length>1){var my_gradient=renderCtx.createLinearGradient(x+w*minusLen*(1-valueLen),y,x+w*minusLen,y);my_gradient.addColorStop(0,"#ffffff");my_gradient.addColorStop(1,"#ff0000");renderCtx.fillStyle=my_gradient;}else {renderCtx.fillStyle="#ff0000";}renderCtx.fillRect(x+w*minusLen*(1-valueLen),y,w*minusLen*valueLen,h);renderCtx.beginPath();renderCtx.moveTo(x+w*minusLen*(1-valueLen),y);renderCtx.lineTo(x+w*minusLen*(1-valueLen),y+h);renderCtx.lineTo(x+w*minusLen,y+h);renderCtx.lineTo(x+w*minusLen,y);renderCtx.lineTo(x+w*minusLen*(1-valueLen),y);renderCtx.lineWidth=1;renderCtx.strokeStyle="#ff0000";renderCtx.stroke();renderCtx.closePath();}else if(valueType==="plus"){var plusLen=checksCF.dataBar.plusLen;if(plusLen===1){if(format.length>1){var _my_gradient=renderCtx.createLinearGradient(x,y,x+w*valueLen,y);_my_gradient.addColorStop(0,format[0]);_my_gradient.addColorStop(1,format[1]);renderCtx.fillStyle=_my_gradient;}else {var _format=_slicedToArray$3(format,1);renderCtx.fillStyle=_format[0];}renderCtx.fillRect(x,y,w*valueLen,h);renderCtx.beginPath();renderCtx.moveTo(x,y);renderCtx.lineTo(x,y+h);renderCtx.lineTo(x+w*valueLen,y+h);renderCtx.lineTo(x+w*valueLen,y);renderCtx.lineTo(x,y);renderCtx.lineWidth=1;var _format2=_slicedToArray$3(format,1);renderCtx.strokeStyle=_format2[0];renderCtx.stroke();renderCtx.closePath();}else {var _minusLen=checksCF.dataBar.minusLen;if(format.length>1){var _my_gradient2=renderCtx.createLinearGradient(x+w*_minusLen,y,x+w*_minusLen+w*plusLen*valueLen,y);_my_gradient2.addColorStop(0,format[0]);_my_gradient2.addColorStop(1,format[1]);renderCtx.fillStyle=_my_gradient2;}else {var _format3=_slicedToArray$3(format,1);renderCtx.fillStyle=_format3[0];}renderCtx.fillRect(x+w*_minusLen,y,w*plusLen*valueLen,h);renderCtx.beginPath();renderCtx.moveTo(x+w*_minusLen,y);renderCtx.lineTo(x+w*_minusLen,y+h);renderCtx.lineTo(x+w*_minusLen+w*plusLen*valueLen,y+h);renderCtx.lineTo(x+w*_minusLen+w*plusLen*valueLen,y);renderCtx.lineTo(x+w*_minusLen,y);renderCtx.lineWidth=1;var _format4=_slicedToArray$3(format,1);renderCtx.strokeStyle=_format4[0];renderCtx.stroke();renderCtx.closePath();}}}var _pos_x=startX+offsetLeft;var _pos_y=startY+offsetTop+1;renderCtx.save();renderCtx.beginPath();renderCtx.rect(_pos_x,_pos_y,cellWidth,cellHeight);renderCtx.clip();renderCtx.scale(this.sheetCtx.zoomRatio,this.sheetCtx.zoomRatio);var textInfo=cell?getCellTextInfo(cell,renderCtx,this.sheetCtx,{cellWidth:cellWidth,cellHeight:cellHeight,space_width:space_width,space_height:space_height,r:r,c:c}):undefined;if((checksCF===null||checksCF===void 0?void 0:checksCF.icons)&&textInfo.type==="plain"){var l=checksCF.icons.left;var t=checksCF.icons.top;var _value=textInfo.values[0];var verticalAlignPos=_pos_y+_value.top-textInfo.textHeightAll;if(verticalAlign===0){verticalAlignPos=_pos_y+cellHeight/2-textInfo.textHeightAll/2;}else if(verticalAlign===1){verticalAlignPos=_pos_y;}else if(verticalAlign===2){verticalAlignPos-=textInfo.desc;}verticalAlignPos/=this.sheetCtx.zoomRatio;renderCtx.drawImage(getCfIconsImg(),l*42,t*32,32,32,_pos_x/this.sheetCtx.zoomRatio,verticalAlignPos,textInfo.textHeightAll/this.sheetCtx.zoomRatio,textInfo.textHeightAll/this.sheetCtx.zoomRatio);}renderCtx.fillStyle=normalizedAttr(flowdata,r,c,"fc");if(checksAF===null||checksAF===void 0?void 0:checksAF[0]){var _checksAF=_slicedToArray$3(checksAF,1);renderCtx.fillStyle=_checksAF[0];}if(checksCF===null||checksCF===void 0?void 0:checksCF.textColor){renderCtx.fillStyle=checksCF.textColor;}if(((_cell$ct$fa$indexOf=cell===null||cell===void 0?void 0:(_cell$ct=cell.ct)===null||_cell$ct===void 0?void 0:(_cell$ct$fa=_cell$ct.fa)===null||_cell$ct$fa===void 0?void 0:_cell$ct$fa.indexOf("[Red]"))!==null&&_cell$ct$fa$indexOf!==void 0?_cell$ct$fa$indexOf:-1)>-1&&(cell===null||cell===void 0?void 0:(_cell$ct2=cell.ct)===null||_cell$ct2===void 0?void 0:_cell$ct2.t)==="n"&&(cell===null||cell===void 0?void 0:cell.v)<0){renderCtx.fillStyle="#ff0000";}this.cellTextRender(textInfo,renderCtx,{pos_x:_pos_x,pos_y:_pos_y});renderCtx.restore();}if(cellOverflow_bd_r_render){if(!this.sheetCtx.luckysheetcurrentisPivotTable&&!fillStyle&&this.sheetCtx.showGridLines){renderCtx.beginPath();renderCtx.moveTo(endX+offsetLeft-2+bodrder05,startY+offsetTop);renderCtx.lineTo(endX+offsetLeft-2+bodrder05,endY+offsetTop);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.stroke();renderCtx.closePath();}}if(!this.sheetCtx.luckysheetcurrentisPivotTable&&!fillStyle&&this.sheetCtx.showGridLines){renderCtx.beginPath();renderCtx.moveTo(startX+offsetLeft-1,endY+offsetTop-2+bodrder05);renderCtx.lineTo(endX+offsetLeft-1,endY+offsetTop-2+bodrder05);renderCtx.lineWidth=1;renderCtx.strokeStyle=defaultStyle.strokeStyle;renderCtx.stroke();renderCtx.closePath();}(_this$sheetCtx$hooks$9=(_this$sheetCtx$hooks9=this.sheetCtx.hooks).afterRenderCell)===null||_this$sheetCtx$hooks$9===void 0?void 0:_this$sheetCtx$hooks$9.call(_this$sheetCtx$hooks9,(_flowdata$r3=flowdata[r])===null||_flowdata$r3===void 0?void 0:_flowdata$r3[c],{row:r,column:c,startX:cellsize[0],startY:cellsize[1],endX:cellsize[2]+cellsize[0],endY:cellsize[3]+cellsize[1]},renderCtx);}},{key:"cellOverflowRender",value:function cellOverflowRender(r,c,stc,edc,renderCtx,scrollHeight,scrollWidth,offsetLeft,offsetTop,afCompute,cfCompute){var startY;if(r===0){startY=-scrollHeight-1;}else {startY=this.sheetCtx.visibledatarow[r-1]-scrollHeight-1;}var endY=this.sheetCtx.visibledatarow[r]-scrollHeight;var startX;if(stc===0){startX=-scrollWidth;}else {startX=this.sheetCtx.visibledatacolumn[stc-1]-scrollWidth;}var endX=this.sheetCtx.visibledatacolumn[edc]-scrollWidth;var flowdata=getFlowdata(this.sheetCtx);if(!flowdata){return;}var cell=flowdata[r][c];var cellWidth=endX-startX-2;var cellHeight=endY-startY-2;var space_width=2;var space_height=2;var pos_x=startX+offsetLeft;var pos_y=startY+offsetTop+1;var fontset=getFontSet(cell,this.sheetCtx.defaultFontSize);renderCtx.font=fontset;renderCtx.save();renderCtx.beginPath();renderCtx.rect(pos_x,pos_y,cellWidth,cellHeight);renderCtx.clip();renderCtx.scale(this.sheetCtx.zoomRatio,this.sheetCtx.zoomRatio);var textInfo=cell?getCellTextInfo(cell,renderCtx,this.sheetCtx,{cellWidth:cellWidth,cellHeight:cellHeight,space_width:space_width,space_height:space_height,r:r,c:c}):undefined;var checksAF={};var checksCF={};renderCtx.fillStyle=normalizedAttr(flowdata,r,c,"fc");if(checksAF===null||checksAF===void 0?void 0:checksAF[0]){var _checksAF2=_slicedToArray$3(checksAF,1);renderCtx.fillStyle=_checksAF2[0];}if(checksCF===null||checksCF===void 0?void 0:checksCF.textColor){renderCtx.fillStyle=checksCF.textColor;}this.cellTextRender(textInfo,renderCtx,{pos_x:pos_x,pos_y:pos_y});renderCtx.restore();}},{key:"cellOverflow_trace",value:function cellOverflow_trace(r,curC,traceC,traceDir,horizonAlign,textMetrics){var flowdata=getFlowdata(this.sheetCtx);if(!flowdata)return {};var data=flowdata;if(traceDir==="forward"&&traceC<0){return {success:false,r:r,c:traceC};}if(traceDir==="backward"&&traceC>data[r].length-1){return {success:false,r:r,c:traceC};}var cell=data[r][traceC];if(cell&&(!lodash.isEmpty(cell.v)||cell.mc)){return {success:false,r:r,c:traceC};}var start_curC=curC-1<0?0:this.sheetCtx.visibledatacolumn[curC-1];var end_curC=this.sheetCtx.visibledatacolumn[curC];var w=textMetrics-(end_curC-start_curC);if(horizonAlign==="0"){start_curC-=w/2;end_curC+=w/2;}else if(horizonAlign==="1"){end_curC+=w;}else if(horizonAlign==="2"){start_curC-=w;}var start_traceC=traceC-1<0?0:this.sheetCtx.visibledatacolumn[traceC-1];var end_traceC=this.sheetCtx.visibledatacolumn[traceC];if(traceDir==="forward"){if(start_curC<start_traceC){return this.cellOverflow_trace(r,curC,traceC-1,traceDir,horizonAlign,textMetrics);}if(start_curC<end_traceC){return {success:true,r:r,c:traceC};}return {success:false,r:r,c:traceC};}if(traceDir==="backward"){if(end_curC>end_traceC){return this.cellOverflow_trace(r,curC,traceC+1,traceDir,horizonAlign,textMetrics);}if(end_curC>start_traceC){return {success:true,r:r,c:traceC};}return {success:false,r:r,c:traceC};}return null;}},{key:"cellOverflow_colIn",value:function cellOverflow_colIn(map,r,c,col_st,col_ed){var colIn=false;var colLast=false;var rowIndex;var colIndex;var stc;var edc;lodash.forEach(map,function(row,rkey){lodash.forEach(row,function(mapItem,ckey){rowIndex=Number(rkey);colIndex=Number(ckey);stc=mapItem.stc;edc=mapItem.edc;if(rowIndex===r){if(c>=stc&&c<=edc){colIn=true;if(c===edc||c===col_ed){colLast=true;return false;}}}return true;});return !colLast;});return {colIn:colIn,colLast:colLast,rowIndex:rowIndex,colIndex:colIndex,stc:stc,edc:edc};}},{key:"cellTextRender",value:function cellTextRender(textInfo,ctx,option){if(!textInfo){return;}var values=textInfo.values;var pos_x=option.pos_x;var pos_y=option.pos_y;if(!values){return;}if(textInfo.rotate!==0&&textInfo.type!=="verticalWrap"){ctx.save();ctx.translate((pos_x+textInfo.textLeftAll)/this.sheetCtx.zoomRatio,(pos_y+textInfo.textTopAll)/this.sheetCtx.zoomRatio);ctx.rotate(-textInfo.rotate*Math.PI/180);ctx.translate(-(textInfo.textLeftAll+pos_x)/this.sheetCtx.zoomRatio,-(pos_y+textInfo.textTopAll)/this.sheetCtx.zoomRatio);}for(var i=0;i<values.length;i+=1){var word=values[i];if(word.inline===true&&word.style){ctx.font=word.style.fontset;ctx.fillStyle=word.style.fc;}else {ctx.font=word.style;}var txt=lodash.isPlainObject(word.content)?word.content.m:word.content;ctx.fillText(txt,(pos_x+word.left)/this.sheetCtx.zoomRatio,(pos_y+word.top)/this.sheetCtx.zoomRatio);if(word.cancelLine){var c=word.cancelLine;ctx.beginPath();ctx.moveTo(Math.floor((pos_x+c.startX)/this.sheetCtx.zoomRatio)+0.5,Math.floor((pos_y+c.startY)/this.sheetCtx.zoomRatio)+0.5);ctx.lineTo(Math.floor((pos_x+c.endX)/this.sheetCtx.zoomRatio)+0.5,Math.floor((pos_y+c.endY)/this.sheetCtx.zoomRatio)+0.5);ctx.lineWidth=Math.floor(c.fs/9);ctx.strokeStyle=ctx.fillStyle;ctx.stroke();ctx.closePath();}if(word.underLine){var underLines=word.underLine;for(var a=0;a<underLines.length;a+=1){var item=underLines[a];ctx.beginPath();ctx.moveTo(Math.floor((pos_x+item.startX)/this.sheetCtx.zoomRatio)+0.5,Math.floor((pos_y+item.startY)/this.sheetCtx.zoomRatio));ctx.lineTo(Math.floor((pos_x+item.endX)/this.sheetCtx.zoomRatio)+0.5,Math.floor((pos_y+item.endY)/this.sheetCtx.zoomRatio)+0.5);ctx.lineWidth=Math.floor(item.fs/9);ctx.strokeStyle=ctx.fillStyle;ctx.stroke();ctx.closePath();}}}if(textInfo.rotate!==0&&textInfo.type!=="verticalWrap"){ctx.restore();}}},{key:"drawFreezeLine",value:function drawFreezeLine(_ref2){var horizontalTop=_ref2.horizontalTop,verticalLeft=_ref2.verticalLeft;var renderCtx=this.canvasElement.getContext("2d");if(!renderCtx)return;renderCtx.save();renderCtx.scale(this.sheetCtx.devicePixelRatio,this.sheetCtx.devicePixelRatio);renderCtx.strokeStyle="#ccc";renderCtx.lineWidth=2;if(horizontalTop){renderCtx.beginPath();renderCtx.moveTo(0,horizontalTop);renderCtx.lineTo(this.canvasElement.width,horizontalTop);renderCtx.stroke();renderCtx.closePath();}if(verticalLeft){renderCtx.beginPath();renderCtx.moveTo(verticalLeft,0);renderCtx.lineTo(verticalLeft,this.canvasElement.height);renderCtx.stroke();renderCtx.closePath();}renderCtx.restore();}}]);return Canvas;}();function handleScreenShot(ctx){if(ctx.luckysheet_select_save==null)return undefined;if(ctx.luckysheet_select_save.length===0){return undefined;}if(ctx.luckysheet_select_save.length>1){return undefined;}if(ctx.config.merge!=null){var has_PartMC=false;for(var s=0;s<ctx.luckysheet_select_save.length;s+=1){var r1=ctx.luckysheet_select_save[s].row[0];var r2=ctx.luckysheet_select_save[s].row[1];var c1=ctx.luckysheet_select_save[s].column[0];var c2=ctx.luckysheet_select_save[s].column[1];has_PartMC=hasPartMC(ctx,ctx.config,r1,r2,c1,c2);if(has_PartMC){break;}}if(has_PartMC){return undefined;}}var st_r=ctx.luckysheet_select_save[0].row[0];var ed_r=ctx.luckysheet_select_save[0].row[1];var st_c=ctx.luckysheet_select_save[0].column[0];var ed_c=ctx.luckysheet_select_save[0].column[1];var scrollHeight;var rh_height;if(st_r-1<0){scrollHeight=0;rh_height=ctx.visibledatarow[ed_r];}else {scrollHeight=ctx.visibledatarow[st_r-1];rh_height=ctx.visibledatarow[ed_r]-ctx.visibledatarow[st_r-1];}var scrollWidth;var ch_width;if(st_c-1<0){scrollWidth=0;ch_width=ctx.visibledatacolumn[ed_c];}else {scrollWidth=ctx.visibledatacolumn[st_c-1];ch_width=ctx.visibledatacolumn[ed_c]-ctx.visibledatacolumn[st_c-1];}var newCanvasElement=document.createElement("canvas");newCanvasElement.width=Math.ceil(ch_width*devicePixelRatio);newCanvasElement.height=Math.ceil(rh_height*devicePixelRatio);newCanvasElement.style.width="".concat(ch_width,"px");newCanvasElement.style.height="".concat(rh_height,"px");var newCanvas=new Canvas(newCanvasElement,ctx);newCanvas.drawMain({scrollWidth:scrollWidth,scrollHeight:scrollHeight,drawWidth:ch_width,drawHeight:rh_height,offsetLeft:1,offsetTop:1,clear:true});var ctx_newCanvas=newCanvasElement.getContext("2d");if(ctx_newCanvas==null)return undefined;ctx_newCanvas.beginPath();ctx_newCanvas.moveTo(0,0);ctx_newCanvas.lineTo(0,ctx.devicePixelRatio*rh_height);ctx_newCanvas.lineWidth=ctx.devicePixelRatio*2;ctx_newCanvas.strokeStyle=defaultStyle.strokeStyle;ctx_newCanvas.stroke();ctx_newCanvas.closePath();ctx_newCanvas.beginPath();ctx_newCanvas.moveTo(0,0);ctx_newCanvas.lineTo(ctx.devicePixelRatio*ch_width,0);ctx_newCanvas.lineWidth=ctx.devicePixelRatio*2;ctx_newCanvas.strokeStyle=defaultStyle.strokeStyle;ctx_newCanvas.stroke();ctx_newCanvas.closePath();var image=new Image();var url=newCanvasElement.toDataURL("image/png");image.src=url;if(ch_width>rh_height){image.style.width="100%";}else {image.style.height="100%";}newCanvasElement.remove();return image.src;}var INVALID_PARAMS=new Error("invalid params");var SHEET_NOT_FOUND=new Error("sheet not found");function getSheet(ctx){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var _options$index=options.index,index=_options$index===void 0?getSheetIndex(ctx,options.id||ctx.currentSheetId):_options$index;if(index==null){throw SHEET_NOT_FOUND;}var sheet=ctx.luckysheetfile[index];if(sheet==null){throw SHEET_NOT_FOUND;}return sheet;}function getCellValue$1(ctx,row,column){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(!lodash.isNumber(row)||!lodash.isNumber(column)){throw new Error("row or column cannot be null or undefined");}var sheet=getSheet(ctx,options);var _options$type=options.type,type=_options$type===void 0?"v":_options$type;var targetSheetData=sheet.data;if(!targetSheetData){throw SHEET_NOT_FOUND;}var cellData=targetSheetData[row][column];var ret;if(cellData&&lodash.isPlainObject(cellData)){ret=cellData[type];if(type==="f"&&ret!=null){ret=functionHTMLGenerate(ret);}else if(type==="f"){ret=cellData.v;}else if(cellData&&cellData.ct&&cellData.ct.fa==="yyyy-MM-dd"){ret=cellData.m;}}if(ret===undefined){ret=null;}return ret;}function setCellValue$1(ctx,row,column,value,cellInput){var options=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};if(!lodash.isNumber(row)||!lodash.isNumber(column)){throw new Error("row or column cannot be null or undefined");}var sheet=getSheet(ctx,options);var data=sheet.data;var formatList={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(value==null||value.toString().length===0){delFunctionGroup(ctx,row,column);setCellValue(ctx,row,column,data,value);}else if(value instanceof Object){var _data$row;var curv={};if((data===null||data===void 0?void 0:(_data$row=data[row])===null||_data$row===void 0?void 0:_data$row[column])==null){data[row][column]={};}var cell=data[row][column];if(value.f!=null&&value.v==null){curv.f=value.f;if(value.ct!=null){curv.ct=value.ct;}updateCell(ctx,row,column,cellInput,curv);}else {if(value.ct!=null){curv.ct=value.ct;}if(value.f!=null){curv.f=value.f;}if(value.v!=null){curv.v=value.v;}else {curv.v=cell.v;}if(value.m!=null){curv.m=value.m;}delFunctionGroup(ctx,row,column);setCellValue(ctx,row,column,data,curv);}lodash.forEach(value,function(v,attr){if(attr in formatList){updateFormatCell(ctx,data,attr,v,row,row,column,column);}else {cell[attr]=v;}});data[row][column]=cell;}else {if(value.toString().substr(0,1)==="="||value.toString().substr(0,5)==="<span"){updateCell(ctx,row,column,cellInput,value);}else {delFunctionGroup(ctx,row,column);setCellValue(ctx,row,column,data,value);}}}function clearCell(ctx,row,column){var _sheet$data,_sheet$data$row;var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(!lodash.isNumber(row)||!lodash.isNumber(column)){throw new Error("row or column cannot be null or undefined");}var sheet=getSheet(ctx,options);var cell=(_sheet$data=sheet.data)===null||_sheet$data===void 0?void 0:(_sheet$data$row=_sheet$data[row])===null||_sheet$data$row===void 0?void 0:_sheet$data$row[column];if(cell&&lodash.isPlainObject(cell)){delete cell.m;delete cell.v;if(cell.f!=null){delete cell.f;delFunctionGroup(ctx,row,column,sheet.id);delete cell.spl;}}}function setCellFormat(ctx,row,column,attr,value){var _targetSheetData$row;var options=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};if(!lodash.isNumber(row)||!lodash.isNumber(column)){throw new Error("row or column cannot be null or undefined");}if(!attr){throw new Error("attr cannot be null or undefined");}var sheet=getSheet(ctx,options);var targetSheetData=sheet.data;var cellData=(targetSheetData===null||targetSheetData===void 0?void 0:(_targetSheetData$row=targetSheetData[row])===null||_targetSheetData$row===void 0?void 0:_targetSheetData$row[column])||{};var cfg=sheet.config||{};if(attr==="ct"&&(!value||value.fa==null||value.t==null)){throw new Error("'fa' and 't' should be present in value when attr is 'ct'");}if(attr==="bd"){if(cfg.borderInfo==null){cfg.borderInfo=[];}var borderInfo=_objectSpread2$1({rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[column,column],row:[row,row]}]},value);cfg.borderInfo.push(borderInfo);}else {cellData[attr]=value;}targetSheetData[row][column]=cellData;sheet.config=cfg;ctx.config=cfg;}function freeze(ctx,type,range){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var sheet=getSheet(ctx,options);var typeMap={row:"rangeRow",column:"rangeColumn",both:"rangeBoth"};var innerType=typeMap[type];sheet.frozen={type:innerType,range:{column_focus:range.column,row_focus:range.row}};}function insertRowOrColumn(ctx,type,index,count,direction){var options=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};if(!["row","column"].includes(type)||!lodash.isNumber(index)||!lodash.isNumber(count)||!["lefttop","rightbottom"].includes(direction)){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);insertRowCol(ctx,{type:type,index:index,count:count,direction:direction,id:sheet.id});}function deleteRowOrColumn(ctx,type,start,end){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};if(!["row","column"].includes(type)||!lodash.isNumber(start)||!lodash.isNumber(end)){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);deleteRowCol(ctx,{type:type,start:start,end:end,id:sheet.id});}function setRowHeight(ctx,rowInfo){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!lodash.isPlainObject(rowInfo)){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);var cfg=sheet.config||{};if(cfg.rowlen==null){cfg.rowlen={};}lodash.forEach(rowInfo,function(len,r){if(Number(r)>=0){if(Number(len)>=0){cfg.rowlen[Number(r)]=Number(len);}}});sheet.config=cfg;if(ctx.currentSheetId===sheet.id){ctx.config=cfg;}}function setColumnWidth(ctx,columnInfo){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!lodash.isPlainObject(columnInfo)){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);var cfg=sheet.config||{};if(cfg.columnlen==null){cfg.columnlen={};}lodash.forEach(columnInfo,function(len,c){if(Number(c)>=0){if(Number(len)>=0){cfg.columnlen[Number(c)]=Number(len);}}});sheet.config=cfg;if(ctx.currentSheetId===sheet.id){ctx.config=cfg;}}function getRowHeight(ctx,rows){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!lodash.isArray(rows)||rows.length===0){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);var cfg=sheet.config||{};var rowlen=cfg.rowlen||{};var rowlenObj={};rows.forEach(function(item){if(Number(item)>=0){var size=rowlen[Number(item)]||ctx.defaultrowlen;rowlenObj[Number(item)]=size;}});return rowlenObj;}function getColumnWidth(ctx,columns){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!lodash.isArray(columns)||columns.length===0){throw INVALID_PARAMS;}var sheet=getSheet(ctx,options);var cfg=sheet.config||{};var columnlen=cfg.columnlen||{};var columnlenObj={};columns.forEach(function(item){if(Number(item)>=0){var size=columnlen[Number(item)]||ctx.defaultcollen;columnlenObj[Number(item)]=size;}});return columnlenObj;}function getSelection(ctx){var _ctx$luckysheet_selec;return (_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec.map(function(selection){return {row:selection.row,column:selection.column};});}function getFlattenRange(ctx,range){var _range;range=range||getSelection(ctx);var result=[];(_range=range)===null||_range===void 0?void 0:_range.forEach(function(ele){var rs=ele.row;var cs=ele.column;for(var r=rs[0];r<=rs[1];r+=1){for(var c=cs[0];c<=cs[1];c+=1){result.push({r:r,c:c});}}});return result;}function getCellsByFlattenRange(ctx,range){range=range||getFlattenRange(ctx);var flowdata=getFlowdata(ctx);if(!flowdata)return [];return range.map(function(item){var _flowdata$item$r;return (_flowdata$item$r=flowdata[item.r])===null||_flowdata$item$r===void 0?void 0:_flowdata$item$r[item.c];});}function getSelectionCoordinates(ctx){var result=[];var rangeArr=lodash.cloneDeep(ctx.luckysheet_select_save);var sheetId=ctx.currentSheetId;rangeArr===null||rangeArr===void 0?void 0:rangeArr.forEach(function(ele){var rangeText=getRangetxt(ctx,sheetId,{column:ele.column,row:ele.row});result.push(rangeText);});return result;}function getCellsByRange(ctx,range){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var sheet=getSheet(ctx,options);if(!range||_typeof$1(range)==="object"){return getdatabyselection(ctx,range,sheet.id);}throw INVALID_PARAMS;}function getHtmlByRange(ctx,range){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var sheet=getSheet(ctx,options);return rangeValueToHtml(ctx,sheet.id,range);}function setSelection(ctx,range,options){var sheet=getSheet(ctx,options);sheet.luckysheet_select_save=normalizeSelection(ctx,range);if(ctx.currentSheetId===sheet.id){ctx.luckysheet_select_save=sheet.luckysheet_select_save;}}function setCellValuesByRange(ctx,data,range,cellInput){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};if(data==null){throw INVALID_PARAMS;}if(range instanceof Array){throw new Error("setCellValuesByRange does not support multiple ranges");}if(!lodash.isPlainObject(range)){throw INVALID_PARAMS;}var rowCount=range.row[1]-range.row[0]+1;var columnCount=range.column[1]-range.column[0]+1;if(data.length!==rowCount||data[0].length!==columnCount){throw new Error("data size does not match range");}for(var i=0;i<rowCount;i+=1){for(var j=0;j<columnCount;j+=1){var row=range.row[0]+i;var column=range.column[0]+j;setCellValue$1(ctx,row,column,data[i][j],cellInput,options);}}}function setCellFormatByRange(ctx,attr,value,range){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};if(lodash.isPlainObject(range)){range=[range];}if(!lodash.isArray(range)){throw INVALID_PARAMS;}range.forEach(function(singleRange){for(var r=singleRange.row[0];r<=singleRange.row[1];r+=1){for(var c=singleRange.column[0];c<=singleRange.column[1];c+=1){setCellFormat(ctx,r,c,attr,value,options);}}});}function mergeCells$1(ctx,ranges,type){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var sheet=getSheet(ctx,options);mergeCells(ctx,sheet.id,ranges,type);}function cancelMerge(ctx,ranges){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};mergeCells$1(ctx,ranges,"merge-cancel",options);}function getAllSheets(ctx){return ctx.luckysheetfile;}function addSheet$1(ctx,settings){addSheet(ctx,settings,false);}function deleteSheet$1(ctx){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var sheet=getSheet(ctx,options);deleteSheet(ctx,sheet.id);}function activateSheet(ctx){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var sheet=getSheet(ctx,options);ctx.currentSheetId=sheet.id;}function setSheetName(ctx,name){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var sheet=getSheet(ctx,options);sheet.name=name;}function setSheetOrder(ctx,orderList){var _ctx$luckysheetfile;(_ctx$luckysheetfile=ctx.luckysheetfile)===null||_ctx$luckysheetfile===void 0?void 0:_ctx$luckysheetfile.forEach(function(sheet){if(sheet.id in orderList){sheet.order=orderList[sheet.id];}});lodash.sortBy(ctx.luckysheetfile,["order"]).forEach(function(sheet,i){sheet.order=i;});}function scroll(ctx,scrollbarX,scrollbarY,options){if(options.scrollLeft!=null){if(!lodash.isNumber(options.scrollLeft)){throw INVALID_PARAMS;}if(scrollbarX){scrollbarX.scrollLeft=options.scrollLeft;}}else if(options.targetColumn!=null){if(!lodash.isNumber(options.targetColumn)){throw INVALID_PARAMS;}var col_pre=options.targetColumn<=0?0:ctx.visibledatacolumn[options.targetColumn-1];if(scrollbarX){scrollbarX.scrollLeft=col_pre;}}if(options.scrollTop!=null){if(!lodash.isNumber(options.scrollTop)){throw INVALID_PARAMS;}if(scrollbarY){scrollbarY.scrollTop=options.scrollTop;}}else if(options.targetRow!=null){if(!lodash.isNumber(options.targetRow)){throw INVALID_PARAMS;}var row_pre=options.targetRow<=0?0:ctx.visibledatarow[options.targetRow-1];if(scrollbarY){scrollbarY.scrollTop=row_pre;}}}var index=/*#__PURE__*/Object.freeze({__proto__:null,getCellValue:getCellValue$1,setCellValue:setCellValue$1,clearCell:clearCell,setCellFormat:setCellFormat,freeze:freeze,insertRowOrColumn:insertRowOrColumn,deleteRowOrColumn:deleteRowOrColumn,setRowHeight:setRowHeight,setColumnWidth:setColumnWidth,getRowHeight:getRowHeight,getColumnWidth:getColumnWidth,getSelection:getSelection,getFlattenRange:getFlattenRange,getCellsByFlattenRange:getCellsByFlattenRange,getSelectionCoordinates:getSelectionCoordinates,getCellsByRange:getCellsByRange,getHtmlByRange:getHtmlByRange,setSelection:setSelection,setCellValuesByRange:setCellValuesByRange,setCellFormatByRange:setCellFormatByRange,mergeCells:mergeCells$1,cancelMerge:cancelMerge,getAllSheets:getAllSheets,getSheet:getSheet,addSheet:addSheet$1,deleteSheet:deleteSheet$1,activateSheet:activateSheet,setSheetName:setSheetName,setSheetOrder:setSheetOrder,scroll:scroll});var defaultSettings={column:60,row:84,showToolbar:true,showFormulaBar:true,showSheetTabs:true,data:[],config:{},devicePixelRatio:(global||window).devicePixelRatio,allowEdit:true,lang:null,forceCalculation:false,rowHeaderWidth:46,columnHeaderHeight:20,defaultColWidth:73,defaultRowHeight:19,defaultFontSize:10,toolbarItems:["undo","redo","format-painter","clear-format","|","currency-format","percentage-format","number-decrease","number-increase","format","font-size","|","bold","italic","strike-through","underline","|","font-color","background","border","merge-cell","|","horizontal-align","vertical-align","text-wrap","text-rotation","|","freeze","sort","image","comment","quick-formula","screenshot"],cellContextMenu:["copy","paste","|","insert-row","insert-column","delete-row","delete-column","delete-cell","hide-row","hide-column","clear","sort","filter","chart","image","link","data","cell-format"],sheetTabContextMenu:["delete","copy","rename","color","hide","|","move"],generateSheetId:function generateSheetId(){return v4();},hooks:{}};function handleCopy(ctx){if(ctx.luckysheetPaintModelOn){cancelPaintModel(ctx);}var selection=ctx.luckysheet_select_save;if(!selection||lodash.isEmpty(selection)){return;}if(ctx.config.merge!=null){var has_PartMC=false;for(var s=0;s<selection.length;s+=1){var r1=selection[s].row[0];var r2=selection[s].row[1];var c1=selection[s].column[0];var c2=selection[s].column[1];has_PartMC=hasPartMC(ctx,ctx.config,r1,r2,c1,c2);if(has_PartMC){break;}}if(has_PartMC){return;}}if(selection.length>1){var isSameRow=true;var str_r=selection[0].row[0];var end_r=selection[0].row[1];var isSameCol=true;var str_c=selection[0].column[0];var end_c=selection[0].column[1];for(var _s=1;_s<selection.length;_s+=1){if(selection[_s].row[0]!==str_r||selection[_s].row[1]!==end_r){isSameRow=false;}if(selection[_s].column[0]!==str_c||selection[_s].column[1]!==end_c){isSameCol=false;}}if(!isSameRow&&!isSameCol||selectIsOverlap(ctx)){return;}}copy(ctx);ctx.luckysheet_paste_iscut=false;}function handleGlobalEnter(ctx,cellInput,e){if((e.altKey||e.metaKey)&&ctx.luckysheetCellUpdate.length>0){var _ctx$luckysheet_selec;var last=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[ctx.luckysheet_select_save.length-1];if(last&&!lodash.isNil(last.row_focus)&&!lodash.isNil(last.column_focus));e.preventDefault();}else if(ctx.luckysheetCellUpdate.length>0){var lastCellUpdate=lodash.clone(ctx.luckysheetCellUpdate);updateCell(ctx,ctx.luckysheetCellUpdate[0],ctx.luckysheetCellUpdate[1],cellInput);ctx.luckysheet_select_save=[{row:[lastCellUpdate[0],lastCellUpdate[0]],column:[lastCellUpdate[1],lastCellUpdate[1]],row_focus:lastCellUpdate[0],column_focus:lastCellUpdate[1]}];moveHighlightCell(ctx,"down",1,"rangeOfSelect");e.preventDefault();}else {var _ctx$luckysheet_selec2,_ctx$luckysheet_selec3;if(((_ctx$luckysheet_selec2=(_ctx$luckysheet_selec3=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec3===void 0?void 0:_ctx$luckysheet_selec3.length)!==null&&_ctx$luckysheet_selec2!==void 0?_ctx$luckysheet_selec2:0)>0){var _last=ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1];var row_index=_last.row_focus;var col_index=_last.column_focus;ctx.luckysheetCellUpdate=[row_index,col_index];e.preventDefault();}}}function handleBatchSelectionWithArrowKey(ctx,e){if(ctx.luckysheetCellUpdate.length>0){return;}switch(e.key){}}function handleWithCtrlOrMetaKey(ctx,e,cellInput,fxInput,handleUndo,handleRedo){var flowdata=getFlowdata(ctx);if(!flowdata)return;if(e.shiftKey){var _ctx$luckysheet_selec4;ctx.luckysheet_shiftpositon=lodash.cloneDeep((_ctx$luckysheet_selec4=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec4===void 0?void 0:_ctx$luckysheet_selec4[ctx.luckysheet_select_save.length-1]);ctx.luckysheet_shiftkeydown=true;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)){handleBatchSelectionWithArrowKey(ctx,e);}else if(e.key===":"||e.key==="'"){var _ctx$luckysheet_selec5;var last=(_ctx$luckysheet_selec5=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec5===void 0?void 0:_ctx$luckysheet_selec5[ctx.luckysheet_select_save.length-1];if(!last)return;var row_index=last.row_focus;var col_index=last.column_focus;updateCell(ctx,row_index,col_index,cellInput,flowdata);var value=getNowDateTime(2);cellInput.innerHTML=value;handleFormulaInput(ctx,fxInput,cellInput,e.keyCode);}}else if(e.key==="b"){handleBold(ctx,cellInput);}else if(e.key==="c"){handleCopy(ctx);e.stopPropagation();return;}else if(e.key==="v"){var _ctx$luckysheet_selec6,_ctx$luckysheet_selec7;if(((_ctx$luckysheet_selec6=(_ctx$luckysheet_selec7=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec7===void 0?void 0:_ctx$luckysheet_selec7.length)!==null&&_ctx$luckysheet_selec6!==void 0?_ctx$luckysheet_selec6:0)>1){return;}selectionCache.isPasteAction=true;e.stopPropagation();return;}else if(e.key==="x"){if(ctx.luckysheetPaintModelOn){cancelPaintModel(ctx);}var selection=ctx.luckysheet_select_save;if(!selection||lodash.isEmpty(selection)){return;}if(ctx.config.merge!=null){var has_PartMC=false;for(var s=0;s<selection.length;s+=1){var r1=selection[s].row[0];var r2=selection[s].row[1];var c1=selection[s].column[0];var c2=selection[s].column[1];has_PartMC=hasPartMC(ctx,ctx.config,r1,r2,c1,c2);if(has_PartMC){break;}}if(has_PartMC){return;}}if(selection.length>1){return;}copy(ctx);ctx.luckysheet_paste_iscut=true;e.stopPropagation();return;}else if(e.key==="z"){handleUndo();e.stopPropagation();return;}else if(e.key==="y"){handleRedo();e.stopPropagation();return;}else if(e.key==="a"){selectAll(ctx);}e.preventDefault();}function handleShiftWithArrowKey(ctx,e){var _ctx$luckysheet_selec8;if(ctx.luckysheetCellUpdate.length>0){return;}ctx.luckysheet_shiftpositon=lodash.cloneDeep((_ctx$luckysheet_selec8=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec8===void 0?void 0:_ctx$luckysheet_selec8[ctx.luckysheet_select_save.length-1]);ctx.luckysheet_shiftkeydown=true;e.preventDefault();}function handleArrowKey(ctx,e){if(ctx.luckysheetCellUpdate.length>0||ctx.luckysheet_cell_selected_move||ctx.luckysheet_cell_selected_extend){return;}switch(e.key){case"ArrowUp":moveHighlightCell(ctx,"down",-1,"rangeOfSelect");break;case"ArrowDown":moveHighlightCell(ctx,"down",1,"rangeOfSelect");break;case"ArrowLeft":moveHighlightCell(ctx,"right",-1,"rangeOfSelect");break;case"ArrowRight":moveHighlightCell(ctx,"right",1,"rangeOfSelect");break;}}function handleGlobalKeyDown(ctx,cellInput,fxInput,e,cache,handleUndo,handleRedo){var kcode=e.keyCode;var kstr=e.key;if(ctx.contextMenu){return;}if(ctx.luckysheetCellUpdate.length>0&&kstr!=="Enter"&&kstr!=="Tab"&&kstr!=="ArrowUp"&&kstr!=="ArrowDown"&&kstr!=="ArrowLeft"&&kstr!=="ArrowRight"){return;}if(kstr==="Enter"){if(!ctx.allowEdit)return;handleGlobalEnter(ctx,cellInput,e);}else if(kstr==="Tab"){if(ctx.luckysheetCellUpdate.length>0){return;}moveHighlightCell(ctx,"right",1,"rangeOfSelect");e.preventDefault();}else if(kstr==="F2"){var _ctx$luckysheet_selec9;if(!ctx.allowEdit)return;if(ctx.luckysheetCellUpdate.length>0){return;}var last=(_ctx$luckysheet_selec9=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec9===void 0?void 0:_ctx$luckysheet_selec9[ctx.luckysheet_select_save.length-1];if(!last)return;var row_index=last.row_focus;var col_index=last.column_focus;ctx.luckysheetCellUpdate=[row_index,col_index];e.preventDefault();}else if(kstr==="F4"&&ctx.luckysheetCellUpdate.length>0){e.preventDefault();}else if(kstr==="Escape"&&ctx.luckysheetCellUpdate.length>0){cancelNormalSelected(ctx);moveHighlightCell(ctx,"down",0,"rangeOfSelect");e.preventDefault();}else {if(e.ctrlKey||e.metaKey){handleWithCtrlOrMetaKey(ctx,e,cellInput,fxInput,handleUndo,handleRedo);return;}if(e.shiftKey&&(kstr==="ArrowUp"||kstr==="ArrowDown"||kstr==="ArrowLeft"||kstr==="ArrowRight")){handleShiftWithArrowKey(ctx,e);}else if(kstr==="Escape"){ctx.contextMenu=undefined;}else if(kstr==="Delete"||kstr==="Backspace"){var _ctx$activeImg;if(!ctx.allowEdit)return;if(((_ctx$activeImg=ctx.activeImg)===null||_ctx$activeImg===void 0?void 0:_ctx$activeImg.id)!=null){removeActiveImage(ctx);}else {deleteSelectedCellText(ctx);}e.preventDefault();}else if(kstr==="ArrowUp"||kstr==="ArrowDown"||kstr==="ArrowLeft"||kstr==="ArrowRight"){handleArrowKey(ctx,e);}else if(!(kcode>=112&&kcode<=123||kcode<=46||kcode===144||kcode===108||e.ctrlKey||e.altKey||e.shiftKey&&(kcode===37||kcode===38||kcode===39||kcode===40))||kcode===8||kcode===32||kcode===46||kcode===0||e.ctrlKey&&kcode===86){if(!ctx.allowEdit)return;if(String.fromCharCode(kcode)!=null&&!lodash.isEmpty(ctx.luckysheet_select_save)&&kstr!=="CapsLock"&&kstr!=="Win"&&kcode!==18){var _last2=ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1];var _row_index=_last2.row_focus;var _col_index=_last2.column_focus;ctx.luckysheetCellUpdate=[_row_index,_col_index];cache.overwriteCell=true;handleFormulaInput(ctx,fxInput,cellInput,kcode);}}}cellInput===null||cellInput===void 0?void 0:cellInput.focus();e.stopPropagation();}var mouseWheelUniqueTimeout;function handleGlobalWheel(ctx,e,cache,scrollbarX,scrollbarY){var scrollLeft=scrollbarX.scrollLeft;var scrollTop=scrollbarY.scrollTop;var visibledatacolumn_c=ctx.visibledatacolumn;var visibledatarow_c=ctx.visibledatarow;clearTimeout(mouseWheelUniqueTimeout);if(cache.visibleColumnsUnique!=null){visibledatacolumn_c=cache.visibleColumnsUnique;}else {visibledatacolumn_c=lodash.uniq(visibledatacolumn_c);cache.visibleColumnsUnique=visibledatacolumn_c;}if(cache.visibleRowsUnique!=null){visibledatarow_c=cache.visibleRowsUnique;}else {visibledatarow_c=lodash.uniq(visibledatarow_c);cache.visibleRowsUnique=visibledatarow_c;}var row_st=lodash.sortedIndex(visibledatarow_c,scrollTop)+1;var rowscroll=0;var scrollNum=1;if(e.deltaY!==0){var row_ed;var step=Math.round(scrollNum/ctx.zoomRatio);step=step<1?1:step;if(e.deltaY>0){row_ed=row_st+step;if(row_ed>=visibledatarow_c.length){row_ed=visibledatarow_c.length-1;}}else {row_ed=row_st-step;if(row_ed<0){row_ed=0;}}rowscroll=row_ed===0?0:visibledatarow_c[row_ed-1];scrollbarY.scrollTop=rowscroll;}else if(e.deltaX!==0){if(e.deltaX>0){scrollLeft+=20*ctx.zoomRatio;}else {scrollLeft-=20*ctx.zoomRatio;}scrollbarX.scrollLeft=scrollLeft;}mouseWheelUniqueTimeout=setTimeout(function(){delete cache.visibleColumnsUnique;delete cache.visibleRowsUnique;},500);e.preventDefault();}function fixPositionOnFrozenCells(freeze,x,y,mouseX,mouseY){var _freeze$vertical,_freeze$horizontal;if(!freeze)return [x,y];var freezenverticaldata=freeze===null||freeze===void 0?void 0:(_freeze$vertical=freeze.vertical)===null||_freeze$vertical===void 0?void 0:_freeze$vertical.freezenverticaldata;var freezenhorizontaldata=freeze===null||freeze===void 0?void 0:(_freeze$horizontal=freeze.horizontal)===null||_freeze$horizontal===void 0?void 0:_freeze$horizontal.freezenhorizontaldata;if(freezenverticaldata!=null&&mouseX<freezenverticaldata[0]-freezenverticaldata[2]){x=mouseX+freezenverticaldata[2];}if(freezenhorizontaldata!=null&&mouseY<freezenhorizontaldata[0]-freezenhorizontaldata[2]){y=mouseY+freezenhorizontaldata[2];}return [x,y];}function handleCellAreaMouseDown(ctx,globalCache,e,cellInput,container,fxInput){var _globalCache$freezen,_ctx$hooks$beforeCell,_ctx$hooks,_flowdata$row_index;ctx.contextMenu=undefined;var flowdata=getFlowdata(ctx);if(!flowdata)return;removeEditingComment(ctx,globalCache);cancelActiveImgItem(ctx,globalCache);var rect=container.getBoundingClientRect();var mouseX=e.pageX-rect.left;var mouseY=e.pageY-rect.top;var x=mouseX+ctx.scrollLeft;var y=mouseY+ctx.scrollTop;if(x>=rect.width+ctx.scrollLeft||y>=rect.height+ctx.scrollTop){return;}var freeze=(_globalCache$freezen=globalCache.freezen)===null||_globalCache$freezen===void 0?void 0:_globalCache$freezen[ctx.currentSheetId];var _fixPositionOnFrozenC=fixPositionOnFrozenCells(freeze,x,y,mouseX,mouseY);var _fixPositionOnFrozenC2=_slicedToArray$3(_fixPositionOnFrozenC,2);x=_fixPositionOnFrozenC2[0];y=_fixPositionOnFrozenC2[1];var row_location=rowLocation(y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];var row_index_ed=row_index;var col_index_ed=col_index;var margeset=mergeBorder(ctx,flowdata,row_index,col_index);if(margeset){var _margeset$row=_slicedToArray$3(margeset.row,4);row_pre=_margeset$row[0];row=_margeset$row[1];row_index=_margeset$row[2];row_index_ed=_margeset$row[3];var _margeset$column=_slicedToArray$3(margeset.column,4);col_pre=_margeset$column[0];col=_margeset$column[1];col_index=_margeset$column[2];col_index_ed=_margeset$column[3];}if(((_ctx$hooks$beforeCell=(_ctx$hooks=ctx.hooks).beforeCellMouseDown)===null||_ctx$hooks$beforeCell===void 0?void 0:_ctx$hooks$beforeCell.call(_ctx$hooks,(_flowdata$row_index=flowdata[row_index])===null||_flowdata$row_index===void 0?void 0:_flowdata$row_index[col_index],{row:row_index,column:col_index,startRow:row_pre,startColumn:col_pre,endRow:row,endColumn:col}))===false){return;}if(col_pre<ctx.scrollLeft){ctx.scrollLeft=col_pre;}if(row_pre<ctx.scrollTop){ctx.scrollTop=row_pre;}if(e.button===2){var isInSelection=false;lodash.forEach(ctx.luckysheet_select_save,function(obj_s){if(obj_s.row!=null&&row_index>=obj_s.row[0]&&row_index<=obj_s.row[1]&&col_index>=obj_s.column[0]&&col_index<=obj_s.column[1]){isInSelection=true;return false;}return true;});if(isInSelection){return;}}ctx.luckysheet_scroll_status=true;if(ctx.luckysheetCellUpdate.length>0){if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){var _$last;var rowseleted=[row_index,row_index_ed];var columnseleted=[col_index,col_index_ed];var left=col_pre;var width=col-col_pre-1;var top=row_pre;var height=row-row_pre-1;if(e.shiftKey){var last=ctx.formulaCache.func_selectedrange;top=0;height=0;rowseleted=[];if(last==null||last.top==null||last.height==null||last.row_focus==null||last.left==null||last.width==null)return;if(last.top>row_pre){top=row_pre;height=last.top+last.height-row_pre;if(last.row[1]>last.row_focus){last.row[1]=last.row_focus;}rowseleted=[row_index,last.row[1]];}else if(last.top===row_pre){top=row_pre;height=last.top+last.height-row_pre;rowseleted=[row_index,last.row[0]];}else {top=last.top;height=row-last.top-1;if(last.row[0]<last.row_focus){last.row[0]=last.row_focus;}rowseleted=[last.row[0],row_index];}left=0;width=0;columnseleted=[];if(last.left>col_pre){left=col_pre;width=last.left+last.width-col_pre;if(last.column==null||last.column_focus==null)return;if(last.column[1]>last.column_focus){last.column[1]=last.column_focus;}columnseleted=[col_index,last.column[1]];}else if(last.left===col_pre){left=col_pre;width=last.left+last.width-col_pre;columnseleted=[col_index,last.column[0]];}else {left=last.left;width=col-last.left-1;if(last.column==null||last.column_focus==null)return;if(last.column[0]<last.column_focus){last.column[0]=last.column_focus;}columnseleted=[last.column[0],col_index];}var changeparam=mergeMoveMain(ctx,columnseleted,rowseleted,last,top,height,left,width);if(changeparam!=null){var _changeparam=_slicedToArray$3(changeparam,6);columnseleted=_changeparam[0];rowseleted=_changeparam[1];top=_changeparam[2];height=_changeparam[3];left=_changeparam[4];width=_changeparam[5];}last.row=rowseleted;last.column=columnseleted;last.left_move=left;last.width_move=width;last.top_move=top;last.height_move=height;ctx.formulaCache.func_selectedrange=last;}else if(e.ctrlKey&&((_$last=lodash.last(cellInput.querySelectorAll("span")))===null||_$last===void 0?void 0:_$last.innerText)!==","){var vText=cellInput.innerText;if(vText[vText.length-1]===")"){vText=vText.substring(0,vText.length-1);}if(vText.length>0){var lastWord=vText.substring(vText.length-1,1);if(lastWord!==","&&lastWord!=="="&&lastWord!=="("){vText+=",";}}if(vText.length>0&&vText.substring(0,1)==="="){vText=functionHTMLGenerate(vText);if(window.getSelection){var _currSelection$anchor,_currSelection$anchor2,_currSelection$anchor3,_currSelection$anchor4;var currSelection=window.getSelection();if(currSelection==null)return;ctx.formulaCache.functionRangeIndex=[lodash.indexOf((_currSelection$anchor=currSelection.anchorNode)===null||_currSelection$anchor===void 0?void 0:(_currSelection$anchor2=_currSelection$anchor.parentNode)===null||_currSelection$anchor2===void 0?void 0:(_currSelection$anchor3=_currSelection$anchor2.parentNode)===null||_currSelection$anchor3===void 0?void 0:_currSelection$anchor3.childNodes,(_currSelection$anchor4=currSelection.anchorNode)===null||_currSelection$anchor4===void 0?void 0:_currSelection$anchor4.parentNode),currSelection.anchorOffset];}else {var textRange=document.selection.createRange();ctx.formulaCache.functionRangeIndex=textRange;}cellInput.innerHTML=vText;cancelFunctionrangeSelected(ctx);createRangeHightlight(ctx,vText);}ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;fxInput.innerHTML=vText;rangeHightlightselected(ctx,cellInput);israngeseleciton(ctx);ctx.formulaCache.func_selectedrange={left:left,width:width,top:top,height:height,left_move:left,width_move:width,top_move:top,height_move:height,row:rowseleted,column:columnseleted,row_focus:row_index,column_focus:col_index};}else {ctx.formulaCache.func_selectedrange={left:left,width:width,top:top,height:height,left_move:left,width_move:width,top_move:top,height_move:height,row:rowseleted,column:columnseleted,row_focus:row_index,column_focus:col_index};}rangeSetValue(ctx,cellInput,{row:rowseleted,column:columnseleted});ctx.formulaCache.rangestart=true;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;ctx.formulaCache.selectingRangeIndex=ctx.formulaCache.rangechangeindex;createFormulaRangeSelect(ctx,{rangeIndex:ctx.formulaCache.rangechangeindex||0,left:left,top:top,width:width,height:height});return;}updateCell(ctx,ctx.luckysheetCellUpdate[0],ctx.luckysheetCellUpdate[1],cellInput);ctx.luckysheet_select_status=true;}if(checkProtectionSelectLockedOrUnLockedCells(ctx,row_index,col_index,ctx.currentSheetId)){ctx.luckysheet_select_status=true;}if(ctx.luckysheet_select_status){if(e.shiftKey){var _ctx$luckysheet_selec;var _last=(_ctx$luckysheet_selec=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec===void 0?void 0:_ctx$luckysheet_selec[ctx.luckysheet_select_save.length-1];if(_last&&_last.top!=null&&_last.left!=null&&_last.height!=null&&_last.width!=null&&_last.row_focus!=null&&_last.column_focus!=null){var _top2=0;var _height2=0;var _rowseleted2=[];if(_last.top>row_pre){_top2=row_pre;_height2=_last.top+_last.height-row_pre;if(_last.row[1]>_last.row_focus){_last.row[1]=_last.row_focus;}_rowseleted2=[row_index,_last.row[1]];}else if(_last.top===row_pre){_top2=row_pre;_height2=_last.top+_last.height-row_pre;_rowseleted2=[row_index,_last.row[0]];}else {_top2=_last.top;_height2=row-_last.top-1;if(_last.row[0]<_last.row_focus){_last.row[0]=_last.row_focus;}_rowseleted2=[_last.row[0],row_index];}var _left2=0;var _width2=0;var _columnseleted2=[];if(_last.left>col_pre){_left2=col_pre;_width2=_last.left+_last.width-col_pre;if(_last.column[1]>_last.column_focus){_last.column[1]=_last.column_focus;}_columnseleted2=[col_index,_last.column[1]];}else if(_last.left===col_pre){_left2=col_pre;_width2=_last.left+_last.width-col_pre;_columnseleted2=[col_index,_last.column[0]];}else {_left2=_last.left;_width2=col-_last.left-1;if(_last.column[0]<_last.column_focus){_last.column[0]=_last.column_focus;}_columnseleted2=[_last.column[0],col_index];}var _changeparam2=mergeMoveMain(ctx,_columnseleted2,_rowseleted2,_last,_top2,_height2,_left2,_width2);if(_changeparam2!=null){var _changeparam3=_slicedToArray$3(_changeparam2,6);_columnseleted2=_changeparam3[0];_rowseleted2=_changeparam3[1];_top2=_changeparam3[2];_height2=_changeparam3[3];_left2=_changeparam3[4];_width2=_changeparam3[5];}_last.row=_rowseleted2;_last.column=_columnseleted2;_last.left_move=_left2;_last.width_move=_width2;_last.top_move=_top2;_last.height_move=_height2;ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1]=_last;}}else if(e.ctrlKey||e.metaKey){var _ctx$luckysheet_selec2;(_ctx$luckysheet_selec2=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec2===void 0?void 0:_ctx$luckysheet_selec2.push({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1,left_move:col_pre,width_move:col-col_pre-1,top_move:row_pre,height_move:row-row_pre-1,row:[row_index,row_index_ed],column:[col_index,col_index_ed],row_focus:row_index,column_focus:col_index});}else {ctx.luckysheet_select_save=[{left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1,left_move:col_pre,width_move:col-col_pre-1,top_move:row_pre,height_move:row-row_pre-1,row:[row_index,row_index_ed],column:[col_index,col_index_ed],row_focus:row_index,column_focus:col_index}];}}ctx.luckysheet_select_save=normalizeSelection(ctx,ctx.luckysheet_select_save);if(ctx.hooks.afterCellMouseDown){setTimeout(function(){var _ctx$hooks$afterCellM,_ctx$hooks2,_flowdata$row_index2;(_ctx$hooks$afterCellM=(_ctx$hooks2=ctx.hooks).afterCellMouseDown)===null||_ctx$hooks$afterCellM===void 0?void 0:_ctx$hooks$afterCellM.call(_ctx$hooks2,(_flowdata$row_index2=flowdata[row_index])===null||_flowdata$row_index2===void 0?void 0:_flowdata$row_index2[col_index],{row:row_index,column:col_index,startRow:row_pre,startColumn:col_pre,endRow:row,endColumn:col});});}}function handleCellAreaDoubleClick(ctx,globalCache,settings,e,container){var _globalCache$freezen2;var flowdata=getFlowdata(ctx);if(!flowdata)return;if(ctx.luckysheetCellUpdate.length>0&&ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){return;}if(!settings.allowEdit){return;}var rect=container.getBoundingClientRect();var mouseX=e.pageX-rect.left;var mouseY=e.pageY-rect.top;var x=mouseX+ctx.scrollLeft;var y=mouseY+ctx.scrollTop;var freeze=(_globalCache$freezen2=globalCache.freezen)===null||_globalCache$freezen2===void 0?void 0:_globalCache$freezen2[ctx.currentSheetId];var _fixPositionOnFrozenC3=fixPositionOnFrozenCells(freeze,x,y,mouseX,mouseY);var _fixPositionOnFrozenC4=_slicedToArray$3(_fixPositionOnFrozenC3,2);x=_fixPositionOnFrozenC4[0];y=_fixPositionOnFrozenC4[1];var row_location=rowLocation(y,ctx.visibledatarow);var row_index=row_location[2];var col_location=colLocation(x,ctx.visibledatacolumn);var col_index=col_location[2];var margeset=mergeBorder(ctx,flowdata,row_index,col_index);if(margeset){var _margeset$row2=_slicedToArray$3(margeset.row,3);row_index=_margeset$row2[2];var _margeset$column2=_slicedToArray$3(margeset.column,3);col_index=_margeset$column2[2];}var _ctx$luckysheet_selec3=ctx.luckysheet_select_save[0],column_focus=_ctx$luckysheet_selec3.column_focus,row_focus=_ctx$luckysheet_selec3.row_focus;if(!lodash.isNil(column_focus)&&!lodash.isNil(row_focus)&&(column_focus!==col_index||row_focus!==row_index)){row_index=row_focus;col_index=column_focus;}luckysheetUpdateCell(ctx,row_index,col_index);}function handleContextMenu(ctx,settings,e,workbookContainer){var _ctx$luckysheet_selec4,_ctx$luckysheet_selec5;if(!ctx.allowEdit){return;}var flowdata=getFlowdata(ctx);if(!flowdata)return;var workbookRect=workbookContainer.getBoundingClientRect();if(((_ctx$luckysheet_selec4=(_ctx$luckysheet_selec5=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec5===void 0?void 0:_ctx$luckysheet_selec5.length)!==null&&_ctx$luckysheet_selec4!==void 0?_ctx$luckysheet_selec4:0)===0){return;}var cellContextMenu=settings.cellContextMenu;if(lodash.isEmpty(cellContextMenu)){return;}var x=e.pageX-workbookRect.left;var y=e.pageY-workbookRect.top;ctx.contextMenu={x:x,y:y,pageX:e.pageX,pageY:e.pageY};e.preventDefault();}function mouseRender(ctx,globalCache,e,cellInput,scrollX,scrollY,container){var rect=container.getBoundingClientRect();if(ctx.luckysheet_scroll_status&&!ctx.luckysheet_cols_change_size&&!ctx.luckysheet_rows_change_size){var left=ctx.scrollLeft;var top=ctx.scrollTop;var x=e.pageX-rect.left;var y=e.pageY-rect.top;var winH=rect.height-20*ctx.zoomRatio;var winW=rect.width-60*ctx.zoomRatio;if(y<0||y>winH){var stop;if(y<0){stop=top+y/2;}else {stop=top+(y-winH)/2;}scrollY.scrollTop=stop;}if(x<0||x>winW){var sleft;if(x<0){sleft=left+x/2;}else {sleft=left+(x-winW)/2;}scrollX.scrollLeft=sleft;}}if(ctx.luckysheet_select_status){var _ctx$luckysheet_selec6,_globalCache$freezen3;var _x=e.pageX-rect.left-ctx.rowHeaderWidth+ctx.scrollLeft;var _y=e.pageY-rect.top-ctx.columnHeaderHeight+ctx.scrollTop;var row_location=rowLocation(_y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];var col_location=colLocation(_x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];if(!checkProtectionSelectLockedOrUnLockedCells(ctx,row_index,col_index,ctx.currentSheetId)){ctx.luckysheet_select_status=false;return;}var last=lodash.cloneDeep((_ctx$luckysheet_selec6=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec6===void 0?void 0:_ctx$luckysheet_selec6[ctx.luckysheet_select_save.length-1]);if(!last||lodash.isNil(last.left)||lodash.isNil(last.top)||lodash.isNil(last.height)||lodash.isNil(last.width)||lodash.isNil(last.row_focus)||lodash.isNil(last.column_focus)){return;}var _top3=0;var height=0;var rowseleted=[];if(last.top>row_pre){_top3=row_pre;height=last.top+last.height-row_pre;if(last.row[1]>last.row_focus){last.row[1]=last.row_focus;}rowseleted=[row_index,last.row[1]];}else if(last.top===row_pre){_top3=row_pre;height=last.top+last.height-row_pre;rowseleted=[row_index,last.row[0]];}else {_top3=last.top;height=row-last.top-1;if(last.row[0]<last.row_focus){last.row[0]=last.row_focus;}rowseleted=[last.row[0],row_index];}var _left3=0;var width=0;var columnseleted=[];if(last.left>col_pre){_left3=col_pre;width=last.left+last.width-col_pre;if(last.column[1]>last.column_focus){last.column[1]=last.column_focus;}columnseleted=[col_index,last.column[1]];}else if(last.left===col_pre){_left3=col_pre;width=last.left+last.width-col_pre;columnseleted=[col_index,last.column[0]];}else {_left3=last.left;width=col-last.left-1;if(last.column[0]<last.column_focus){last.column[0]=last.column_focus;}columnseleted=[last.column[0],col_index];}var changeparam=mergeMoveMain(ctx,columnseleted,rowseleted,last,_top3,height,_left3,width);if(changeparam!=null){var _changeparam4=_slicedToArray$3(changeparam,6);columnseleted=_changeparam4[0];rowseleted=_changeparam4[1];_top3=_changeparam4[2];height=_changeparam4[3];_left3=_changeparam4[4];width=_changeparam4[5];}last.row=rowseleted;last.column=columnseleted;last.left_move=_left3;last.width_move=width;last.top_move=_top3;last.height_move=height;ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1]=last;scrollToFrozenRowCol(ctx,(_globalCache$freezen3=globalCache.freezen)===null||_globalCache$freezen3===void 0?void 0:_globalCache$freezen3[ctx.currentSheetId]);}else if(ctx.formulaCache.rangestart){rangeDrag(ctx,e,cellInput,scrollX.scrollLeft,scrollY.scrollTop,container);}else if(ctx.luckysheet_rows_selected_status);else if(ctx.luckysheet_cols_selected_status);else if(ctx.luckysheet_cell_selected_move);else if(ctx.luckysheet_cell_selected_extend){onDropCellSelect(ctx,e,scrollX,scrollY,container);}else if(ctx.luckysheet_cols_change_size){var _x2=e.pageX-rect.left-ctx.rowHeaderWidth+container.scrollLeft;if(_x2+3-ctx.luckysheet_cols_change_size_start[0]>30&&_x2<rect.width+ctx.scrollLeft-100){var changeSizeLine=container.querySelector(".fortune-change-size-line");if(changeSizeLine){changeSizeLine.style.left="".concat(_x2,"px");}var changeSizeCol=container.querySelector(".fortune-cols-change-size");if(changeSizeCol){changeSizeCol.style.left="".concat(_x2-2,"px");}}}else if(ctx.luckysheet_rows_change_size){var _y2=e.pageY-rect.top-ctx.columnHeaderHeight+container.scrollTop;if(_y2+3-ctx.luckysheet_rows_change_size_start[0]>19&&_y2<rect.height+ctx.scrollTop-20){var _changeSizeLine=container.querySelector(".fortune-change-size-line");if(_changeSizeLine){_changeSizeLine.style.top="".concat(_y2,"px");}var changeSizeRow=container.querySelector(".fortune-rows-change-size");if(changeSizeRow){changeSizeRow.style.top="".concat(_y2,"px");}}}}function handleOverlayMouseMove(ctx,globalCache,e,cellInput,scrollX,scrollY,container){if(onCommentBoxResize(ctx,globalCache,e))return;if(onCommentBoxMove(ctx,globalCache,e))return;if(onImageMove(ctx,globalCache,e))return;if(onImageResize(ctx,globalCache,e))return;overShowComment(ctx,e,scrollX,scrollY,container);if(!!ctx.luckysheet_scroll_status||!!ctx.luckysheet_select_status||!!ctx.luckysheet_rows_selected_status||!!ctx.luckysheet_cols_selected_status||!!ctx.luckysheet_cell_selected_move||!!ctx.luckysheet_cell_selected_extend||!!ctx.luckysheet_cols_change_size||!!ctx.luckysheet_rows_change_size){mouseRender(ctx,globalCache,e,cellInput,scrollX,scrollY,container);}}function handleOverlayMouseUp(ctx,globalCache,settings,e,container){var rect=container.getBoundingClientRect();onImageMoveEnd(ctx,globalCache,container);onImageResizeEnd(ctx,globalCache,container);onCommentBoxMoveEnd(ctx,globalCache,container);onCommentBoxResizeEnd(ctx,globalCache,container);onFormulaRangeDragEnd(ctx);if(ctx.luckysheet_select_status){if(ctx.luckysheetPaintModelOn){pasteHandlerOfPaintModel(ctx,ctx.luckysheet_copy_save);if(ctx.luckysheetPaintSingle){cancelPaintModel(ctx);}}}ctx.luckysheet_select_status=false;ctx.luckysheet_scroll_status=false;ctx.luckysheet_rows_selected_status=false;ctx.luckysheet_cols_selected_status=false;ctx.luckysheet_model_move_state=false;if(ctx.luckysheet_rows_change_size){var _ctx$luckysheet_selec7,_ctx$luckysheet_selec8;ctx.luckysheet_rows_change_size=false;var scrollTop=ctx.scrollTop;var y=e.pageY-rect.top-ctx.columnHeaderHeight+scrollTop;var winH=rect.height;var size=y+3-ctx.luckysheet_rows_change_size_start[0];if(y+3-ctx.luckysheet_rows_change_size_start[0]<19){size=19;}if(y>=winH-20+scrollTop){size=winH-20-ctx.luckysheet_rows_change_size_start[0]+scrollTop;}var cfg=ctx.config;if(cfg.rowlen==null){cfg.rowlen={};}if(cfg.customHeight==null){cfg.customHeight={};}cfg.customHeight[ctx.luckysheet_rows_change_size_start[1]]=1;var changeRowIndex=ctx.luckysheet_rows_change_size_start[1];var changeRowSelected=false;if(((_ctx$luckysheet_selec7=(_ctx$luckysheet_selec8=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec8===void 0?void 0:_ctx$luckysheet_selec8.length)!==null&&_ctx$luckysheet_selec7!==void 0?_ctx$luckysheet_selec7:0)>0){var _ctx$luckysheet_selec9,_ctx$luckysheet_selec10;(_ctx$luckysheet_selec9=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec9===void 0?void 0:(_ctx$luckysheet_selec10=_ctx$luckysheet_selec9.filter(function(select){return select.row_select;}))===null||_ctx$luckysheet_selec10===void 0?void 0:_ctx$luckysheet_selec10.some(function(select){if(changeRowIndex>=select.row[0]&&changeRowIndex<=select.row[1]){changeRowSelected=true;}return changeRowSelected;});}if(changeRowSelected){var _ctx$luckysheet_selec11,_ctx$luckysheet_selec12;cfg.rowlen||(cfg.rowlen={});(_ctx$luckysheet_selec11=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec11===void 0?void 0:(_ctx$luckysheet_selec12=_ctx$luckysheet_selec11.filter(function(select){return select.row_select;}))===null||_ctx$luckysheet_selec12===void 0?void 0:_ctx$luckysheet_selec12.forEach(function(select){for(var r=select.row[0];r<=select.row[1];r+=1){cfg.rowlen[r]=Math.ceil(size/ctx.zoomRatio);}});}else {cfg.rowlen[ctx.luckysheet_rows_change_size_start[1]]=Math.ceil(size/ctx.zoomRatio);}ctx.config=cfg;var idx=getSheetIndex(ctx,ctx.currentSheetId);if(idx==null)return;ctx.luckysheetfile[idx].config=ctx.config;}if(ctx.luckysheet_cols_change_size){var _ctx$luckysheet_selec13,_ctx$luckysheet_selec14;ctx.luckysheet_cols_change_size=false;var scrollLeft=ctx.scrollLeft;var x=e.pageX-rect.left-ctx.rowHeaderWidth+scrollLeft;var winW=rect.width;var _size=x+3-ctx.luckysheet_cols_change_size_start[0];var firstcolumnlen=ctx.defaultcollen;if(ctx.config.columnlen!=null&&ctx.config.columnlen[ctx.luckysheet_cols_change_size_start[1]]!=null){firstcolumnlen=ctx.config.columnlen[ctx.luckysheet_cols_change_size_start[1]];}if(Math.abs(_size-firstcolumnlen)<3){return;}if(x+3-ctx.luckysheet_cols_change_size_start[0]<30){_size=30;}if(x>=winW-100+scrollLeft){_size=winW-100-ctx.luckysheet_cols_change_size_start[0]+scrollLeft;}var _cfg=ctx.config;if(_cfg.columnlen==null){_cfg.columnlen={};}if(_cfg.customWidth==null){_cfg.customWidth={};}_cfg.customWidth[ctx.luckysheet_cols_change_size_start[1]]=1;var changeColumnIndex=ctx.luckysheet_cols_change_size_start[1];var changeColumnSelected=false;if(((_ctx$luckysheet_selec13=(_ctx$luckysheet_selec14=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec14===void 0?void 0:_ctx$luckysheet_selec14.length)!==null&&_ctx$luckysheet_selec13!==void 0?_ctx$luckysheet_selec13:0)>0){var _ctx$luckysheet_selec15,_ctx$luckysheet_selec16;(_ctx$luckysheet_selec15=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec15===void 0?void 0:(_ctx$luckysheet_selec16=_ctx$luckysheet_selec15.filter(function(select){return select.column_select;}))===null||_ctx$luckysheet_selec16===void 0?void 0:_ctx$luckysheet_selec16.some(function(select){if(changeColumnIndex>=select.column[0]&&changeColumnIndex<=select.column[1]){changeColumnSelected=true;}return changeColumnSelected;});}if(changeColumnSelected){var _ctx$luckysheet_selec17,_ctx$luckysheet_selec18;_cfg.columnlen||(_cfg.columnlen={});(_ctx$luckysheet_selec17=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec17===void 0?void 0:(_ctx$luckysheet_selec18=_ctx$luckysheet_selec17.filter(function(select){return select.column_select;}))===null||_ctx$luckysheet_selec18===void 0?void 0:_ctx$luckysheet_selec18.forEach(function(select){for(var r=select.column[0];r<=select.column[1];r+=1){_cfg.columnlen[r]=Math.ceil(_size/ctx.zoomRatio);}});}else {_cfg.columnlen[ctx.luckysheet_cols_change_size_start[1]]=Math.ceil(_size/ctx.zoomRatio);}ctx.config=_cfg;var _idx=getSheetIndex(ctx,ctx.currentSheetId);if(_idx==null)return;ctx.luckysheetfile[_idx].config=ctx.config;}if(ctx.luckysheet_cell_selected_move);if(ctx.luckysheet_cell_selected_extend){onDropCellSelectEnd(ctx,e,container);}}function handleRowHeaderMouseDown(ctx,globalCache,e,container,cellInput,fxInput){if(!checkProtectionAllSelected(ctx,ctx.currentSheetId)){return;}removeEditingComment(ctx,globalCache);cancelActiveImgItem(ctx,globalCache);var rect=container.getBoundingClientRect();var y=e.pageY-rect.top+ctx.scrollTop;var row_location=rowLocation(y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];var col_index=ctx.visibledatacolumn.length-1;var col=ctx.visibledatacolumn[col_index];var col_pre=0;if(e.button===2){var isInSelection=false;var flowdata=getFlowdata(ctx);lodash.forEach(ctx.luckysheet_select_save,function(obj_s){var _flowdata$0$length,_flowdata$;if(obj_s.row!=null&&row_index>=obj_s.row[0]&&row_index<=obj_s.row[1]&&obj_s.column[0]===0&&obj_s.column[1]===((_flowdata$0$length=flowdata===null||flowdata===void 0?void 0:(_flowdata$=flowdata[0])===null||_flowdata$===void 0?void 0:_flowdata$.length)!==null&&_flowdata$0$length!==void 0?_flowdata$0$length:0)-1){isInSelection=true;return false;}return true;});if(isInSelection){return;}}var top=row_pre;var height=row-row_pre-1;var rowseleted=[row_index,row_index];ctx.luckysheet_scroll_status=true;if(!lodash.isEmpty(ctx.luckysheetCellUpdate)){if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){var _$last2;var changeparam=mergeMoveMain(ctx,[0,col_index],rowseleted,{row_focus:row_index,column_focus:0},top,height,col_pre,col);if(changeparam!=null){var _ref=[changeparam[1],changeparam[2],changeparam[3]];rowseleted=_ref[0];top=_ref[1];height=_ref[2];}if(e.shiftKey){var last=ctx.formulaCache.func_selectedrange;top=0;height=0;rowseleted=[];if(last==null||last.top==null||last.height==null||last.row==null||last.row_focus==null)return;if(last.top>row_pre){top=row_pre;height=last.top+last.height-row_pre;if(last.row[1]>last.row_focus){last.row[1]=last.row_focus;}rowseleted=[row_index,last.row[1]];}else if(last.top===row_pre){top=row_pre;height=last.top+last.height-row_pre;rowseleted=[row_index,last.row[0]];}else {top=last.top;height=row-last.top-1;if(last.row[0]<last.row_focus){last.row[0]=last.row_focus;}rowseleted=[last.row[0],row_index];}changeparam=mergeMoveMain(ctx,[0,col_index],rowseleted,{row_focus:row_index,column_focus:0},top,height,col_pre,col);if(changeparam!=null){var _ref2=[changeparam[1],changeparam[2],changeparam[3]];rowseleted=_ref2[0];top=_ref2[1];height=_ref2[2];}last.row=rowseleted;last.top_move=top;last.height_move=height;ctx.formulaCache.func_selectedrange=last;}else if(e.ctrlKey&&((_$last2=lodash.last(cellInput.querySelectorAll("span")))===null||_$last2===void 0?void 0:_$last2.innerText)!==","){var vText="".concat(cellInput.innerText,",");if(vText.length>0&&vText.substring(0,1)==="="){vText=functionHTMLGenerate(vText);if(window.getSelection){var _currSelection$anchor5,_currSelection$anchor6,_currSelection$anchor7,_currSelection$anchor8;var currSelection=window.getSelection();if(currSelection==null)return;ctx.formulaCache.functionRangeIndex=[lodash.indexOf((_currSelection$anchor5=currSelection.anchorNode)===null||_currSelection$anchor5===void 0?void 0:(_currSelection$anchor6=_currSelection$anchor5.parentNode)===null||_currSelection$anchor6===void 0?void 0:(_currSelection$anchor7=_currSelection$anchor6.parentNode)===null||_currSelection$anchor7===void 0?void 0:_currSelection$anchor7.childNodes,(_currSelection$anchor8=currSelection.anchorNode)===null||_currSelection$anchor8===void 0?void 0:_currSelection$anchor8.parentNode),currSelection.anchorOffset];}else {var textRange=document.selection.createRange();ctx.formulaCache.functionRangeIndex=textRange;}cellInput.innerHTML=vText;cancelFunctionrangeSelected(ctx);createRangeHightlight(ctx,vText);}ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;fxInput.innerHTML=vText;rangeHightlightselected(ctx,cellInput);israngeseleciton(ctx);ctx.formulaCache.func_selectedrange={left:colLocationByIndex(0,ctx.visibledatacolumn)[0],width:colLocationByIndex(0,ctx.visibledatacolumn)[1]-colLocationByIndex(0,ctx.visibledatacolumn)[0]-1,top:top,height:height,left_move:col_pre,width_move:col-col_pre-1,top_move:top,height_move:height,row:rowseleted,column:[0,col_index],row_focus:row_index,column_focus:0};}else {ctx.formulaCache.func_selectedrange={left:colLocationByIndex(0,ctx.visibledatacolumn)[0],width:colLocationByIndex(0,ctx.visibledatacolumn)[1]-colLocationByIndex(0,ctx.visibledatacolumn)[0]-1,top:top,height:height,left_move:col_pre,width_move:col-col_pre-1,top_move:top,height_move:height,row:rowseleted,column:[0,col_index],row_focus:row_index,column_focus:0};}if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){rangeSetValue(ctx,cellInput,{row:rowseleted,column:[null,null]});}ctx.formulaCache.rangedrag_row_start=true;ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_column_start=false;return;}updateCell(ctx,ctx.luckysheetCellUpdate[0],ctx.luckysheetCellUpdate[1],cellInput);ctx.luckysheet_rows_selected_status=true;}else {ctx.luckysheet_rows_selected_status=true;}if(ctx.luckysheet_rows_selected_status){if(e.shiftKey){var _ctx$luckysheet_selec19;var _last2=lodash.cloneDeep((_ctx$luckysheet_selec19=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec19===void 0?void 0:_ctx$luckysheet_selec19[ctx.luckysheet_select_save.length-1]);if(!_last2||lodash.isNil(_last2.top)||lodash.isNil(_last2.height)||lodash.isNil(_last2.row_focus)){return;}var _top=0;var _height=0;var _rowseleted=[];if(_last2.top>row_pre){_top=row_pre;_height=_last2.top+_last2.height-row_pre;if(_last2.row[1]>_last2.row_focus){_last2.row[1]=_last2.row_focus;}_rowseleted=[row_index,_last2.row[1]];}else if(_last2.top===row_pre){_top=row_pre;_height=_last2.top+_last2.height-row_pre;_rowseleted=[row_index,_last2.row[0]];}else {_top=_last2.top;_height=row-_last2.top-1;if(_last2.row[0]<_last2.row_focus){_last2.row[0]=_last2.row_focus;}_rowseleted=[_last2.row[0],row_index];}_last2.row=_rowseleted;_last2.top_move=_top;_last2.height_move=_height;ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1]=_last2;}else if(e.ctrlKey){var _ctx$luckysheet_selec20;(_ctx$luckysheet_selec20=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec20===void 0?void 0:_ctx$luckysheet_selec20.push({left:colLocationByIndex(0,ctx.visibledatacolumn)[0],width:colLocationByIndex(0,ctx.visibledatacolumn)[1]-colLocationByIndex(0,ctx.visibledatacolumn)[0]-1,top:top,height:height,left_move:col_pre,width_move:col-col_pre-1,top_move:top,height_move:height,row:rowseleted,column:[0,col_index],row_focus:row_index,column_focus:0,row_select:true});}else {ctx.luckysheet_select_save=[];ctx.luckysheet_select_save.push({left:colLocationByIndex(0,ctx.visibledatacolumn)[0],width:colLocationByIndex(0,ctx.visibledatacolumn)[1]-colLocationByIndex(0,ctx.visibledatacolumn)[0]-1,top:top,height:height,left_move:col_pre,width_move:col-col_pre-1,top_move:top,height_move:height,row:rowseleted,column:[0,col_index],row_focus:row_index,column_focus:0,row_select:true});}}}function handleColumnHeaderMouseDown(ctx,globalCache,e,container,cellInput,fxInput){if(!checkProtectionAllSelected(ctx,ctx.currentSheetId)){return;}removeEditingComment(ctx,globalCache);cancelActiveImgItem(ctx,globalCache);var rect=container.getBoundingClientRect();var x=e.pageX-rect.left+ctx.scrollLeft;var row_index=ctx.visibledatarow.length-1;var row=ctx.visibledatarow[row_index];var row_pre=0;var col_location=colLocation(x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];ctx.orderbyindex=col_index;if(e.button===2){var isInSelection=false;var flowdata=getFlowdata(ctx);lodash.forEach(ctx.luckysheet_select_save,function(obj_s){var _flowdata$length;if(obj_s.column!=null&&col_index>=obj_s.column[0]&&col_index<=obj_s.column[1]&&obj_s.row[0]===0&&obj_s.row[1]===((_flowdata$length=flowdata===null||flowdata===void 0?void 0:flowdata.length)!==null&&_flowdata$length!==void 0?_flowdata$length:0)-1){isInSelection=true;return false;}return true;});if(isInSelection){return;}}var left=col_pre;var width=col-col_pre-1;var columnseleted=[col_index,col_index];ctx.luckysheet_scroll_status=true;if(!lodash.isEmpty(ctx.luckysheetCellUpdate)){if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){var _$last3;var changeparam=mergeMoveMain(ctx,columnseleted,[0,row_index],{row_focus:0,column_focus:col_index},row_pre,row,left,width);if(changeparam!=null){var _ref3=[changeparam[0],changeparam[4],changeparam[5]];columnseleted=_ref3[0];left=_ref3[1];width=_ref3[2];}if(e.shiftKey){var last=ctx.formulaCache.func_selectedrange;left=0;width=0;columnseleted=[];if(last==null||last.width==null||last.height==null||last.left==null||last.column_focus==null)return;if(last.left>col_pre){left=col_pre;width=last.left+last.width-col_pre;if(last.column[1]>last.column_focus){last.column[1]=last.column_focus;}columnseleted=[col_index,last.column[1]];}else if(last.left===col_pre){left=col_pre;width=last.left+last.width-col_pre;columnseleted=[col_index,last.column[0]];}else {left=last.left;width=col-last.left-1;if(last.column[0]<last.column_focus){last.column[0]=last.column_focus;}columnseleted=[last.column[0],col_index];}changeparam=mergeMoveMain(ctx,columnseleted,[0,row_index],{row_focus:0,column_focus:col_index},row_pre,row,left,width);if(changeparam!=null){var _ref4=[changeparam[0],changeparam[4],changeparam[5]];columnseleted=_ref4[0];left=_ref4[1];width=_ref4[2];}last.column=columnseleted;last.left_move=left;last.width_move=width;ctx.formulaCache.func_selectedrange=last;}else if(e.ctrlKey&&((_$last3=lodash.last(cellInput.querySelectorAll("span")))===null||_$last3===void 0?void 0:_$last3.innerText)!==","){var vText="".concat(cellInput.innerText,",");if(vText.length>0&&vText.substring(0,1)==="="){vText=functionHTMLGenerate(vText);if(window.getSelection){var _currSelection$anchor9,_currSelection$anchor10,_currSelection$anchor11,_currSelection$anchor12;var currSelection=window.getSelection();if(currSelection==null)return;ctx.formulaCache.functionRangeIndex=[lodash.indexOf((_currSelection$anchor9=currSelection.anchorNode)===null||_currSelection$anchor9===void 0?void 0:(_currSelection$anchor10=_currSelection$anchor9.parentNode)===null||_currSelection$anchor10===void 0?void 0:(_currSelection$anchor11=_currSelection$anchor10.parentNode)===null||_currSelection$anchor11===void 0?void 0:_currSelection$anchor11.childNodes,(_currSelection$anchor12=currSelection.anchorNode)===null||_currSelection$anchor12===void 0?void 0:_currSelection$anchor12.parentNode),currSelection.anchorOffset];}else {var textRange=document.selection.createRange();ctx.formulaCache.functionRangeIndex=textRange;}cellInput.innerHTML=vText;cancelFunctionrangeSelected(ctx);createRangeHightlight(ctx,vText);}ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_column_start=false;ctx.formulaCache.rangedrag_row_start=false;fxInput.innerHTML=vText;rangeHightlightselected(ctx,cellInput);israngeseleciton(ctx);ctx.formulaCache.func_selectedrange={left:left,width:width,top:rowLocationByIndex(0,ctx.visibledatarow)[0],height:rowLocationByIndex(0,ctx.visibledatarow)[1]-rowLocationByIndex(0,ctx.visibledatarow)[0]-1,left_move:left,width_move:width,top_move:row_pre,height_move:row-row_pre-1,row:[0,row_index],column:columnseleted,row_focus:0,column_focus:col_index};}else {ctx.formulaCache.func_selectedrange={left:left,width:width,top:rowLocationByIndex(0,ctx.visibledatarow)[0],height:rowLocationByIndex(0,ctx.visibledatarow)[1]-rowLocationByIndex(0,ctx.visibledatarow)[0]-1,left_move:left,width_move:width,top_move:row_pre,height_move:row-row_pre-1,row:[0,row_index],column:columnseleted,row_focus:0,column_focus:col_index};}if(ctx.formulaCache.rangestart||ctx.formulaCache.rangedrag_column_start||ctx.formulaCache.rangedrag_row_start||israngeseleciton(ctx)){rangeSetValue(ctx,cellInput,{row:[null,null],column:columnseleted});}ctx.formulaCache.rangedrag_column_start=true;ctx.formulaCache.rangestart=false;ctx.formulaCache.rangedrag_row_start=false;return;}updateCell(ctx,ctx.luckysheetCellUpdate[0],ctx.luckysheetCellUpdate[1],cellInput);ctx.luckysheet_cols_selected_status=true;}else {ctx.luckysheet_cols_selected_status=true;}if(ctx.luckysheet_cols_selected_status){if(e.shiftKey){var _ctx$luckysheet_selec21;var _last3=lodash.cloneDeep((_ctx$luckysheet_selec21=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec21===void 0?void 0:_ctx$luckysheet_selec21[ctx.luckysheet_select_save.length-1]);var _left=0;var _width=0;var _columnseleted=[];if(!_last3||lodash.isNil(_last3.left)||lodash.isNil(_last3.width)||lodash.isNil(_last3.column_focus)){return;}if(_last3.left>col_pre){_left=col_pre;_width=_last3.left+_last3.width-col_pre;if(_last3.column[1]>_last3.column_focus){_last3.column[1]=_last3.column_focus;}_columnseleted=[col_index,_last3.column[1]];}else if(_last3.left===col_pre){_left=col_pre;_width=_last3.left+_last3.width-col_pre;_columnseleted=[col_index,_last3.column[0]];}else {_left=_last3.left;_width=col-_last3.left-1;if(_last3.column[0]<_last3.column_focus){_last3.column[0]=_last3.column_focus;}_columnseleted=[_last3.column[0],col_index];}_last3.column=_columnseleted;_last3.left_move=_left;_last3.width_move=_width;ctx.luckysheet_select_save[ctx.luckysheet_select_save.length-1]=_last3;}else if(e.ctrlKey){var _ctx$luckysheet_selec22;(_ctx$luckysheet_selec22=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec22===void 0?void 0:_ctx$luckysheet_selec22.push({left:left,width:width,top:rowLocationByIndex(0,ctx.visibledatarow)[0],height:rowLocationByIndex(0,ctx.visibledatarow)[1]-rowLocationByIndex(0,ctx.visibledatarow)[0]-1,left_move:left,width_move:width,top_move:row_pre,height_move:row-row_pre-1,row:[0,row_index],column:columnseleted,row_focus:0,column_focus:col_index,column_select:true});}else {ctx.luckysheet_select_save=[];ctx.luckysheet_select_save.push({left:left,width:width,top:rowLocationByIndex(0,ctx.visibledatarow)[0],height:rowLocationByIndex(0,ctx.visibledatarow)[1]-rowLocationByIndex(0,ctx.visibledatarow)[0]-1,left_move:left,width_move:width,top_move:row_pre,height_move:row-row_pre-1,row:[0,row_index],column:columnseleted,row_focus:0,column_focus:col_index,column_select:true});}}}function handleColSizeHandleMouseDown(ctx,globalCache,e,headerContainer,workbookContainer,cellArea){removeEditingComment(ctx,globalCache);cancelActiveImgItem(ctx,globalCache);ctx.luckysheetCellUpdate=[];var scrollLeft=ctx.scrollLeft;var scrollTop=ctx.scrollTop;var x=e.pageX-headerContainer.getBoundingClientRect().left+scrollLeft;var col_location=colLocation(x,ctx.visibledatacolumn);var col=col_location[1];var col_pre=col_location[0];var col_index=col_location[2];ctx.luckysheet_cols_change_size=true;ctx.luckysheet_scroll_status=true;var changeSizeLine=workbookContainer.querySelector(".fortune-change-size-line");if(changeSizeLine){var ele=changeSizeLine;ele.style.height="".concat(cellArea.getBoundingClientRect().height+scrollTop,"px");ele.style.borderWidth="0 1px 0 0";ele.style.top="0";ele.style.left="".concat(col-3,"px");ele.style.width="1px";}ctx.luckysheet_cols_change_size_start=[col_pre,col_index];e.stopPropagation();}function handleRowSizeHandleMouseDown(ctx,globalCache,e,headerContainer,workbookContainer,cellArea){removeEditingComment(ctx,globalCache);cancelActiveImgItem(ctx,globalCache);ctx.luckysheetCellUpdate=[];var scrollLeft=ctx.scrollLeft;var scrollTop=ctx.scrollTop;var y=e.pageY-headerContainer.getBoundingClientRect().top+scrollTop;var row_location=rowLocation(y,ctx.visibledatarow);var row=row_location[1];var row_pre=row_location[0];var row_index=row_location[2];ctx.luckysheet_rows_change_size=true;ctx.luckysheet_scroll_status=true;var changeSizeLine=workbookContainer.querySelector(".fortune-change-size-line");if(changeSizeLine){var ele=changeSizeLine;ele.style.width="".concat(cellArea.getBoundingClientRect().width+scrollLeft,"px");ele.style.borderWidth="0 0 1px 0";ele.style.top="".concat(row-3,"px");ele.style.left="0";ele.style.height="1px";}ctx.luckysheet_rows_change_size_start=[row_pre,row_index];e.stopPropagation();}function postPasteCut(ctx,source,target,RowlChange){var execF_rc={};ctx.formulaCache.execFunctionExist=[];for(var r=source.range.row[0];r<=source.range.row[1];r+=1){for(var c=source.range.column[0];c<=source.range.column[1];c+=1){if("".concat(r,"_").concat(c,"_").concat(source.sheetId)in execF_rc){continue;}execF_rc["".concat(r,"_").concat(c,"_").concat(source.sheetId)]=0;ctx.formulaCache.execFunctionExist.push({r:r,c:c,i:source.sheetId});}}for(var _r=target.range.row[0];_r<=target.range.row[1];_r+=1){for(var _c=target.range.column[0];_c<=target.range.column[1];_c+=1){if("".concat(_r,"_").concat(_c,"_").concat(target.sheetId)in execF_rc){continue;}execF_rc["".concat(_r,"_").concat(_c,"_").concat(target.sheetId)]=0;ctx.formulaCache.execFunctionExist.push({r:_r,c:_c,i:target.sheetId});}}var rowHeight;if(ctx.currentSheetId===source.sheetId){ctx.config=source.curConfig;rowHeight=source.curData.length;ctx.luckysheetfile[getSheetIndex(ctx,target.sheetId)].config=target.curConfig;}else if(ctx.currentSheetId===target.sheetId){ctx.config=target.curConfig;rowHeight=target.curData.length;ctx.luckysheetfile[getSheetIndex(ctx,source.sheetId)].config=source.curConfig;}if(RowlChange){ctx.visibledatarow=[];ctx.rh_height=0;for(var i=0;i<rowHeight;i+=1){var rowlen=ctx.defaultrowlen;if(ctx.config.rowlen!=null&&ctx.config.rowlen[i]!=null){rowlen=ctx.config.rowlen[i];}if(ctx.config.rowhidden!=null&&ctx.config.rowhidden[i]!=null){rowlen=ctx.config.rowhidden[i];ctx.visibledatarow.push(ctx.rh_height);continue;}else {ctx.rh_height+=rowlen+1;}ctx.visibledatarow.push(ctx.rh_height);}ctx.rh_height+=80;if(ctx.currentSheetId===source.sheetId);else if(ctx.currentSheetId===target.sheetId);}if(ctx.currentSheetId===source.sheetId){ctx.luckysheetfile[getSheetIndex(ctx,target.sheetId)].data=target.curData;}else if(ctx.currentSheetId===target.sheetId){ctx.luckysheetfile[getSheetIndex(ctx,source.sheetId)].data=source.curData;}if(ctx.currentSheetId===target.sheetId){ctx.luckysheet_select_save=[{row:target.range.row,column:target.range.column}];}else {ctx.luckysheet_select_save=[{row:source.range.row,column:source.range.column}];}if(ctx.luckysheet_select_save.length>0);ctx.luckysheetfile[getSheetIndex(ctx,source.sheetId)].luckysheet_conditionformat_save=source.curCdformat;ctx.luckysheetfile[getSheetIndex(ctx,target.sheetId)].luckysheet_conditionformat_save=target.curCdformat;ctx.luckysheetfile[getSheetIndex(ctx,source.sheetId)].dataVerification=source.curDataVerification;ctx.luckysheetfile[getSheetIndex(ctx,target.sheetId)].dataVerification=target.curDataVerification;ctx.formulaCache.execFunctionExist.reverse();execFunctionGroup(ctx,null,null,null,null,target.curData);ctx.formulaCache.execFunctionGlobalData=null;storeSheetParamALL(ctx);}function pasteHandler(ctx,data,borderInfo){var _ctx$luckysheet_selec,_ctx$luckysheet_selec2;if(!ctx.allowEdit){return;}if(((_ctx$luckysheet_selec=(_ctx$luckysheet_selec2=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec2===void 0?void 0:_ctx$luckysheet_selec2.length)!==null&&_ctx$luckysheet_selec!==void 0?_ctx$luckysheet_selec:0)!==1){return;}if(_typeof$1(data)==="object"){if(data.length===0){return;}var cfg=ctx.config||{};if(cfg.merge==null){cfg.merge={};}if(JSON.stringify(borderInfo).length>2&&cfg.borderInfo==null){cfg.borderInfo=[];}var copyh=data.length;var copyc=data[0].length;var minh=ctx.luckysheet_select_save[0].row[0];var maxh=minh+copyh-1;var minc=ctx.luckysheet_select_save[0].column[0];var maxc=minc+copyc-1;var has_PartMC=false;if(cfg.merge!=null){has_PartMC=hasPartMC(ctx,cfg,minh,maxh,minc,maxc);}if(has_PartMC){return;}var d=getFlowdata(ctx);if(!d)return;var rowMaxLength=d.length;var cellMaxLength=d[0].length;var addr=maxh-rowMaxLength+1;var addc=maxc-cellMaxLength+1;if(addr>0||addc>0){expandRowsAndColumns(d,addr,addc);}if(!d)return;if(cfg.rowlen==null){cfg.rowlen={};}var RowlChange=false;var offsetMC={};for(var h=minh;h<=maxh;h+=1){var x=d[h];var currentRowLen=ctx.defaultrowlen;if(cfg.rowlen[h]!=null){currentRowLen=cfg.rowlen[h];}for(var c=minc;c<=maxc;c+=1){var _x$c,_x$c2;if(x===null||x===void 0?void 0:(_x$c=x[c])===null||_x$c===void 0?void 0:_x$c.mc){if("rs"in x[c].mc){delete cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)];}delete x[c].mc;}var value=null;if(data[h-minh]!=null&&data[h-minh][c-minc]!=null){value=data[h-minh][c-minc];}x[c]=value;if(value!=null&&(x===null||x===void 0?void 0:(_x$c2=x[c])===null||_x$c2===void 0?void 0:_x$c2.mc)){if(x[c].mc.rs!=null){x[c].mc.r=h;x[c].mc.c=c;cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)]=x[c].mc;offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)]=[x[c].mc.r,x[c].mc.c];}else {x[c]={mc:{r:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][0],c:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][1]}};}}if(borderInfo["".concat(h-minh,"_").concat(c-minc)]){var _cfg$borderInfo;var bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:borderInfo["".concat(h-minh,"_").concat(c-minc)].l,r:borderInfo["".concat(h-minh,"_").concat(c-minc)].r,t:borderInfo["".concat(h-minh,"_").concat(c-minc)].t,b:borderInfo["".concat(h-minh,"_").concat(c-minc)].b}};(_cfg$borderInfo=cfg.borderInfo)===null||_cfg$borderInfo===void 0?void 0:_cfg$borderInfo.push(bd_obj);}}d[h]=x;if(currentRowLen!==ctx.defaultrowlen){cfg.rowlen[h]=currentRowLen;}}ctx.luckysheet_select_save=[{row:[minh,maxh],column:[minc,maxc]}];if(addr>0||addc>0||RowlChange){ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].config=cfg;}else {ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].config=cfg;}}else {var _ctx$luckysheet_selec3;data=data.replace(/\r/g,"");var dataChe=[];var che=data.split("\n");var colchelen=che[0].split("\t").length;for(var i=0;i<che.length;i+=1){if(che[i].split("\t").length<colchelen){continue;}dataChe.push(che[i].split("\t"));}var _d=getFlowdata(ctx);if(!_d)return;var last=(_ctx$luckysheet_selec3=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec3===void 0?void 0:_ctx$luckysheet_selec3[ctx.luckysheet_select_save.length-1];if(!last)return;var curR=last.row==null?0:last.row[0];var curC=last.column==null?0:last.column[0];var rlen=dataChe.length;var clen=dataChe[0].length;var _has_PartMC=false;if(ctx.config.merge!=null){_has_PartMC=hasPartMC(ctx,ctx.config,curR,curR+rlen-1,curC,curC+clen-1);}if(_has_PartMC){return;}var _addr=curR+rlen-_d.length;var _addc=curC+clen-_d[0].length;if(_addr>0||_addc>0){expandRowsAndColumns(_d,_addr,_addc);}if(!_d)return;for(var r=0;r<rlen;r+=1){var _x=_d[r+curR];for(var _c2=0;_c2<clen;_c2+=1){var originCell=_x[_c2+curC];var _value=dataChe[r][_c2];if(isRealNum(_value)){if(originCell&&originCell.ct&&originCell.ct.fa==="@"){_value=String(_value);}else {_value=parseFloat(_value);}}if(originCell){originCell.v=_value;if(originCell.ct!=null&&originCell.ct.fa!=null){originCell.m=update(originCell.ct.fa,_value);}else {originCell.m=_value;}if(originCell.f!=null&&originCell.f.length>0){originCell.f="";delFunctionGroup(ctx,r+curR,_c2+curC,ctx.currentSheetId);}}else {var cell={};var mask=genarate(_value);var _mask=_slicedToArray$3(mask,3);cell.m=_mask[0];cell.ct=_mask[1];cell.v=_mask[2];_x[_c2+curC]=cell;}}_d[r+curR]=_x;}last.row=[curR,curR+rlen-1];last.column=[curC,curC+clen-1];}}function pasteHandlerOfCutPaste(ctx,copyRange){var _ctx$luckysheet_selec4;if(!ctx.allowEdit){return;}if(!copyRange)return;var cfg=ctx.config||{};if(cfg.merge==null){cfg.merge={};}var copyHasMC=copyRange.HasMC;var copyRowlChange=copyRange.RowlChange;var copySheetId=copyRange.dataSheetId;var c_r1=copyRange.copyRange[0].row[0];var c_r2=copyRange.copyRange[0].row[1];var c_c1=copyRange.copyRange[0].column[0];var c_c2=copyRange.copyRange[0].column[1];var copyData=lodash.cloneDeep(getdatabyselection(ctx,{row:[c_r1,c_r2],column:[c_c1,c_c2]},copySheetId));var copyh=copyData.length;var copyc=copyData[0].length;var last=(_ctx$luckysheet_selec4=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec4===void 0?void 0:_ctx$luckysheet_selec4[ctx.luckysheet_select_save.length-1];if(!last||!last.row_focus||!last.column_focus)return;var minh=last.row_focus;var maxh=minh+copyh-1;var minc=last.column_focus;var maxc=minc+copyc-1;var has_PartMC=false;if(cfg.merge!=null){has_PartMC=hasPartMC(ctx,cfg,minh,maxh,minc,maxc);}if(has_PartMC){return;}var d=getFlowdata(ctx);if(!d)return;var rowMaxLength=d.length;var cellMaxLength=d[0].length;var addr=copyh+minh-rowMaxLength;var addc=copyc+minc-cellMaxLength;if(addr>0||addc>0){expandRowsAndColumns(d,addr,addc);}var borderInfoCompute=getBorderInfoCompute(ctx,copySheetId);var c_dataVerification=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetId)].dataVerification)||{};var dataVerification=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].dataVerification)||{};if(ctx.currentSheetId===copySheetId){for(var i=c_r1;i<=c_r2;i+=1){for(var j=c_c1;j<=c_c2;j+=1){var cell=d[i][j];if(cell&&lodash.isPlainObject(cell)&&"mc"in cell){var _cell$mc;if(((_cell$mc=cell.mc)===null||_cell$mc===void 0?void 0:_cell$mc.rs)!=null){delete cfg.merge["".concat(cell.mc.r,"_").concat(cell.mc.c)];}delete cell.mc;}d[i][j]=null;delete dataVerification["".concat(i,"_").concat(j)];}}if(cfg.borderInfo&&cfg.borderInfo.length>0){var source_borderInfo=[];for(var _i=0;_i<cfg.borderInfo.length;_i+=1){var bd_rangeType=cfg.borderInfo[_i].rangeType;if(bd_rangeType==="range"){source_borderInfo.push(cfg.borderInfo[_i]);}else if(bd_rangeType==="cell"){var bd_r=cfg.borderInfo[_i].value.row_index;var bd_c=cfg.borderInfo[_i].value.col_index;if(!(bd_r>=c_r1&&bd_r<=c_r2&&bd_c>=c_c1&&bd_c<=c_c2)){source_borderInfo.push(cfg.borderInfo[_i]);}}}cfg.borderInfo=source_borderInfo;}}var offsetMC={};for(var h=minh;h<=maxh;h+=1){var x=d[h];for(var c=minc;c<=maxc;c+=1){var _x$c3,_x$c5;if(borderInfoCompute["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)]){var bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:borderInfoCompute["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)].l,r:borderInfoCompute["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)].r,t:borderInfoCompute["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)].t,b:borderInfoCompute["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)].b}};if(cfg.borderInfo==null){cfg.borderInfo=[];}cfg.borderInfo.push(bd_obj);}else if(borderInfoCompute["".concat(h,"_").concat(c)]){var _bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:null,r:null,t:null,b:null}};if(cfg.borderInfo==null){cfg.borderInfo=[];}cfg.borderInfo.push(_bd_obj);}if(c_dataVerification["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)]){dataVerification["".concat(h,"_").concat(c)]=c_dataVerification["".concat(c_r1+h-minh,"_").concat(c_c1+c-minc)];}if((_x$c3=x[c])===null||_x$c3===void 0?void 0:_x$c3.mc){var _x$c4,_x$c4$mc;if(((_x$c4=x[c])===null||_x$c4===void 0?void 0:(_x$c4$mc=_x$c4.mc)===null||_x$c4$mc===void 0?void 0:_x$c4$mc.rs)!=null){delete cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)];}delete x[c].mc;}var value=null;if(copyData[h-minh]!=null&&copyData[h-minh][c-minc]!=null){value=copyData[h-minh][c-minc];}x[c]=lodash.cloneDeep(value);if(value!=null&&copyHasMC&&((_x$c5=x[c])===null||_x$c5===void 0?void 0:_x$c5.mc)){if(x[c].mc.rs!=null){x[c].mc.r=h;x[c].mc.c=c;cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)]=x[c].mc;offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)]=[x[c].mc.r,x[c].mc.c];}else {x[c]={mc:{r:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][0],c:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][1]}};}}}d[h]=x;}last.row=[minh,maxh];last.column=[minc,maxc];var source;var target;if(ctx.currentSheetId!==copySheetId){var sourceData=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetId)].data);var sourceConfig=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetId)].config);var sourceCurData=lodash.cloneDeep(sourceData);var sourceCurConfig=lodash.cloneDeep(sourceConfig)||{};if(sourceCurConfig.merge==null){sourceCurConfig.merge={};}for(var source_r=c_r1;source_r<=c_r2;source_r+=1){for(var source_c=c_c1;source_c<=c_c2;source_c+=1){var _cell=sourceCurData[source_r][source_c];if(_cell===null||_cell===void 0?void 0:_cell.mc){if("rs"in _cell.mc){delete sourceCurConfig.merge["".concat(_cell.mc.r,"_").concat(_cell.mc.c)];}delete _cell.mc;}sourceCurData[source_r][source_c]=null;}}if(sourceCurConfig.borderInfo&&sourceCurConfig.borderInfo.length>0){var _source_borderInfo=[];for(var _i2=0;_i2<sourceCurConfig.borderInfo.length;_i2+=1){var _bd_rangeType=sourceCurConfig.borderInfo[_i2].rangeType;if(_bd_rangeType==="range"){_source_borderInfo.push(sourceCurConfig.borderInfo[_i2]);}else if(_bd_rangeType==="cell"){var _bd_r=sourceCurConfig.borderInfo[_i2].value.row_index;var _bd_c=sourceCurConfig.borderInfo[_i2].value.col_index;if(!(_bd_r>=c_r1&&_bd_r<=c_r2&&_bd_c>=c_c1&&_bd_c<=c_c2)){_source_borderInfo.push(sourceCurConfig.borderInfo[_i2]);}}}sourceCurConfig.borderInfo=_source_borderInfo;}var source_cdformat=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetId)].luckysheet_conditionformat_save);var source_curCdformat=lodash.cloneDeep(source_cdformat);var ruleArr=[];var target_cdformat=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].luckysheet_conditionformat_save);var target_curCdformat=lodash.cloneDeep(target_cdformat);if(ruleArr.length>0){var _target_curCdformat;target_curCdformat=(_target_curCdformat=target_curCdformat)===null||_target_curCdformat===void 0?void 0:_target_curCdformat.concat(ruleArr);}for(var _i3=c_r1;_i3<=c_r2;_i3+=1){for(var _j=c_c1;_j<=c_c2;_j+=1){delete c_dataVerification["".concat(_i3,"_").concat(_j)];}}source={sheetId:copySheetId,data:sourceData,curData:sourceCurData,config:sourceConfig,curConfig:sourceCurConfig,cdformat:source_cdformat,curCdformat:source_curCdformat,dataVerification:lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetId)].dataVerification),curDataVerification:c_dataVerification,range:{row:[c_r1,c_r2],column:[c_c1,c_c2]}};target={sheetId:ctx.currentSheetId,data:getFlowdata(ctx),curData:d,config:lodash.cloneDeep(ctx.config),curConfig:cfg,cdformat:target_cdformat,curCdformat:target_curCdformat,dataVerification:lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].dataVerification),curDataVerification:dataVerification,range:{row:[minh,maxh],column:[minc,maxc]}};}else {var cdformat=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].luckysheet_conditionformat_save);var curCdformat=lodash.cloneDeep(cdformat);if(curCdformat!=null&&curCdformat.length>0);source={sheetId:ctx.currentSheetId,data:getFlowdata(ctx),curData:d,config:lodash.cloneDeep(ctx.config),curConfig:cfg,cdformat:cdformat,curCdformat:curCdformat,dataVerification:lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].dataVerification),curDataVerification:dataVerification,range:{row:[c_r1,c_r2],column:[c_c1,c_c2]}};target={sheetId:ctx.currentSheetId,data:getFlowdata(ctx),curData:d,config:lodash.cloneDeep(ctx.config),curConfig:cfg,cdformat:cdformat,curCdformat:curCdformat,dataVerification:lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)].dataVerification),curDataVerification:dataVerification,range:{row:[minh,maxh],column:[minc,maxc]}};}if(addr>0||addc>0){postPasteCut(ctx,source,target,true);}else {postPasteCut(ctx,source,target,copyRowlChange);}}function pasteHandlerOfCopyPaste(ctx,copyRange){var _ctx$luckysheet_selec5;if(!ctx.allowEdit){return;}if(!copyRange)return;var cfg=ctx.config;if(lodash.isNil(cfg.merge)){cfg.merge={};}var copyHasMC=copyRange.HasMC;var copyRowlChange=copyRange.RowlChange;var copySheetIndex=copyRange.dataSheetId;var c_r1=copyRange.copyRange[0].row[0];var c_r2=copyRange.copyRange[0].row[1];var c_c1=copyRange.copyRange[0].column[0];var c_c2=copyRange.copyRange[0].column[1];var arr=[];var isSameRow=false;var _loop=function _loop(i){var arrData=getdatabyselection(ctx,{row:copyRange.copyRange[i].row,column:copyRange.copyRange[i].column},copySheetIndex);if(copyRange.copyRange.length>1){if(c_r1===copyRange.copyRange[1].row[0]&&c_r2===copyRange.copyRange[1].row[1]){arrData=arrData[0].map(function(col,a){return arrData.map(function(row){return row[a];});});arr=arr.concat(arrData);isSameRow=true;}else if(c_c1===copyRange.copyRange[1].column[0]&&c_c2===copyRange.copyRange[1].column[1]){arr=arr.concat(arrData);}}else {arr=arrData;}};for(var i=0;i<copyRange.copyRange.length;i+=1){_loop(i);}if(isSameRow){arr=arr[0].map(function(col,b){return arr.map(function(row){return row[b];});});}var copyData=lodash.cloneDeep(arr);if(copyRange.copyRange.length>1){for(var _i4=0;_i4<copyData.length;_i4+=1){for(var j=0;j<copyData[_i4].length;j+=1){if(copyData[_i4][j]!=null&&copyData[_i4][j].f!=null){delete copyData[_i4][j].f;delete copyData[_i4][j].spl;}}}}var copyh=copyData.length;var copyc=copyData[0].length;var last=(_ctx$luckysheet_selec5=ctx.luckysheet_select_save)===null||_ctx$luckysheet_selec5===void 0?void 0:_ctx$luckysheet_selec5[ctx.luckysheet_select_save.length-1];if(!last)return;var minh=last.row[0];var maxh=last.row[1];var minc=last.column[0];var maxc=last.column[1];var mh=(maxh-minh+1)%copyh;var mc=(maxc-minc+1)%copyc;if(mh!==0||mc!==0){maxh=minh+copyh-1;maxc=minc+copyc-1;}var has_PartMC=false;if(!lodash.isNil(cfg.merge)){has_PartMC=hasPartMC(ctx,cfg,minh,maxh,minc,maxc);}if(has_PartMC){return;}var timesH=(maxh-minh+1)/copyh;var timesC=(maxc-minc+1)/copyc;var d=getFlowdata(ctx);if(!d)return;var rowMaxLength=d.length;var cellMaxLength=d[0].length;var addr=copyh+minh-rowMaxLength;var addc=copyc+minc-cellMaxLength;if(addr>0||addc>0){expandRowsAndColumns(d,addr,addc);}var borderInfoCompute=getBorderInfoCompute(ctx,copySheetIndex);var c_dataVerification=lodash.cloneDeep(ctx.luckysheetfile[getSheetIndex(ctx,copySheetIndex)].dataVerification)||{};var dataVerification=null;var mth=0;var mtc=0;var maxcellCahe=0;var maxrowCache=0;for(var th=1;th<=timesH;th+=1){for(var tc=1;tc<=timesC;tc+=1){mth=minh+(th-1)*copyh;mtc=minc+(tc-1)*copyc;maxrowCache=minh+th*copyh;maxcellCahe=minc+tc*copyc;var offsetRow=mth-c_r1;var offsetCol=mtc-c_c1;var offsetMC={};for(var h=mth;h<maxrowCache;h+=1){var x=d[h];for(var c=mtc;c<maxcellCahe;c+=1){var _x$c6,_copyData,_x$c7;if(borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)]){var bd_obj={rangeType:"cell",value:{row_index:h,col_index:c,l:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].l,r:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].r,t:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].t,b:borderInfoCompute["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)].b}};if(lodash.isNil(cfg.borderInfo)){cfg.borderInfo=[];}cfg.borderInfo.push(bd_obj);}else if(borderInfoCompute["".concat(h,"_").concat(c)]){var _bd_obj2={rangeType:"cell",value:{row_index:h,col_index:c,l:null,r:null,t:null,b:null}};if(lodash.isNil(cfg.borderInfo)){cfg.borderInfo=[];}cfg.borderInfo.push(_bd_obj2);}if(c_dataVerification["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)]){if(lodash.isNil(dataVerification)){var _ctx$luckysheetfile$g;dataVerification=lodash.cloneDeep(((_ctx$luckysheetfile$g=ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)])===null||_ctx$luckysheetfile$g===void 0?void 0:_ctx$luckysheetfile$g.dataVerification)||{});}dataVerification["".concat(h,"_").concat(c)]=c_dataVerification["".concat(c_r1+h-mth,"_").concat(c_c1+c-mtc)];}if(((_x$c6=x[c])===null||_x$c6===void 0?void 0:_x$c6.mc)!=null){if("rs"in x[c].mc){delete cfg.merge["".concat(x[c].mc.r,"_").concat(x[c].mc.c)];}delete x[c].mc;}var value=null;if((_copyData=copyData[h-mth])===null||_copyData===void 0?void 0:_copyData[c-mtc]){value=lodash.cloneDeep(copyData[h-mth][c-mtc]);}if(!lodash.isNil(value)&&!lodash.isNil(value.f)){var func=value.f;if(offsetRow>0){func="=".concat(functionCopy(ctx,func,"down",offsetRow));}if(offsetRow<0){func="=".concat(functionCopy(ctx,func,"up",Math.abs(offsetRow)));}if(offsetCol>0){func="=".concat(functionCopy(ctx,func,"right",offsetCol));}if(offsetCol<0){func="=".concat(functionCopy(ctx,func,"left",Math.abs(offsetCol)));}var funcV=execfunction(ctx,func,h,c,undefined,true);if(!lodash.isNil(value.spl));else {var _funcV=_slicedToArray$3(funcV,3);value.v=_funcV[1];value.f=_funcV[2];if(!lodash.isNil(value.ct)&&!lodash.isNil(value.ct.fa)){value.m=update(value.ct.fa,funcV[1]);}}}x[c]=lodash.cloneDeep(value);if(value!=null&&copyHasMC&&(x===null||x===void 0?void 0:(_x$c7=x[c])===null||_x$c7===void 0?void 0:_x$c7.mc)){var _x$c8,_x$c8$mc;if((x===null||x===void 0?void 0:(_x$c8=x[c])===null||_x$c8===void 0?void 0:(_x$c8$mc=_x$c8.mc)===null||_x$c8$mc===void 0?void 0:_x$c8$mc.rs)!=null){x[c].mc.r=h;x[c].mc.c=c;cfg.merge["".concat(h,"_").concat(c)]=x[c].mc;offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)]=[x[c].mc.r,x[c].mc.c];}else {x[c]={mc:{r:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][0],c:offsetMC["".concat(value.mc.r,"_").concat(value.mc.c)][1]}};}}}d[h]=x;}}}var cdformat=undefined;last.row=[minh,maxh];last.column=[minc,maxc];var file=ctx.luckysheetfile[getSheetIndex(ctx,ctx.currentSheetId)];file.config=cfg;file.luckysheet_conditionformat_save=cdformat;file.dataVerification=dataVerification;}function handlePaste(ctx,e){if(!ctx.allowEdit){return;}if(selectionCache.isPasteAction){var _ctx$luckysheet_copy_,_ctx$hooks$beforePast,_ctx$hooks,_ctx$luckysheet_copy_2;ctx.luckysheetCellUpdate=[];selectionCache.isPasteAction=false;var clipboardData=e.clipboardData;if(!clipboardData){clipboardData=window.clipboardData;}if(!clipboardData)return;var txtdata=clipboardData.getData("text/html")||clipboardData.getData("text/plain");var isEqual=true;if(txtdata.indexOf("fortune-copy-action-table")>-1&&((_ctx$luckysheet_copy_=ctx.luckysheet_copy_save)===null||_ctx$luckysheet_copy_===void 0?void 0:_ctx$luckysheet_copy_.copyRange)!=null&&ctx.luckysheet_copy_save.copyRange.length>0){var cpDataArr=[];var reg=/<tr.*?>(.*?)<\/tr>/g;var reg2=/<td.*?>(.*?)<\/td>/g;var regArr=txtdata.match(reg)||[];for(var i=0;i<regArr.length;i+=1){var cpRowArr=[];var reg2Arr=regArr[i].match(reg2);if(!lodash.isNil(reg2Arr)){for(var j=0;j<reg2Arr.length;j+=1){var cpValue=reg2Arr[j].replace(/<td.*?>/g,"").replace(/<\/td>/g,"");cpRowArr.push(cpValue);}}cpDataArr.push(cpRowArr);}var copy_r1=ctx.luckysheet_copy_save.copyRange[0].row[0];var copy_r2=ctx.luckysheet_copy_save.copyRange[0].row[1];var copy_c1=ctx.luckysheet_copy_save.copyRange[0].column[0];var copy_c2=ctx.luckysheet_copy_save.copyRange[0].column[1];var copy_index=ctx.luckysheet_copy_save.dataSheetId;var d;if(copy_index===ctx.currentSheetId){d=getFlowdata(ctx);}else {var index=getSheetIndex(ctx,copy_index);if(lodash.isNil(index))return;d=ctx.luckysheetfile[index].data;}if(!d)return;for(var r=copy_r1;r<=copy_r2;r+=1){if(r-copy_r1>cpDataArr.length-1){break;}for(var c=copy_c1;c<=copy_c2;c+=1){var _d$r3,_d$r3$c,_d$r3$c$ct;var cell=d[r][c];var isInlineStr=false;if(!lodash.isNil(cell)&&!lodash.isNil(cell.mc)&&lodash.isNil(cell.mc.rs)){continue;}var v=void 0;if(!lodash.isNil(cell)){var _cell$ct$fa$indexOf,_cell$ct,_cell$ct$fa;if(((_cell$ct$fa$indexOf=(_cell$ct=cell.ct)===null||_cell$ct===void 0?void 0:(_cell$ct$fa=_cell$ct.fa)===null||_cell$ct$fa===void 0?void 0:_cell$ct$fa.indexOf("w"))!==null&&_cell$ct$fa$indexOf!==void 0?_cell$ct$fa$indexOf:-1)>-1){var _d$r,_d$r$c;v=(_d$r=d[r])===null||_d$r===void 0?void 0:(_d$r$c=_d$r[c])===null||_d$r$c===void 0?void 0:_d$r$c.v;}else {var _d$r2,_d$r2$c;v=(_d$r2=d[r])===null||_d$r2===void 0?void 0:(_d$r2$c=_d$r2[c])===null||_d$r2$c===void 0?void 0:_d$r2$c.m;}}else {v="";}if(lodash.isNil(v)&&((_d$r3=d[r])===null||_d$r3===void 0?void 0:(_d$r3$c=_d$r3[c])===null||_d$r3$c===void 0?void 0:(_d$r3$c$ct=_d$r3$c.ct)===null||_d$r3$c$ct===void 0?void 0:_d$r3$c$ct.t)==="inlineStr"){v=d[r][c].ct.s.map(function(val){return val.v;}).join("");isInlineStr=true;}if(lodash.isNil(v)){v="";}if(isInlineStr);else {if(lodash.trim(cpDataArr[r-copy_r1][c-copy_c1])!==lodash.trim(v)){isEqual=false;break;}}}}}var locale_fontjson=locale(ctx).fontjson;if(((_ctx$hooks$beforePast=(_ctx$hooks=ctx.hooks).beforePaste)===null||_ctx$hooks$beforePast===void 0?void 0:_ctx$hooks$beforePast.call(_ctx$hooks,ctx.luckysheet_select_save,txtdata))===false){return;}if(txtdata.indexOf("fortune-copy-action-table")>-1&&((_ctx$luckysheet_copy_2=ctx.luckysheet_copy_save)===null||_ctx$luckysheet_copy_2===void 0?void 0:_ctx$luckysheet_copy_2.copyRange)!=null&&ctx.luckysheet_copy_save.copyRange.length>0&&isEqual){if(ctx.luckysheet_paste_iscut){ctx.luckysheet_paste_iscut=false;pasteHandlerOfCutPaste(ctx,ctx.luckysheet_copy_save);ctx.luckysheet_selection_range=[];}else {pasteHandlerOfCopyPaste(ctx,ctx.luckysheet_copy_save);}}else if(txtdata.indexOf("fortune-copy-action-image")>-1);else {if(txtdata.indexOf("table")>-1){var ele=document.createElement("div");ele.innerHTML=txtdata;var trList=ele.querySelectorAll("table tr");if(trList.length===0){ele.remove();return;}var data=new Array(trList.length);var colLen=0;lodash.forEach(trList[0].querySelectorAll("td"),function(td){var colspan=td.colSpan;if(Number.isNaN(colspan)){colspan=1;}colLen+=colspan;});for(var _i5=0;_i5<data.length;_i5+=1){data[_i5]=new Array(colLen);}var _r2=0;var borderInfo={};lodash.forEach(trList,function(tr){var c=0;lodash.forEach(tr.querySelectorAll("td"),function(td){var cell={};var txt=td.innerText||td.innerHTML;if(lodash.trim(txt).length===0){cell.v=undefined;cell.m="";}else {var mask=genarate(txt);var _mask2=_slicedToArray$3(mask,3);cell.m=_mask2[0];cell.ct=_mask2[1];cell.v=_mask2[2];}var bg=td.style.backgroundColor;if(bg==="rgba(0, 0, 0, 0)"||lodash.isEmpty(bg)){bg=undefined;}cell.bg=bg;var fontWight=td.style.fontWeight;cell.bl=fontWight.toString()==="400"||fontWight==="normal"||lodash.isEmpty(fontWight)?0:1;cell.it=td.style.fontStyle==="normal"||lodash.isEmpty(td.style.fontStyle)?0:1;var ff=td.style.fontFamily||"";var ffs=ff.split(",");for(var _i6=0;_i6<ffs.length;_i6+=1){var fa=lodash.trim(ffs[_i6].toLowerCase());fa=locale_fontjson[fa];if(lodash.isNil(fa)){cell.ff=0;}else {cell.ff=fa;break;}}var fs=Math.round(parseInt(td.style.fontSize||"13",10)*72/96);cell.fs=fs;cell.fc=td.style.color;var ht=td.style.textAlign||"left";if(ht==="center"){cell.ht=0;}else if(ht==="right"){cell.ht=2;}else {cell.ht=1;}var vt=td.style.verticalAlign||"top";if(vt==="middle"){cell.vt=0;}else if(vt==="top"||vt==="text-top"){cell.vt=1;}else {cell.vt=2;}while(c<colLen&&!lodash.isNil(data[_r2][c])){c+=1;}if(c===colLen){return true;}if(lodash.isNil(data[_r2][c])){data[_r2][c]=cell;var rowspan=parseInt(td.getAttribute("rowspan"),10);var colspan=parseInt(td.getAttribute("colspan"),10);if(Number.isNaN(rowspan)){rowspan=1;}if(Number.isNaN(colspan)){colspan=1;}var r_ab=ctx.luckysheet_select_save[0].row[0]+_r2;var c_ab=ctx.luckysheet_select_save[0].column[0]+c;for(var rp=0;rp<rowspan;rp+=1){for(var cp=0;cp<colspan;cp+=1){if(rp===0){var bt=td.style.borderTop;if(!lodash.isEmpty(bt)&&bt.substring(0,3).toLowerCase()!=="0px"){var width=td.style.borderTopWidth;var type=td.style.borderTopStyle;var color=td.style.borderTopColor;var borderconfig=getQKBorder(width,type,color);if(!borderInfo["".concat(_r2+rp,"_").concat(c+cp)]){borderInfo["".concat(_r2+rp,"_").concat(c+cp)]={};}borderInfo["".concat(_r2+rp,"_").concat(c+cp)].t={style:borderconfig[0],color:borderconfig[1]};}}if(rp===rowspan-1){var bb=td.style.borderBottom;if(!lodash.isEmpty(bb)&&bb.substring(0,3).toLowerCase()!=="0px"){var _width=td.style.borderBottomWidth;var _type=td.style.borderBottomStyle;var _color=td.style.borderBottomColor;var _borderconfig=getQKBorder(_width,_type,_color);if(!borderInfo["".concat(_r2+rp,"_").concat(c+cp)]){borderInfo["".concat(_r2+rp,"_").concat(c+cp)]={};}borderInfo["".concat(_r2+rp,"_").concat(c+cp)].b={style:_borderconfig[0],color:_borderconfig[1]};}}if(cp===0){var bl=td.style.borderLeft;if(!lodash.isEmpty(bl)&&bl.substring(0,3).toLowerCase()!=="0px"){var _width2=td.style.borderLeftWidth;var _type2=td.style.borderLeftStyle;var _color2=td.style.borderLeftColor;var _borderconfig2=getQKBorder(_width2,_type2,_color2);if(!borderInfo["".concat(_r2+rp,"_").concat(c+cp)]){borderInfo["".concat(_r2+rp,"_").concat(c+cp)]={};}borderInfo["".concat(_r2+rp,"_").concat(c+cp)].l={style:_borderconfig2[0],color:_borderconfig2[1]};}}if(cp===colspan-1){var br=td.style.borderLeft;if(!lodash.isEmpty(br)&&br.substring(0,3).toLowerCase()!=="0px"){var _width3=td.style.borderRightWidth;var _type3=td.style.borderRightStyle;var _color3=td.style.borderRightColor;var _borderconfig3=getQKBorder(_width3,_type3,_color3);if(!borderInfo["".concat(_r2+rp,"_").concat(c+cp)]){borderInfo["".concat(_r2+rp,"_").concat(c+cp)]={};}borderInfo["".concat(_r2+rp,"_").concat(c+cp)].r={style:_borderconfig3[0],color:_borderconfig3[1]};}}if(rp===0&&cp===0){continue;}data[_r2+rp][c+cp]={mc:{r:r_ab,c:c_ab}};}}if(rowspan>1||colspan>1){var first={rs:rowspan,cs:colspan,r:r_ab,c:c_ab};data[_r2][c].mc=first;}}c+=1;if(c===colLen){return true;}return true;});_r2+=1;});ctx.luckysheet_selection_range=[];pasteHandler(ctx,data,borderInfo);ele.remove();}else if(clipboardData.files.length===1&&clipboardData.files[0].type.indexOf("image")>-1);else {txtdata=clipboardData.getData("text/plain");pasteHandler(ctx,txtdata);}}}else if(ctx.luckysheetCellUpdate.length>0){var _clipboardData2;e.preventDefault();var _clipboardData=e.clipboardData;if(!_clipboardData){_clipboardData=window.clipboardData;}var text=(_clipboardData2=_clipboardData)===null||_clipboardData2===void 0?void 0:_clipboardData2.getData("text/plain");if(text){document.execCommand("insertText",false,text);}}}function handlePasteByClick(ctx,triggerType){var _ctx$luckysheet_copy_3;if(!ctx.allowEdit){return;}var textarea=document.querySelector("#fortune-copy-content");var data=textarea===null||textarea===void 0?void 0:textarea.innerHTML;if(!data)return;if(data.indexOf("fortune-copy-action-table")>-1&&((_ctx$luckysheet_copy_3=ctx.luckysheet_copy_save)===null||_ctx$luckysheet_copy_3===void 0?void 0:_ctx$luckysheet_copy_3.copyRange)!=null&&ctx.luckysheet_copy_save.copyRange.length>0){if(ctx.luckysheet_paste_iscut){ctx.luckysheet_paste_iscut=false;pasteHandlerOfCutPaste(ctx,ctx.luckysheet_copy_save);}else {pasteHandlerOfCopyPaste(ctx,ctx.luckysheet_copy_save);}}else if(data.indexOf("fortune-copy-action-image")>-1);else;}

  function n(n){for(var r=arguments.length,t=Array(r>1?r-1:0),e=1;e<r;e++)t[e-1]=arguments[e];{var i=Y[n],o=i?"function"==typeof i?i.apply(null,t):i:"unknown error nr: "+n;throw Error("[Immer] "+o)}}function r(n){return !!n&&!!n[Q]}function t(n){return !!n&&(function(n){if(!n||"object"!=typeof n)return !1;var r=Object.getPrototypeOf(n);if(null===r)return !0;var t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return t===Object||"function"==typeof t&&Function.toString.call(t)===Z}(n)||Array.isArray(n)||!!n[L]||!!n.constructor[L]||s(n)||v(n))}function i$1(n,r,t){void 0===t&&(t=!1),0===o$1(n)?(t?Object.keys:nn)(n).forEach((function(e){t&&"symbol"==typeof e||r(e,n[e],n);})):n.forEach((function(t,e){return r(e,t,n)}));}function o$1(n){var r=n[Q];return r?r.i>3?r.i-4:r.i:Array.isArray(n)?1:s(n)?2:v(n)?3:0}function u(n,r){return 2===o$1(n)?n.has(r):Object.prototype.hasOwnProperty.call(n,r)}function a(n,r){return 2===o$1(n)?n.get(r):n[r]}function f(n,r,t){var e=o$1(n);2===e?n.set(r,t):3===e?(n.delete(r),n.add(t)):n[r]=t;}function c(n,r){return n===r?0!==n||1/n==1/r:n!=n&&r!=r}function s(n){return X&&n instanceof Map}function v(n){return q&&n instanceof Set}function p(n){return n.o||n.t}function l(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var r=rn(n);delete r[Q];for(var t=nn(r),e=0;e<t.length;e++){var i=t[e],o=r[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]});}return Object.create(Object.getPrototypeOf(n),r)}function d(n,e){return void 0===e&&(e=!1),y(n)||r(n)||!t(n)?n:(o$1(n)>1&&(n.set=n.add=n.clear=n.delete=h),Object.freeze(n),e&&i$1(n,(function(n,r){return d(r,!0)}),!0),n)}function h(){n(2);}function y(n){return null==n||"object"!=typeof n||Object.isFrozen(n)}function b(r){var t=tn[r];return t||n(18,r),t}function m(n,r){tn[n]||(tn[n]=r);}function _(){return U||n(0),U}function j(n,r){r&&(b("Patches"),n.u=[],n.s=[],n.v=r);}function O(n){g(n),n.p.forEach(S),n.p=null;}function g(n){n===U&&(U=n.l);}function w(n){return U={p:[],l:U,h:n,m:!0,_:0}}function S(n){var r=n[Q];0===r.i||1===r.i?r.j():r.O=!0;}function P(r,e){e._=e.p.length;var i=e.p[0],o=void 0!==r&&r!==i;return e.h.g||b("ES5").S(e,r,o),o?(i[Q].P&&(O(e),n(4)),t(r)&&(r=M(e,r),e.l||x(e,r)),e.u&&b("Patches").M(i[Q].t,r,e.u,e.s)):r=M(e,i,[]),O(e),e.u&&e.v(e.u,e.s),r!==H?r:void 0}function M(n,r,t){if(y(r))return r;var e=r[Q];if(!e)return i$1(r,(function(i,o){return A(n,e,r,i,o,t)}),!0),r;if(e.A!==n)return r;if(!e.P)return x(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=l(e.k):e.o;i$1(3===e.i?new Set(o):o,(function(r,i){return A(n,e,o,r,i,t)})),x(n,o,!1),t&&n.u&&b("Patches").R(e,t,n.u,n.s);}return e.o}function A(e,i,o,a,c,s){if(c===o&&n(5),r(c)){var v=M(e,c,s&&i&&3!==i.i&&!u(i.D,a)?s.concat(a):void 0);if(f(o,a,v),!r(v))return;e.m=!1;}if(t(c)&&!y(c)){if(!e.h.F&&e._<1)return;M(e,c),i&&i.A.l||x(e,c);}}function x(n,r,t){void 0===t&&(t=!1),n.h.F&&n.m&&d(r,t);}function z(n,r){var t=n[Q];return (t?p(t):n)[r]}function I(n,r){if(r in n)for(var t=Object.getPrototypeOf(n);t;){var e=Object.getOwnPropertyDescriptor(t,r);if(e)return e;t=Object.getPrototypeOf(t);}}function k(n){n.P||(n.P=!0,n.l&&k(n.l));}function E$1(n){n.o||(n.o=l(n.t));}function R(n,r,t){var e=s(r)?b("MapSet").N(r,t):v(r)?b("MapSet").T(r,t):n.g?function(n,r){var t=Array.isArray(n),e={i:t?1:0,A:r?r.A:_(),P:!1,I:!1,D:{},l:r,t:n,k:null,o:null,j:null,C:!1},i=e,o=en$1;t&&(i=[e],o=on);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(r,t):b("ES5").J(r,t);return (t?t.A:_()).p.push(e),e}function D(e){return r(e)||n(22,e),function n(r){if(!t(r))return r;var e,u=r[Q],c=o$1(r);if(u){if(!u.P&&(u.i<4||!b("ES5").K(u)))return u.t;u.I=!0,e=F(r,c),u.I=!1;}else e=F(r,c);return i$1(e,(function(r,t){u&&a(u.t,r)===t||f(e,r,n(t));})),3===c?new Set(e):e}(e)}function F(n,r){switch(r){case 2:return new Map(n);case 3:return Array.from(n)}return l(n)}function T(){function e(n){if(!t(n))return n;if(Array.isArray(n))return n.map(e);if(s(n))return new Map(Array.from(n.entries()).map((function(n){return [n[0],e(n[1])]})));if(v(n))return new Set(Array.from(n).map(e));var r=Object.create(Object.getPrototypeOf(n));for(var i in n)r[i]=e(n[i]);return u(n,L)&&(r[L]=n[L]),r}function f(n){return r(n)?e(n):n}var c="add";m("Patches",{$:function(r,t){return t.forEach((function(t){for(var i=t.path,u=t.op,f=r,s=0;s<i.length-1;s++){var v=o$1(f),p=""+i[s];0!==v&&1!==v||"__proto__"!==p&&"constructor"!==p||n(24),"function"==typeof f&&"prototype"===p&&n(24),"object"!=typeof(f=a(f,p))&&n(15,i.join("/"));}var l=o$1(f),d=e(t.value),h=i[i.length-1];switch(u){case"replace":switch(l){case 2:return f.set(h,d);case 3:n(16);default:return f[h]=d}case c:switch(l){case 1:return "-"===h?f.push(d):f.splice(h,0,d);case 2:return f.set(h,d);case 3:return f.add(d);default:return f[h]=d}case"remove":switch(l){case 1:return f.splice(h,1);case 2:return f.delete(h);case 3:return f.delete(t.value);default:return delete f[h]}default:n(17,u);}})),r},R:function(n,r,t,e){switch(n.i){case 0:case 4:case 2:return function(n,r,t,e){var o=n.t,s=n.o;i$1(n.D,(function(n,i){var v=a(o,n),p=a(s,n),l=i?u(o,n)?"replace":c:"remove";if(v!==p||"replace"!==l){var d=r.concat(n);t.push("remove"===l?{op:l,path:d}:{op:l,path:d,value:p}),e.push(l===c?{op:"remove",path:d}:"remove"===l?{op:c,path:d,value:f(v)}:{op:"replace",path:d,value:f(v)});}}));}(n,r,t,e);case 5:case 1:return function(n,r,t,e){var i=n.t,o=n.D,u=n.o;if(u.length<i.length){var a=[u,i];i=a[0],u=a[1];var s=[e,t];t=s[0],e=s[1];}for(var v=0;v<i.length;v++)if(o[v]&&u[v]!==i[v]){var p=r.concat([v]);t.push({op:"replace",path:p,value:f(u[v])}),e.push({op:"replace",path:p,value:f(i[v])});}for(var l=i.length;l<u.length;l++){var d=r.concat([l]);t.push({op:c,path:d,value:f(u[l])});}i.length<u.length&&e.push({op:"replace",path:r.concat(["length"]),value:i.length});}(n,r,t,e);case 3:return function(n,r,t,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=r.concat([u]);t.push({op:"remove",path:i,value:n}),e.unshift({op:c,path:i,value:n});}u++;})),u=0,o.forEach((function(n){if(!i.has(n)){var o=r.concat([u]);t.push({op:c,path:o,value:n}),e.unshift({op:"remove",path:o,value:n});}u++;}));}(n,r,t,e)}},M:function(n,r,t,e){t.push({op:"replace",path:[],value:r===H?void 0:r}),e.push({op:"replace",path:[],value:n});}});}var G,U,W="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),X="undefined"!=typeof Map,q="undefined"!=typeof Set,B="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,H=W?Symbol.for("immer-nothing"):((G={})["immer-nothing"]=!0,G),L=W?Symbol.for("immer-draftable"):"__$immer_draftable",Q=W?Symbol.for("immer-state"):"__$immer_state",Y={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(n){return "Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+n},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(n){return "Cannot apply patch, path doesn't resolve: "+n},16:'Sets cannot have "replace" patches.',17:function(n){return "Unsupported patch operation: "+n},18:function(n){return "The plugin for '"+n+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+n+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(n){return "produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+n+"'"},22:function(n){return "'current' expects a draft, got: "+n},23:function(n){return "'original' expects a draft, got: "+n},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},Z=""+Object.prototype.constructor,nn="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,rn=Object.getOwnPropertyDescriptors||function(n){var r={};return nn(n).forEach((function(t){r[t]=Object.getOwnPropertyDescriptor(n,t);})),r},tn={},en$1={get:function(n,r){if(r===Q)return n;var e=p(n);if(!u(e,r))return function(n,r,t){var e,i=I(r,t);return i?"value"in i?i.value:null===(e=i.get)||void 0===e?void 0:e.call(n.k):void 0}(n,e,r);var i=e[r];return n.I||!t(i)?i:i===z(n.t,r)?(E$1(n),n.o[r]=R(n.A.h,i,n)):i},has:function(n,r){return r in p(n)},ownKeys:function(n){return Reflect.ownKeys(p(n))},set:function(n,r,t){var e=I(p(n),r);if(null==e?void 0:e.set)return e.set.call(n.k,t),!0;if(!n.P){var i=z(p(n),r),o=null==i?void 0:i[Q];if(o&&o.t===t)return n.o[r]=t,n.D[r]=!1,!0;if(c(t,i)&&(void 0!==t||u(n.t,r)))return !0;E$1(n),k(n);}return n.o[r]===t&&"number"!=typeof t&&(void 0!==t||r in n.o)||(n.o[r]=t,n.D[r]=!0,!0)},deleteProperty:function(n,r){return void 0!==z(n.t,r)||r in n.t?(n.D[r]=!1,E$1(n),k(n)):delete n.D[r],n.o&&delete n.o[r],!0},getOwnPropertyDescriptor:function(n,r){var t=p(n),e=Reflect.getOwnPropertyDescriptor(t,r);return e?{writable:!0,configurable:1!==n.i||"length"!==r,enumerable:e.enumerable,value:t[r]}:e},defineProperty:function(){n(11);},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12);}},on={};i$1(en$1,(function(n,r){on[n]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)};})),on.deleteProperty=function(r,t){return isNaN(parseInt(t))&&n(13),on.set.call(this,r,t,void 0)},on.set=function(r,t,e){return "length"!==t&&isNaN(parseInt(t))&&n(14),en$1.set.call(this,r[0],t,e,r[0])};var un=function(){function e(r){var e=this;this.g=B,this.F=!0,this.produce=function(r,i,o){if("function"==typeof r&&"function"!=typeof i){var u=i;i=r;var a=e;return function(n){var r=this;void 0===n&&(n=u);for(var t=arguments.length,e=Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];return a.produce(n,(function(n){var t;return (t=i).call.apply(t,[r,n].concat(e))}))}}var f;if("function"!=typeof i&&n(6),void 0!==o&&"function"!=typeof o&&n(7),t(r)){var c=w(e),s=R(e,r,void 0),v=!0;try{f=i(s),v=!1;}finally{v?O(c):g(c);}return "undefined"!=typeof Promise&&f instanceof Promise?f.then((function(n){return j(c,o),P(n,c)}),(function(n){throw O(c),n})):(j(c,o),P(f,c))}if(!r||"object"!=typeof r){if(void 0===(f=i(r))&&(f=r),f===H&&(f=void 0),e.F&&d(f,!0),o){var p=[],l=[];b("Patches").M(r,f,p,l),o(p,l);}return f}n(21,r);},this.produceWithPatches=function(n,r){if("function"==typeof n)return function(r){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return e.produceWithPatches(r,(function(r){return n.apply(void 0,[r].concat(i))}))};var t,i,o=e.produce(n,r,(function(n,r){t=n,i=r;}));return "undefined"!=typeof Promise&&o instanceof Promise?o.then((function(n){return [n,t,i]})):[o,t,i]},"boolean"==typeof(null==r?void 0:r.useProxies)&&this.setUseProxies(r.useProxies),"boolean"==typeof(null==r?void 0:r.autoFreeze)&&this.setAutoFreeze(r.autoFreeze);}var i=e.prototype;return i.createDraft=function(e){t(e)||n(8),r(e)&&(e=D(e));var i=w(this),o=R(this,e,void 0);return o[Q].C=!0,g(i),o},i.finishDraft=function(r,t){var e=r&&r[Q];(e&&e.C||n(9),e.I&&n(10));var i=e.A;return j(i,t),P(void 0,i)},i.setAutoFreeze=function(n){this.F=n;},i.setUseProxies=function(r){r&&!B&&n(20),this.g=r;},i.applyPatches=function(n,t){var e;for(e=t.length-1;e>=0;e--){var i=t[e];if(0===i.path.length&&"replace"===i.op){n=i.value;break}}e>-1&&(t=t.slice(e+1));var o=b("Patches").$;return r(n)?o(n,t):this.produce(n,(function(n){return o(n,t)}))},e}(),an=new un,fn=an.produce,cn=an.produceWithPatches.bind(an),sn=an.setAutoFreeze.bind(an),vn=an.setUseProxies.bind(an),pn=an.applyPatches.bind(an),ln=an.createDraft.bind(an),dn=an.finishDraft.bind(an);

  var WorkbookContext = /*#__PURE__*/React__default['default'].createContext({
    context: defaultContext(),
    setContext: function setContext() {},
    settings: defaultSettings,
    handleUndo: function handleUndo() {},
    handleRedo: function handleRedo() {},
    refs: {
      globalCache: {
        undoList: [],
        redoList: []
      },
      cellInput: /*#__PURE__*/React__default['default'].createRef(),
      fxInput: /*#__PURE__*/React__default['default'].createRef(),
      canvas: /*#__PURE__*/React__default['default'].createRef(),
      scrollbarX: /*#__PURE__*/React__default['default'].createRef(),
      scrollbarY: /*#__PURE__*/React__default['default'].createRef(),
      cellArea: /*#__PURE__*/React__default['default'].createRef(),
      workbookContainer: /*#__PURE__*/React__default['default'].createRef()
    }
  });

  var ColumnHeader = function ColumnHeader() {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings,
        refs = _useContext.refs;

    var containerRef = React.useRef(null);
    var colChangeSizeRef = React.useRef(null);

    var _useState = React.useState({
      col: -1,
      col_pre: -1
    }),
        _useState2 = _slicedToArray(_useState, 2),
        hoverLocation = _useState2[0],
        setHoverLocation = _useState2[1];

    var _useState3 = React.useState([]),
        _useState4 = _slicedToArray(_useState3, 2),
        selectedLocation = _useState4[0],
        setSelectedLocation = _useState4[1];

    var onMouseMove = React.useCallback(function (e) {
      if (context.luckysheet_cols_change_size) {
        return;
      }

      var x = e.pageX - containerRef.current.getBoundingClientRect().left + containerRef.current.scrollLeft;
      var col_location = colLocation(x, context.visibledatacolumn);

      var _col_location = _slicedToArray(col_location, 2),
          col_pre = _col_location[0],
          col = _col_location[1];

      if (col_pre !== hoverLocation.col_pre || col !== hoverLocation.col) {
        setHoverLocation({
          col_pre: col_pre,
          col: col
        });
      }
    }, [context.luckysheet_cols_change_size, context.visibledatacolumn, hoverLocation.col, hoverLocation.col_pre]);
    var onMouseDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleColumnHeaderMouseDown(draftCtx, refs.globalCache, nativeEvent, containerRef.current, refs.cellInput.current, refs.fxInput.current);
      });
    }, [refs.globalCache, refs.cellInput, refs.fxInput, setContext]);
    var onMouseLeave = React.useCallback(function () {
      if (context.luckysheet_cols_change_size) {
        return;
      }

      setHoverLocation({
        col: -1,
        col_pre: -1
      });
    }, [context.luckysheet_cols_change_size]);
    var onColSizeHandleMouseDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleColSizeHandleMouseDown(draftCtx, refs.globalCache, nativeEvent, containerRef.current, refs.workbookContainer.current, refs.cellArea.current);
      });
      e.stopPropagation();
    }, [refs.cellArea, refs.globalCache, refs.workbookContainer, setContext]);
    var onContextMenu = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleContextMenu(draftCtx, settings, nativeEvent, refs.workbookContainer.current);
      });
    }, [refs.workbookContainer, setContext, settings]);
    React.useEffect(function () {
      var s = context.luckysheet_select_save;
      if (lodash.isNil(s)) return;
      var columnTitleMap = {};

      for (var i = 0; i < s.length; i += 1) {
        var c1 = s[i].column[0];
        var c2 = s[i].column[1];
        columnTitleMap = selectTitlesMap(columnTitleMap, c1, c2);
      }

      var columnTitleRange = selectTitlesRange(columnTitleMap);
      var selects = [];

      for (var j = 0; j < columnTitleRange.length; j += 1) {
        var _c = columnTitleRange[j][0];
        var _c2 = columnTitleRange[j][columnTitleRange[j].length - 1];
        var col = colLocationByIndex(_c2, context.visibledatacolumn)[1];
        var col_pre = colLocationByIndex(_c, context.visibledatacolumn)[0];

        if (lodash.isNumber(col) && lodash.isNumber(col_pre)) {
          selects.push({
            col: col,
            col_pre: col_pre
          });
        }
      }

      setSelectedLocation(selects);
    }, [context.luckysheet_select_save, context.visibledatacolumn]);
    React.useEffect(function () {
      containerRef.current.scrollLeft = context.scrollLeft;
    }, [context.scrollLeft]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "fortune-col-header",
      style: {
        height: context.columnHeaderHeight - 1.5
      },
      onMouseMove: onMouseMove,
      onMouseDown: onMouseDown,
      onMouseLeave: onMouseLeave,
      onContextMenu: onContextMenu
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-cols-change-size",
      ref: colChangeSizeRef,
      id: "fortune-cols-change-size",
      onMouseDown: onColSizeHandleMouseDown,
      style: {
        left: hoverLocation.col - 5,
        opacity: context.luckysheet_cols_change_size ? 1 : 0
      }
    }), !context.luckysheet_cols_change_size && hoverLocation.col >= 0 && hoverLocation.col_pre >= 0 ? /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-col-header-hover",
      style: {
        left: hoverLocation.col_pre,
        width: hoverLocation.col - hoverLocation.col_pre - 1,
        display: "block"
      }
    }) : null, selectedLocation.map(function (_ref, i) {
      var col = _ref.col,
          col_pre = _ref.col_pre;
      return /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-col-header-selected",
        key: i,
        style: {
          left: col_pre,
          width: col - col_pre - 1,
          display: "block",
          backgroundColor: "rgba(76, 76, 76, 0.1)"
        }
      });
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cols-h-cells luckysheetsheetchange",
      id: "luckysheet-cols-h-cells_0",
      style: {
        width: context.ch_width,
        height: 1
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cols-h-cells-c"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-grdblkpush"
    }))));
  };

  var RowHeader = function RowHeader() {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings,
        refs = _useContext.refs;

    var rowChangeSizeRef = React.useRef(null);
    var containerRef = React.useRef(null);

    var _useState = React.useState({
      row: -1,
      row_pre: -1
    }),
        _useState2 = _slicedToArray(_useState, 2),
        hoverLocation = _useState2[0],
        setHoverLocation = _useState2[1];

    var _useState3 = React.useState([]),
        _useState4 = _slicedToArray(_useState3, 2),
        selectedLocation = _useState4[0],
        setSelectedLocation = _useState4[1];

    var onMouseMove = React.useCallback(function (e) {
      if (context.luckysheet_rows_change_size) {
        return;
      }

      var y = e.pageY - containerRef.current.getBoundingClientRect().top + containerRef.current.scrollTop;
      var row_location = rowLocation(y, context.visibledatarow);

      var _row_location = _slicedToArray(row_location, 2),
          row_pre = _row_location[0],
          row = _row_location[1];

      if (row_pre !== hoverLocation.row_pre || row !== hoverLocation.row) {
        setHoverLocation({
          row_pre: row_pre,
          row: row
        });
      }
    }, [context.luckysheet_rows_change_size, context.visibledatarow, hoverLocation.row, hoverLocation.row_pre]);
    var onMouseDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleRowHeaderMouseDown(draftCtx, refs.globalCache, nativeEvent, containerRef.current, refs.cellInput.current, refs.fxInput.current);
      });
    }, [refs.globalCache, refs.cellInput, refs.fxInput, setContext]);
    var onMouseLeave = React.useCallback(function () {
      if (context.luckysheet_rows_change_size) {
        return;
      }

      setHoverLocation({
        row: -1,
        row_pre: -1
      });
    }, [context.luckysheet_rows_change_size]);
    var onRowSizeHandleMouseDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleRowSizeHandleMouseDown(draftCtx, refs.globalCache, nativeEvent, containerRef.current, refs.workbookContainer.current, refs.cellArea.current);
      });
      e.stopPropagation();
    }, [refs.cellArea, refs.globalCache, refs.workbookContainer, setContext]);
    var onContextMenu = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleContextMenu(draftCtx, settings, nativeEvent, refs.workbookContainer.current);
      });
    }, [refs.workbookContainer, setContext, settings]);
    React.useEffect(function () {
      var s = context.luckysheet_select_save || [];
      var rowTitleMap = {};

      for (var i = 0; i < s.length; i += 1) {
        var r1 = s[i].row[0];
        var r2 = s[i].row[1];
        rowTitleMap = selectTitlesMap(rowTitleMap, r1, r2);
      }

      var rowTitleRange = selectTitlesRange(rowTitleMap);
      var selects = [];

      for (var _i = 0; _i < rowTitleRange.length; _i += 1) {
        var _r = rowTitleRange[_i][0];
        var _r2 = rowTitleRange[_i][rowTitleRange[_i].length - 1];
        var row = rowLocationByIndex(_r2, context.visibledatarow)[1];
        var row_pre = rowLocationByIndex(_r, context.visibledatarow)[0];

        if (lodash.isNumber(row_pre) && lodash.isNumber(row)) {
          selects.push({
            row: row,
            row_pre: row_pre
          });
        }
      }

      setSelectedLocation(selects);
    }, [context.luckysheet_select_save, context.visibledatarow]);
    React.useEffect(function () {
      containerRef.current.scrollTop = context.scrollTop;
    }, [context.scrollTop]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "fortune-row-header",
      style: {
        width: context.rowHeaderWidth - 1.5,
        height: context.cellmainHeight
      },
      onMouseMove: onMouseMove,
      onMouseDown: onMouseDown,
      onMouseLeave: onMouseLeave,
      onContextMenu: onContextMenu
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-rows-change-size",
      ref: rowChangeSizeRef,
      onMouseDown: onRowSizeHandleMouseDown,
      style: {
        top: hoverLocation.row - 3,
        opacity: context.luckysheet_rows_change_size ? 1 : 0
      }
    }), hoverLocation.row >= 0 && hoverLocation.row_pre >= 0 ? /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-row-header-hover",
      style: {
        top: hoverLocation.row_pre,
        height: hoverLocation.row - hoverLocation.row_pre - 1,
        display: "block"
      }
    }) : null, selectedLocation.map(function (_ref, i) {
      var row = _ref.row,
          row_pre = _ref.row_pre;
      return /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-row-header-selected",
        key: i,
        style: {
          top: row_pre,
          height: row - row_pre - 1,
          display: "block",
          backgroundColor: "rgba(76, 76, 76, 0.1)"
        }
      });
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      style: {
        height: context.rh_height,
        width: 1
      },
      id: "luckysheetrowHeader_0",
      className: "luckysheetsheetchange"
    }));
  };

  var ContentEditable = /*#__PURE__*/function (_React$Component) {
    _inherits(ContentEditable, _React$Component);

    var _super = _createSuper(ContentEditable);

    function ContentEditable() {
      var _this;

      _classCallCheck(this, ContentEditable);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _super.call.apply(_super, [this].concat(args));
      _this.lastHtml = undefined;
      _this.root = null;
      return _this;
    }

    _createClass(ContentEditable, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        var _this$props = this.props,
            autoFocus = _this$props.autoFocus,
            initialContent = _this$props.initialContent;

        if (autoFocus) {
          var _this$root;

          (_this$root = this.root) === null || _this$root === void 0 ? void 0 : _this$root.focus();
        }

        if (initialContent && this.root) {
          this.root.innerHTML = initialContent;
        }
      }
    }, {
      key: "emitChange",
      value: function emitChange() {
        var _this$root2;

        var onChange = this.props.onChange;
        var html = (_this$root2 = this.root) === null || _this$root2 === void 0 ? void 0 : _this$root2.innerHTML;

        if (onChange && html !== this.lastHtml) {
          onChange(html || "");
        }

        this.lastHtml = html;
      }
    }, {
      key: "render",
      value: function render() {
        var _this2 = this;

        var _this$props2 = this.props,
            innerRef = _this$props2.innerRef,
            _onBlur = _this$props2.onBlur;
        return /*#__PURE__*/React__default['default'].createElement("div", _objectSpread2(_objectSpread2({
          onMouseDown: function onMouseDown(e) {
            return e.stopPropagation();
          },
          onDoubleClick: function onDoubleClick(e) {
            return e.stopPropagation();
          },
          onClick: function onClick(e) {
            return e.stopPropagation();
          }
        }, lodash.omit(this.props, "innerRef", "onChange", "html", "onBlur", "autoFocus", "initialContent")), {}, {
          ref: function ref(e) {
            _this2.root = e;
            innerRef === null || innerRef === void 0 ? void 0 : innerRef(e);
          },
          tabIndex: 0,
          onInput: this.emitChange.bind(this),
          onBlur: function onBlur(e) {
            _this2.emitChange.bind(_this2)();

            _onBlur === null || _onBlur === void 0 ? void 0 : _onBlur(e);
          },
          contentEditable: true
        }));
      }
    }]);

    return ContentEditable;
  }(React__default['default'].Component);

  var FormulaSearch = function FormulaSearch(props) {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context;

    if (lodash.isEmpty(context.functionCandidates)) return null;
    return /*#__PURE__*/React__default['default'].createElement("div", _objectSpread2(_objectSpread2({}, props), {}, {
      id: "luckysheet-formula-search-c",
      className: "luckysheet-formula-search-c"
    }), context.functionCandidates.map(function (v) {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: v.n,
        "data-func": v.n,
        className: "luckysheet-formula-search-item"
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-formula-search-func"
      }, v.n), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-formula-search-detail"
      }, v.d));
    }));
  };

  var FormulaHint = function FormulaHint(props) {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context;

    var _locale = locale(context),
        formulaMore = _locale.formulaMore;

    if (!context.functionHint) return null;
    var fn = context.formulaCache.functionlistMap[context.functionHint];
    if (!fn) return null;
    return /*#__PURE__*/React__default['default'].createElement("div", _objectSpread2(_objectSpread2({}, props), {}, {
      id: "luckysheet-formula-help-c",
      className: "luckysheet-formula-help-c"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-close",
      title: "\u5173\u95ED"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-times",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-collapse",
      title: "\u6536\u8D77"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-angle-up",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-title"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-title-formula"
    }, /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-help-function-name"
    }, fn.n), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-paren"
    }, "("), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-parameter-holder"
    }, fn.p.map(function (param, i) {
      var name = param.name;

      if (param.repeat === "y") {
        name += ", ...";
      }

      if (param.require === "o") {
        name = "[".concat(name, "]");
      }

      return /*#__PURE__*/React__default['default'].createElement("span", {
        className: "luckysheet-arguments-help-parameter",
        dir: "auto",
        key: name
      }, name, i !== fn.p.length - 1 && ", ");
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-paren"
    }, ")"))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-content"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-content-example"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-arguments-help-section-title"
    }, formulaMore.helpExample), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-arguments-help-formula"
    }, /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-help-function-name"
    }, fn.n), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-paren"
    }, "("), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-parameter-holder"
    }, fn.p.map(function (param, i) {
      return /*#__PURE__*/React__default['default'].createElement("span", {
        key: param.name,
        className: "luckysheet-arguments-help-parameter",
        dir: "auto"
      }, param.example, i !== fn.p.length - 1 && ", ");
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-paren"
    }, ")"))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-content-detail"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-arguments-help-section"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name"
    }, formulaMore.helpAbstract), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-arguments-help-parameter-content"
    }, fn.d))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-content-param"
    }, fn.p.map(function (param) {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-arguments-help-section",
        key: param.name
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-arguments-help-section-title"
      }, param.name, param.repeat === "y" && /*#__PURE__*/React__default['default'].createElement("span", {
        className: "luckysheet-arguments-help-argument-info"
      }, "...-", formulaMore.allowRepeatText), param.require === "o" && /*#__PURE__*/React__default['default'].createElement("span", {
        className: "luckysheet-arguments-help-argument-info"
      }, "-[", formulaMore.allowOptionText, "]")), /*#__PURE__*/React__default['default'].createElement("span", {
        className: "luckysheet-arguments-help-parameter-content"
      }, param.detail));
    }))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-formula-help-foot"
    }));
  };

  function usePrevious(value) {
    var ref = React.useRef();
    React.useEffect(function () {
      ref.current = value;
    }, [value]);
    return ref.current;
  }

  var InputBox = function InputBox() {
    var _context$luckysheet_s;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        refs = _useContext.refs;

    var inputRef = React.useRef(null);
    var lastKeyDownEventRef = React.useRef();
    var prevCellUpdate = usePrevious(context.luckysheetCellUpdate);
    var prevSheetId = usePrevious(context.currentSheetId);
    var firstSelection = (_context$luckysheet_s = context.luckysheet_select_save) === null || _context$luckysheet_s === void 0 ? void 0 : _context$luckysheet_s[0];
    var inputBoxStyle = React.useMemo(function () {
      if (firstSelection && context.luckysheetCellUpdate.length > 0) {
        var flowdata = getFlowdata(context);
        if (!flowdata) return {};
        return getStyleByCell(flowdata, firstSelection.row_focus, firstSelection.column_focus);
      }

      return {};
    }, [context.luckysheetfile, context.currentSheetId, context.luckysheetCellUpdate, firstSelection]);
    React.useLayoutEffect(function () {
      if (firstSelection && context.luckysheetCellUpdate.length > 0) {
        var _flowdata$row_index;

        if (refs.globalCache.doNotUpdateCell) {
          delete refs.globalCache.doNotUpdateCell;
          return;
        }

        if (lodash.isEqual(prevCellUpdate, context.luckysheetCellUpdate) && prevSheetId === context.currentSheetId) {
          return;
        }

        var flowdata = getFlowdata(context);
        var row_index = firstSelection.row_focus;
        var col_index = firstSelection.column_focus;
        var cell = flowdata === null || flowdata === void 0 ? void 0 : (_flowdata$row_index = flowdata[row_index]) === null || _flowdata$row_index === void 0 ? void 0 : _flowdata$row_index[col_index];
        var value = "";

        if (cell && !refs.globalCache.overwriteCell) {
          if (isInlineStringCell(cell)) {
            value = getInlineStringHTML(row_index, col_index, flowdata);
          } else if (cell.f) {
            value = getCellValue(row_index, col_index, flowdata, "f");
            setContext(function (ctx) {
              createRangeHightlight(ctx, value);
            });
          } else {
            value = valueShowEs(row_index, col_index, flowdata);

            if (Number(cell.qp) === 1) {
              value = value ? "".concat(value) : value;
            }
          }
        }

        refs.globalCache.overwriteCell = false;
        inputRef.current.innerHTML = escapeScriptTag(value);

        if (!refs.globalCache.doNotFocus) {
          setTimeout(function () {
            moveToEnd(inputRef.current);
          });
        }

        delete refs.globalCache.doNotFocus;
      }
    }, [context.luckysheetCellUpdate, context.luckysheetfile, context.currentSheetId, firstSelection]);
    React.useEffect(function () {
      if (lodash.isEmpty(context.luckysheetCellUpdate)) {
        if (inputRef.current) {
          inputRef.current.innerHTML = "";
        }
      }
    }, [context.luckysheetCellUpdate]);
    var onKeyDown = React.useCallback(function (e) {
      lastKeyDownEventRef.current = new KeyboardEvent(e.type, e.nativeEvent);

      if (e.key === "Escape" && context.luckysheetCellUpdate.length > 0) {
        setContext(function (draftCtx) {
          cancelNormalSelected(draftCtx);
          moveHighlightCell(draftCtx, "down", 0, "rangeOfSelect");
        });
        e.preventDefault();
      } else if (e.key === "Enter" && context.luckysheetCellUpdate.length > 0) {
        if (e.altKey || e.metaKey) {
          document.execCommand("insertHTML", false, "\n");
          e.stopPropagation();
        }
      } else if (e.key === "Tab" && context.luckysheetCellUpdate.length > 0) {
        setContext(function (draftCtx) {
          updateCell(draftCtx, draftCtx.luckysheetCellUpdate[0], draftCtx.luckysheetCellUpdate[1], refs.cellInput.current);
          moveHighlightCell(draftCtx, "right", 1, "rangeOfSelect");
        });
        e.preventDefault();
        e.stopPropagation();
      } else if (e.key === "F4" && context.luckysheetCellUpdate.length > 0) {
        e.preventDefault();
      }
    }, [context.luckysheetCellUpdate.length, refs.cellInput, setContext]);
    var onChange = React.useCallback(function () {
      var e = lastKeyDownEventRef.current;
      if (!e) return;
      var kcode = e.keyCode;
      if (!kcode) return;

      if (!(kcode >= 112 && kcode <= 123 || kcode <= 46 || kcode === 144 || kcode === 108 || e.ctrlKey || e.altKey || e.shiftKey && (kcode === 37 || kcode === 38 || kcode === 39 || kcode === 40)) || kcode === 8 || kcode === 32 || kcode === 46 || e.ctrlKey && kcode === 86) {
        setContext(function (draftCtx) {
          handleFormulaInput(draftCtx, refs.fxInput.current, refs.cellInput.current, kcode);
        });
      }
    }, [refs.cellInput, refs.fxInput, setContext]);
    var onPaste = React.useCallback(function (e) {
      if (lodash.isEmpty(context.luckysheetCellUpdate)) {
        e.preventDefault();
      }
    }, [context.luckysheetCellUpdate]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-input-box",
      style: firstSelection && !lodash.isEmpty(context.luckysheetCellUpdate) ? {
        left: firstSelection.left,
        top: firstSelection.top,
        display: "block"
      } : {
        left: -10000,
        top: -10000,
        display: "block"
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-input-box-inner",
      style: firstSelection ? _objectSpread2({
        minWidth: firstSelection.width,
        minHeight: firstSelection.height
      }, inputBoxStyle) : {}
    }, /*#__PURE__*/React__default['default'].createElement(ContentEditable, {
      innerRef: function innerRef(e) {
        inputRef.current = e;
        refs.cellInput.current = e;
      },
      className: "luckysheet-cell-input",
      id: "luckysheet-rich-text-editor",
      "aria-autocomplete": "list",
      onChange: onChange,
      onKeyDown: onKeyDown,
      onPaste: onPaste
    })), document.activeElement === inputRef.current && /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, /*#__PURE__*/React__default['default'].createElement(FormulaSearch, {
      style: {
        top: ((firstSelection === null || firstSelection === void 0 ? void 0 : firstSelection.height_move) || 0) + 4
      }
    }), /*#__PURE__*/React__default['default'].createElement(FormulaHint, {
      style: {
        top: ((firstSelection === null || firstSelection === void 0 ? void 0 : firstSelection.height_move) || 0) + 4
      }
    })));
  };

  var ScrollBar = function ScrollBar(_ref) {
    var axis = _ref.axis;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        refs = _useContext.refs,
        setContext = _useContext.setContext;

    React.useEffect(function () {
      if (axis === "x") {
        refs.scrollbarX.current.scrollLeft = context.scrollLeft;
      } else {
        refs.scrollbarY.current.scrollTop = context.scrollTop;
      }
    }, [axis === "x" ? context.scrollLeft : context.scrollTop]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: axis === "x" ? refs.scrollbarX : refs.scrollbarY,
      style: axis === "x" ? {
        width: "100%"
      } : {
        height: "100%"
      },
      className: "luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-".concat(axis),
      onScroll: function onScroll() {
        if (axis === "x") {
          setContext(function (draftCtx) {
            draftCtx.scrollLeft = refs.scrollbarX.current.scrollLeft;
          });
        } else {
          setContext(function (draftCtx) {
            draftCtx.scrollTop = refs.scrollbarY.current.scrollTop;
          });
        }
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      style: axis === "x" ? {
        width: context.ch_width,
        height: 10
      } : {
        width: 10,
        height: context.rh_height
      }
    }));
  };

  var SheetOverlay = function SheetOverlay() {
    var _context$luckysheet_s, _context$luckysheet_s2, _$last, _$last2, _$last3, _$last4, _context$luckysheet_s3, _context$luckysheet_s4, _context$luckysheet_s5, _context$luckysheet_s6, _context$presences$le, _context$presences, _context$commentBoxes2, _context$insertedImgs;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings,
        refs = _useContext.refs;

    var containerRef = React.useRef(null);
    var flowdata = getFlowdata(context);
    var cellAreaMouseDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleCellAreaMouseDown(draftCtx, refs.globalCache, nativeEvent, refs.cellInput.current, refs.cellArea.current, refs.fxInput.current);
      });
    }, [refs.cellArea, refs.cellInput, refs.globalCache, refs.fxInput, setContext]);
    var cellAreaContextMenu = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleContextMenu(draftCtx, settings, nativeEvent, refs.workbookContainer.current);
      });
    }, [refs.workbookContainer, setContext, settings]);
    var cellAreaDoubleClick = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleCellAreaDoubleClick(draftCtx, refs.globalCache, settings, nativeEvent, refs.cellArea.current);
      });
    }, [refs.cellArea, refs.globalCache, setContext, settings]);
    var onLeftTopClick = React.useCallback(function () {
      setContext(function (draftCtx) {
        selectAll(draftCtx);
      });
    }, [setContext]);
    var onMouseMove = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleOverlayMouseMove(draftCtx, refs.globalCache, nativeEvent, refs.cellInput.current, refs.scrollbarX.current, refs.scrollbarY.current, containerRef.current);
      });
    }, [refs.cellInput, refs.globalCache, refs.scrollbarX, refs.scrollbarY, setContext]);
    var onMouseUp = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleOverlayMouseUp(draftCtx, refs.globalCache, settings, nativeEvent, containerRef.current);
      });
    }, [refs.globalCache, setContext, settings]);
    var onTouchStart = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftContext) {
        handleOverlayTouchStart(draftContext, nativeEvent, refs.globalCache);
      });
      e.stopPropagation();
    }, [refs.globalCache, setContext]);
    var onTouchMove = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContext(function (draftCtx) {
        handleOverlayTouchMove(draftCtx, nativeEvent, refs.globalCache, refs.scrollbarX.current, refs.scrollbarY.current);
      });
    }, [refs.globalCache, refs.scrollbarX, refs.scrollbarY, setContext]);
    var onTouchEnd = React.useCallback(function () {
      handleOverlayTouchEnd(refs.globalCache);
    }, [refs.globalCache]);
    React.useEffect(function () {
      refs.cellArea.current.scrollLeft = context.scrollLeft;
      refs.cellArea.current.scrollTop = context.scrollTop;
    }, [context.scrollLeft, context.scrollTop, refs.cellArea]);
    React.useEffect(function () {
      if (!context.editingCommentBox) {
        var _refs$cellInput$curre;

        (_refs$cellInput$curre = refs.cellInput.current) === null || _refs$cellInput$curre === void 0 ? void 0 : _refs$cellInput$curre.focus({
          preventScroll: true
        });
      }
    }, [context.editingCommentBox, context.luckysheet_select_save, refs.cellInput]);
    React.useEffect(function () {
      if (flowdata) {
        var psShownCells = [];

        for (var i = 0; i < flowdata.length; i += 1) {
          for (var j = 0; j < flowdata[i].length; j += 1) {
            var _cell$ps;

            var cell = flowdata[i][j];
            if (!cell) continue;

            if ((_cell$ps = cell.ps) === null || _cell$ps === void 0 ? void 0 : _cell$ps.isShow) {
              psShownCells.push({
                r: i,
                c: j
              });
            }
          }
        }

        setContext(function (ctx) {
          return showComments(ctx, psShownCells);
        });
      }
    }, [flowdata, setContext]);
    React.useLayoutEffect(function () {
      if (context.commentBoxes || context.hoveredCommentBox || context.editingCommentBox) {
        var _context$commentBoxes;

        lodash.concat((_context$commentBoxes = context.commentBoxes) === null || _context$commentBoxes === void 0 ? void 0 : _context$commentBoxes.filter(function (v) {
          var _context$editingComme;

          return v.rc !== ((_context$editingComme = context.editingCommentBox) === null || _context$editingComme === void 0 ? void 0 : _context$editingComme.rc);
        }), [context.hoveredCommentBox, context.editingCommentBox]).forEach(function (box) {
          if (box) {
            drawArrow(box.rc, box.size);
          }
        });
      }
    }, [context.commentBoxes, context.hoveredCommentBox, context.editingCommentBox]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-sheet-overlay",
      ref: containerRef,
      onMouseMove: onMouseMove,
      onMouseUp: onMouseUp,
      onTouchStart: onTouchStart,
      onTouchMove: onTouchMove,
      onTouchEnd: onTouchEnd,
      tabIndex: -1,
      style: {
        width: context.luckysheetTableContentHW[0],
        height: context.luckysheetTableContentHW[1]
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-col-header-wrap"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-left-top",
      onClick: onLeftTopClick,
      style: {
        width: context.rowHeaderWidth - 1.5,
        height: context.columnHeaderHeight - 1.5
      }
    }), /*#__PURE__*/React__default['default'].createElement(ColumnHeader, null)), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-row-body"
    }, /*#__PURE__*/React__default['default'].createElement(RowHeader, null), /*#__PURE__*/React__default['default'].createElement(ScrollBar, {
      axis: "x"
    }), /*#__PURE__*/React__default['default'].createElement(ScrollBar, {
      axis: "y"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      ref: refs.cellArea,
      className: "fortune-cell-area",
      onMouseDown: cellAreaMouseDown,
      onDoubleClick: cellAreaDoubleClick,
      onContextMenu: cellAreaContextMenu,
      style: {
        width: context.cellmainWidth,
        height: context.cellmainHeight,
        cursor: context.luckysheet_cell_selected_extend ? "crosshair" : "default"
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      id: "fortune-formula-functionrange"
    }), context.formulaRangeSelect && /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy fortune-formula-functionrange-select",
      style: context.formulaRangeSelect
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy-top fortune-copy"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy-right fortune-copy"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy-bottom fortune-copy"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy-left fortune-copy"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-selection-copy-hc"
    })), context.formulaRangeHighlight.map(function (v) {
      var rangeIndex = v.rangeIndex,
          backgroundColor = v.backgroundColor;
      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: rangeIndex,
        id: "fortune-formula-functionrange-highlight",
        className: "fortune-selection-highlight fortune-formula-functionrange-highlight",
        style: lodash.omit(v, "backgroundColor")
      }, ["top", "right", "bottom", "left"].map(function (d) {
        return /*#__PURE__*/React__default['default'].createElement("div", {
          key: d,
          "data-type": d,
          className: "fortune-selection-copy-".concat(d, " fortune-copy"),
          style: {
            backgroundColor: backgroundColor
          }
        });
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-hc",
        style: {
          backgroundColor: backgroundColor
        }
      }), ["lt", "rt", "lb", "rb"].map(function (d) {
        return /*#__PURE__*/React__default['default'].createElement("div", {
          key: d,
          "data-type": d,
          className: "fortune-selection-highlight-".concat(d, " luckysheet-highlight"),
          style: {
            backgroundColor: backgroundColor
          }
        });
      }));
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-row-count-show luckysheet-count-show",
      id: "luckysheet-row-count-show"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-column-count-show luckysheet-count-show",
      id: "luckysheet-column-count-show"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-change-size-line",
      hidden: !context.luckysheet_cols_change_size && !context.luckysheet_rows_change_size
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cell-selected-focus",
      style: ((_context$luckysheet_s = (_context$luckysheet_s2 = context.luckysheet_select_save) === null || _context$luckysheet_s2 === void 0 ? void 0 : _context$luckysheet_s2.length) !== null && _context$luckysheet_s !== void 0 ? _context$luckysheet_s : 0) > 0 ? {
        display: "block",
        left: (_$last = lodash.last(context.luckysheet_select_save)) === null || _$last === void 0 ? void 0 : _$last.left,
        width: (_$last2 = lodash.last(context.luckysheet_select_save)) === null || _$last2 === void 0 ? void 0 : _$last2.width,
        top: (_$last3 = lodash.last(context.luckysheet_select_save)) === null || _$last3 === void 0 ? void 0 : _$last3.top,
        height: (_$last4 = lodash.last(context.luckysheet_select_save)) === null || _$last4 === void 0 ? void 0 : _$last4.height
      } : {}
    }), ((_context$luckysheet_s3 = (_context$luckysheet_s4 = context.luckysheet_selection_range) === null || _context$luckysheet_s4 === void 0 ? void 0 : _context$luckysheet_s4.length) !== null && _context$luckysheet_s3 !== void 0 ? _context$luckysheet_s3 : 0) > 0 && /*#__PURE__*/React__default['default'].createElement("div", {
      id: "fortune-selection-copy"
    }, context.luckysheet_selection_range.map(function (range) {
      var r1 = range.row[0];
      var r2 = range.row[1];
      var c1 = range.column[0];
      var c2 = range.column[1];
      var row = context.visibledatarow[r2];
      var row_pre = r1 - 1 === -1 ? 0 : context.visibledatarow[r1 - 1];
      var col = context.visibledatacolumn[c2];
      var col_pre = c1 - 1 === -1 ? 0 : context.visibledatacolumn[c1 - 1];
      return /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy",
        key: "".concat(r1, "-").concat(r2, "-").concat(c1, "-").concat(c2),
        style: {
          left: col_pre,
          width: col - col_pre - 1,
          top: row_pre,
          height: row - row_pre - 1
        }
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-top fortune-copy"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-right fortune-copy"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-bottom fortune-copy"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-left fortune-copy"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-selection-copy-hc"
      }));
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-chart-rangeShow"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-cell-selected-extend"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-cell-selected-move"
    }), ((_context$luckysheet_s5 = (_context$luckysheet_s6 = context.luckysheet_select_save) === null || _context$luckysheet_s6 === void 0 ? void 0 : _context$luckysheet_s6.length) !== null && _context$luckysheet_s5 !== void 0 ? _context$luckysheet_s5 : 0) > 0 && /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-cell-selected-boxs"
    }, context.luckysheet_select_save.map(function (selection, index) {
      var _refs$globalCache$fre;

      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: index,
        id: "luckysheet-cell-selected",
        className: "luckysheet-cell-selected",
        style: getSelectionStyle(context, selection, (_refs$globalCache$fre = refs.globalCache.freezen) === null || _refs$globalCache$fre === void 0 ? void 0 : _refs$globalCache$fre[context.currentSheetId])
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-inner-border"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-fillhandle",
        onMouseDown: function onMouseDown(e) {
          var nativeEvent = e.nativeEvent;
          setContext(function (draftContext) {
            createDropCellRange(draftContext, nativeEvent, containerRef.current);
          });
          e.stopPropagation();
        }
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-inner-border"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-draghandle-top luckysheet-cs-draghandle"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-draghandle-left luckysheet-cs-draghandle"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-draghandle-right luckysheet-cs-draghandle"
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-touchhandle-btn"
      })), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-cs-touchhandle-btn"
      })));
    })), ((_context$presences$le = (_context$presences = context.presences) === null || _context$presences === void 0 ? void 0 : _context$presences.length) !== null && _context$presences$le !== void 0 ? _context$presences$le : 0) > 0 && context.presences.map(function (presence, index) {
      if (presence.sheetId !== context.currentSheetId) {
        return null;
      }

      var _presence$selection = presence.selection,
          r = _presence$selection.r,
          c = _presence$selection.c,
          color = presence.color;
      var row_pre = r - 1 === -1 ? 0 : context.visibledatarow[r - 1];
      var col_pre = c - 1 === -1 ? 0 : context.visibledatacolumn[c - 1];
      var row = context.visibledatarow[r];
      var col = context.visibledatacolumn[c];
      var width = col - col_pre - 1;
      var height = row - row_pre - 1;
      var usernameStyle = {
        maxWidth: width + 1,
        backgroundColor: color
      };

      lodash.set(usernameStyle, r === 0 ? "top" : "bottom", height);

      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: (presence === null || presence === void 0 ? void 0 : presence.userId) || index,
        className: "fortune-presence-selection",
        style: {
          left: col_pre,
          top: row_pre - 2,
          width: width,
          height: height,
          borderColor: color,
          borderWidth: 1
        }
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "fortune-presence-username",
        style: usernameStyle
      }, presence.username));
    }), /*#__PURE__*/React__default['default'].createElement(InputBox, null), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-postil-showBoxs"
    }, lodash.concat((_context$commentBoxes2 = context.commentBoxes) === null || _context$commentBoxes2 === void 0 ? void 0 : _context$commentBoxes2.filter(function (v) {
      var _context$editingComme2;

      return (v === null || v === void 0 ? void 0 : v.rc) !== ((_context$editingComme2 = context.editingCommentBox) === null || _context$editingComme2 === void 0 ? void 0 : _context$editingComme2.rc);
    }), [context.editingCommentBox, context.hoveredCommentBox]).map(function (commentBox) {
      var _context$editingComme3;

      if (!commentBox) return null;
      var r = commentBox.r,
          c = commentBox.c,
          rc = commentBox.rc,
          left = commentBox.left,
          top = commentBox.top,
          width = commentBox.width,
          height = commentBox.height,
          value = commentBox.value,
          autoFocus = commentBox.autoFocus,
          size = commentBox.size;
      var isEditing = ((_context$editingComme3 = context.editingCommentBox) === null || _context$editingComme3 === void 0 ? void 0 : _context$editingComme3.rc) === rc;
      var commentId = "comment-box-".concat(rc);
      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: rc
      }, /*#__PURE__*/React__default['default'].createElement("canvas", {
        id: "arrowCanvas-".concat(rc),
        className: "arrowCanvas",
        width: size.width,
        height: size.height,
        style: {
          position: "absolute",
          left: size.left,
          top: size.top,
          zIndex: 100,
          pointerEvents: "none"
        }
      }), /*#__PURE__*/React__default['default'].createElement("div", {
        id: commentId,
        className: "luckysheet-postil-show-main",
        style: {
          width: width,
          height: height,
          color: "#000",
          padding: 5,
          border: "1px solid #000",
          backgroundColor: "rgb(255,255,225)",
          position: "absolute",
          left: left,
          top: top,
          boxSizing: "border-box",
          zIndex: isEditing ? 200 : 100
        },
        onMouseDown: function onMouseDown(e) {
          var nativeEvent = e.nativeEvent;
          setContext(function (draftContext) {
            if (flowdata) {
              setEditingComment(draftContext, flowdata, r, c);
            }
          });
          onCommentBoxMoveStart(context, refs.globalCache, nativeEvent, containerRef.current, {
            r: r,
            c: c,
            rc: rc
          }, commentId);
          e.stopPropagation();
        }
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-postil-dialog-move"
      }, ["t", "r", "b", "l"].map(function (v) {
        return /*#__PURE__*/React__default['default'].createElement("div", {
          key: v,
          className: "luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-".concat(v),
          "data-type": v
        });
      })), isEditing && /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-postil-dialog-resize"
      }, ["lt", "mt", "lm", "rm", "rt", "lb", "mb", "rb"].map(function (v) {
        return /*#__PURE__*/React__default['default'].createElement("div", {
          key: v,
          className: "luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-".concat(v),
          "data-type": v,
          onMouseDown: function onMouseDown(e) {
            var nativeEvent = e.nativeEvent;
            onCommentBoxResizeStart(context, refs.globalCache, nativeEvent, containerRef.current, {
              r: r,
              c: c,
              rc: rc
            }, commentId, v);
            e.stopPropagation();
          }
        });
      })), /*#__PURE__*/React__default['default'].createElement("div", {
        style: {
          width: "100%",
          height: "100%",
          overflow: "hidden"
        }
      }, /*#__PURE__*/React__default['default'].createElement(ContentEditable, {
        id: "comment-editor-".concat(rc),
        autoFocus: autoFocus,
        style: {
          width: "100%",
          height: "100%",
          lineHeight: "20px",
          boxSizing: "border-box",
          textAlign: "center",
          wordBreak: "break-all",
          outline: "none"
        },
        spellCheck: false,
        "data-r": r,
        "data-c": c,
        onKeyDown: function onKeyDown(e) {
          return e.stopPropagation();
        },
        onFocus: function onFocus(e) {
          refs.globalCache.editingCommentBoxEle = e.target;
        },
        onMouseDown: function onMouseDown(e) {
          setContext(function (draftContext) {
            if (flowdata) {
              setEditingComment(draftContext, flowdata, r, c);
            }
          });
          e.stopPropagation();
        },
        onDoubleClick: function onDoubleClick(e) {
          e.stopPropagation();
        },
        initialContent: value
      }))));
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-multipleRange-show"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-dynamicArray-hightShow"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-image-showBoxs"
    }, context.activeImg && /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-modal-dialog-activeImage",
      className: "luckysheet-modal-dialog",
      style: _objectSpread2({
        padding: 0,
        position: "absolute",
        zIndex: 300
      }, lodash.omit(context.activeImg, "src"))
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-border",
      style: {
        position: "absolute"
      }
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-content",
      style: _objectSpread2(_objectSpread2({}, lodash.omit(context.activeImg, "src, left,top")), {}, {
        backgroundImage: "url(".concat(context.activeImg.src, ")"),
        backgroundSize: "".concat(context.activeImg.width, "px ").concat(context.activeImg.height, "px"),
        backgroundRepeat: "no-repeat"
      }),
      onMouseDown: function onMouseDown(e) {
        var nativeEvent = e.nativeEvent;
        onImageMoveStart(context, refs.globalCache, nativeEvent, containerRef.current);
        e.stopPropagation();
      }
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-resize"
    }, ["lt", "mt", "lm", "rm", "rt", "lb", "mb", "rb"].map(function (v) {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: v,
        className: "luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-".concat(v),
        "data-type": v,
        onMouseDown: function onMouseDown(e) {
          var nativeEvent = e.nativeEvent;
          onImageResizeStart(context, refs.globalCache, nativeEvent, containerRef.current, v);
          e.stopPropagation();
        }
      });
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-controll"
    }, /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-crop",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u88C1\u526A",
      title: "\u88C1\u526A"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-pencil",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-restore",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u6062\u590D\u539F\u56FE",
      title: "\u6062\u590D\u539F\u56FE"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-window-maximize",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-del",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u5220\u9664",
      title: "\u5220\u9664"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-trash",
      "aria-hidden": "true"
    })))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "img-list"
    }, (_context$insertedImgs = context.insertedImgs) === null || _context$insertedImgs === void 0 ? void 0 : _context$insertedImgs.map(function (v) {
      var _context$activeImg;

      var id = v.id,
          left = v.left,
          top = v.top,
          width = v.width,
          height = v.height,
          src = v.src;
      if (v.id === ((_context$activeImg = context.activeImg) === null || _context$activeImg === void 0 ? void 0 : _context$activeImg.id)) return null;
      return /*#__PURE__*/React__default['default'].createElement("div", {
        id: id,
        className: "luckysheet-modal-dialog luckysheet-modal-dialog-image",
        style: {
          width: width,
          height: height,
          padding: 0,
          position: "absolute",
          left: left,
          top: top,
          zIndex: 200
        },
        onClick: function onClick(e) {
          setContext(function (ctx) {
            ctx.activeImg = v;
          });
          e.stopPropagation();
        }
      }, /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-modal-dialog-content",
        style: {
          width: "100%",
          height: "100%",
          overflow: "hidden",
          position: "relative"
        }
      }, /*#__PURE__*/React__default['default'].createElement("img", {
        src: src,
        alt: "",
        style: {
          width: width,
          height: height,
          padding: 0,
          position: "absolute"
        }
      })), /*#__PURE__*/React__default['default'].createElement("div", {
        className: "luckysheet-modal-dialog-border"
      }));
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-modal-dialog-cropping",
      className: "luckysheet-modal-dialog",
      style: {
        display: "none",
        padding: 0,
        position: "absolute",
        zIndex: 300
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "cropping-mask"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "cropping-content"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-border",
      style: {
        position: "absolute"
      }
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-resize"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item lt",
      "data-type": "lt"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item mt",
      "data-type": "mt"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item lm",
      "data-type": "lm"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item rm",
      "data-type": "rm"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item rt",
      "data-type": "rt"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item lb",
      "data-type": "lb"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item mb",
      "data-type": "mb"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "resize-item rb",
      "data-type": "rb"
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-modal-dialog-controll"
    }, /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-crop",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u88C1\u526A",
      title: "\u88C1\u526A"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-pencil",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-restore",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u6062\u590D\u539F\u56FE",
      title: "\u6062\u590D\u539F\u56FE"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-window-maximize",
      "aria-hidden": "true"
    })), /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-modal-controll-btn luckysheet-modal-controll-del",
      role: "button",
      tabIndex: 0,
      "aria-label": "\u5220\u9664",
      title: "\u5220\u9664"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "fa fa-trash",
      "aria-hidden": "true"
    })))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "cell-date-picker"
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-dataVerification-dropdown-btn"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-dataVerification-dropdown-List",
      className: "luckysheet-mousedown-cancel"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-dataVerification-showHintBox",
      className: "luckysheet-mousedown-cancel"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cell-copy"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-grdblkflowpush"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-cell-flow_0",
      className: "luckysheet-cell-flow luckysheetsheetchange"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cell-flow-clip"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-grdblkpush"
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheetcoltable_0",
      className: "luckysheet-cell-flow-col"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-sheettable_0",
      className: "luckysheet-cell-sheettable",
      style: {
        height: context.rh_height,
        width: context.ch_width
      }
    })))))));
  };

  var Sheet = function Sheet(_ref) {
    var _context$config, _context$config2;

    var sheet = _ref.sheet;
    var data = sheet.data;
    var containerRef = React.useRef(null);
    var placeholderRef = React.useRef(null);

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        refs = _useContext.refs;

    React.useEffect(function () {
      function resize() {
        if (!data) return;
        setContext(function (draftCtx) {
          updateContextWithSheetData(draftCtx, data);
          updateContextWithCanvas(draftCtx, refs.canvas.current, placeholderRef.current);
        });
      }

      window.addEventListener("resize", resize);
      return function () {
        window.removeEventListener("resize", resize);
      };
    }, [data, refs.canvas, setContext]);
    React.useEffect(function () {
      if (!data) return;
      setContext(function (draftCtx) {
        return updateContextWithSheetData(draftCtx, data);
      });
    }, [(_context$config = context.config) === null || _context$config === void 0 ? void 0 : _context$config.rowlen, (_context$config2 = context.config) === null || _context$config2 === void 0 ? void 0 : _context$config2.columnlen, data, setContext]);
    React.useEffect(function () {
      setContext(function (draftCtx) {
        return updateContextWithCanvas(draftCtx, refs.canvas.current, placeholderRef.current);
      });
    }, [refs.canvas, setContext]);
    React.useEffect(function () {
      initFreeze(context, refs.globalCache, context.currentSheetId);
    }, [refs.globalCache, sheet.frozen, context.currentSheetId, context.visibledatacolumn, context.visibledatarow]);
    React.useEffect(function () {
      var _refs$globalCache$fre, _freeze$horizontal, _freeze$vertical;

      if (context.groupValuesRefreshData.length > 0) {
        return;
      }

      var tableCanvas = new Canvas(refs.canvas.current, context);
      if (tableCanvas == null) return;
      var freeze = (_refs$globalCache$fre = refs.globalCache.freezen) === null || _refs$globalCache$fre === void 0 ? void 0 : _refs$globalCache$fre[sheet.id];

      if ((freeze === null || freeze === void 0 ? void 0 : (_freeze$horizontal = freeze.horizontal) === null || _freeze$horizontal === void 0 ? void 0 : _freeze$horizontal.freezenhorizontaldata) || (freeze === null || freeze === void 0 ? void 0 : (_freeze$vertical = freeze.vertical) === null || _freeze$vertical === void 0 ? void 0 : _freeze$vertical.freezenverticaldata)) {
        var _freeze$horizontal2, _freeze$vertical2;

        var horizontalData = freeze === null || freeze === void 0 ? void 0 : (_freeze$horizontal2 = freeze.horizontal) === null || _freeze$horizontal2 === void 0 ? void 0 : _freeze$horizontal2.freezenhorizontaldata;
        var verticallData = freeze === null || freeze === void 0 ? void 0 : (_freeze$vertical2 = freeze.vertical) === null || _freeze$vertical2 === void 0 ? void 0 : _freeze$vertical2.freezenverticaldata;

        if (horizontalData && verticallData) {
          var _horizontalData = _slicedToArray(horizontalData, 3),
              horizontalPx = _horizontalData[0],
              horizontalScrollTop = _horizontalData[2];

          var _verticallData = _slicedToArray(verticallData, 3),
              verticalPx = _verticallData[0],
              verticalScrollWidth = _verticallData[2];

          tableCanvas.drawMain({
            scrollWidth: context.scrollLeft + verticalPx - verticalScrollWidth,
            scrollHeight: context.scrollTop + horizontalPx - horizontalScrollTop,
            offsetLeft: verticalPx - verticalScrollWidth + context.rowHeaderWidth,
            offsetTop: horizontalPx - horizontalScrollTop + context.columnHeaderHeight,
            clear: true
          });
          tableCanvas.drawMain({
            scrollWidth: context.scrollLeft + verticalPx - verticalScrollWidth,
            scrollHeight: horizontalScrollTop,
            drawHeight: horizontalPx,
            offsetLeft: verticalPx - verticalScrollWidth + context.rowHeaderWidth
          });
          tableCanvas.drawMain({
            scrollWidth: verticalScrollWidth,
            scrollHeight: context.scrollTop + horizontalPx - horizontalScrollTop,
            drawWidth: verticalPx,
            offsetTop: horizontalPx - horizontalScrollTop + context.columnHeaderHeight
          });
          tableCanvas.drawMain({
            scrollWidth: verticalScrollWidth,
            scrollHeight: horizontalScrollTop,
            drawWidth: verticalPx,
            drawHeight: horizontalPx
          });
          tableCanvas.drawColumnHeader(context.scrollLeft + verticalPx - verticalScrollWidth, undefined, verticalPx - verticalScrollWidth + context.rowHeaderWidth);
          tableCanvas.drawColumnHeader(verticalScrollWidth, verticalPx);
          tableCanvas.drawRowHeader(context.scrollTop + horizontalPx - horizontalScrollTop, undefined, horizontalPx - horizontalScrollTop + context.columnHeaderHeight);
          tableCanvas.drawRowHeader(horizontalScrollTop, horizontalPx);
          tableCanvas.drawFreezeLine({
            horizontalTop: horizontalPx - horizontalScrollTop + context.columnHeaderHeight - 2,
            verticalLeft: verticalPx - verticalScrollWidth + context.rowHeaderWidth - 2
          });
        } else if (horizontalData) {
          var _horizontalData2 = _slicedToArray(horizontalData, 3),
              _horizontalPx = _horizontalData2[0],
              _horizontalScrollTop = _horizontalData2[2];

          tableCanvas.drawMain({
            scrollWidth: context.scrollLeft,
            scrollHeight: context.scrollTop + _horizontalPx - _horizontalScrollTop,
            offsetTop: _horizontalPx - _horizontalScrollTop + context.columnHeaderHeight,
            clear: true
          });
          tableCanvas.drawMain({
            scrollWidth: context.scrollLeft,
            scrollHeight: _horizontalScrollTop,
            drawHeight: _horizontalPx
          });
          tableCanvas.drawColumnHeader(context.scrollLeft);
          tableCanvas.drawRowHeader(context.scrollTop + _horizontalPx - _horizontalScrollTop, undefined, _horizontalPx - _horizontalScrollTop + context.columnHeaderHeight);
          tableCanvas.drawRowHeader(_horizontalScrollTop, _horizontalPx);
          tableCanvas.drawFreezeLine({
            horizontalTop: _horizontalPx - _horizontalScrollTop + context.columnHeaderHeight - 2
          });
        } else if (verticallData) {
          var _verticallData2 = _slicedToArray(verticallData, 3),
              _verticalPx = _verticallData2[0],
              _verticalScrollWidth = _verticallData2[2];

          tableCanvas.drawMain({
            scrollWidth: context.scrollLeft + _verticalPx - _verticalScrollWidth,
            scrollHeight: context.scrollTop,
            offsetLeft: _verticalPx - _verticalScrollWidth + context.rowHeaderWidth
          });
          tableCanvas.drawMain({
            scrollWidth: _verticalScrollWidth,
            scrollHeight: context.scrollTop,
            drawWidth: _verticalPx
          });
          tableCanvas.drawRowHeader(context.scrollTop);
          tableCanvas.drawColumnHeader(context.scrollLeft + _verticalPx - _verticalScrollWidth, undefined, _verticalPx - _verticalScrollWidth + context.rowHeaderWidth);
          tableCanvas.drawColumnHeader(_verticalScrollWidth, _verticalPx);
          tableCanvas.drawFreezeLine({
            verticalLeft: _verticalPx - _verticalScrollWidth + context.rowHeaderWidth - 2
          });
        }
      } else {
        tableCanvas.drawMain({
          scrollWidth: context.scrollLeft,
          scrollHeight: context.scrollTop,
          clear: true
        });
        tableCanvas.drawColumnHeader(context.scrollLeft);
        tableCanvas.drawRowHeader(context.scrollTop);
      }
    }, [context, refs.canvas, refs.globalCache.freezen, setContext, sheet.id]);
    React.useEffect(function () {
      if (context.groupValuesRefreshData.length > 0) {
        setContext(function (draftCtx) {
          groupValuesRefresh(draftCtx);
        });
      }
    }, [context.groupValuesRefreshData.length, setContext]);
    var onWheel = React.useCallback(function (e) {
      setContext(function (draftCtx) {
        handleGlobalWheel(draftCtx, e, refs.globalCache, refs.scrollbarX.current, refs.scrollbarY.current);
      });
    }, [refs.globalCache, refs.scrollbarX, refs.scrollbarY, setContext]);
    React.useEffect(function () {
      var container = containerRef.current;
      container === null || container === void 0 ? void 0 : container.addEventListener("wheel", onWheel);
      return function () {
        container === null || container === void 0 ? void 0 : container.removeEventListener("wheel", onWheel);
      };
    }, [onWheel]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "fortune-sheet-container"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      ref: placeholderRef,
      className: "fortune-sheet-canvas-placeholder"
    }), /*#__PURE__*/React__default['default'].createElement("canvas", {
      className: "fortune-sheet-canvas",
      ref: refs.canvas
    }), /*#__PURE__*/React__default['default'].createElement(SheetOverlay, null));
  };

  var SVGIcon = function SVGIcon(_ref) {
    var _ref$width = _ref.width,
        width = _ref$width === void 0 ? 24 : _ref$width,
        _ref$height = _ref.height,
        height = _ref$height === void 0 ? 24 : _ref$height,
        name = _ref.name,
        style = _ref.style;
    return /*#__PURE__*/React__default['default'].createElement("svg", {
      width: width,
      height: height,
      style: style
    }, /*#__PURE__*/React__default['default'].createElement("use", {
      xlinkHref: "#".concat(name)
    }));
  };

  var Button = function Button(_ref) {
    var tooltip = _ref.tooltip,
        onClick = _ref.onClick,
        iconId = _ref.iconId,
        disabled = _ref.disabled,
        selected = _ref.selected,
        children = _ref.children;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-button fortune-toolbar-item",
      onClick: onClick,
      "data-tips": tooltip,
      role: "button",
      style: selected ? {
        backgroundColor: "#E7E5EB"
      } : {}
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: iconId,
      style: disabled ? {
        opacity: 0.3
      } : {}
    }), tooltip && /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-tooltip"
    }, tooltip), children);
  };

  var Divider = function Divider() {
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-divider fortune-toolbar-item"
    });
  };

  var MenuDivider = function MenuDivider() {
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-menu-divider"
    });
  };

  function useOutsideClick(containerRef, handler, deps) {
    React.useEffect(function () {
      function handleClickOutside(e) {
        if (containerRef.current && !containerRef.current.contains(e.target)) {
          handler();
        }
      }

      document.addEventListener("mousedown", handleClickOutside);
      return function () {
        document.removeEventListener("mousedown", handleClickOutside);
      };
    }, deps);
  }

  var Combo = function Combo(_ref) {
    var tooltip = _ref.tooltip,
        _onClick = _ref.onClick,
        text = _ref.text,
        iconId = _ref.iconId,
        children = _ref.children;
    var style = {
      userSelect: "none"
    };

    var _useState = React.useState(false),
        _useState2 = _slicedToArray(_useState, 2),
        open = _useState2[0],
        setOpen = _useState2[1];

    var _useState3 = React.useState({
      left: 0
    }),
        _useState4 = _slicedToArray(_useState3, 2),
        popupPosition = _useState4[0],
        setPopupPosition = _useState4[1];

    var popupRef = React.useRef(null);
    var buttonRef = React.useRef(null);
    useOutsideClick(popupRef, function () {
      setOpen(false);
    });
    React.useLayoutEffect(function () {
      if (!popupRef.current) {
        return;
      }

      if (!open) {
        setPopupPosition({
          left: 0
        });
      }

      var winW = window.innerWidth;
      var rect = popupRef.current.getBoundingClientRect();
      var menuW = rect.width;
      var left = rect.left;

      if (left + menuW > winW) {
        setPopupPosition({
          left: -rect.width + buttonRef.current.clientWidth
        });
      }
    }, [open]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toobar-combo-container fortune-toolbar-item"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      ref: buttonRef,
      className: "fortune-toolbar-combo"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-combo-button",
      onClick: function onClick(e) {
        if (_onClick) _onClick(e);else setOpen(!open);
      },
      "data-tips": tooltip,
      role: "button",
      style: style
    }, iconId ? /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: iconId
    }) : /*#__PURE__*/React__default['default'].createElement("span", {
      className: "fortune-toolbar-combo-text"
    }, text)), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-combo-arrow",
      onClick: function onClick() {
        return setOpen(!open);
      },
      "data-tips": tooltip,
      role: "button",
      style: style
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "combo-arrow",
      width: 10
    })), tooltip && /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-tooltip"
    }, tooltip)), open && /*#__PURE__*/React__default['default'].createElement("div", {
      ref: popupRef,
      className: "fortune-toolbar-combo-popup",
      style: popupPosition
    }, children === null || children === void 0 ? void 0 : children(setOpen)));
  };

  var palette = [["#000", "#444", "#666", "#999", "#ccc", "#eee", "#f3f3f3", "#fff"], ["#f00", "#f90", "#ff0", "#0f0", "#0ff", "#00f", "#90f", "#f0f"], ["#f4cccc", "#fce5cd", "#fff2cc", "#d9ead3", "#d0e0e3", "#cfe2f3", "#d9d2e9", "#ead1dc"], ["#ea9999", "#f9cb9c", "#ffe599", "#b6d7a8", "#a2c4c9", "#9fc5e8", "#b4a7d6", "#d5a6bd"], ["#e06666", "#f6b26b", "#ffd966", "#93c47d", "#76a5af", "#6fa8dc", "#8e7cc3", "#c27ba0"], ["#c00", "#e69138", "#f1c232", "#6aa84f", "#45818e", "#3d85c6", "#674ea7", "#a64d79"], ["#900", "#b45f06", "#bf9000", "#38761d", "#134f5c", "#0b5394", "#351c75", "#741b47"], ["#600", "#783f04", "#7f6000", "#274e13", "#0c343d", "#073763", "#20124d", "#4c1130"]];

  var ColorPicker = function ColorPicker(_ref) {
    var onPick = _ref.onPick;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-color-picker"
    }, palette.map(function (rows, i) {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        key: i,
        className: "fortune-toolbar-color-picker-row"
      }, rows.map(function (c) {
        return /*#__PURE__*/React__default['default'].createElement("div", {
          key: c,
          className: "fortune-toolbar-color-picker-item",
          onClick: function onClick() {
            return onPick(c);
          },
          style: {
            backgroundColor: c
          }
        });
      }));
    }));
  };

  var Select = function Select(_ref) {
    var children = _ref.children;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-toolbar-select"
    }, children);
  };

  var Option = function Option(_ref2) {
    var iconId = _ref2.iconId,
        onClick = _ref2.onClick,
        children = _ref2.children;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      onClick: onClick,
      className: "fortune-toolbar-select-option"
    }, iconId && /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: iconId
    }), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortuen-toolbar-text"
    }, children));
  };

  var Dialog = function Dialog(_ref) {
    var type = _ref.type,
        onOk = _ref.onOk,
        onCancel = _ref.onCancel,
        children = _ref.children,
        containerStyle = _ref.containerStyle,
        contentStyle = _ref.contentStyle;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context;

    var _locale = locale(context),
        button = _locale.button;

    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-dialog",
      style: containerStyle
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-modal-dialog-header"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "forturn-modal-dialog-icon-close",
      onClick: onCancel
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "close",
      style: {
        padding: 7,
        cursor: "pointer"
      }
    }))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-dialog-box-content",
      style: contentStyle
    }, children), type != null && /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-dialog-box-button-container"
    }, type === "ok" ? /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-message-box-button button-default",
      onClick: onOk
    }, button.confirm) : /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-message-box-button button-primary",
      onClick: onOk
    }, button.confirm), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-message-box-button button-default",
      onClick: onCancel
    }, button.cancel))));
  };

  var ModalContext = /*#__PURE__*/React__default['default'].createContext({
    component: null,
    showModal: function showModal() {},
    hideModal: function hideModal() {}
  });

  var ModalProvider = function ModalProvider(_ref) {
    var children = _ref.children;

    var _useState = React.useState(null),
        _useState2 = _slicedToArray(_useState, 2),
        component = _useState2[0],
        setComponent = _useState2[1];

    var showModal = React.useCallback(function (c) {
      setComponent(c);
    }, []);
    var hideModal = React.useCallback(function () {
      setComponent(null);
    }, []);
    var providerValue = React.useMemo(function () {
      return {
        component: null,
        showModal: showModal,
        hideModal: hideModal
      };
    }, [hideModal, showModal]);
    return /*#__PURE__*/React__default['default'].createElement(ModalContext.Provider, {
      value: providerValue
    }, children, component && /*#__PURE__*/React__default['default'].createElement("div", {
      onMouseDown: function onMouseDown(e) {
        return e.stopPropagation();
      },
      onMouseMove: function onMouseMove(e) {
        return e.stopPropagation();
      },
      onMouseUp: function onMouseUp(e) {
        return e.stopPropagation();
      },
      onContextMenu: function onContextMenu(e) {
        return e.stopPropagation();
      },
      className: "fortune-popover-backdrop fortune-modal-container"
    }, component));
  };

  function useDialog() {
    var _useContext = React.useContext(ModalContext),
        showModal = _useContext.showModal,
        hideModal = _useContext.hideModal;

    var showDialog = React.useCallback(function (content, type) {
      var onOk = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : hideModal;
      var onCancel = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : hideModal;
      showModal( /*#__PURE__*/React__default['default'].createElement(Dialog, {
        type: type,
        onOk: onOk,
        onCancel: onCancel
      }, content));
    }, [hideModal, showModal]);
    return {
      showDialog: showDialog,
      hideDialog: hideModal
    };
  }

  var FormulaSearch$1 = function FormulaSearch(_ref) {
    var _onCancel = _ref.onCancel;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        _useContext$refs = _useContext.refs,
        cellInput = _useContext$refs.cellInput,
        globalCache = _useContext$refs.globalCache;

    var _useState = React.useState(0),
        _useState2 = _slicedToArray(_useState, 2),
        selectedType = _useState2[0],
        setSelectedType = _useState2[1];

    var _useState3 = React.useState(0),
        _useState4 = _slicedToArray(_useState3, 2),
        selectedFuncIndex = _useState4[0],
        setSelectedFuncIndex = _useState4[1];

    var _useState5 = React.useState(""),
        _useState6 = _slicedToArray(_useState5, 2),
        searchText = _useState6[0],
        setSearchText = _useState6[1];

    var _locale = locale(context),
        formulaMore = _locale.formulaMore,
        functionlist = _locale.functionlist,
        button = _locale.button;

    var typeList = React.useMemo(function () {
      return [{
        t: 0,
        n: formulaMore.Math
      }, {
        t: 1,
        n: formulaMore.Statistical
      }, {
        t: 2,
        n: formulaMore.Lookup
      }, {
        t: 3,
        n: formulaMore.luckysheet
      }, {
        t: 4,
        n: formulaMore.dataMining
      }, {
        t: 5,
        n: formulaMore.Database
      }, {
        t: 6,
        n: formulaMore.Date
      }, {
        t: 7,
        n: formulaMore.Filter
      }, {
        t: 8,
        n: formulaMore.Financial
      }, {
        t: 9,
        n: formulaMore.Engineering
      }, {
        t: 10,
        n: formulaMore.Logical
      }, {
        t: 11,
        n: formulaMore.Operator
      }, {
        t: 12,
        n: formulaMore.Text
      }, {
        t: 13,
        n: formulaMore.Parser
      }, {
        t: 14,
        n: formulaMore.Array
      }, {
        t: -1,
        n: formulaMore.other
      }];
    }, [formulaMore]);
    var filteredFunctionList = React.useMemo(function () {
      if (searchText) {
        var list = [];

        var text = lodash.cloneDeep(searchText.toUpperCase());

        for (var i = 0; i < functionlist.length; i += 1) {
          if (/^[a-zA-Z]+$/.test(text)) {
            if (functionlist[i].n.indexOf(text) !== -1) {
              list.push(functionlist[i]);
            }
          } else if (functionlist[i].a.indexOf(text) !== -1) {
            list.push(functionlist[i]);
          }
        }

        return list;
      }

      return lodash.filter(functionlist, function (v) {
        return v.t === selectedType;
      });
    }, [functionlist, selectedType, searchText]);
    var onConfirm = React.useCallback(function () {
      var _context$luckysheet_s;

      var last = (_context$luckysheet_s = context.luckysheet_select_save) === null || _context$luckysheet_s === void 0 ? void 0 : _context$luckysheet_s[context.luckysheet_select_save.length - 1];
      var row_index = last === null || last === void 0 ? void 0 : last.row_focus;
      var col_index = last === null || last === void 0 ? void 0 : last.column_focus;

      if (!last) {
        row_index = 0;
        col_index = 0;
      } else {
        if (row_index == null) {
          var _last$row = _slicedToArray(last.row, 1);

          row_index = _last$row[0];
        }

        if (col_index == null) {
          var _last$column = _slicedToArray(last.column, 1);

          col_index = _last$column[0];
        }
      }

      var formulaTxt = "<span dir=\"auto\" class=\"luckysheet-formula-text-color\">=</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">".concat(filteredFunctionList[selectedFuncIndex].n.toUpperCase(), "</span><span dir=\"auto\" class=\"luckysheet-formula-text-color\">(</span>");
      setContext(function (ctx) {
        if (cellInput.current != null) {
          ctx.luckysheetCellUpdate = [row_index, col_index];
          globalCache.doNotUpdateCell = true;
          cellInput.current.innerHTML = formulaTxt;
          var spans = cellInput.current.childNodes;

          if (!lodash.isEmpty(spans)) {
            setCaretPosition(ctx, spans[spans.length - 1], 0, 1);
          }

          ctx.functionHint = filteredFunctionList[selectedFuncIndex].n.toUpperCase();
          ctx.functionCandidates = [];

          if (lodash.isEmpty(ctx.formulaCache.functionlistMap)) {
            for (var i = 0; i < functionlist.length; i += 1) {
              ctx.formulaCache.functionlistMap[functionlist[i].n] = functionlist[i];
            }
          }

          _onCancel();
        }
      });
    }, [cellInput, context.luckysheet_select_save, filteredFunctionList, globalCache, selectedFuncIndex, setContext, _onCancel, functionlist]);
    var onCancel = React.useCallback(function () {
      setContext(function (ctx) {
        cancelNormalSelected(ctx);

        if (cellInput.current) {
          cellInput.current.innerHTML = "";
        }
      });

      _onCancel();
    }, [_onCancel, cellInput, setContext]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-search-formula"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "inpbox"
    }, /*#__PURE__*/React__default['default'].createElement("div", null, formulaMore.findFunctionTitle, "\uFF1A"), /*#__PURE__*/React__default['default'].createElement("input", {
      className: "formulaInputFocus",
      id: "searchFormulaListInput",
      placeholder: formulaMore.tipInputFunctionName,
      spellCheck: "false",
      onChange: function onChange(e) {
        return setSearchText(e.target.value);
      }
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "selbox"
    }, /*#__PURE__*/React__default['default'].createElement("span", null, formulaMore.selectCategory, "\uFF1A"), /*#__PURE__*/React__default['default'].createElement("select", {
      id: "formulaTypeSelect",
      onChange: function onChange(e) {
        setSelectedType(parseInt(e.target.value, 10));
        setSelectedFuncIndex(0);
      }
    }, typeList.map(function (v) {
      return /*#__PURE__*/React__default['default'].createElement("option", {
        key: v.t,
        value: v.t
      }, v.n);
    }))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "listbox",
      style: {
        height: 200
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", null, formulaMore.selectFunctionTitle, "\uFF1A"), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "formulaList"
    }, filteredFunctionList.map(function (v, index) {
      return /*#__PURE__*/React__default['default'].createElement("div", {
        className: "listBox".concat(index === selectedFuncIndex ? " on" : ""),
        key: v.n,
        onClick: function onClick() {
          return setSelectedFuncIndex(index);
        }
      }, /*#__PURE__*/React__default['default'].createElement("div", null, v.n), /*#__PURE__*/React__default['default'].createElement("div", null, v.a));
    }))), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-dialog-box-button-container"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-message-box-button button-primary",
      onClick: onConfirm
    }, button.confirm), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-message-box-button button-default",
      onClick: onCancel
    }, button.cancel)));
  };

  var Toolbar = function Toolbar(_ref) {
    var _context$luckysheet_s, _flowdata$row;

    var setMoreItems = _ref.setMoreItems,
        moreItemsOpen = _ref.moreItemsOpen;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        refs = _useContext.refs,
        settings = _useContext.settings,
        handleUndo = _useContext.handleUndo,
        handleRedo = _useContext.handleRedo;

    var contextRef = React.useRef(context);
    var containerRef = React.useRef(null);

    var _useState = React.useState(-1),
        _useState2 = _slicedToArray(_useState, 2),
        toolbarWrapIndex = _useState2[0],
        setToolbarWrapIndex = _useState2[1];

    var _useState3 = React.useState([]),
        _useState4 = _slicedToArray(_useState3, 2),
        itemLocations = _useState4[0],
        setItemLocations = _useState4[1];

    var _useDialog = useDialog(),
        showDialog = _useDialog.showDialog,
        hideDialog = _useDialog.hideDialog;

    var firstSelection = (_context$luckysheet_s = context.luckysheet_select_save) === null || _context$luckysheet_s === void 0 ? void 0 : _context$luckysheet_s[0];
    var flowdata = getFlowdata(context);
    contextRef.current = context;
    var row = firstSelection === null || firstSelection === void 0 ? void 0 : firstSelection.row_focus;
    var col = firstSelection === null || firstSelection === void 0 ? void 0 : firstSelection.column_focus;
    var cell = flowdata && row != null && col != null ? flowdata === null || flowdata === void 0 ? void 0 : (_flowdata$row = flowdata[row]) === null || _flowdata$row === void 0 ? void 0 : _flowdata$row[col] : undefined;

    var _locale = locale(context),
        toolbar = _locale.toolbar,
        merge = _locale.merge,
        border = _locale.border,
        freezen = _locale.freezen,
        defaultFmt = _locale.defaultFmt,
        formula = _locale.formula,
        sort = _locale.sort,
        align = _locale.align,
        textWrap = _locale.textWrap,
        rotation = _locale.rotation,
        screenshot = _locale.screenshot;

    var sheetWidth = context.luckysheetTableContentHW[0];
    React.useEffect(function () {
      setToolbarWrapIndex(-1);
    }, [settings.toolbarItems]);
    React.useEffect(function () {
      if (toolbarWrapIndex === -1) {
        var container = containerRef.current;
        if (!container) return;
        var items = container.querySelectorAll(".fortune-toolbar-item");
        if (!items) return;
        var locations = [];
        var containerRect = container.getBoundingClientRect();

        for (var i = 0; i < items.length; i += 1) {
          var item = items[i];
          var itemRect = item.getBoundingClientRect();
          locations.push(itemRect.left - containerRect.left + itemRect.width);
        }

        setItemLocations(locations);
      }
    }, [toolbarWrapIndex, sheetWidth]);
    React.useEffect(function () {
      if (itemLocations.length === 0) return;
      var container = containerRef.current;
      if (!container) return;
      var moreButtonWidth = 50;

      for (var i = itemLocations.length - 1; i >= 0; i -= 1) {
        var loc = itemLocations[i];

        if (loc + moreButtonWidth < container.clientWidth) {
          setToolbarWrapIndex(i);

          if (i === itemLocations.length - 1) {
            setMoreItems(null);
          }

          break;
        }
      }
    }, [itemLocations, setMoreItems, sheetWidth]);
    var getToolbarItem = React.useCallback(function (name, i) {
      var _toolbarItemSelectedF;

      var tooltip = toolbar[name];

      if (name === "|") {
        return /*#__PURE__*/React__default['default'].createElement(Divider, {
          key: i
        });
      }

      if (["font-color", "background"].includes(name)) {
        var pick = function pick(color) {
          setContext(function (draftCtx) {
            return (name === "font-color" ? handleTextColor : handleTextBackground)(draftCtx, refs.cellInput.current, color);
          });

          if (name === "font-color") {
            refs.globalCache.recentTextColor = color;
          } else {
            refs.globalCache.recentBackgroundColor = color;
          }
        };

        return /*#__PURE__*/React__default['default'].createElement("div", null, name === "font-color" && /*#__PURE__*/React__default['default'].createElement("div", {
          style: {
            width: 17,
            height: 2,
            backgroundColor: refs.globalCache.recentTextColor,
            position: "absolute",
            top: 27,
            left: 624,
            zIndex: 1000
          }
        }), name === "background" && /*#__PURE__*/React__default['default'].createElement("div", {
          style: {
            width: 17,
            height: 2,
            backgroundColor: refs.globalCache.recentBackgroundColor,
            position: "absolute",
            top: 27,
            left: 670,
            zIndex: 1000
          }
        }), /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: name,
          key: name,
          tooltip: tooltip,
          onClick: function onClick() {
            var color = name === "font-color" ? refs.globalCache.recentTextColor : refs.globalCache.recentBackgroundColor;
            if (color) pick(color);
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(ColorPicker, {
            onPick: function onPick(color) {
              pick(color);
              setOpen(false);
            }
          });
        }));
      }

      if (name === "format") {
        var currentFmt = defaultFmt[0].text;

        if (cell) {
          var curr = normalizedCellAttr(cell, "ct");

          var format = lodash.find(defaultFmt, function (v) {
            return v.value === (curr === null || curr === void 0 ? void 0 : curr.fa);
          });

          if ((curr === null || curr === void 0 ? void 0 : curr.fa) != null) {
            if (format != null) {
              currentFmt = format.text;
            } else {
              currentFmt = defaultFmt[defaultFmt.length - 1].text;
            }
          }
        }

        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          text: currentFmt,
          key: name,
          tooltip: tooltip
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, defaultFmt.slice(0, defaultFmt.length - 2).map(function (_ref2, ii) {
            var text = _ref2.text,
                value = _ref2.value,
                example = _ref2.example;
            return value !== "split" ? /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setOpen(false);
                setContext(function (ctx) {
                  var d = getFlowdata(ctx);
                  if (d == null) return;
                  updateFormat(ctx, refs.cellInput.current, d, "ct", value);
                });
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, /*#__PURE__*/React__default['default'].createElement("div", null, text), /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-subtext"
            }, example))) : /*#__PURE__*/React__default['default'].createElement(MenuDivider, {
              key: ii
            });
          }));
        });
      }

      if (name === "font-size") {
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          text: cell ? normalizedCellAttr(cell, "fs") : "10",
          key: name,
          tooltip: tooltip
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, [9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72].map(function (num) {
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: num,
              onClick: function onClick() {
                setContext(function (draftContext) {
                  return handleTextSize(draftContext, refs.cellInput.current, num);
                });
                setOpen(false);
              }
            }, num);
          }));
        });
      }

      if (name === "horizontal-align") {
        var _$find;

        var items = [{
          title: "align-left",
          text: align.left,
          value: 1
        }, {
          title: "align-center",
          text: align.center,
          value: 0
        }, {
          title: "align-right",
          text: align.right,
          value: 2
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: ((_$find = lodash.find(items, function (item) {
            return "".concat(item.value) === "".concat(cell === null || cell === void 0 ? void 0 : cell.ht);
          })) === null || _$find === void 0 ? void 0 : _$find.title) || "align-left",
          key: name,
          tooltip: toolbar.horizontalAlign
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, items.map(function (_ref3) {
            var text = _ref3.text,
                title = _ref3.title;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: title,
              onClick: function onClick() {
                setContext(function (ctx) {
                  handleHorizontalAlign(ctx, refs.cellInput.current, title.replace("align-", ""));
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: title
            })));
          }));
        });
      }

      if (name === "vertical-align") {
        var _$find2;

        var _items = [{
          title: "align-top",
          text: align.top,
          value: 1
        }, {
          title: "align-middle",
          text: align.middle,
          value: 0
        }, {
          title: "align-bottom",
          text: align.bottom,
          value: 2
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: ((_$find2 = lodash.find(_items, function (item) {
            return "".concat(item.value) === "".concat(cell === null || cell === void 0 ? void 0 : cell.vt);
          })) === null || _$find2 === void 0 ? void 0 : _$find2.title) || "align-top",
          key: name,
          tooltip: toolbar.verticalAlign
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items.map(function (_ref4) {
            var text = _ref4.text,
                title = _ref4.title;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: title,
              onClick: function onClick() {
                setContext(function (ctx) {
                  handleVerticalAlign(ctx, refs.cellInput.current, title.replace("align-", ""));
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: title
            })));
          }));
        });
      }

      if (name === "undo") {
        return /*#__PURE__*/React__default['default'].createElement(Button, {
          iconId: name,
          tooltip: tooltip,
          key: name,
          disabled: refs.globalCache.undoList.length === 0,
          onClick: function onClick() {
            return handleUndo();
          }
        });
      }

      if (name === "redo") {
        return /*#__PURE__*/React__default['default'].createElement(Button, {
          iconId: name,
          tooltip: tooltip,
          key: name,
          disabled: refs.globalCache.redoList.length === 0,
          onClick: function onClick() {
            return handleRedo();
          }
        });
      }

      if (name === "screenshot") {
        return /*#__PURE__*/React__default['default'].createElement(Button, {
          iconId: name,
          tooltip: tooltip,
          key: name,
          onClick: function onClick() {
            var imgsrc = handleScreenShot(contextRef.current);

            if (imgsrc) {
              showDialog( /*#__PURE__*/React__default['default'].createElement("div", null, /*#__PURE__*/React__default['default'].createElement("div", null, screenshot.screenshotTipSuccess), /*#__PURE__*/React__default['default'].createElement("img", {
                src: imgsrc,
                alt: "",
                style: {
                  maxWidth: "100%",
                  maxHeight: "100%"
                }
              })));
            }
          }
        });
      }

      if (name === "image") {
        return /*#__PURE__*/React__default['default'].createElement(Button, {
          iconId: name,
          tooltip: toolbar.insertImage,
          key: name,
          onClick: function onClick() {
            return showImgChooser();
          }
        }, /*#__PURE__*/React__default['default'].createElement("input", {
          id: "fortune-img-upload",
          type: "file",
          accept: "image/*",
          style: {
            display: "none"
          },
          onChange: function onChange(e) {
            var _e$currentTarget$file;

            var file = (_e$currentTarget$file = e.currentTarget.files) === null || _e$currentTarget$file === void 0 ? void 0 : _e$currentTarget$file[0];
            if (!file) return;
            var render = new FileReader();
            render.readAsDataURL(file);

            render.onload = function (event) {
              var _event$target;

              if (event.target == null) return;
              var src = (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.result;
              var image = new Image();

              image.onload = function () {
                setContext(function (draftCtx) {
                  insertImage(draftCtx, image);
                });
              };

              image.src = src;
            };

            e.currentTarget.value = "";
          }
        }));
      }

      if (name === "comment") {
        var _context$luckysheet_s2, _flowdata$row_index$c;

        var last = (_context$luckysheet_s2 = context.luckysheet_select_save) === null || _context$luckysheet_s2 === void 0 ? void 0 : _context$luckysheet_s2[context.luckysheet_select_save.length - 1];
        var row_index = last === null || last === void 0 ? void 0 : last.row_focus;
        var col_index = last === null || last === void 0 ? void 0 : last.column_focus;

        if (!last) {
          row_index = 0;
          col_index = 0;
        } else {
          if (row_index == null) {
            var _last$row = _slicedToArray(last.row, 1);

            row_index = _last$row[0];
          }

          if (col_index == null) {
            var _last$column = _slicedToArray(last.column, 1);

            col_index = _last$column[0];
          }
        }

        var itemData;

        if ((flowdata === null || flowdata === void 0 ? void 0 : (_flowdata$row_index$c = flowdata[row_index][col_index]) === null || _flowdata$row_index$c === void 0 ? void 0 : _flowdata$row_index$c.ps) != null) {
          itemData = [{
            key: "edit",
            text: "",
            onClick: editComment
          }, {
            key: "delete",
            text: "",
            onClick: deleteComment
          }, {
            key: "showOrHide",
            text: "/",
            onClick: showHideComment
          }, {
            key: "showOrHideAll",
            text: "/",
            onClick: showHideAllComments
          }];
        } else {
          itemData = [{
            key: "new",
            text: "",
            onClick: newComment
          }, {
            key: "showOrHideAll",
            text: "/",
            onClick: showHideAllComments
          }];
        }

        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: name,
          key: name,
          tooltip: tooltip
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, itemData.map(function (_ref5) {
            var key = _ref5.key,
                text = _ref5.text,
                _onClick = _ref5.onClick;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: key,
              onClick: function onClick() {
                setContext(function (draftContext) {
                  return _onClick(draftContext, refs.globalCache, row_index, col_index);
                });
                setOpen(false);
              }
            }, text);
          }));
        });
      }

      if (name === "quick-formula") {
        var _itemData = [{
          text: formula.sum,
          value: "SUM"
        }, {
          text: formula.average,
          value: "AVERAGE"
        }, {
          text: formula.count,
          value: "COUNT"
        }, {
          text: formula.max,
          value: "MAX"
        }, {
          text: formula.min,
          value: "MIN"
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: "formula-sum",
          key: name,
          tooltip: toolbar.autoSum,
          onClick: function onClick() {
            return setContext(function (ctx) {
              handleSum(ctx, refs.cellInput.current, refs.globalCache);
            });
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _itemData.map(function (_ref6) {
            var value = _ref6.value,
                text = _ref6.text;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  autoSelectionFormula(ctx, refs.cellInput.current, value, refs.globalCache);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, /*#__PURE__*/React__default['default'].createElement("div", null, text), /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-subtext"
            }, value)));
          }), /*#__PURE__*/React__default['default'].createElement(MenuDivider, null), /*#__PURE__*/React__default['default'].createElement(Option, {
            key: "formula",
            onClick: function onClick() {
              showDialog( /*#__PURE__*/React__default['default'].createElement(FormulaSearch$1, {
                onCancel: hideDialog
              }));
              setOpen(false);
            }
          }, "".concat(formula.find, "...")));
        });
      }

      if (name === "merge-cell") {
        var itemdata = [{
          text: merge.mergeAll,
          value: "merge-all"
        }, {
          text: merge.mergeV,
          value: "merge-vertical"
        }, {
          text: merge.mergeH,
          value: "merge-horizontal"
        }, {
          text: merge.mergeCancel,
          value: "merge-cancel"
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: "merge-all",
          key: name,
          tooltip: tooltip,
          text: "\u5408\u5E76\u5355\u5143\u683C",
          onClick: function onClick() {
            return setContext(function (ctx) {
              handleMerge(ctx, "merge-all");
            });
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, itemdata.map(function (_ref7) {
            var text = _ref7.text,
                value = _ref7.value;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  handleMerge(ctx, value);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: value,
              style: {
                marginRight: 4
              }
            }), text));
          }));
        });
      }

      if (name === "border") {
        var _items2 = [{
          text: border.borderTop,
          value: "border-top"
        }, {
          text: border.borderBottom,
          value: "border-bottom"
        }, {
          text: border.borderLeft,
          value: "border-left"
        }, {
          text: border.borderRight,
          value: "border-right"
        }, {
          text: "",
          value: "divider"
        }, {
          text: border.borderNone,
          value: "border-none"
        }, {
          text: border.borderAll,
          value: "border-all"
        }, {
          text: border.borderOutside,
          value: "border-outside"
        }, {
          text: "",
          value: "divider"
        }, {
          text: border.borderInside,
          value: "border-inside"
        }, {
          text: border.borderHorizontal,
          value: "border-horizontal"
        }, {
          text: border.borderVertical,
          value: "border-vertical"
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: "border-all",
          key: name,
          tooltip: tooltip,
          text: "\u8FB9\u6846\u8BBE\u7F6E",
          onClick: function onClick() {
            return setContext(function (ctx) {
              handleBorder(ctx, "border-all");
            });
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items2.map(function (_ref8, ii) {
            var text = _ref8.text,
                value = _ref8.value;
            return value !== "divider" ? /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  handleBorder(ctx, value);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: value
            }))) : /*#__PURE__*/React__default['default'].createElement(MenuDivider, {
              key: ii
            });
          }));
        });
      }

      if (name === "freeze") {
        var _items3 = [{
          text: freezen.freezenRowRange,
          value: "freeze-row"
        }, {
          text: freezen.freezenColumnRange,
          value: "freeze-col"
        }, {
          text: freezen.freezenRCRange,
          value: "freeze-row-col"
        }, {
          text: freezen.freezenCancel,
          value: "freeze-cancel"
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: "freeze-row-col",
          key: name,
          tooltip: tooltip,
          onClick: function onClick() {
            return setContext(function (ctx) {
              handleFreeze(ctx, "freeze-row-col");
            });
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items3.map(function (_ref9) {
            var text = _ref9.text,
                value = _ref9.value;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  handleFreeze(ctx, value);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: value
            })));
          }));
        });
      }

      if (name === "sort") {
        var _items4 = [{
          title: "sort-asc",
          text: sort.asc
        }, {
          title: "sort-desc",
          text: sort.desc
        }];
        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: "sort-asc",
          key: name,
          tooltip: toolbar.sort,
          onClick: function onClick() {
            setContext(function (ctx) {
              handleSort(ctx, true);
            });
          }
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items4.map(function (_ref10) {
            var text = _ref10.text,
                title = _ref10.title;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: title,
              onClick: function onClick() {
                setContext(function (ctx) {
                  if (title === "sort-asc") {
                    handleSort(ctx, true);
                  }

                  if (title === "sort-desc") {
                    handleSort(ctx, false);
                  }
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: title
            })));
          }));
        });
      }

      if (name === "text-wrap") {
        var _items5 = [{
          text: textWrap.clip,
          iconId: "text-clip",
          value: "clip"
        }, {
          text: textWrap.overflow,
          iconId: "text-overflow",
          value: "overflow"
        }, {
          text: textWrap.wrap,
          iconId: "text-wrap",
          value: "wrap"
        }];
        var _curr = _items5[0];

        if ((cell === null || cell === void 0 ? void 0 : cell.tb) != null) {
          _curr = lodash.get(_items5, cell.tb);
        }

        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: _curr.iconId,
          key: name,
          tooltip: toolbar.textWrap
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items5.map(function (_ref11) {
            var text = _ref11.text,
                iconId = _ref11.iconId,
                value = _ref11.value;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  var d = getFlowdata(ctx);
                  if (d == null) return;
                  updateFormat(ctx, refs.cellInput.current, d, "tb", value);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: iconId
            })));
          }));
        });
      }

      if (name === "text-rotation") {
        var _items6 = [{
          text: rotation.none,
          iconId: "text-rotation-none",
          value: "none"
        }, {
          text: rotation.angleup,
          iconId: "text-rotation-angleup",
          value: "angleup"
        }, {
          text: rotation.angledown,
          iconId: "text-rotation-angledown",
          value: "angledown"
        }, {
          text: rotation.vertical,
          iconId: "text-rotation-vertical",
          value: "vertical"
        }, {
          text: rotation.rotationUp,
          iconId: "text-rotation-up",
          value: "rotation-up"
        }, {
          text: rotation.rotationDown,
          iconId: "text-rotation-down",
          value: "rotation-down"
        }];
        var _curr2 = _items6[0];

        if ((cell === null || cell === void 0 ? void 0 : cell.tr) != null) {
          _curr2 = lodash.get(_items6, cell.tr);
        }

        return /*#__PURE__*/React__default['default'].createElement(Combo, {
          iconId: _curr2.iconId,
          key: name,
          tooltip: toolbar.textRotate
        }, function (setOpen) {
          return /*#__PURE__*/React__default['default'].createElement(Select, null, _items6.map(function (_ref12) {
            var text = _ref12.text,
                iconId = _ref12.iconId,
                value = _ref12.value;
            return /*#__PURE__*/React__default['default'].createElement(Option, {
              key: value,
              onClick: function onClick() {
                setContext(function (ctx) {
                  var d = getFlowdata(ctx);
                  if (d == null) return;
                  updateFormat(ctx, refs.cellInput.current, d, "tr", value);
                });
                setOpen(false);
              }
            }, /*#__PURE__*/React__default['default'].createElement("div", {
              className: "fortune-toolbar-menu-line"
            }, text, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
              name: iconId
            })));
          }));
        });
      }

      return /*#__PURE__*/React__default['default'].createElement(Button, {
        iconId: name,
        tooltip: tooltip,
        key: name,
        selected: (_toolbarItemSelectedF = toolbarItemSelectedFunc(name)) === null || _toolbarItemSelectedF === void 0 ? void 0 : _toolbarItemSelectedF(cell),
        onClick: function onClick() {
          return setContext(function (draftCtx) {
            var _toolbarItemClickHand;

            (_toolbarItemClickHand = toolbarItemClickHandler(name)) === null || _toolbarItemClickHand === void 0 ? void 0 : _toolbarItemClickHand(draftCtx, refs.cellInput.current, refs.globalCache);
          });
        }
      });
    }, [toolbar, cell, setContext, refs.cellInput, refs.globalCache, defaultFmt, align, handleUndo, handleRedo, flowdata, formula, showDialog, hideDialog, merge, border, freezen, screenshot, sort, textWrap, rotation, context.luckysheet_select_save]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "fortune-toolbar"
    }, (toolbarWrapIndex === -1 ? settings.toolbarItems : settings.toolbarItems.slice(0, toolbarWrapIndex + 1)).map(function (name, i) {
      return getToolbarItem(name, i);
    }), toolbarWrapIndex !== -1 && toolbarWrapIndex < settings.toolbarItems.length - 1 ? /*#__PURE__*/React__default['default'].createElement(Button, {
      iconId: "more",
      tooltip: toolbar.toolMore,
      onClick: function onClick() {
        if (moreItemsOpen) {
          setMoreItems(null);
        } else {
          setMoreItems(settings.toolbarItems.slice(toolbarWrapIndex + 1).map(function (name, i) {
            return getToolbarItem(name, i);
          }));
        }
      }
    }) : null);
  };

  var LocationBox = function LocationBox() {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context;

    var rangeText = React.useMemo(function () {
      var lastSelection = lodash.last(context.luckysheet_select_save);

      if (!(lastSelection && lastSelection.row_focus != null && lastSelection.column_focus != null)) return "";
      var rf = lastSelection.row_focus;
      var cf = lastSelection.column_focus;

      if (context.config.merge != null && "".concat(rf, "_").concat(cf) in context.config.merge) {
        return getRangetxt(context, context.currentSheetId, {
          column: [cf, cf],
          row: [rf, rf]
        });
      }

      return getRangetxt(context, context.currentSheetId, lastSelection);
    }, [context.currentSheetId, context.luckysheet_select_save]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-name-box-container"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-name-box",
      tabIndex: 0,
      dir: "ltr",
      "aria-autocomplete": "list"
    }, rangeText));
  };

  var FxEditor = function FxEditor() {
    var _context$luckysheet_s, _context$luckysheet_s4;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        refs = _useContext.refs;

    var _useState = React.useState(false),
        _useState2 = _slicedToArray(_useState, 2),
        focused = _useState2[0],
        setFocused = _useState2[1];

    var lastKeyDownEventRef = React.useRef();
    var inputContainerRef = React.useRef(null);
    var firstSelection = (_context$luckysheet_s = context.luckysheet_select_save) === null || _context$luckysheet_s === void 0 ? void 0 : _context$luckysheet_s[0];
    var prevFirstSelection = usePrevious(firstSelection);
    var prevSheetId = usePrevious(context.currentSheetId);
    React.useEffect(function () {
      if (lodash.isEqual(prevFirstSelection, firstSelection) && context.currentSheetId === prevSheetId) {
        return;
      }

      var d = getFlowdata(context);
      var value = "";

      if (firstSelection) {
        var _d$r;

        var r = firstSelection.row_focus;
        var c = firstSelection.column_focus;
        if (lodash.isNil(r) || lodash.isNil(c)) return;
        var cell = d === null || d === void 0 ? void 0 : (_d$r = d[r]) === null || _d$r === void 0 ? void 0 : _d$r[c];

        if (cell) {
          if (isInlineStringCell(cell)) {
            value = getInlineStringNoStyle(r, c, d);
          } else if (cell.f) {
            value = getCellValue(r, c, d, "f");
          } else {
            value = valueShowEs(r, c, d);
          }
        }

        refs.fxInput.current.innerHTML = escapeScriptTag(value);
      } else {
        refs.fxInput.current.innerHTML = "";
      }
    }, [context.luckysheetfile, context.currentSheetId, context.luckysheet_select_save]);
    var onFocus = React.useCallback(function () {
      var _context$luckysheet_s2, _context$luckysheet_s3;

      if (!context.allowEdit) {
        return;
      }

      if (((_context$luckysheet_s2 = (_context$luckysheet_s3 = context.luckysheet_select_save) === null || _context$luckysheet_s3 === void 0 ? void 0 : _context$luckysheet_s3.length) !== null && _context$luckysheet_s2 !== void 0 ? _context$luckysheet_s2 : 0) > 0) {
        setFocused(true);
        setContext(function (draftCtx) {
          var last = draftCtx.luckysheet_select_save[draftCtx.luckysheet_select_save.length - 1];
          var row_index = last.row_focus;
          var col_index = last.column_focus;
          draftCtx.luckysheetCellUpdate = [row_index, col_index];
          refs.globalCache.doNotFocus = true;
        });
      }
    }, [context.allowEdit, (_context$luckysheet_s4 = context.luckysheet_select_save) === null || _context$luckysheet_s4 === void 0 ? void 0 : _context$luckysheet_s4.length, refs.globalCache, setContext]);
    var onKeyDown = React.useCallback(function (e) {
      if (!context.allowEdit) {
        return;
      }

      lastKeyDownEventRef.current = new KeyboardEvent(e.type, e.nativeEvent);
      var key = e.key;
      setContext(function (draftCtx) {
        if (context.luckysheetCellUpdate.length > 0) {
          switch (key) {
            case "Enter":
              {
                var lastCellUpdate = lodash.clone(draftCtx.luckysheetCellUpdate);

                updateCell(draftCtx, draftCtx.luckysheetCellUpdate[0], draftCtx.luckysheetCellUpdate[1], refs.fxInput.current);
                draftCtx.luckysheet_select_save = [{
                  row: [lastCellUpdate[0], lastCellUpdate[0]],
                  column: [lastCellUpdate[1], lastCellUpdate[1]],
                  row_focus: lastCellUpdate[0],
                  column_focus: lastCellUpdate[1]
                }];
                moveHighlightCell(draftCtx, "down", 1, "rangeOfSelect");
                e.preventDefault();
                e.stopPropagation();
                break;
              }

            case "Escape":
              {
                cancelNormalSelected(draftCtx);
                moveHighlightCell(draftCtx, "down", 0, "rangeOfSelect");
                e.preventDefault();
                e.stopPropagation();
                break;
              }

            case "ArrowLeft":
              {
                rangeHightlightselected(draftCtx, refs.fxInput.current);
                break;
              }

            case "ArrowRight":
              {
                rangeHightlightselected(draftCtx, refs.fxInput.current);
                break;
              }
          }
        }
      });
    }, [context.allowEdit, context.luckysheetCellUpdate.length, refs.fxInput, setContext]);
    var onChange = React.useCallback(function () {
      var e = lastKeyDownEventRef.current;
      if (!e) return;
      var kcode = e.keyCode;
      if (!kcode) return;

      if (!(kcode >= 112 && kcode <= 123 || kcode <= 46 || kcode === 144 || kcode === 108 || e.ctrlKey || e.altKey || e.shiftKey && (kcode === 37 || kcode === 38 || kcode === 39 || kcode === 40)) || kcode === 8 || kcode === 32 || kcode === 46 || e.ctrlKey && kcode === 86) {
        setContext(function (draftCtx) {
          handleFormulaInput(draftCtx, refs.cellInput.current, refs.fxInput.current, kcode);
        });
      }
    }, [refs.cellInput, refs.fxInput, setContext]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-fx-editor"
    }, /*#__PURE__*/React__default['default'].createElement(LocationBox, null), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-fx-icon"
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "fx",
      width: 18,
      height: 18
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      ref: inputContainerRef,
      className: "fortune-fx-input-container"
    }, /*#__PURE__*/React__default['default'].createElement(ContentEditable, {
      innerRef: function innerRef(e) {
        refs.fxInput.current = e;
      },
      className: "fortune-fx-input",
      id: "luckysheet-functionbox-cell",
      "aria-autocomplete": "list",
      onFocus: onFocus,
      onKeyDown: onKeyDown,
      onChange: onChange,
      onBlur: function onBlur() {
        return setFocused(false);
      },
      tabIndex: 0
    }), focused && /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, /*#__PURE__*/React__default['default'].createElement(FormulaSearch, {
      style: {
        top: inputContainerRef.current.clientHeight
      }
    }), /*#__PURE__*/React__default['default'].createElement(FormulaHint, {
      style: {
        top: inputContainerRef.current.clientHeight
      }
    }))));
  };

  var MessageBox = function MessageBox(_ref) {
    var _ref$type = _ref.type,
        type = _ref$type === void 0 ? "yesno" : _ref$type,
        onOk = _ref.onOk,
        onCancel = _ref.onCancel,
        children = _ref.children;
    return /*#__PURE__*/React__default['default'].createElement(Dialog, {
      type: type,
      onOk: onOk,
      onCancel: onCancel,
      contentStyle: {
        width: 300,
        paddingTop: 20,
        paddingBottom: 30,
        display: "flex",
        justifyContent: "center",
        alignItems: "center"
      }
    }, children);
  };

  function useAlert() {
    var _useContext = React.useContext(ModalContext),
        showModal = _useContext.showModal,
        hideModal = _useContext.hideModal;

    var showAlert = React.useCallback(function (message) {
      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "ok";
      var onOk = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : hideModal;
      var onCancel = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : hideModal;
      showModal( /*#__PURE__*/React__default['default'].createElement(MessageBox, {
        type: type,
        onOk: onOk,
        onCancel: onCancel
      }, message));
    }, [hideModal, showModal]);
    return {
      showAlert: showAlert,
      hideAlert: hideModal
    };
  }

  var SheetItem = function SheetItem(_ref) {
    var sheet = _ref.sheet,
        isDropPlaceholder = _ref.isDropPlaceholder;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        refs = _useContext.refs;

    var _useState = React.useState(false),
        _useState2 = _slicedToArray(_useState, 2),
        editing = _useState2[0],
        setEditing = _useState2[1];

    var containerRef = React.useRef(null);
    var editable = React.useRef(null);

    var _useState3 = React.useState(false),
        _useState4 = _slicedToArray(_useState3, 2),
        dragOver = _useState4[0],
        setDragOver = _useState4[1];

    var _useAlert = useAlert(),
        showAlert = _useAlert.showAlert;

    React.useEffect(function () {
      if (!editable.current) return;

      if (editing) {
        if (window.getSelection) {
          var range = document.createRange();
          range.selectNodeContents(editable.current);

          if (range.startContainer && document.body.contains(range.startContainer)) {
            var selection = window.getSelection();
            selection === null || selection === void 0 ? void 0 : selection.removeAllRanges();
            selection === null || selection === void 0 ? void 0 : selection.addRange(range);
          }
        } else if (document.selection) {
          var _range = document.body.createTextRange();

          _range.moveToElementText(editable.current);

          _range.select();
        }
      }

      editable.current.dataset.oldText = editable.current.innerText;
    }, [editing]);
    var onBlur = React.useCallback(function () {
      setContext(function (draftCtx) {
        try {
          editSheetName(draftCtx, editable.current);
        } catch (e) {
          showAlert(e.message);
        }
      });
      setEditing(false);
    }, [setContext, showAlert]);
    var onKeyDown = React.useCallback(function (e) {
      if (e.key === "Enter") {
        var _editable$current;

        (_editable$current = editable.current) === null || _editable$current === void 0 ? void 0 : _editable$current.blur();
      }

      e.stopPropagation();
    }, []);
    var onDragStart = React.useCallback(function (e) {
      e.dataTransfer.setData("sheetId", "".concat(sheet.id));
      e.stopPropagation();
    }, [sheet.id]);
    var onDrop = React.useCallback(function (e) {
      var draggingId = e.dataTransfer.getData("sheetId");
      setContext(function (draftCtx) {
        var droppingId = sheet.id;
        var draggingSheet;
        var droppingSheet;

        lodash.sortBy(draftCtx.luckysheetfile, ["order"]).forEach(function (f, i) {
          f.order = i;

          if (f.id === draggingId) {
            draggingSheet = f;
          } else if (f.id === droppingId) {
            droppingSheet = f;
          }
        });

        if (draggingSheet && droppingSheet) {
          draggingSheet.order = droppingSheet.order - 0.1;

          lodash.sortBy(draftCtx.luckysheetfile, ["order"]).forEach(function (f, i) {
            f.order = i;
          });
        } else if (draggingSheet && isDropPlaceholder) {
          draggingSheet.order = draftCtx.luckysheetfile.length;
        }
      });
      setDragOver(false);
      e.stopPropagation();
    }, [isDropPlaceholder, setContext, sheet.id]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      onDragOver: function onDragOver(e) {
        e.preventDefault();
        e.stopPropagation();
      },
      onDragEnter: function onDragEnter(e) {
        setDragOver(true);
        e.stopPropagation();
      },
      onDragLeave: function onDragLeave(e) {
        setDragOver(false);
        e.stopPropagation();
      },
      onDragEnd: function onDragEnd(e) {
        setDragOver(false);
        e.stopPropagation();
      },
      onDrop: onDrop,
      onDragStart: onDragStart,
      draggable: true,
      key: sheet.id,
      ref: containerRef,
      className: isDropPlaceholder ? "fortune-sheettab-placeholder" : "luckysheet-sheets-item".concat(context.currentSheetId === sheet.id ? " luckysheet-sheets-item-active" : ""),
      onClick: function onClick() {
        if (isDropPlaceholder) return;
        setContext(function (draftCtx) {
          draftCtx.currentSheetId = sheet.id;
        });
      },
      onContextMenu: function onContextMenu(e) {
        if (isDropPlaceholder) return;
        var rect = refs.workbookContainer.current.getBoundingClientRect();
        var pageX = e.pageX,
            pageY = e.pageY;
        setContext(function (ctx) {
          ctx.sheetTabContextMenu = {
            x: pageX - rect.left,
            y: pageY - rect.top,
            sheet: sheet,
            onRename: function onRename() {
              return setEditing(true);
            }
          };
        });
      },
      style: dragOver ? {
        borderLeft: "2px solid #0188fb"
      } : {}
    }, /*#__PURE__*/React__default['default'].createElement("span", {
      className: "luckysheet-sheets-item-name",
      spellCheck: "false",
      contentEditable: isDropPlaceholder ? false : editing,
      onDoubleClick: function onDoubleClick() {
        return setEditing(true);
      },
      onBlur: onBlur,
      onKeyDown: onKeyDown,
      ref: editable,
      style: dragOver ? {
        pointerEvents: "none"
      } : {}
    }, sheet.name));
  };

  var SheetTab = function SheetTab() {
    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings,
        refs = _useContext.refs;

    var tabContainerRef = React.useRef(null);
    var leftScrollRef = React.useRef(null);
    var rightScrollRef = React.useRef(null);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-sheet-area luckysheet-noselected-text",
      onContextMenu: function onContextMenu(e) {
        return e.preventDefault();
      },
      id: "luckysheet-sheet-area"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-sheet-content"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-sheettab-button",
      onClick: function onClick() {
        setContext(function (draftCtx) {
          if (draftCtx.luckysheetCellUpdate.length > 0) {
            updateCell(draftCtx, draftCtx.luckysheetCellUpdate[0], draftCtx.luckysheetCellUpdate[1], refs.cellInput.current);
          }

          addSheet(draftCtx, settings);
        }, {
          addSheetOp: true
        });
      }
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "plus",
      width: 16,
      height: 16
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "luckysheet-sheets-m",
      className: "luckysheet-sheets-m lucky-button-custom"
    }, /*#__PURE__*/React__default['default'].createElement("i", {
      className: "iconfont luckysheet-iconfont-caidan2"
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-sheettab-container",
      id: "fortune-sheettab-container"
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-sheettab-container-c",
      id: "fortune-sheettab-container-c",
      ref: tabContainerRef
    }, lodash.sortBy(context.luckysheetfile, function (s) {
      return Number(s.order);
    }).map(function (sheet) {
      return /*#__PURE__*/React__default['default'].createElement(SheetItem, {
        key: sheet.id,
        sheet: sheet
      });
    }), /*#__PURE__*/React__default['default'].createElement(SheetItem, {
      isDropPlaceholder: true,
      sheet: {
        name: "",
        id: "drop-placeholder"
      }
    }))), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "fortune-sheettab-leftscroll",
      className: "fortune-sheettab-scroll",
      ref: leftScrollRef,
      onClick: function onClick() {
        tabContainerRef.current.scrollLeft -= 150;
      }
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "arrow-doubleleft",
      width: 12,
      height: 12
    })), /*#__PURE__*/React__default['default'].createElement("div", {
      id: "fortune-sheettab-rightscroll",
      className: "fortune-sheettab-scroll",
      ref: rightScrollRef,
      onClick: function onClick() {
        tabContainerRef.current.scrollLeft += 150;
      }
    }, /*#__PURE__*/React__default['default'].createElement(SVGIcon, {
      name: "arrow-doubleright",
      width: 12,
      height: 12
    }))));
  };

  var Divider$1 = function Divider() {
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-context-menu-divider"
    });
  };

  var Menu = function Menu(_ref) {
    var _onClick = _ref.onClick,
        children = _ref.children;
    var containerRef = React.useRef(null);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "luckysheet-cols-menuitem luckysheet-mousedown-cancel",
      onClick: function onClick(e) {
        return _onClick === null || _onClick === void 0 ? void 0 : _onClick(e, containerRef.current);
      }
    }, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"
    }, children));
  };

  var ContextMenu = function ContextMenu() {
    var containerRef = React.useRef(null);

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings;

    var contextMenu = context.contextMenu;

    var _locale = locale(context),
        rightclick = _locale.rightclick;

    var getMenuElement = React.useCallback(function (name, i) {
      var _context$luckysheet_s;

      var selection = (_context$luckysheet_s = context.luckysheet_select_save) === null || _context$luckysheet_s === void 0 ? void 0 : _context$luckysheet_s[0];

      if (name === "|") {
        return /*#__PURE__*/React__default['default'].createElement(Divider$1, {
          key: "divider-".concat(i)
        });
      }

      if (name === "copy") {
        return /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: name,
          onClick: function onClick() {
            setContext(function (draftCtx) {
              handleCopy(draftCtx);
              draftCtx.contextMenu = undefined;
            });
          }
        }, rightclick.copy);
      }

      if (name === "paste") {
        return /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: name,
          onClick: function onClick() {
            setContext(function (draftCtx) {
              handlePasteByClick(draftCtx);
              draftCtx.contextMenu = undefined;
            });
          }
        }, rightclick.paste);
      }

      if (name === "insert-column") {
        return (selection === null || selection === void 0 ? void 0 : selection.row_select) ? null : ["left", "right"].map(function (dir) {
          var _context$lang, _context$lang2;

          return /*#__PURE__*/React__default['default'].createElement(Menu, {
            key: "add-col-".concat(dir),
            onClick: function onClick(e) {
              var _context$luckysheet_s2, _context$luckysheet_s3, _context$luckysheet_s4, _e$target$querySelect;

              var position = (_context$luckysheet_s2 = context.luckysheet_select_save) === null || _context$luckysheet_s2 === void 0 ? void 0 : (_context$luckysheet_s3 = _context$luckysheet_s2[0]) === null || _context$luckysheet_s3 === void 0 ? void 0 : (_context$luckysheet_s4 = _context$luckysheet_s3.column) === null || _context$luckysheet_s4 === void 0 ? void 0 : _context$luckysheet_s4[0];
              if (position == null) return;
              var countStr = (_e$target$querySelect = e.target.querySelector("input")) === null || _e$target$querySelect === void 0 ? void 0 : _e$target$querySelect.value;
              if (countStr == null) return;
              var count = parseInt(countStr, 10);
              if (count < 1) return;
              var direction = dir === "left" ? "lefttop" : "rightbottom";
              var insertRowColOp = {
                type: "column",
                index: position,
                count: count,
                direction: direction,
                id: context.currentSheetId
              };
              setContext(function (draftCtx) {
                insertRowCol(draftCtx, insertRowColOp);
                draftCtx.contextMenu = undefined;
              }, {
                insertRowColOp: insertRowColOp
              });
            }
          }, /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, ((_context$lang = context.lang) === null || _context$lang === void 0 ? void 0 : _context$lang.startsWith("zh")) && /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, rightclick.to, /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-".concat(dir)
          }, rightclick[dir])), "".concat(rightclick.insert, "  "), /*#__PURE__*/React__default['default'].createElement("input", {
            onClick: function onClick(e) {
              return e.stopPropagation();
            },
            onKeyDown: function onKeyDown(e) {
              return e.stopPropagation();
            },
            type: "text",
            className: "luckysheet-mousedown-cancel",
            placeholder: rightclick.number,
            defaultValue: "1"
          }), /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"
          }, "".concat(rightclick.column, "  ")), !((_context$lang2 = context.lang) === null || _context$lang2 === void 0 ? void 0 : _context$lang2.startsWith("zh")) && /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-".concat(dir)
          }, rightclick[dir])));
        });
      }

      if (name === "insert-row") {
        return (selection === null || selection === void 0 ? void 0 : selection.column_select) ? null : ["top", "bottom"].map(function (dir) {
          var _context$lang3, _context$lang4;

          return /*#__PURE__*/React__default['default'].createElement(Menu, {
            key: "add-row-".concat(dir),
            onClick: function onClick(e, container) {
              var _context$luckysheet_s5, _context$luckysheet_s6, _context$luckysheet_s7, _container$querySelec;

              var position = (_context$luckysheet_s5 = context.luckysheet_select_save) === null || _context$luckysheet_s5 === void 0 ? void 0 : (_context$luckysheet_s6 = _context$luckysheet_s5[0]) === null || _context$luckysheet_s6 === void 0 ? void 0 : (_context$luckysheet_s7 = _context$luckysheet_s6.row) === null || _context$luckysheet_s7 === void 0 ? void 0 : _context$luckysheet_s7[0];
              if (position == null) return;
              var countStr = (_container$querySelec = container.querySelector("input")) === null || _container$querySelec === void 0 ? void 0 : _container$querySelec.value;
              if (countStr == null) return;
              var count = parseInt(countStr, 10);
              if (count < 1) return;
              var direction = dir === "top" ? "lefttop" : "rightbottom";
              var insertRowColOp = {
                type: "row",
                index: position,
                count: count,
                direction: direction,
                id: context.currentSheetId
              };
              setContext(function (draftCtx) {
                insertRowCol(draftCtx, insertRowColOp);
                draftCtx.contextMenu = undefined;
              }, {
                insertRowColOp: insertRowColOp
              });
            }
          }, /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, ((_context$lang3 = context.lang) === null || _context$lang3 === void 0 ? void 0 : _context$lang3.startsWith("zh")) && /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, rightclick.to, /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-".concat(dir)
          }, rightclick[dir])), "".concat(rightclick.insert, "  "), /*#__PURE__*/React__default['default'].createElement("input", {
            onClick: function onClick(e) {
              return e.stopPropagation();
            },
            onKeyDown: function onKeyDown(e) {
              return e.stopPropagation();
            },
            type: "text",
            className: "luckysheet-mousedown-cancel",
            placeholder: rightclick.number,
            defaultValue: "1"
          }), /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"
          }, "".concat(rightclick.row, "  ")), !((_context$lang4 = context.lang) === null || _context$lang4 === void 0 ? void 0 : _context$lang4.startsWith("zh")) && /*#__PURE__*/React__default['default'].createElement("span", {
            className: "luckysheet-cols-rows-shift-".concat(dir)
          }, rightclick[dir])));
        });
      }

      if (name === "delete-column") {
        return (selection === null || selection === void 0 ? void 0 : selection.row_select) ? null : /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: "delete-col",
          onClick: function onClick() {
            if (!selection) return;

            var _selection$column = _slicedToArray(selection.column, 2),
                st_index = _selection$column[0],
                ed_index = _selection$column[1];

            var deleteRowColOp = {
              type: "column",
              start: st_index,
              end: ed_index,
              id: context.currentSheetId
            };
            setContext(function (draftCtx) {
              deleteRowCol(draftCtx, deleteRowColOp);
              draftCtx.contextMenu = undefined;
            }, {
              deleteRowColOp: deleteRowColOp
            });
          }
        }, rightclick.deleteSelected, rightclick.column);
      }

      if (name === "delete-row") {
        return (selection === null || selection === void 0 ? void 0 : selection.column_select) ? null : /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: "delete-row",
          onClick: function onClick() {
            if (!selection) return;

            var _selection$row = _slicedToArray(selection.row, 2),
                st_index = _selection$row[0],
                ed_index = _selection$row[1];

            var deleteRowColOp = {
              type: "row",
              start: st_index,
              end: ed_index,
              id: context.currentSheetId
            };
            setContext(function (draftCtx) {
              deleteRowCol(draftCtx, deleteRowColOp);
              draftCtx.contextMenu = undefined;
            }, {
              deleteRowColOp: deleteRowColOp
            });
          }
        }, rightclick.deleteSelected, rightclick.row);
      }

      return null;
    }, [context.currentSheetId, context.lang, context.luckysheet_select_save, rightclick, setContext]);
    React.useLayoutEffect(function () {
      if (!containerRef.current || !contextMenu) {
        return;
      }

      var winH = window.innerHeight;
      var winW = window.innerWidth;
      var rect = containerRef.current.getBoundingClientRect();
      var menuW = rect.width;
      var menuH = rect.height;
      var top = contextMenu.pageY;
      var left = contextMenu.pageX;
      var hasOverflow = false;

      if (left + menuW > winW) {
        left -= menuW;
        hasOverflow = true;
      }

      if (top + menuH > winH) {
        top -= menuH;
        hasOverflow = true;
      }

      if (top < 0) {
        top = 0;
        hasOverflow = true;
      }

      if (hasOverflow) {
        setContext(function (draftCtx) {
          draftCtx.contextMenu.x = left;
          draftCtx.contextMenu.y = top;
        });
      }
    }, [contextMenu, setContext]);
    if (lodash.isEmpty(context.contextMenu)) return null;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-context-menu luckysheet-cols-menu",
      ref: containerRef,
      onContextMenu: function onContextMenu(e) {
        return e.stopPropagation();
      },
      style: {
        left: contextMenu.x,
        top: contextMenu.y
      }
    }, settings.cellContextMenu.map(function (menu, i) {
      return getMenuElement(menu, i);
    }));
  };

  var SVGDefines = function SVGDefines() {
    return /*#__PURE__*/React__default['default'].createElement("svg", {
      style: {
        position: "absolute",
        width: 0,
        height: 0
      },
      xmlns: "http://www.w3.org/2000/svg",
      xmlnsXlink: "http://www.w3.org/1999/xlink"
    }, /*#__PURE__*/React__default['default'].createElement("defs", null, /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "add"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "4.75",
      y: "4.75",
      width: "14.5",
      height: "14.5",
      rx: "0.75",
      stroke: "#424A59",
      strokeOpacity: "0.9",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "11.25",
      y: "8.5",
      width: "1.5",
      height: "7",
      fill: "#535B68"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "15.5",
      y: "11.25",
      width: "1.5",
      height: "7",
      transform: "rotate(90 15.5 11.25)",
      fill: "#535B68"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-bottom"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9.25 12.5L12.0002 15.5L14.75 12.5H9.25Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.5",
      y: "16.5",
      width: "13",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "11.25",
      y: "5.5",
      width: "1.5",
      height: "7.5",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-center"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 6.75H19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M8 12H16",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 17.25L19 17.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-justify"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M19.5 6.5H4.5",
      stroke: "#525C6F",
      strokeWidth: "1.5",
      strokeLinejoin: "round"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M19.5 12L4.5 12",
      stroke: "#525C6F",
      strokeWidth: "1.5",
      strokeLinejoin: "round"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M19.5 17.5H4.5",
      stroke: "#525C6F",
      strokeWidth: "1.5",
      strokeLinejoin: "round"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-left"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 6.75H19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 12H13",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 17.25L19 17.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-middle"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9.25 16.5L12.0002 13.5L14.75 16.5H9.25Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9.25 7L12.0002 10L14.75 7L9.25 7Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.5",
      y: "11",
      width: "13",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "11.25",
      y: "16",
      width: "1.5",
      height: "3.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "11.25",
      y: "4",
      width: "1.5",
      height: "3.5",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-right"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 6.75H19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11 12H19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5 17.25L19 17.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "align-top"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9.25 11L12.0002 8L14.75 11H9.25Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.5",
      y: "5.5",
      width: "13",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "11.25",
      y: "10.5",
      width: "1.5",
      height: "7.5",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "bold"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M6.30566 5.07617V18.9992H12.4872C13.9107 18.9992 15.0417 18.7067 15.8607 18.1607C16.8162 17.4977 17.3037 16.4837 17.3037 15.1187C17.3037 14.1827 17.0307 13.4417 16.5237 12.8567C16.0167 12.2717 15.3147 11.8817 14.3982 11.7257C15.1002 11.4917 15.6657 11.1212 16.0947 10.6142C16.5042 10.0487 16.7187 9.36617 16.7187 8.58617C16.7187 7.49417 16.3482 6.63617 15.6072 6.01217C14.8467 5.38817 13.8132 5.07617 12.5262 5.07617H6.30566ZM7.90466 6.42167H12.1557C13.1307 6.42167 13.8717 6.59717 14.3787 6.98717C14.8857 7.37717 15.1392 7.96217 15.1392 8.74217C15.1392 9.54167 14.8662 10.1462 14.3592 10.5557C13.8522 10.9457 13.1112 11.1602 12.1362 11.1602H7.90466V6.42167ZM7.90466 12.4862H12.3507C13.4232 12.4862 14.2422 12.6812 14.8077 13.1102C15.3927 13.5392 15.7047 14.2022 15.7047 15.0992C15.7047 15.9962 15.3537 16.6787 14.6712 17.1077C14.0862 17.4587 13.3257 17.6537 12.3507 17.6537H7.90466V12.4862Z",
      fill: "#394259"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-all"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-bottom"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "18.25",
      x2: "19",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-color"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M16 10.9106L18.9511 13.8617L14.5431 18.2697H11.592V15.3186L16 10.9106Z",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M6.5 6.5H17.5V9.84613H19V6.5V5H17.5H6.5H5V6.5V17.5V19H6.5H9.84616V17.5H6.5V6.5Z",
      fill: "#535A68"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-horizontal"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "18.25",
      x2: "19",
      y2: "18.25",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border_diagonal_down"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "17.9697",
      y1: "18.0303",
      x2: "5.96967",
      y2: "6.03033",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border_diagonal_up"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      y1: "-0.75",
      x2: "16.9706",
      y2: "-0.75",
      transform: "matrix(0.707107 -0.707107 -0.707107 -0.707107 5.5 17.5)",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-inside"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-left"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5.75",
      y1: "19",
      x2: "5.75",
      y2: "5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-none"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-outside"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-right"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "18.25",
      y1: "19",
      x2: "18.25",
      y2: "5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-vertical"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "18.25",
      y1: "19",
      x2: "18.25",
      y2: "5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-style"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "5.75",
      x2: "19",
      y2: "5.75",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "12.25",
      x2: "7.5",
      y2: "12.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "8.8252",
      y1: "12.25",
      x2: "11.3252",
      y2: "12.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12.6504",
      y1: "12.25",
      x2: "15.1504",
      y2: "12.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "16.4746",
      y1: "12.25",
      x2: "18.9746",
      y2: "12.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "18.25",
      x2: "6.5",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "7.08008",
      y1: "18.25",
      x2: "8.58008",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "9.16016",
      y1: "18.25",
      x2: "10.6602",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "11.2402",
      y1: "18.25",
      x2: "12.7402",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "13.3203",
      y1: "18.25",
      x2: "14.8203",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "15.4004",
      y1: "18.25",
      x2: "16.9004",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "17.4805",
      y1: "18.25",
      x2: "18.9805",
      y2: "18.25",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "border-top"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#CCCED2",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "5",
      y1: "5.75",
      x2: "19",
      y2: "5.75",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 18 18",
      fill: "none",
      id: "close"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M13.9255 5L5.00091 13.9246",
      stroke: "#262A33",
      strokeOpacity: "0.9",
      strokeWidth: "1.5",
      strokeLinecap: "round"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M13.9255 13.9238L5.00091 4.9992",
      stroke: "#262A33",
      strokeOpacity: "0.9",
      strokeWidth: "1.5",
      strokeLinecap: "round"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 10 24",
      fill: "none",
      id: "combo-arrow"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M8 10H2L5 14L8 10Z",
      fill: "#A6A6A6"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      fill: "none",
      viewBox: "0 0 24 24",
      id: "comment"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M9.968 15.7L12 17.956l2.032-2.258H18.5v-10h-13v10h4.468zm1.289 3.673L9.3 17.2H5.5A1.5 1.5 0 014 15.7v-10a1.5 1.5 0 011.5-1.5h13A1.5 1.5 0 0120 5.7v10a1.5 1.5 0 01-1.5 1.5h-3.8l-1.957 2.174a1 1 0 01-1.486 0z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M7 8.2h10v1.5H7V8.2zM7 11.699h6v1.5H7z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "strike-through"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "6",
      y: "11.5",
      width: "13",
      height: "1.5",
      fill: "#394259"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9.00344 11.5C9.69342 11.9717 10.6431 12.3814 11.8525 12.729C13.071 13.0815 13.9121 13.4403 14.376 13.8052C14.8398 14.1639 15.0718 14.6742 15.0718 15.3359C15.0718 15.9977 14.8213 16.5203 14.3203 16.9038C13.8193 17.2873 13.0988 17.479 12.1587 17.479C11.1506 17.479 10.3434 17.244 9.7373 16.7739C9.13737 16.2977 8.8374 15.6514 8.8374 14.835H7.04688C7.04688 15.6204 7.26335 16.3224 7.69629 16.9409C8.13542 17.5594 8.757 18.048 9.56104 18.4067C10.3651 18.7593 11.231 18.9355 12.1587 18.9355C13.5874 18.9355 14.7285 18.6077 15.582 17.9521C16.4355 17.2904 16.8623 16.4121 16.8623 15.3174C16.8623 14.6309 16.7077 14.034 16.3984 13.5269C16.0954 13.0197 15.6253 12.5775 14.9883 12.2002C14.581 11.9526 14.0705 11.7192 13.457 11.5H9.00344Z",
      fill: "#394259"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M7.71685 10C7.5547 9.61466 7.47363 9.19458 7.47363 8.73975C7.47363 7.67594 7.8973 6.79769 8.74463 6.10498C9.59814 5.40609 10.7052 5.05664 12.0659 5.05664C12.9937 5.05664 13.8193 5.236 14.543 5.59473C15.2728 5.95345 15.8356 6.44824 16.2314 7.0791C16.6335 7.70996 16.8345 8.39958 16.8345 9.14795H15.0439C15.0439 8.33154 14.7842 7.69141 14.2646 7.22754C13.7451 6.75749 13.0122 6.52246 12.0659 6.52246C11.1877 6.52246 10.5011 6.71729 10.0063 7.10693C9.51774 7.4904 9.27344 8.02539 9.27344 8.71191C9.27344 9.2095 9.46296 9.63887 9.84201 10H7.71685Z",
      fill: "#394259"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "clear-format"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "8",
      y1: "18.25",
      x2: "20",
      y2: "18.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M14 7.12132L17.8787 11L10 18.8787L6.12132 15L14 7.12132ZM14 5L15.0607 6.06066L18.9393 9.93934L20 11L18.9393 12.0607L12 19L8 19L5.06066 16.0607L4 15L5.06066 13.9393L12.9393 6.06066L14 5Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "13.9375",
      y: "6.12316",
      width: "6.98528",
      height: "5.7265",
      transform: "rotate(45 13.9375 6.12316)",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "image"
    }, /*#__PURE__*/React__default['default'].createElement("circle", {
      cx: "8.75",
      cy: "8.75",
      r: "1.25",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "4.75",
      y: "5.25",
      width: "14.5",
      height: "13.5",
      rx: "0.75",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M7 19L12.984 11.8949C13.1659 11.6789 13.4905 11.6563 13.7006 11.845L19.5 17.0556",
      stroke: "#525C6F",
      strokeWidth: "1.5",
      strokeLinejoin: "round"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "italic"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11 5H16V6.5H11V5Z",
      fill: "#394259"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9 17.5H14V19H9V17.5Z",
      fill: "#394259"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M10.7598 17.877L12.7598 5.87695L14.2394 6.12355L12.2394 18.1236L10.7598 17.877Z",
      fill: "#394259"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "merge-cancel"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M13 14.9998L16.5 11.9996L13 8.99982V14.9998Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11 14.9998L7.5 11.9996L11 8.99982L11 14.9998Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "10",
      y: "11.2498",
      width: "4.5",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "merge-horizontal"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11 15L14.5 11.9998L11 9V15Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5",
      y: "11.25",
      width: "8.5",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M6.5 6.5H7.5H9.5H11V5H9.5H6.5H5V6.5V17.5V19H6.5H9.5H11V17.5H9.5H7.5H6.5V6.5ZM13 16V15.5H14.5V16V17.5H17.5V6.5H14.5V8V8.5H13V8V6.5V5H14.5H17.5H19V6.5V17.5V19H17.5H14.5H13V17.5V16Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "merge-vertical"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M9 10.9998L12.0002 14.4998L15 10.9998L9 10.9998Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "12.75",
      y: "4.99982",
      width: "8.5",
      height: "1.5",
      transform: "rotate(90 12.75 4.99982)",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M17.5 6.49982L17.5 7L17.5 10.9998H19V9.49982V6.49982V4.99982H17.5L6.5 4.99982H5V6.49982L5 9.49982V10.9998H6.5V9.49982L6.5 7L6.5 6.49982L17.5 6.49982ZM8 12.9998L8.5 12.9998V14.4998H8H6.5V17.4998H17.5V14.4998H16H15.5V12.9998H16H17.5H19L19 14.4998V17.4998V18.9998H17.5H6.5L5 18.9998L5 17.4998V14.4998V12.9998H6.5H8Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "merge-all"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M15.5 14.9998L12 11.9996L15.5 8.99982V14.9998Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M8.5 14.9998L12 11.9996L8.5 8.99982L8.5 14.9998Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "7",
      y: "11.2498",
      width: "2.5",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "14.5",
      y: "11.2498",
      width: "2.5",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      fill: "none",
      viewBox: "0 0 16 16",
      id: "plus"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M8 1.715v12.571M1.714 8h12.572",
      stroke: "#666",
      strokeWidth: "1.714"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "-100 -100 1224 1224",
      fill: "#525C6F",
      id: "background"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zM389.3 700.2c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-0.6-0.6-1.3-1.2-2-1.7l-78.2-78.2c-3.5-3.5-9.3-3.5-12.8 0l-48 48c-3.5 3.5-3.5 9.3 0 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256z m12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "-100 -100 1224 1224",
      fill: "#525C6F",
      id: "font-color"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zM253.7 736h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-0.2 3.2-0.5 5.1-1.8 7.8-7.3 6-12.4L573.6 118.6c-1.4-3.9-5.1-6.6-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-0.4 1-0.5 2.1-0.5 3.2-0.1 5.3 4.3 9.7 9.7 9.7z m255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "text-overflow"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M16.5 15L20 11.9998L16.5 9V15Z",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "7",
      y: "11.25",
      width: "9.5",
      height: "1.5",
      fill: "#525C6F"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "4.75",
      y1: "5",
      x2: "4.75",
      y2: "19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12.25",
      y1: "5",
      x2: "12.25",
      y2: "9.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12.25",
      y1: "14.5",
      x2: "12.25",
      y2: "19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "text-wrap"
    }, /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "4.75",
      y1: "5",
      x2: "4.75",
      y2: "19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "19.25",
      y1: "5",
      x2: "19.25",
      y2: "19",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M7.00001 16.2502L9.99 13.5V15.5H12.0005C13.9335 15.5 15.5005 13.933 15.5005 12C15.5005 10.067 13.9335 8.5 12.0005 8.5H7V7H12.0005C14.7619 7 17.0005 9.23857 17.0005 12C17.0005 14.7614 14.7619 17 12.0005 17H9.99V19L7.00001 16.2502Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "underline"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M17 19H7V17.5H17V19Z",
      fill: "#394259"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M9.25 5V12.25C9.25 13.7688 10.4812 15 12 15C13.5188 15 14.75 13.7688 14.75 12.25V5H16.25V12.25C16.25 14.5972 14.3472 16.5 12 16.5C9.65278 16.5 7.75 14.5972 7.75 12.25V5H9.25Z",
      fill: "#394259"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "undo"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M3.5 7.75001L7.2019 10.835V8.5H13.25C15.4591 8.5 17.25 10.2909 17.25 12.5C17.25 14.7091 15.4591 16.5 13.25 16.5H7V18H13.25C16.2876 18 18.75 15.5376 18.75 12.5C18.75 9.46244 16.2876 7 13.25 7H7.2019V4.66547L3.5 7.75001Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "redo"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fillRule: "evenodd",
      clipRule: "evenodd",
      d: "M20.5 7.75001L16.7981 10.835V8.5H10.75C8.54086 8.5 6.75 10.2909 6.75 12.5C6.75 14.7091 8.54086 16.5 10.75 16.5H17V18H10.75C7.71243 18 5.25 15.5376 5.25 12.5C5.25 9.46244 7.71243 7 10.75 7H16.7981V4.66547L20.5 7.75001Z",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "fx"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M841 370c3-3.3 2.7-8.3-0.6-11.3-1.5-1.3-3.4-2.1-5.3-2.1h-72.6c-2.4 0-4.6 1-6.1 2.8L633.5 504.6c-2.9 3.4-7.9 3.8-11.3 0.9-0.9-0.8-1.6-1.7-2.1-2.8l-63.5-141.3c-1.3-2.9-4.1-4.7-7.3-4.7H380.7l0.9-4.7 8-42.3c10.5-55.4 38-81.4 85.8-81.4 18.6 0 35.5 1.7 48.8 4.7l14.1-66.8c-22.6-4.7-35.2-6.1-54.9-6.1-103.3 0-156.4 44.3-175.9 147.3l-9.4 49.4h-97.6c-3.8 0-7.1 2.7-7.8 6.4L181.9 415c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H284l-89 429.9c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H269c3.8 0 7.1-2.7 7.8-6.4l89.7-433.1h135.8l68.2 139.1c1.4 2.9 1 6.4-1.2 8.8l-180.6 203c-2.9 3.3-2.6 8.4 0.7 11.3 1.5 1.3 3.4 2 5.3 2h72.7c2.4 0 4.6-1 6.1-2.8l123.7-146.7c2.8-3.4 7.9-3.8 11.3-1 0.9 0.8 1.6 1.7 2.1 2.8L676.4 784c1.3 2.8 4.1 4.7 7.3 4.7h64.6c4.4 0 8-3.6 8-8 0-1.2-0.3-2.4-0.8-3.5l-95.2-198.9c-1.4-2.9-0.9-6.4 1.3-8.8L841 370z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "currency-format"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M675.861333 192l45.610667 44.906667-166.997333 169.6h237.525333v64H544v144.597333h248v64H544v176.597333h-64v-176.597333H232v-64H480v-144.597333H232v-64h237.482667l-166.954667-169.6L348.138667 192 512 358.464 675.861333 192z",
      "p-id": "5490"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "percentage-format"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M855.7 210.8l-42.4-42.4c-3.1-3.1-8.2-3.1-11.3 0L168.3 801.9c-3.1 3.1-3.1 8.2 0 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1 0.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144z m0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zM720 576c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144z m0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z",
      "p-id": "5920"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "number-decrease"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m367.616-403.925333a94.72 94.72 0 0 0-27.306667-17.322667c-25.514667-10.496-54.954667-11.392-81.706667-5.632-36.778667 7.936-66.56 31.872-84.906666 64.256-19.797333 34.816-28.16 77.397333-28.16 139.178667 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.797334c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-50.432-5.888-104.106667-32.768-148.394667a148.906667 148.906667 0 0 0-27.562667-34.474667z m-81.066667 314.197333c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306667 135.552 0 87.04-20.394667 132.565333-58.794667 132.565334z m289.024 212.394667a4.266667 4.266667 0 0 1-4.266667-4.266667V640l-103.68 103.68a4.266667 4.266667 0 0 0 0 6.016L704 853.333333v-75.733333a4.266667 4.266667 0 0 1 4.266667-4.266667H896v-53.333333h-187.733333z",
      "p-id": "6524"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "number-increase"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m366.848-402.944a111.530667 111.530667 0 0 0-45.226667-21.76 142.933333 142.933333 0 0 0-71.253333 1.152A130.56 130.56 0 0 0 305.92 234.666667c-19.797333 34.816-28.16 77.397333-28.16 139.178666 0 61.184 8.405333 102.4 28.16 137.941334a125.866667 125.866667 0 0 0 112.768 67.797333c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-61.696-11.178667-141.653333-61.098666-181.888z m-79.872 313.173334c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306666 135.552 0 87.04-20.394667 132.565333-58.794666 132.565333z m335.232 71.978666c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.730667 28.16-77.312 28.16-135.509333 0-47.786667-3.84-99.114667-27.093333-141.909333-27.178667-50.176-82.944-75.392-139.093334-64.554667l-12.8 3.157333A128.64 128.64 0 0 0 641.706667 234.666667c-19.797333 34.773333-28.16 77.354667-28.16 139.093333 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.754667z m0-340.053333c39.594667 0 59.306667 45.653333 59.306666 135.552 0 86.954667-20.394667 132.565333-58.794666 132.565333-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.192 20.394667-133.76 58.794667-133.76z m34.858666 476.16a4.266667 4.266667 0 0 1-4.266666 4.266667H597.333333v53.333333h187.733334a4.266667 4.266667 0 0 1 4.266666 4.266667V853.333333l103.68-103.68a4.266667 4.266667 0 0 0 0-6.016L789.333333 640v75.733333z",
      "p-id": "6702"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      id: "format-painter"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M15.1004 6.5L6.90039 6.5V9.8L15.1004 9.8L15.1004 6.5ZM15.1004 5C15.9288 5 16.6004 5.67157 16.6004 6.5V9.8C16.6004 10.6284 15.9288 11.3 15.1004 11.3H6.90039C6.07196 11.3 5.40039 10.6284 5.40039 9.8V6.5C5.40039 5.67157 6.07196 5 6.90039 5H15.1004Z"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M17.7174 8.90039H15.3262V7.40039H18.4674C18.8816 7.40039 19.2174 7.73618 19.2174 8.15039V13.7859C19.2174 14.163 18.9374 14.4814 18.5634 14.5297L10.8174 15.5299V19.0004H9.31738V14.8705C9.31738 14.4934 9.59736 14.175 9.97134 14.1267L17.7174 13.1265V8.90039Z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1096 1096",
      id: "formula-sum"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      fill: "#525C6F",
      d: "M725.333333 853.333333H256c-17.066667 0-29.866667-8.533333-38.4-25.6-8.533333-17.066667-4.266667-34.133333 4.266667-46.933333l230.4-268.8-230.4-268.8c-8.533333-12.8-12.8-34.133333-4.266667-46.933333 8.533333-17.066667 21.333333-25.6 38.4-25.6h469.333333c46.933333 0 85.333333 38.4 85.333334 85.333333v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667s-42.666667-17.066667-42.666667-42.666667V256H349.866667l196.266666 226.133333c12.8 17.066667 12.8 38.4 0 55.466667L349.866667 768H725.333333v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 46.933333-38.4 85.333333-85.333334 85.333333z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "arrow-doubleleft"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M272.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512z"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M576.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      id: "arrow-doubleright"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M837.2 492.3L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "freeze-col"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5.75 12H18.25M12 5.5V18.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M12 12L5.5 17.75",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11.25 6L5.75 11.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "freeze-row"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5.75 12H18.25M12 5.5V18.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M18 6.5L11.5 12.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11.25 6L5.75 11.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "freeze-row-col"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M5.75 12H18.25M12 5.5V18.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M18 6L5.75 18.25",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M11.25 6L5.75 11.5",
      stroke: "#525C6F",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 24 24",
      fill: "none",
      id: "freeze-cancel"
    }, /*#__PURE__*/React__default['default'].createElement("rect", {
      x: "5.75",
      y: "5.75",
      width: "12.5",
      height: "12.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "6.5",
      y1: "12",
      x2: "17.5",
      y2: "12",
      stroke: "#535A68",
      strokeWidth: "1.5"
    }), /*#__PURE__*/React__default['default'].createElement("line", {
      x1: "12",
      y1: "17.5",
      x2: "12",
      y2: "6.5",
      stroke: "#535A68",
      strokeWidth: "1.5"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "sort-desc"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z",
      "p-id": "2016"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z",
      "p-id": "2017"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M416 702h-76V172c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v530h-76c-6.7 0-10.5 7.8-6.3 13l112 141.9c3.2 4.1 9.4 4.1 12.6 0l112-141.9c4.1-5.2 0.4-13-6.3-13z",
      "p-id": "2018"
    })), /*#__PURE__*/React__default['default'].createElement("svg", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "sort-asc"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z",
      "p-id": "2263"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z",
      "p-id": "2264"
    }), /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M310.3 167.1c-3.2-4.1-9.4-4.1-12.6 0L185.7 309c-4.2 5.3-0.4 13 6.3 13h76v530c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V322h76c6.7 0 10.5-7.8 6.3-13l-112-141.9z",
      "p-id": "2265"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "more"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M224 597.333333C183.466667 597.333333 149.333333 563.2 149.333333 522.666667S183.466667 448 224 448s74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666zM512 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666S471.466667 448 512 448s74.666667 34.133333 74.666667 74.666667S554.666667 597.333333 512 597.333333zM800 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666s34.133333-74.666667 74.666667-74.666667 74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666z"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      width: "24",
      height: "24",
      id: "text-clip"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M217.6 810.666667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667H217.6a4.266667 4.266667 0 0 0-4.266667 4.266667v588.8a4.266667 4.266667 0 0 0 4.266667 4.266667zM725.333333 217.6v247.466667a4.266667 4.266667 0 0 1-4.266666 4.266666H388.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266667h332.8a4.266667 4.266667 0 0 1 4.266666 4.266666v247.466667a4.266667 4.266667 0 0 0 4.266667 4.266667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667h-76.8a4.266667 4.266667 0 0 0-4.266667 4.266667z",
      "p-id": "13371",
      fill: "#525C6F"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-none"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M657.066667 620.088889c24.177778 0 39.822222-24.177778 31.288889-46.933333L509.155556 150.755556c-14.222222-34.133333-64-34.133333-78.222223 0L250.311111 573.155556c-9.955556 22.755556 7.111111 46.933333 31.288889 46.933333 14.222222 0 25.6-8.533333 31.288889-21.333333l36.977778-92.444445h240.355555l36.977778 92.444445c4.266667 12.8 17.066667 21.333333 29.866667 21.333333z m-285.866667-170.666667L469.333333 203.377778l98.133334 246.044444H371.2zM704 662.755556c-11.377778 11.377778-11.377778 28.444444 0 39.822222l45.511111 45.511111H204.8c-15.644444 0-28.444444 12.8-28.444444 28.444444s12.8 28.444444 28.444444 28.444445h544.711111l-45.511111 45.511111c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0L839.111111 796.444444c11.377778-11.377778 11.377778-28.444444 0-39.822222l-93.866667-93.866666c-11.377778-11.377778-29.866667-11.377778-41.244444 0z",
      "p-id": "17165"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-angleup"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M634.311111 398.222222c17.066667-17.066667 11.377778-45.511111-11.377778-54.044444L196.266667 170.666667c-35.555556-14.222222-69.688889 21.333333-55.466667 55.466666l172.088889 426.666667c8.533333 22.755556 38.4 28.444444 54.044444 11.377778 9.955556-9.955556 12.8-24.177778 7.111111-36.977778l-39.822222-91.022222 170.666667-170.666667 91.022222 39.822222c12.8 4.266667 28.444444 2.844444 38.4-7.111111z m-322.844444 81.066667l-105.244445-243.2L449.422222 341.333333l-137.955555 137.955556zM696.888889 393.955556c0 15.644444 12.8 28.444444 28.444444 28.444444h64L403.911111 807.822222c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0l385.422223-385.422222V526.222222c0 15.644444 12.8 28.444444 28.444444 28.444445s28.444444-12.8 28.444444-28.444445v-133.688889c0-15.644444-12.8-28.444444-28.444444-28.444444h-133.688889c-14.222222 1.422222-27.022222 14.222222-27.022222 29.866667z",
      "p-id": "17929"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-angledown"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M625.777778 634.311111c17.066667 17.066667 45.511111 11.377778 54.044444-11.377778l172.088889-426.666666c14.222222-35.555556-21.333333-69.688889-55.466667-55.466667L371.2 312.888889c-22.755556 8.533333-28.444444 38.4-11.377778 54.044444 9.955556 9.955556 24.177778 12.8 36.977778 7.111111l91.022222-39.822222 170.666667 170.666667-39.822222 92.444444c-4.266667 11.377778-2.844444 27.022222 7.111111 36.977778z m-81.066667-322.844444l243.2-105.244445L682.666667 449.422222l-137.955556-137.955555zM630.044444 696.888889c-15.644444 0-28.444444 12.8-28.444444 28.444444v64L216.177778 403.911111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222l385.422222 385.422223H497.777778c-15.644444 0-28.444444 12.8-28.444445 28.444444s12.8 28.444444 28.444445 28.444444h133.688889c15.644444 0 28.444444-12.8 28.444444-28.444444v-133.688889c-1.422222-14.222222-14.222222-27.022222-29.866667-27.022222z",
      "p-id": "18084"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-vertical"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M465.066667 672.711111c-24.177778 0-39.822222-24.177778-31.288889-46.933333l179.2-423.822222c14.222222-34.133333 64-34.133333 78.222222 0L871.822222 625.777778c9.955556 22.755556-7.111111 46.933333-31.288889 46.933333-14.222222 0-25.6-8.533333-31.288889-21.333333l-36.977777-92.444445H531.911111l-36.977778 92.444445c-4.266667 12.8-17.066667 21.333333-29.866666 21.333333z m285.866666-170.666667L652.8 256 554.666667 502.044444h196.266666zM157.866667 704c11.377778-11.377778 28.444444-11.377778 39.822222 0l45.511111 45.511111V204.8c0-15.644444 12.8-28.444444 28.444444-28.444444s28.444444 12.8 28.444445 28.444444v544.711111l45.511111-45.511111c11.377778-11.377778 28.444444-11.377778 39.822222 0 11.377778 11.377778 11.377778 28.444444 0 39.822222L292.977778 839.111111c-11.377778 11.377778-28.444444 11.377778-39.822222 0l-93.866667-93.866667c-12.8-11.377778-12.8-29.866667-1.422222-41.244444z",
      "p-id": "18239"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-up"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M620.088889 366.933333c0-24.177778-24.177778-39.822222-46.933333-31.288889L150.755556 514.844444c-34.133333 14.222222-34.133333 64 0 78.222223l423.822222 179.2c22.755556 9.955556 46.933333-7.111111 46.933333-31.288889 0-14.222222-8.533333-25.6-21.333333-31.288889l-92.444445-36.977778V433.777778l92.444445-36.977778c11.377778-4.266667 19.911111-17.066667 19.911111-29.866667z m-170.666667 285.866667L203.377778 554.666667l246.044444-98.133334v196.266667zM662.755556 320c11.377778 11.377778 28.444444 11.377778 39.822222 0l45.511111-45.511111v544.711111c0 15.644444 12.8 28.444444 28.444444 28.444444s28.444444-12.8 28.444445-28.444444V274.488889l45.511111 45.511111c11.377778 11.377778 28.444444 11.377778 39.822222 0 11.377778-11.377778 11.377778-28.444444 0-39.822222L796.444444 184.888889c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-93.866666 93.866667c-11.377778 11.377778-11.377778 29.866667 0 41.244444z",
      "p-id": "18394"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "screenshot"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M320 704V128H256v128H128v64h128v448h448v128h64v-128h128v-64H320z m384-64h64V256H384v64h320v320z",
      "p-id": "3788"
    })), /*#__PURE__*/React__default['default'].createElement("symbol", {
      viewBox: "0 0 1024 1024",
      fill: "#535A68",
      id: "text-rotation-down"
    }, /*#__PURE__*/React__default['default'].createElement("path", {
      d: "M403.911111 657.066667c0 24.177778 24.177778 39.822222 46.933333 31.288889L873.244444 509.155556c34.133333-14.222222 34.13333299-64 0-78.222223L450.844444 250.311111c-22.755556-9.955556-46.933333 7.111111-46.933333 31.288889 0 14.222222 8.533333 25.6 21.333333 31.288889l92.444445 36.977778-1e-8 240.355555-92.44444499 36.977778c-12.8 4.266667-21.333333 17.066667-21.333333 29.866667z m170.666667-285.86666701L820.622222 469.33333299l-246.044444 98.13333401L574.577778 371.19999999zM361.244444 704c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-45.511111 45.511111L275.911111 204.79999999c0-15.644444-12.8-28.444444-28.44444399-28.44444399s-28.444444 12.8-28.44444501 28.444444l-1e-8 544.711111-45.51111099-45.511111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222L227.555556 839.111111c11.377778 11.377778 28.444444 11.377778 39.822222-1e-8l93.866666-93.86666699c11.377778-11.377778 11.377778-29.866667 0-41.244444z",
      "p-id": "10914"
    }))));
  };

  var SheetTabContextMenu = function SheetTabContextMenu() {
    var _settings$sheetTabCon;

    var _useContext = React.useContext(WorkbookContext),
        context = _useContext.context,
        setContext = _useContext.setContext,
        settings = _useContext.settings;

    var _context$sheetTabCont = context.sheetTabContextMenu,
        x = _context$sheetTabCont.x,
        y = _context$sheetTabCont.y,
        sheet = _context$sheetTabCont.sheet,
        onRename = _context$sheetTabCont.onRename;

    var _locale = locale(context),
        sheetconfig = _locale.sheetconfig;

    var _useState = React.useState({
      x: -1,
      y: -1
    }),
        _useState2 = _slicedToArray(_useState, 2),
        position = _useState2[0],
        setPosition = _useState2[1];

    var _useAlert = useAlert(),
        showAlert = _useAlert.showAlert,
        hideAlert = _useAlert.hideAlert;

    var containerRef = React.useRef(null);
    var close = React.useCallback(function () {
      setContext(function (ctx) {
        ctx.sheetTabContextMenu = {};
      });
    }, [setContext]);
    React.useLayoutEffect(function () {
      var _containerRef$current;

      var rect = (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.getBoundingClientRect();

      if (rect && x != null && y != null) {
        setPosition({
          x: x,
          y: y - rect.height
        });
      }
    }, [x, y]);
    useOutsideClick(containerRef, close, [close]);
    var moveSheet = React.useCallback(function (delta) {
      if (!sheet) return;
      setContext(function (ctx) {
        var currentOrder = -1;

        lodash.sortBy(ctx.luckysheetfile, ["order"]).forEach(function (_sheet, i) {
          _sheet.order = i;

          if (_sheet.id === sheet.id) {
            currentOrder = i;
          }
        });

        index.setSheetOrder(ctx, _defineProperty({}, sheet.id, currentOrder + delta));
      });
    }, [setContext, sheet]);
    if (!sheet || x == null || y == null) return null;
    return /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-context-menu luckysheet-cols-menu",
      onContextMenu: function onContextMenu(e) {
        return e.stopPropagation();
      },
      style: {
        left: position.x,
        top: position.y,
        overflow: "visible"
      },
      ref: containerRef
    }, (_settings$sheetTabCon = settings.sheetTabContextMenu) === null || _settings$sheetTabCon === void 0 ? void 0 : _settings$sheetTabCon.map(function (name, i) {
      if (name === "delete") {
        return /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: name,
          onClick: function onClick() {
            showAlert(sheetconfig.confirmDelete, "yesno", function () {
              setContext(function (draftCtx) {
                deleteSheet(draftCtx, sheet.id);
              }, {
                deleteSheetOp: {
                  id: sheet.id
                }
              });
              hideAlert();
            });
            close();
          }
        }, sheetconfig.delete);
      }

      if (name === "rename") {
        return /*#__PURE__*/React__default['default'].createElement(Menu, {
          key: name,
          onClick: function onClick() {
            onRename === null || onRename === void 0 ? void 0 : onRename();
            close();
          }
        }, sheetconfig.rename);
      }

      if (name === "move") {
        return /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, {
          key: name
        }, /*#__PURE__*/React__default['default'].createElement(Menu, {
          onClick: function onClick() {
            moveSheet(-1.5);
            close();
          }
        }, sheetconfig.moveLeft), /*#__PURE__*/React__default['default'].createElement(Menu, {
          onClick: function onClick() {
            moveSheet(1.5);
            close();
          }
        }, sheetconfig.moveRight));
      }

      if (name === "|") {
        return /*#__PURE__*/React__default['default'].createElement(Divider$1, {
          key: "divide-".concat(i)
        });
      }

      return null;
    }));
  };

  var MoreItemsContaier = function MoreItemsContaier(_ref) {
    var onClose = _ref.onClose,
        children = _ref.children;
    var containerRef = React.useRef(null);
    useOutsideClick(containerRef, function () {
      onClose === null || onClose === void 0 ? void 0 : onClose();
    }, [containerRef, onClose]);
    return /*#__PURE__*/React__default['default'].createElement("div", {
      ref: containerRef,
      className: "fortune-toolbar-more-container"
    }, children);
  };

  function generateAPIs(context, setContext, settings, cellInput, scrollbarX, scrollbarY) {
    return {
      applyOp: function applyOp(ops) {
        setContext(function (ctx_) {
          var _opToPatch = opToPatch(ctx_, ops),
              _opToPatch2 = _slicedToArray(_opToPatch, 2),
              patches = _opToPatch2[0],
              specialOps = _opToPatch2[1];

          if (specialOps.length > 0) {
            var _specialOps = _slicedToArray(specialOps, 1),
                specialOp = _specialOps[0];

            if (specialOp.op === "insertRowCol") {
              ctx_ = fn(ctx_, function (draftCtx) {
                insertRowCol(draftCtx, specialOp.value);
              });
            } else if (specialOp.op === "deleteRowCol") {
              ctx_ = fn(ctx_, function (draftCtx) {
                deleteRowCol(draftCtx, specialOp.value);
              });
            } else if (specialOp.op === "addSheet") {
              ctx_ = fn(ctx_, function (draftCtx) {
                addSheet(draftCtx, settings);
              });
            } else if (specialOp.op === "deleteSheet") {
              ctx_ = fn(ctx_, function (draftCtx) {
                deleteSheet(draftCtx, specialOp.value.id);
              });
            }
          }

          var newContext = pn(ctx_, patches);
          return newContext;
        }, {
          noHistory: true
        });
      },
      getCellValue: function getCellValue(row, column) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return index.getCellValue(context, row, column, options);
      },
      setCellValue: function setCellValue(row, column, value) {
        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
        return setContext(function (draftCtx) {
          return index.setCellValue(draftCtx, row, column, value, cellInput, options);
        });
      },
      clearCell: function clearCell(row, column) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return setContext(function (draftCtx) {
          return index.clearCell(draftCtx, row, column, options);
        });
      },
      setCellFormat: function setCellFormat(row, column, attr, value) {
        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
        return setContext(function (draftCtx) {
          return index.setCellFormat(draftCtx, row, column, attr, value, options);
        });
      },
      freeze: function freeze(type, range) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return setContext(function (draftCtx) {
          return index.freeze(draftCtx, type, range, options);
        });
      },
      insertRowOrColumn: function insertRowOrColumn(type, index$1, count) {
        var direction = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : "rightbottom";
        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};
        return setContext(function (draftCtx) {
          return index.insertRowOrColumn(draftCtx, type, index$1, count, direction, options);
        });
      },
      deleteRowOrColumn: function deleteRowOrColumn(type, start, end) {
        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
        return setContext(function (draftCtx) {
          return index.deleteRowOrColumn(draftCtx, type, start, end, options);
        });
      },
      setRowHeight: function setRowHeight(rowInfo) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return setContext(function (draftCtx) {
          return index.setRowHeight(draftCtx, rowInfo, options);
        });
      },
      setColumnWidth: function setColumnWidth(columnInfo) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return setContext(function (draftCtx) {
          return index.setColumnWidth(draftCtx, columnInfo, options);
        });
      },
      getRowHeight: function getRowHeight(rows) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return index.getRowHeight(context, rows, options);
      },
      getColumnWidth: function getColumnWidth(columns) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return index.getColumnWidth(context, columns, options);
      },
      getSelection: function getSelection() {
        return index.getSelection(context);
      },
      getFlattenRange: function getFlattenRange(range) {
        return index.getFlattenRange(context, range);
      },
      getCellsByFlattenRange: function getCellsByFlattenRange(range) {
        return index.getCellsByFlattenRange(context, range);
      },
      getSelectionCoordinates: function getSelectionCoordinates() {
        return index.getSelectionCoordinates(context);
      },
      getCellsByRange: function getCellsByRange(range) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return index.getCellsByRange(context, range, options);
      },
      getHtmlByRange: function getHtmlByRange(range) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return index.getHtmlByRange(context, range, options);
      },
      setSelection: function setSelection(range) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return setContext(function (draftCtx) {
          return index.setSelection(draftCtx, range, options);
        });
      },
      setCellValuesByRange: function setCellValuesByRange(data, range) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return setContext(function (draftCtx) {
          return index.setCellValuesByRange(draftCtx, data, range, cellInput, options);
        });
      },
      setCellFormatByRange: function setCellFormatByRange(attr, value, range) {
        var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
        return setContext(function (draftCtx) {
          return index.setCellFormatByRange(draftCtx, attr, value, range, options);
        });
      },
      mergeCells: function mergeCells(ranges, type) {
        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
        return setContext(function (draftCtx) {
          return index.mergeCells(draftCtx, ranges, type, options);
        });
      },
      cancelMerge: function cancelMerge(ranges) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return setContext(function (draftCtx) {
          return index.cancelMerge(draftCtx, ranges, options);
        });
      },
      getAllSheets: function getAllSheets() {
        return index.getAllSheets(context);
      },
      getSheet: function getSheet() {
        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        return index.getSheet(context, options);
      },
      addSheet: function addSheet() {
        return setContext(function (draftCtx) {
          return index.addSheet(draftCtx, settings);
        });
      },
      deleteSheet: function deleteSheet() {
        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        return setContext(function (draftCtx) {
          return index.deleteSheet(draftCtx, options);
        });
      },
      activateSheet: function activateSheet() {
        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        return setContext(function (draftCtx) {
          return index.activateSheet(draftCtx, options);
        });
      },
      setSheetName: function setSheetName(name) {
        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
        return setContext(function (draftCtx) {
          return index.setSheetName(draftCtx, name, options);
        });
      },
      setSheetOrder: function setSheetOrder(orderList) {
        return setContext(function (draftCtx) {
          return index.setSheetOrder(draftCtx, orderList);
        });
      },
      scroll: function scroll(options) {
        return index.scroll(context, scrollbarX, scrollbarY, options);
      },
      addPresences: function addPresences(newPresences) {
        setContext(function (draftCtx) {
          draftCtx.presences = lodash.differenceBy(draftCtx.presences || [], newPresences, function (v) {
            return v.userId == null ? v.username : v.userId;
          }).concat(newPresences);
        });
      },
      removePresences: function removePresences(arr) {
        setContext(function (draftCtx) {
          if (draftCtx.presences != null) {
            draftCtx.presences = lodash.differenceBy(draftCtx.presences, arr, function (v) {
              return v.userId == null ? v.username : v.userId;
            });
          }
        });
      }
    };
  }

  var _excluded = ["onChange", "onOp", "data"];
  T();
  var Workbook = /*#__PURE__*/React__default['default'].forwardRef(function (_ref, ref) {
    var _context$luckysheetfi;

    var onChange = _ref.onChange,
        onOp = _ref.onOp,
        originalData = _ref.data,
        props = _objectWithoutProperties(_ref, _excluded);

    var _useState = React.useState(defaultContext()),
        _useState2 = _slicedToArray(_useState, 2),
        context = _useState2[0],
        setContext = _useState2[1];

    var cellInput = React.useRef(null);
    var fxInput = React.useRef(null);
    var canvas = React.useRef(null);
    var scrollbarX = React.useRef(null);
    var scrollbarY = React.useRef(null);
    var cellArea = React.useRef(null);
    var workbookContainer = React.useRef(null);
    var globalCache = React.useRef({
      undoList: [],
      redoList: []
    });

    var _useState3 = React.useState(null),
        _useState4 = _slicedToArray(_useState3, 2),
        moreToolbarItems = _useState4[0],
        setMoreToolbarItems = _useState4[1];

    var mergedSettings = React.useMemo(function () {
      return lodash.assign(lodash.cloneDeep(defaultSettings), props);
    }, _toConsumableArray(lodash.values(props)));
    var emitOp = React.useCallback(function (ctx, patches, options) {
      if (onOp) {
        onOp(patchToOp(ctx, patches, options));
      }
    }, [onOp]);
    var setContextWithProduce = React.useCallback(function (recipe) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      setContext(function (ctx_) {
        var _produceWithPatches = cn(ctx_, recipe),
            _produceWithPatches2 = _slicedToArray(_produceWithPatches, 3),
            result = _produceWithPatches2[0],
            patches = _produceWithPatches2[1],
            inversePatches = _produceWithPatches2[2];

        if (patches.length > 0 && !options.noHistory) {
          if (options.logPatch) {
            console.info("patch", patches);
          }

          var filteredPatches = filterPatch(patches);
          var filteredInversePatches = filterPatch(inversePatches);

          if (filteredInversePatches.length > 0) {
            if (!options.addSheetOp && !options.deleteSheetOp) {
              globalCache.current.undoList.push({
                patches: filteredPatches,
                inversePatches: filteredInversePatches,
                options: options
              });
              globalCache.current.redoList = [];
            }

            emitOp(result, filteredPatches, options);
          }
        }

        return result;
      });
    }, [emitOp]);
    var handleUndo = React.useCallback(function () {
      var history = globalCache.current.undoList.pop();

      if (history) {
        setContext(function (ctx_) {
          var newContext = pn(ctx_, history.inversePatches);
          globalCache.current.redoList.push(history);
          var inversedOptions = inverseRowColOptions(history.options);

          if (inversedOptions === null || inversedOptions === void 0 ? void 0 : inversedOptions.insertRowColOp) {
            inversedOptions.restoreDeletedCells = true;
          }

          emitOp(newContext, history.inversePatches, inversedOptions);
          return newContext;
        });
      }
    }, [emitOp]);
    var handleRedo = React.useCallback(function () {
      var history = globalCache.current.redoList.pop();

      if (history) {
        setContext(function (ctx_) {
          var newContext = pn(ctx_, history.patches);
          globalCache.current.undoList.push(history);
          emitOp(newContext, history.patches, history.options);
          return newContext;
        });
      }
    }, [emitOp]);
    React.useEffect(function () {
      if (context.luckysheet_select_save != null) {
        var _mergedSettings$hooks, _mergedSettings$hooks2;

        (_mergedSettings$hooks = mergedSettings.hooks) === null || _mergedSettings$hooks === void 0 ? void 0 : (_mergedSettings$hooks2 = _mergedSettings$hooks.afterSelectionChange) === null || _mergedSettings$hooks2 === void 0 ? void 0 : _mergedSettings$hooks2.call(_mergedSettings$hooks, context.currentSheetId, context.luckysheet_select_save[0]);
      }
    }, [context.currentSheetId, context.luckysheet_select_save, mergedSettings.hooks]);
    var providerValue = React.useMemo(function () {
      return {
        context: context,
        setContext: setContextWithProduce,
        settings: mergedSettings,
        handleUndo: handleUndo,
        handleRedo: handleRedo,
        refs: {
          globalCache: globalCache.current,
          cellInput: cellInput,
          fxInput: fxInput,
          canvas: canvas,
          scrollbarX: scrollbarX,
          scrollbarY: scrollbarY,
          cellArea: cellArea,
          workbookContainer: workbookContainer
        }
      };
    }, [context, handleRedo, handleUndo, mergedSettings, setContextWithProduce]);
    React.useEffect(function () {
      if (!lodash.isEmpty(context.luckysheetfile)) {
        onChange === null || onChange === void 0 ? void 0 : onChange(context.luckysheetfile);
      }
    }, [context.luckysheetfile, onChange]);
    React.useEffect(function () {
      setContextWithProduce(function (draftCtx) {
        var _draftCtx$luckysheetf3, _draftCtx$luckysheet_;

        if (lodash.isEmpty(draftCtx.luckysheetfile)) {
          var newData = fn(originalData, function (draftData) {
            ensureSheetIndex(draftData, mergedSettings.generateSheetId);
          });
          draftCtx.luckysheetfile = newData;
        }

        draftCtx.defaultcolumnNum = mergedSettings.column;
        draftCtx.defaultrowNum = mergedSettings.row;
        draftCtx.defaultFontSize = mergedSettings.defaultFontSize;
        draftCtx.lang = mergedSettings.lang;
        draftCtx.allowEdit = mergedSettings.allowEdit;
        draftCtx.hooks = mergedSettings.hooks;

        if (lodash.isEmpty(draftCtx.currentSheetId)) {
          initSheetIndex(draftCtx);
        }

        var sheetIdx = getSheetIndex(draftCtx, draftCtx.currentSheetId);

        if (sheetIdx == null) {
          var _draftCtx$luckysheetf, _draftCtx$luckysheetf2;

          if (((_draftCtx$luckysheetf = (_draftCtx$luckysheetf2 = draftCtx.luckysheetfile) === null || _draftCtx$luckysheetf2 === void 0 ? void 0 : _draftCtx$luckysheetf2.length) !== null && _draftCtx$luckysheetf !== void 0 ? _draftCtx$luckysheetf : 0) > 0) {
            sheetIdx = 0;
            draftCtx.currentSheetId = draftCtx.luckysheetfile[0].id;
          }
        }

        if (sheetIdx == null) return;
        var sheet = (_draftCtx$luckysheetf3 = draftCtx.luckysheetfile) === null || _draftCtx$luckysheetf3 === void 0 ? void 0 : _draftCtx$luckysheetf3[sheetIdx];
        if (!sheet) return;
        var cellData = sheet.celldata;
        var data = sheet.data;

        if (lodash.isEmpty(data)) {
          var _lastRow$r, _lastCol$c;

          var lastRow = lodash.maxBy(cellData, "r");

          var lastCol = lodash.maxBy(cellData, "c");

          var lastRowNum = Math.max((_lastRow$r = lastRow === null || lastRow === void 0 ? void 0 : lastRow.r) !== null && _lastRow$r !== void 0 ? _lastRow$r : 0, draftCtx.defaultrowNum);
          var lastColNum = Math.max((_lastCol$c = lastCol === null || lastCol === void 0 ? void 0 : lastCol.c) !== null && _lastCol$c !== void 0 ? _lastCol$c : 0, draftCtx.defaultcolumnNum);

          if (lastRowNum && lastColNum) {
            var expandedData = lodash.times(lastRowNum + 1, function () {
              return lodash.times(lastColNum + 1, function () {
                return null;
              });
            });

            cellData === null || cellData === void 0 ? void 0 : cellData.forEach(function (d) {
              expandedData[d.r][d.c] = d.v;
            });
            draftCtx.luckysheetfile = fn(draftCtx.luckysheetfile, function (d) {
              d[sheetIdx].data = expandedData;
            });
            data = expandedData;
          }
        }

        if (lodash.isEmpty(draftCtx.luckysheet_select_save) && !lodash.isEmpty(sheet.luckysheet_select_save)) {
          draftCtx.luckysheet_select_save = sheet.luckysheet_select_save;
        }

        if (((_draftCtx$luckysheet_ = draftCtx.luckysheet_select_save) === null || _draftCtx$luckysheet_ === void 0 ? void 0 : _draftCtx$luckysheet_.length) === 0) {
          var _data, _data$, _data$$, _data2, _data2$, _data2$$, _data2$$$mc, _data3, _data3$, _data3$$, _data3$$$mc;

          if (((_data = data) === null || _data === void 0 ? void 0 : (_data$ = _data[0]) === null || _data$ === void 0 ? void 0 : (_data$$ = _data$[0]) === null || _data$$ === void 0 ? void 0 : _data$$.mc) && !lodash.isNil((_data2 = data) === null || _data2 === void 0 ? void 0 : (_data2$ = _data2[0]) === null || _data2$ === void 0 ? void 0 : (_data2$$ = _data2$[0]) === null || _data2$$ === void 0 ? void 0 : (_data2$$$mc = _data2$$.mc) === null || _data2$$$mc === void 0 ? void 0 : _data2$$$mc.rs) && !lodash.isNil((_data3 = data) === null || _data3 === void 0 ? void 0 : (_data3$ = _data3[0]) === null || _data3$ === void 0 ? void 0 : (_data3$$ = _data3$[0]) === null || _data3$$ === void 0 ? void 0 : (_data3$$$mc = _data3$$.mc) === null || _data3$$$mc === void 0 ? void 0 : _data3$$$mc.cs)) {
            draftCtx.luckysheet_select_save = [{
              row: [0, data[0][0].mc.rs - 1],
              column: [0, data[0][0].mc.cs - 1]
            }];
          } else {
            draftCtx.luckysheet_select_save = [{
              row: [0, 0],
              column: [0, 0]
            }];
          }
        }

        draftCtx.config = lodash.isNil(sheet.config) ? {} : sheet.config;
        draftCtx.insertedImgs = sheet.images;
        draftCtx.zoomRatio = lodash.isNil(sheet.zoomRatio) ? 1 : sheet.zoomRatio;

        if (!lodash.isNil(sheet.defaultRowHeight)) {
          draftCtx.defaultrowlen = Number(sheet.defaultRowHeight);
        } else {
          draftCtx.defaultrowlen = mergedSettings.defaultRowHeight;
        }

        if (!lodash.isNil(sheet.defaultColWidth)) {
          draftCtx.defaultcollen = Number(sheet.defaultColWidth);
        } else {
          draftCtx.defaultcollen = mergedSettings.defaultColWidth;
        }

        if (!lodash.isNil(sheet.showGridLines)) {
          var showGridLines = sheet.showGridLines;

          if (showGridLines === 0 || showGridLines === false) {
            draftCtx.showGridLines = false;
          } else {
            draftCtx.showGridLines = true;
          }
        } else {
          draftCtx.showGridLines = true;
        }

        if (lodash.isNil(mergedSettings.lang)) {
          var lang = navigator.languages && navigator.languages[0] || navigator.language || navigator.userLanguage;
          draftCtx.lang = lang;
        }
      }, {
        noHistory: true
      });
    }, [context.currentSheetId, context.luckysheetfile.length, originalData, mergedSettings.defaultRowHeight, mergedSettings.defaultColWidth, mergedSettings.column, mergedSettings.row, mergedSettings.defaultFontSize, mergedSettings.lang, mergedSettings.allowEdit, mergedSettings.hooks, mergedSettings.generateSheetId, setContextWithProduce]);
    var onKeyDown = React.useCallback(function (e) {
      var nativeEvent = e.nativeEvent;
      setContextWithProduce(function (draftCtx) {
        handleGlobalKeyDown(draftCtx, cellInput.current, fxInput.current, nativeEvent, globalCache.current, handleUndo, handleRedo);
      });
    }, [handleRedo, handleUndo, setContextWithProduce]);
    var onPaste = React.useCallback(function (e) {
      if (cellInput.current === document.activeElement) {
        setContextWithProduce(function (draftCtx) {
          handlePaste(draftCtx, e);
        });
      }
    }, [setContextWithProduce]);
    var onMoreToolbarItemsClose = React.useCallback(function () {
      setMoreToolbarItems(null);
    }, []);
    React.useEffect(function () {
      document.addEventListener("paste", onPaste);
      return function () {
        document.removeEventListener("paste", onPaste);
      };
    }, [onPaste]);
    React.useImperativeHandle(ref, function () {
      return generateAPIs(context, setContextWithProduce, mergedSettings, cellInput.current, scrollbarX.current, scrollbarY.current);
    }, [context, mergedSettings, setContextWithProduce]);
    var i = getSheetIndex(context, context.currentSheetId);

    if (i == null) {
      return null;
    }

    var sheet = (_context$luckysheetfi = context.luckysheetfile) === null || _context$luckysheetfi === void 0 ? void 0 : _context$luckysheetfi[i];

    if (!sheet) {
      return null;
    }

    return /*#__PURE__*/React__default['default'].createElement(WorkbookContext.Provider, {
      value: providerValue
    }, /*#__PURE__*/React__default['default'].createElement(ModalProvider, null, /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-container",
      ref: workbookContainer,
      onKeyDown: onKeyDown
    }, /*#__PURE__*/React__default['default'].createElement(SVGDefines, null), /*#__PURE__*/React__default['default'].createElement("div", {
      className: "fortune-workarea"
    }, mergedSettings.showToolbar && /*#__PURE__*/React__default['default'].createElement(Toolbar, {
      moreItemsOpen: moreToolbarItems !== null,
      setMoreItems: setMoreToolbarItems
    }), mergedSettings.showFormulaBar && /*#__PURE__*/React__default['default'].createElement(FxEditor, null)), /*#__PURE__*/React__default['default'].createElement(Sheet, {
      sheet: sheet
    }), mergedSettings.showSheetTabs && /*#__PURE__*/React__default['default'].createElement(SheetTab, null), /*#__PURE__*/React__default['default'].createElement(ContextMenu, null), /*#__PURE__*/React__default['default'].createElement(SheetTabContextMenu, null), moreToolbarItems && /*#__PURE__*/React__default['default'].createElement(MoreItemsContaier, {
      onClose: onMoreToolbarItemsClose
    }, moreToolbarItems), !lodash.isEmpty(context.contextMenu) && /*#__PURE__*/React__default['default'].createElement("div", {
      onMouseDown: function onMouseDown() {
        setContextWithProduce(function (draftCtx) {
          draftCtx.contextMenu = undefined;
        });
      },
      onMouseMove: function onMouseMove(e) {
        return e.stopPropagation();
      },
      onMouseUp: function onMouseUp(e) {
        return e.stopPropagation();
      },
      onContextMenu: function onContextMenu(e) {
        e.preventDefault();
        e.stopPropagation();
      },
      className: "fortune-popover-backdrop"
    }))));
  });

  exports.Workbook = Workbook;

  Object.defineProperty(exports, '__esModule', { value: true });

})));
